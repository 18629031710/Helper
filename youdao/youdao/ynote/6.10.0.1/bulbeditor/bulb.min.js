!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("BulbEditor",[],t):"object"==typeof exports?exports.BulbEditor=t():e.BulbEditor=t()}(window,function(){return function(e){function t(t){for(var o,a,s=t[0],l=t[1],c=t[2],u=0,h=[];u<s.length;u++)a=s[u],i[a]&&h.push(i[a][0]),i[a]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(d&&d(t);h.length;)h.shift()();return r.push.apply(r,c||[]),n()}function n(){for(var e,t=0;t<r.length;t++){for(var n=r[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(r.splice(t--,1),e=a(a.s=n[0]))}return e}var o={},i={1:0},r=[];function a(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,a),n.l=!0,n.exports}a.m=e,a.c=o,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(e,t){if(1&t&&(e=a(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)a.d(n,o,function(t){return e[t]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="./";var s=window.webpackJsonpBulbEditor=window.webpackJsonpBulbEditor||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var d=l;return r.push([249,0]),n()}([,function(e,t,n){(function(o){var i;void 0===(i=function(e){for(var t,o=n(104),i=this&&this.DEBUG?this:window,r=i.DEBUG||null!=i.logLevel,a=i.console,s={},l=function(){},c="log warn error time timeEnd profile profileEnd".split(" "),d=c.length;--d>=0;)t=c[d],r&&a[t]?s[t]=a[t].bind(a):s[t]=l;return r&&i.alert?s.debugAlert=function(e){i.alert(e)}:s.debugAlert=s.error,s.log=function(){o.log("Log: ",Array.from(arguments),"white","#CCCCCC")},s.warn=function(){o.warn(Array.from(arguments))},s.error=function(){o.error(Array.from(arguments))},s.DEBUG=r,s}.call(t,n,t,e))||(e.exports=i)}).call(this,n(60))},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(){function e(){}return e.getAllBlockTypes=function(){return[e.ATTACHMENT,e.BLOCK,e.CATALOGUE,e.HANDWRITE,e.HEADING,e.HR,e.IMAGE,e.LIST_ITEM,e.PARAGRAPH,e.TABLE,e.TODO,e.QUOTE,e.CODE,e.UNKNOWN]},e.getType=function(e){if(e)return e.getType()},e.isParagraph=function(t){return e.getType(t)===e.PARAGRAPH},e.isParagraphCluster=function(t){return this.isParagraphClusterType(e.getType(t))},e.isParagraphClusterType=function(t){return t===e.PARAGRAPH||t===e.LIST_ITEM||t===e.HEADING||t===e.CATALOGUE||t===e.TODO||t===e.QUOTE||t===e.CODE},e.isListItem=function(t){return e.getType(t)===e.LIST_ITEM},e.isAttachment=function(t){return e.getType(t)===e.ATTACHMENT},e.isHeaderFooter=function(e){return this.getType(e)===this.HEADER_FOOTER},e.isTable=function(t){return e.getType(t)===e.TABLE},e.isImage=function(t){return e.getType(t)===e.IMAGE},e.isHr=function(t){return e.getType(t)===e.HR},e.isUnknown=function(t){return this.getType(t)===e.UNKNOWN},e.isHeading=function(t){return e.getType(t)===e.HEADING},e.isCatalogue=function(t){return e.getType(t)===e.CATALOGUE},e.isTodo=function(t){return e.getType(t)===e.TODO},e.isQuote=function(t){return e.getType(t)===e.QUOTE},e.isCode=function(t){return e.getType(t)===e.CODE},e.isTextBlock=function(t,n){return(!n||!n.selectWholeBlock)&&e.isParagraphCluster(t)},e.isTextOrTableBlock=function(t){return e.isTextBlock(t)||e.isTable(t)},e.isHandWrite=function(t){return e.getType(t)===e.HANDWRITE},e.ATTACHMENT="attachment",e.BLOCK="block",e.CATALOGUE="catalogue",e.HANDWRITE="handwrite",e.HEADER_FOOTER="header-footer",e.HEADING="heading",e.HR="horizontal-line",e.IMAGE="image",e.LIST_ITEM="list-item",e.PARAGRAPH="paragraph",e.QUOTE="quote",e.TABLE="table",e.TODO="todo",e.CODE="code",e.UNKNOWN="unknown",e}()}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(){function e(){}return e.isCollabCommand=function(e){var t=!1;return null!=e&&null!=e.collabProperties&&(t=e.collabProperties.isCollabCmd),t},e.isGUID=function(e){return!!e&&/^[\w\-]+$/.test(e)},e.isInlineStateSetCommand=function(e){return null!=e.isInlineStateSet&&!0===e.isInlineStateSet()},e.newGUID=function(){var e="";return e+=(Math.floor(100*Math.random())+"00").substr(0,2),e+=(Math.floor(100*Math.random())+"00").substr(0,2),e+="-",e+=Date.now().toString()},e}()}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0);return{_map:{},add:function(e){var n=e.prototype.name,o=this._map;n?o[n]?t.error("Command class ["+n+"] exists!"):o[n]=e:t.error("The Command class has no name!",e)},get:function(e){var n=this._map[e];return n||t.error("Command class ["+e+"] does not exist!"),n},getAllNames:function(){return o.keys(this._map)}}}.call(t,n,t,e))||(e.exports=o)},,function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return{COMPAT:"compat",DEFAULT_BACKGROUND:"NoBackground",INTERM:"interm",INDENT_WIDTH:28,MAX_LIST_ITEM_LEVEL:9,LINE_BREAK:/Windows/.test(window.navigator.userAgent)?"\r\n":"\n",IS_MAC:/Mac|iPod|iPhone|iPad/.test(window.navigator.platform),QUOTE_PADDING:"0 10px 0 17px",QUOTE_BORDER_LEFT:"3px solid #e8e8e8",QUOTE_MARGIN:"0 5px",PLATFORM_LINE_HEIGHT:1.75,PAGE_TYPE_A4:"A4",PAGE_TYPE_B5:"B5",PAGE_TYPE_NONE:"NONE",PAGE_TYPE_TEST:"TEST",PAGE_HEIGHT_A4:1123,PAGE_HEIGHT_B5:945,PAGE_HEIGHT_NONE:Number.MAX_VALUE,PAGE_HEIGHT_TEST:100,PAGE_WIDTH_A4:792,PAGE_WIDTH_B5:663,PAGE_WIDTH_NONE:Number.MAX_VALUE,PAGE_WIDTH_TEST:792,PAGE_SPLIT_BLANK_HEIGHT:70,PAGE_SPLIT_MIDDLE_HEIGHT:10,TOLERABLE_HEIGHT_CHANGE:3,PAGE_CLASS_A4:"page-A4",PAGE_CLASS_B5:"page-B5",PAGE_CLASS_TEST:"page-TEST",WSClientStatusCode:{Connecting:0,Open:1,Closing:2,Closed:3,Ready:5,Disabled:10,Intializing:11},WSEVENTID_HOST_CLOSE:4500,MAX_MESSAGE_SIZE:5e3,MAX_UNDO_STACK_SIZE:20,MAX_CMD_DELAY_MILLIS:4e3,MAX_INIT_DELAY_MILLIS:2e3,MAX_LOCAL_CMD_COUNT_PER_SEC:20,REGULAR_CMD_SENT_MILLIS:2e3,LATENCY_TO_SHOW_SET_CONTENT_PROGRESS:2e3,CJSON_ACTION:"action",CJSON_COMMANDID:"cmdId",CJSON_COMMANDOWNER:"cmdOwner",CJSON_COLLABCOMMANDS:"collabCmds",CJSON_COLLAB_NOTE_READY:"collabNoteReady",CJSON_COLLAB_VERSION:"collabVersion",CJSON_DATA_CMD_ERROR:"dataCmdError",CJSON_ENDVERSION:"endVersion",CJSON_ERROR_TO_CLOSE:"errToClose",CJSON_FINALVERSION:"finalVersion",CJSON_INITIALIZE_COLLABSTARTED:"collabStarted",CJSON_INITIALIZE_DONE:"done",CJSON_INITIALIZE_RESULT:"initResult",CJSON_IS_HISTORY_SAVE:"isHistorySave",CJSON_IS_SERVER_CMD:"isServerCmd",CJSON_LOCKCOLOR:"lockColor",CJSON_LOCK_BLOCK_ID:"lockedBlkId",CJSON_MODIFIERS:"modifiers",CJSON_NICKNAME:"nickname",CJSON_NONDATACOMMANDS:"nondataCmds",CJSON_NOTEVERSIONUPDATE:"versionUpdate",CJSON_PORTRAIT:"portraitUrl",CJSON_READONLY:"readOnly",CJSON_SESSIONID:"sessionId",CJSON_SESSIONPROPERTY:"sessionProp",CJSON_STARTVERSION:"startVersion",NONDATACMD_BLOCKSELECTION:"nb_BlkSelection",NONDATACMD_CLINTPONG:"nb_clientPong",NONDATACMD_COLLABCLOSE:"nb_CollabClose",NONDATACMD_COLLABINFO:"nb_CollabInfo",NONDATACMD_DATACMDFAILED:"nb_dataCmdFailed",NONDATACMD_GETMODIFIERS:"nb_getModifiers",NONDATACMD_NOTESAVE:"nb_noteSave",NONDATACMD_LOCKRELEASE:"nb_lockRelease",NONDATACMD_SESSIONINITIALIZED:"nb_sessionInitialized",NONDATACMD_SEVERPING:"nb_serverPing",OPTIONS_COLLABID:"collabId",OPTIONS_NICKNAME:"nickname",OPTIONS_NOTEVERSION:"noteVersion",OPTIONS_PORTRAIT:"portraitUrl",OPTIONS_SESSIONTYPE:"sessionType",OPTIONS_SESSIONID:"sessionId",OPTIONS_USERID:"userId",OPTIONS_BUILDVERSION:"buildVersion",OPTIONS_RECONNECT:"reconn",ERRORID_FAILED_RECEIVE_COLLAB_CMD:4001,ERRORID_FAILED_SEND_LOCAL_CMD:4002,ERRORID_COLLAB_ENGINE_NULL:4003,CONNECTION_FAILED_SEND:"发送协同命令失败：",CONNECTION_NO_CONNECTED:"当前没有与协同服务器连接",CONNECTION_REFUSED:"协同服务器连接被拒绝",CONNECTION_SERVER_CLOSED:"协同服务器已经关闭",ERROR_CODE:"错误编码：",ERROR_CONFLICT_EXECUTION:"编辑区域冲突",ERROR_FAILED_SEND_LOCAL_CMD:"发送本地已执行命令失败",ERROR_FAILED_RECEIVE_COLLAB_CMD:"接收协同命令超时",ERROR_EXCEPTION:"未知错误：",ERROR_REASON:"原因：",ERROR_UNMATCHED_VERSION:"本地笔记版本与服务器端不匹配，本地/服务器：",INVALIDACTION_BLANK_NOTE:"笔记还没有加载",INVALIDACTION_BLOCKS_DIRTY:"目标段落已经被人修改过",INVALIDACTION_COLLAB_NOT_READY:"笔记内容不满足协同的要求",INVALIDACTION_EDIT_READ_ONLY:"只读模式下不可以编辑",INVALIDACTION_EDIT_NOT_READY:"笔记还没有进入编辑状态，如果此状态持续数秒，请刷新页面",INVALIDACTION_FINALVERSION_NOTREADY:"被撤销命令正在同步中，请稍后再试",INVALIDACTION_EMPTY_CMDJSON:"空协同操作指令，将被忽略",INVALIDACTION_EMPTY_LOCALCMD:"空本地操作指令，将被忽略",INVALIDACTION_INVALID_LOCALCMD:"无效的本地命令",INVALIDACTION_FAILED_COLLABCMD:"协同命令执行失败",INVALIDACTION_FAILED_LOCALCMD:"本地命令执行失败",INVALIDACTION_INVALID_CMD_VERSION:"被撤销命令版本无效，丢弃此命令",INVALIDACTION_INVALID_RANGE:"命令所操作区域已经被删除或者无效",INVALIDACTION_TOO_MANY_CMD:"命令操作过快，请稍候，等待处理命令个数：",INVALIDACTION_TOO_LARGE_MESSAGE:"操作所含数据过多，请减少操作数据：",INVALIDACTION_UNSUPPORTED_CMD:"不支持的操作指令：",INVALIDACTION_WORK_ON_LOCKED_BLOCK:"当前或相邻的段落或目标段落被锁定或删除，请稍后操作",LOADING_IMAGE_PATH:"http://note.youdao.com/editor/collab/loading.gif?47",INSERT_BLANK_CATALOGUE_TEXT:"目录为空，请插入标题（字体左侧）后点击刷新按钮"}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(13),o=n(1),i=n(0),r=n(447),a={_keyHandlerMap:{},_parseKey:function(e){return e=(e=(e+="").replace(/[\s\uFEFF\xA0]/g,"")).toLowerCase()},_makeMapKey:function(e,t){return(e=e||"main")+"-"+t},getHandler:function(e,t){return this._keyHandlerMap[this._makeMapKey(e,t)]},register:function(e){if(e&&e.name&&e.key&&e.action){var t,n,r,a=this._keyHandlerMap;(n=i.defaults({},e,{scope:"main",read:!1,preventDefault:!0})).key=t=this._parseKey(e.key),t?a[r=this._makeMapKey(n.scope,n.name)]||i.some(a,function(e){return e.key===t&&e.scope===n.scope})?o.error("The key handler is conflict with other",n):a[r]=n:o.warn("The key is not valid!",e)}else o.warn("The param is not valid!",e)},exec:function(e,t,n,i){var r=this._makeMapKey(e,t),a=this._keyHandlerMap[r];a?n.isReadOnly&&n.isReadOnly()&&!a.read?i&&i.preventDefault&&i.preventDefault():(a.preventDefault&&i&&i.preventDefault&&i.preventDefault(),this.disableExec(a,n,i,t)||a.action.apply(a,[n,i,t])):o.warn("No key handler for scope/name: ",e,t)},disableExec:function(e,t,n,o){var i,a,s,l,c,d=r.ACTION_HIDE,u=r.ACTION_DISABLE;return!!t.getNoteRange&&(i=t.getNoteRange().getStartBlockRange().block.getType().toUpperCase(),a=o.replace("insert",""),s=r["RANGE_"+i],l=r.EDITOR_BUTTON_STATE_MAP[a.toLowerCase()],!!(a&&s&&l)&&((c=l.find(function(e){return e.on===s}))&&(c.action===d||c.action===u)))},matchKey:function(e,t){if(t){var n,r=this._keyHandlerMap;if(n=i.find(r,function(n){return n.key===t&&n.scope===e}))return n.name;o.warn("Can not find the key handler with key: "+t)}},getAllHandlerNamesOfScope:function(e){var t=[];return i.each(this._keyHandlerMap,function(n){n.scope===e&&t.push(n.name)}),t}};return t.extend({initialize:function(e){e=i.defaults(e||{},{scope:"main"}),this._scope=e.scope,this._customMap={},delete this.options},getKey:function(e){return(this._customMap[e]||a.getHandler(this._scope,e)||{}).key},bind:function(e){var t=this.getKey(e);t&&this.trigger("bind-key",t)},unbind:function(e){var t=this.getKey(e);t&&this.trigger("unbind-key",t)},updateKey:function(e,t){if(e&&t){a.getHandler(this._scope,e)&&(this.unbind(e),this._customMap[e]={key:t},this.bind(e))}},hasHandler:function(e){return!!a.getHandler(this._scope,e)},execWithKey:function(e,t,n){var r;i.some(this._customMap,function(t,n){if(t.key===e)return r=n,!0}),r||(r=a.matchKey(this._scope,e)),r?a.exec(this._scope,r,t,n):o.warn("no handler for scope/key ",this._scope,e)},execWithName:function(e,t,n){a.exec(this._scope,e,t,n)},getAvailableHandlerNames:function(){return a.getAllHandlerNamesOfScope(this._scope)}},{register:function(e){a.register(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(40),n(13),n(81),n(6),n(1),n(152),n(79),n(19),n(124),n(125)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e,n){return new t({keepLineBreak:!1!==n,text:e})},t.createBlank=function(e){return t.create("",e)},t.fromCollabJSON=function(e){if(!e||!e.text)return t.createBlank(!0);var o=t.create(e.text,e.keepLineBreak);return n.each(e.inlineStyles,function(e,t){n.each(e,function(e){u.isSupport(t)?o.setStyle(e.from,e.to,t,e.value):o.setUnknownStyle(e.from,e.to,t,e.value)})}),o},t.fromJSON=function(e){if(e&&e.isRichText&&e.data){var o,i=[];return n.each(e.data,function(e){var t=c.fromJSON(e);t&&i.push(t)}),(o=new t({keepLineBreak:e.keepLineBreak,text:""})).appendRichChars(i),o}},t.fromXml=function(e){var n=this,o=$(e),i=new t({text:o.find("text").text()});return o.find("inline-styles").children().each(function(e,t){var n,o,r=t.nodeName.toLowerCase(),a=$(t),l=parseInt(a.find("from").text(),10),c=parseInt(a.find("to").text(),10),h=a.find("value");0!==h.length&&(n=h.text(),u.isSupport(r)?i.setStyle(l,c,r,n):(o=a.attr(s.COMPAT),d.isCompatible(o)&&(p.add(r),n=o+"|"+n,i.setUnknownStyle(l,c,r,n))))}),o.find("entities").children().each(function(e,t){var r=$(t),a={},s=r.find("type").text(),l=parseInt(r.find("start").text(),10);a.type=s,a.start=l,a.inlineStyles=n.getEntityStyles("inline-styles",o),i.appendEntity(a)}),i},t.getEntityStyles=function(e,t){var n={};return $(t).find("entities").children().find(e).children().each(function(e,t){var o=t.nodeName,i=$(t).text();n[o]=i}),n},t.CLONE_DATA=function(e){var t,n=e.length,o=new Array(n);for(t=0;t<n;++t)o[t]=e[t].clone();return o},t.EXTRACT_UNKNOWN_VALUE=function(e){var t=e.indexOf("|");return-1===t?{value:e}:{compat:e.substring(0,t),value:e.substring(t+1)}},t.prototype.append=function(e){e&&e.getClonedData||l.warn("no richText"),this.appendRichChars(e.getClonedData())},t.prototype.appendRichChars=function(e){e&&0!==e.length&&(this.isKeepLineBreak()||(e=this._removeLineBreak(e)),this.richTextProps.data=this.richTextProps.data.concat(e))},t.prototype.clone=function(){var e=new t({keepLineBreak:this.isKeepLineBreak(),text:""});return e.appendRichChars(this.getClonedData()),e},t.prototype.getClonedData=function(){return t.CLONE_DATA(this.richTextProps.data)},t.prototype.getCommonStyle=function(e,t,n,o,i){var r,a,c=this.richTextProps.data,d=null;if(this.isEmpty())return u.getDefault(n);if(e<0)l.warn("start should not be less than 0",e);else if(e>t)l.warn("start should not greater than end",e,t);else{if(!(t>c.length)){if(e===t)0===e&&c[0]?d=c[0].getStyle(n,!1,o):c[e-1]&&(d=c[e-1].getStyle(n,!1,o));else for(r=e;r<t;++r)if(c&&c[r]){if(a=c[r].getStyle(n,!1,o),null===d)d=a;else if(d!==a)return i?null:s.INTERM}else l.warn("unexpected undefine in data",c);return!i||d!==s.INTERM&&d!==u.getDefault(n)?d:null}l.warn("end should not geater than data.length",t,c)}},t.prototype.getCommonStyles=function(e,t,o){var i=this,r={},a=u.getAllConfig();return n.each(a,function(n,a){var s=i.getCommonStyle(e,t,a,o);null!=s&&(r[a]=s)}),r},t.prototype.setEntities=function(e){this.richTextProps.entities=e},t.prototype.getEntities=function(){return this.richTextProps.entities},t.prototype.removeEntitiy=function(e){var t=this;n.each(e,function(e,o){var i=n.findLastIndex(t.richTextProps.entities,{type:o});t.richTextProps.entities.splice(i,1)})},t.prototype.getLength=function(e){var t,n=this.richTextProps.data,o=n.length;if(e)for(t=0;t<n.length;t++)$.trim(n[t].toString())||o--;return o},t.prototype.getReadOnlyData=function(){return this.richTextProps.data},t.prototype.getReadOnlyStylesList=function(e,t,o){var i=this,r=this.richTextProps.data,a=[],s=u.getAllConfig();return e=!1!==e,n.each(r,function(r){var l={};n.each(s,function(n,a){var s;s=o&&!r.getStyle(a,!1)&&i.merStyle(o,a)?i.merStyle(o,a):r.getStyle(a,e,t),(e||!e&&null!=s)&&(l[a]=s)}),a.push(l)}),a},t.prototype.merStyle=function(e,t){var o;return n.each(e,function(e,n){t===n&&(o=e)}),o},t.prototype.getStyle=function(e,t,n,i){var r,a,s,c=this.richTextProps.data;if(o(e>=0),o(e<=t),o(t<=c.length),void 0===e||e<0||void 0===t||e>t||t>c.length)return l.error("unexpected params:",e,t,c.length),null;for(s=new Array(t-e),r=e;r<t;++r)a=c[r].getStyle(n,!1,i),s[r-e]=a;return s},t.prototype.getStyleRanges=function(e,t){if(e){if(t=!0===t,u.isSupport(e))t=!1;else if(!t)return;var o,i,r,a,s=this.richTextProps.data,l=s.length,c=[],d=!1;for(o=0;o<l;o++)i=s[o],(r=t?i.getUnknownStyle(e):i.getStyle(e,!1))?(a=n.last(c),!d&&a&&a.value===r?a.to=o+1:c.push({from:o,to:o+1,value:r}),d=!1):d=!0;return c}},t.prototype.getStylesAtIndex=function(e,t){var n=this.richTextProps.data,o=n.length;if(!(e<0||e>=o))return n[e].getStyles(t);l.warn("invlid index of the text",e,n)},t.prototype.indexOf=function(e,t,n){var o,i,r,a,s,l=e.getReadOnlyData(),c=l.length,d=this.getReadOnlyData(),u=d.length;if(c>u)return-1;for(i=t;i<u;i++){for(o=!0,r=0;r<c;r++){if(a=d[i+r],s=l[r],!a){o=!1;break}if((!0!==n||a.char.toLowerCase()!==s.char.toLowerCase())&&a.char!==s.char){o=!1;break}}if(o)return i}return-1},t.prototype.insert=function(e,t){if(e&&e.getClonedData){var n=this.richTextProps.data,o=n.splice(t),i=e.getClonedData();!1===this.isKeepLineBreak()&&!0===e.isKeepLineBreak()&&(i=this._removeLineBreak(i)),this.richTextProps.data=n.concat(i,o)}},t.prototype.isEmpty=function(){return this.getLength(!1)<=0},t.prototype.isKeepLineBreak=function(){return this.richTextProps.keepLineBreak},t.prototype.removeLineBreak=function(){this.richTextProps.data=this._removeLineBreak(this.richTextProps.data)},t.prototype.removeStyles=function(){var e,t=this.richTextProps.data,n=t.length;for(e=0;e<n;++e)t[e].removeStyles()},t.prototype.appendEntity=function(e){this.richTextProps.entities.push(e)},t.prototype.setKeepLineBreak=function(e){(e=!!e)!==this.richTextProps.keepLineBreak&&(this.richTextProps.keepLineBreak=e,!1===this.richTextProps.keepLineBreak&&this.removeLineBreak())},t.prototype.setStyle=function(e,t,o,i,r){if(o&&null!=i){var a,s=this.richTextProps.data,l=n.isArray(i);for(t=Math.min(t,s.length),a=e;a<t;++a)s[a].setStyle(o,l?i[a-e]:i,r)}},t.prototype.setEntity=function(e){var o=this,i=n.sortBy(o.getEntities(),function(e){return e.start}),r=0;i.forEach(function(n){var i=n.type,a=n.start,s=n.inlineStyles,l=new t({text:e[i]});l.setStyles(0,l.getLength(),s),o.insert(l,a+r),r+=l.getLength()}),o.removeEntitiy(e)},t.prototype.setStyles=function(e,t,o){var i=this;o&&n.each(o,function(n,o){i.setStyle(e,t,o,n)})},t.prototype.setUnknownStyle=function(e,t,o,i){var r,a=this.richTextProps.data,s=n.isArray(i);for(t=Math.min(t,a.length),r=e;r<t;++r)a[r].setUnknownStyle(o,s?i[r-e]:i)},t.prototype.slice=function(e,n,o){var i=this.richTextProps.data.slice(e,n),r=new t({});return!1!==o&&(i=t.CLONE_DATA(i)),r.appendRichChars(i),r},t.prototype.toCollabJSON=function(){return this.toJSON(!0)},t.prototype.toJSON=function(e){return!0===e?this._toSimplifyJSON():{data:n.map(this.richTextProps.data,function(e){return e.toJSON()}),isRichText:!0,keepLineBreak:this.isKeepLineBreak()}},t.prototype.toString=function(){for(var e="",t=this.richTextProps.data,n=0,o=t.length;n<o;n++)e+=t[n];return e},t.prototype.toXml=function(e){var t,o=this,i=e.createElement("inline-styles"),r=u.getAllConfig();return n.each(r,function(t,n){var r=o.getStyleRanges(n,!1);o._handleStyleRangesForXML(e,i,n,r,!1)}),t=p.get(),n.each(t,function(t){var n=o.getStyleRanges(t,!0);o._handleStyleRangesForXML(e,i,t,n,!0)}),i},t.prototype.initialize=function(e){var t=this;this.richTextProps=n.clone(e),this.richTextProps=n.defaults(this.richTextProps||{},{keepLineBreak:!0,text:""}),this.richTextProps.data=[],this.richTextProps.entities=[],this.richTextProps.text=r.clear(this.richTextProps.text),this.richTextProps.keepLineBreak||(this.richTextProps.text=this.richTextProps.text.replace(/[\r\n]/g,"")),n.each(h(this.richTextProps.text),function(e){t.richTextProps.data.push(new c(e))})},t.prototype._handleStyleRangesForXML=function(e,o,i,r,a){r&&r.length&&n.each(r,function(n){if(n&&n.value){var r,l,c,d=e.createElement(i),u=e.createElement("from"),h=e.createElement("to"),p=e.createElement("value");u.appendChild(e.createTextNode(n.from)),d.appendChild(u),h.appendChild(e.createTextNode(n.to)),d.appendChild(h),a?((c=(r=t.EXTRACT_UNKNOWN_VALUE(n.value)).compat)&&d.setAttribute(s.COMPAT,c),l=r.value):l=n.value,p.appendChild(e.createTextNode(l)),d.appendChild(p),o.appendChild(d)}})},t.prototype._handleStyleRangesForJSON=function(e,o,i,r){i&&i.length&&n.each(i,function(n){if(n&&n.value){var i,a=e[o];a||(a=e[o]=[]),i=r?t.EXTRACT_UNKNOWN_VALUE(n.value).value:n.value,a.push({from:n.from,to:n.to,value:i})}})},t.prototype._removeLineBreak=function(e){return e&&0!==e.length?e=n.filter(e,function(e){return!1===e.isLineBreak()}):[]},t.prototype._toSimplifyJSON=function(){var e,t,o=this,i={},r=u.getAllConfig();return n.each(r,function(e,t){var n=o.getStyleRanges(t,!1);o._handleStyleRangesForJSON(i,t,n,!1)}),e=p.get(),n.each(e,function(e){var t=o.getStyleRanges(e,!0);o._handleStyleRangesForJSON(i,e,t,!0)}),t={keepLineBreak:o.isKeepLineBreak(),text:o.toString()},n.isEmpty(i)||(t.inlineStyles=i),t},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(80),o=n(0),i=n(1),r=new RegExp("^/yws/res/|^https?://"+t.getNamespace()+"/yws/res"),a=new RegExp("^/yws/api/group|^https?://"+t.getNamespace()+"/yws/api/group"),s={UNKNOWN:-1,WEB_NOTE:1,WEB_GROUP:2,PC:3,IPHONE:4,ANDROID:5,MAC:6},l=window.YNE_PLATFORM||s.UNKNOWN,c=o.keys(s),d={};return s.name=l,o.each(c,function(e){var t=e.toLowerCase(),n=l[e];s["IS_"+e]=l===n||l===t}),l.IS_UNKNOWN&&i.error("The platform is unknown!"),d.isFromWebNote=function(e){return r.test(e)},d.isFromWebGroup=function(e){return a.test(e)},o.extend(s,d),s}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(16),n(1),n(6)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.checkStatus=function(e,o){this.resetStatus(),!1===this.queryAction(e,o)&&(this.isDisabled=this.isHidden=!0),this.isHidden||this.type===t.TYPE.SUBMENU&&(n.invoke(this.items,"checkStatus",e,o),this.isDisabled=0===this.items.filter(function(e){return!e.isHidden&&!e.isDisabled}).length)},t.prototype.onSelected=function(){this.keyHandlerName?this.editor.getController().execKeyHandler(this.keyHandlerName):this.selectAction()},t.prototype.queryAction=function(e,t){i.error("The queryAction() of "+this.name+" should be implemented by options!")},t.prototype.reset=function(){this.resetStatus()},t.prototype.select=function(){this.onSelected()},t.prototype.selectAction=function(){i.error("The selectAction() of "+this.name+" should be implemented by options!")},t.prototype.simplify=function(){var e={index:this.index,type:this.type,isDisabled:this.isDisabled,isHidden:this.isHidden,isDefault:this.isDefault,label:this.label,key:this._getKey()};return this.items&&this.items.length&&(e.items=n.map(this.items,function(e){if(e&&e.simplify)return e.simplify()})),e},t.prototype.initialize=function(e){e=e||{},this.name=e.name,this.label=e.label,this.type=e.type||t.TYPE.ITEM,this.isDefault=!!e.isDefault,this.isDisabled=!!e.isDisabled,this.isHidden=!!e.isHidden,this.key=e.key||"",this.keyHandlerName=e.keyHandlerName||"",this.items=e.items,null!=e.queryAction&&(this.queryAction=e.queryAction),null!=e.selectAction&&(this.selectAction=e.selectAction)},t.prototype.resetStatus=function(){this.isDefault=!1,this.isDisabled=!1,this.isHidden=!1},t.prototype._getKey=function(){var e=this.key||"",o=this.editor.getController().keyHandlerManager;return this.keyHandlerName&&o&&(e=o.getKey(this.keyHandlerName)),e?(e=e.replace(/[\s\uFEFF\xA0]/g,""))?(e=(e=e.toLowerCase()).replace(/mod/,t.MOD),r.IS_MAC&&n.each({meta:"⌘",ctrl:"⌃",alt:"⌥",shift:"⇧"},function(t,n){e=e.replace(n,t)}),e=(e=e.replace(/^([a-z])/g,function(e,t){return t.toUpperCase()})).replace(/\+([a-z])/g,function(e,t){return"+"+t.toUpperCase()})):"":(i.warn("no key for ContextMenuItem: "+this.name),"")},t.TYPE={ITEM:0,SUBMENU:1,SPLIT:2},t.MOD=r.IS_MAC?"meta":"ctrl",t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(244),r=n(3),a=n(1),s=n(17),l=n(86),c=n(2);return t=i.extend({name:"UnknownCompositeCommand",_args:null,_cmds:null,_affectedBlockIds:null,_note:null,isSimple:!1,startingRange:null,endingRange:null,effected:!1,isLocalExecutedCmd:null,finalNoteVersion:null,originalNoteVersion:null,skipBlockLocking:!1,isOriginalCmd:!1,sendingToCollabServerMillis:null,isReadyToApply:null,initialize:function(){var e;this._args=this.options.args||{},this._args.collabProperties=this._args.collabProperties||{},e=this._args.collabProperties,this._cmds=[],this._affectedBlockIds=[],t.__super__.initialize.apply(this),!0===e.isCollabEnabled&&(e.isCollabCmd&&(this.finalNoteVersion=e.finalNoteVersion),this._initializeAffectedBlocks(),this.rangeIsRequired=!0,this.isReadyToApply=!0,this._args.isOriginalCmd&&(this.isOriginalCmd=!0))},finilize:function(){},_applyCommandToComposite:function(e,t){var n,o=this._cmds;o||(o=this._cmds=[]),n=e.apply(),e.isSimple?this.effected=!1!==n:(this.effected=this.effected||e.effected,this._affectedBlockIds||a.error("_affectedBlockIds cannot be null. please check the cmd("+this.name+") initialize has invoked its parent method")),t?this.setEndingRange(t):!e.isSimple&&e.getEndingRange()&&this.setEndingRange(e.getEndingRange()),o.push(e)},apply:function(){throw"Method not implemented."},doReapply:function(e){var t,n,o=this._cmds;if(a.log("doReapply(): `"+this.name+"`"),r.isCollabCommand(e))return this._reapplyCollabCmd(e);if(!o||!o.length)return a.warn("doReapply(): the composite command `"+this.name+"`no _cmds"),!0;for(t=o.length,n=0;n<t;++n)o[n].doReapply(e);return!0},doUnapply:function(e){var t,n=this._cmds;if(r.isCollabCommand(e))return this._unapplyCollabCmd(e);if(!n||!n.length)return a.warn("doUnapply(): the composite command `"+this.name+"`no _cmds"),!0;for(t=n.length-1;t>=0;--t)n[t].doUnapply(e);return!0},setStartingRange:function(e){s.isNoteRange(e)?(this.startingRange=e,this.options.args.range=this.startingRange):a.warn("noteRange is not a NoteRange",e)},setEndingRange:function(e){var t;s.isNoteRange(e)?(this.endingRange=e,t=this._getAffectedBlockIdsFromRange(this.options.note,this.endingRange),this.pushAffectedBlockIds(t)):a.warn("noteRange is not a NoteRange",e)},getStartingRange:function(){return this.startingRange},getEndingRange:function(){return this.endingRange},canBeMerged:function(e){return!!o.contains(["comp.KeyTextInput"],this.name)&&(!this.isCollabUndo&&!this.isCollabRedo&&e.name===this.name&&e.getCmdId()!==this.getCmdId()&&e.isLocalExecutedCmd===this.isLocalExecutedCmd)},executeAtomicCommand:function(e,t){this._applyCommandToComposite(e,t)},fromCollabJSON:function(){var e=this.options.args,n=e.collabProperties.cmdJSON,o=e.collabProperties.coreEditor;t.__super__.fromCollabJSON.apply(this),n&&(n.startNoteRange&&(e.range=l.buildNoteRangeFromJSON(n.startNoteRange,o),e.range?this.setStartingRange(e.range):a.warn("Failed to re-build the startNoteRange",n.startNoteRange)),n.endNoteRange&&(e.endRange=l.buildNoteRangeFromJSON(n.endNoteRange,o),e.endRange&&this.setEndingRange(e.endRange)),n.cmdNoteVersion&&(this.originalNoteVersion=n.cmdNoteVersion),this.skipBlockLocking=n.skipBlockLocking)},getAffectedBlockIds:function(){return o.clone(this._affectedBlockIds)},getCmdFinalNoteVersion:function(){return this.finalNoteVersion},getCmdOriginalNoteVersion:function(){return this.originalNoteVersion},getCollabProps:function(){return this._args.collabProperties},getLockedBlockIds:function(){var e=[],t=this.endingRange;return this.isCollabUndo?t=this.startingRange:this.skipBlockLocking&&(t=null),s.isNoteRange(t)?e.push(t.getEndBlockRange().getBlockId()):t&&a.error("locked targetRange should be a NOTE range",t),e},getIgnoreUndoRedo:function(){return this._args.ignoreUndoRedo},isSingleBlockAffected:function(){var e=!0;return this._args.range?s.isNoteRange(this._args.range)&&this._args.range.isInMultiBlock()&&(e=!1):e=!1,e},isValidStartNoteRange:function(){return!0},mergeLocalCmd:function(e){a.log("targetCmd:",e)},pushAffectedBlockIds:function(e){e&&(this._affectedBlockIds=o.union(this._affectedBlockIds,e))},resetAffectedBlockIds:function(e){this._affectedBlockIds=[],this.pushAffectedBlockIds(e)},setCmdFinalNoteVersion:function(e){this.finalNoteVersion=e},setCmdOriginalNoteVersion:function(e){this.originalNoteVersion=e},setIgnoreUndoRedo:function(e){this._args.ignoreUndoRedo=e},toCollabJSON:function(){var e,n=this,i=t.__super__.toCollabJSON.apply(n),l=[],c=n.getStartingRange(),d=!1;if(n.isOriginalCmd)if(s.isNoteRange(c))i.startNoteRange=c.toCollabJSON();else if(n.rangeIsRequired)return a.error("startingRange should be noteRange",c),null;if(n.isCollabUndo&&(i.isCollabUndo=n.isCollabUndo),n.isCollabRedo&&(i.isCollabRedo=n.isCollabRedo),n.originalNoteVersion&&(i.cmdNoteVersion=n.originalNoteVersion),n.isCollabUndo||n.isCollabRedo){if(n.cmdId=r.newGUID(),i.cmdId=n.cmdId,n.isOriginalCmd)if(s.isNoteRange(n.endingRange))i.endNoteRange=n.endingRange.toCollabJSON();else if(n.rangeIsRequired)return a.error("endingRange should be a noteRange:",n.endingRange),null;o.each(n._cmds,function(t){d||(t.rangeIsRequired=!1,n.isCollabUndo?(t.setCollabRedo(!1),t.setCollabUndo(!0)):(t.setCollabRedo(!0),t.setCollabUndo(!1)),(e=t.toCollabJSON())?l.push(e):(d=!0,a.error("Failed to get cmdJSON",t)))}),i.affectedBlockIds=n._affectedBlockIds.join(",")}return d?null:(l.length>0&&(i.innerCmds=l),n.isLocalExecutedCmd&&(i.isLocalExecutedCmd=!0),i.skipBlockLocking=n.skipBlockLocking,i)},_getAffectedBlockIdsFromRange:function(e,t){var n=[],i=[];if(e&&t){switch(t.getType()){case s.TYPE:n=e.getInterBlocks(t.getStartBlockRange().block,t.getEndBlockRange().block,!0);break;case c.PARAGRAPH:t.block&&n.push(t.block);break;default:a.error("pending supported range type:"+t.getType())}n&&n.length>0&&o.each(n,function(e){i.push(e.getId())})}return i},_initializeAffectedBlocks:function(){var e=[],t=this.options.note,n=this._args.range;n&&(e=this._getAffectedBlockIdsFromRange(t,n),this.pushAffectedBlockIds(e))},_reapplyCollabCmd:function(e){var t=e.collabProperties.cmdJSON;if(t&&t.innerCmds){var n,o=t.innerCmds,i=o.length;for(n=0;n<i;++n){var r=e.collabProperties.coreEditor.buildInnerCommandFromJSON(o[n],e);r&&(r.doReapply(r._args),r.isSimple&&(e.collabProperties.redoUndoEffected=!0))}}},_unapplyCollabCmd:function(e){var t=e.collabProperties.cmdJSON;if(t&&t.innerCmds){var n,o=t.innerCmds;for(n=o.length-1;n>=0;--n){var i=e.collabProperties.coreEditor.buildInnerCommandFromJSON(o[n],e);i&&(i.doUnapply(i._args),i.isSimple&&(e.collabProperties.redoUndoEffected=!0))}}}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(23),n(21),n(106),n(1),n(6),n(61),n(15),n(2),n(24),n(8),n(53),n(19)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(e){var n=new t({});return!0===e&&l.PLATFORM_LINE_HEIGHT&&l.PLATFORM_LINE_HEIGHT!==g.getDefault("line-height",u.PARAGRAPH)&&n.setBlockStyle("line-height",l.PLATFORM_LINE_HEIGHT),n},t.fromJSON=function(e,t){return this.generalFromJSON(e,!1,t)},t.fromCollabJSON=function(e){return this.generalFromJSON(e,!0)},t.fromXml=function(e){var t=this.createBlank();return t.parseIdFromXml(e),t.setText(p.fromXml(e)),$(e).children().each(function(e,n){switch(n.nodeName){case d.TAG_ID_NAME:case d.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":case"language":case"theme":case"entities":break;case"styles":o.fromXml(t,n);break;default:i.appendToTree(t.unknownTree,n)}}),t},t.generalFromJSON=function(e,t,o){if(e){if(e.type=e.type||e.blockType,u.isParagraphClusterType(e.type)&&(e.text||e.richText)){var i,r=this.createBlank();return i=t?p.fromCollabJSON(e.richText):p.fromJSON(e.richText||e.text),r.setText(i),o||n.each(e.styles,function(e,t){r.setBlockStyle(t,e)}),e.blockId&&r.setId(e.blockId),r}s.warn("invalid type or text.")}else s.warn("jsonObj should not be null!")},t.prototype.append=function(e){this.richText.append(e)},t.prototype.countWords=function(e){var t,n=0,o=this.richText;return l.IS_MOBILE||!e?n=r(o):(t=this.getRangeText(e))&&(n=r(t)),n},t.prototype.deleteText=function(e,t,o){n.isObject(e)&&!n.isUndefined(e.start)&&(t=e.end,e=e.start);var i,r=this.richText,a=r.slice(0,e),s=p.createBlank();t>=0&&(i=r.slice(t)),s.append(a),s.append(i),this.setText(s,o)},t.prototype.getBlockBackColor=function(){var e=this.richText.getStyle(0,this.richText.getLength(),"back-color");return u.isParagraph(this)&&e.length&&n.all(e,function(t){return t===e[0]})?e[0]:""},t.prototype.getCommonInlineStyle=function(e,t){var n,o;return t?(n=t.start,o=t.end):(n=this.getStartOffset(),o=this.getEndOffset()),this.richText.getCommonStyle(n,o,e)},t.prototype.getCommonInlineStyles=function(e){var t,n,o=this.richText;return e?(t=e.start,n=e.end):(t=this.getStartOffset(),n=this.getEndOffset()),o.getCommonStyles(t,n)},t.prototype.getDefaultInlineStyles=function(){return f.getAllDefault()},t.prototype.getStartOffset=function(){return 0},t.prototype.getEndOffset=function(){return this.getLength()},t.prototype.getHighlight=function(e,t){if(e&&e.length){var o=this.richText,i=[];return n.each(e,function(e){for(var n=e.getLength(),r=o.indexOf(e,0,t.ignoreCase);-1!==r;)i[r]={end:r+n,start:r},r=o.indexOf(e,r+n,t.ignoreCase)}),(i=n.compact(i)).length?i:null}},t.prototype.getInlineStyleForEmpty=function(e,t){return(this.getInlineStylesForEmpty(t)||{})[e]},t.prototype.getInlineStylesForEmpty=function(e){var t=this.inlineStylesForEmpty;return e&&(t=t||f.getAllDefault()),t=n.clone(t)},t.prototype.getLength=function(e){return this.richText.getLength(e)},t.prototype.getReadOnlyText=function(){return this.richText},t.prototype.getRangeText=function(e){if(e&&null!=e.start)return this.sliceText(e.start,e.end)},t.prototype.getStyleRanges=function(e,t){return this.richText.getStyleRanges(e,t)},t.prototype.getText=function(){return this.richText.slice(0)},t.prototype.getTextStyle=function(e,t,o){var i=this.richText;return n.isObject(t)&&null!=t.start&&(o=t.end,t=t.start),i.getStyle(t,o,e)},t.prototype.getTextStylesAtIndex=function(e){return this.richText.getStylesAtIndex(e)},t.prototype.setEntity=function(e){this.richText.setEntity(e),this.trigger("content-change")},t.prototype.insertText=function(e,t){return this.richText.insert(t,e),this.trigger("content-change"),!0},t.prototype.isEmpty=function(){return this.richText.isEmpty()},t.prototype.isEmptyContent=function(){return 0===this.getLength(!1)},t.prototype.removeAllStyles=function(){e.prototype.removeAllStyles.call(this),this.richText.removeStyles(),this.trigger("content-change",this)},t.prototype.setInlineStylesForEmpty=function(e){this.inlineStylesForEmpty=e},t.prototype.setText=function(e,t){e instanceof p||(n.isString(e)||(e=String(e)),e=new p({text:e})),this.richText=e,this.trigger("content-change",t)},t.prototype.setTextStyle=function(e,t,o,i){var r,a=this.richText;u.isQuote(this)&&(r=this.getDefaultSetFont()),n.isObject(o)&&null!=o.start&&(i=o.end,o=o.start),a.setStyle(o,i,e,t,r),this.trigger("content-change")},t.prototype.sliceText=function(e,t,n){return this.richText.slice(e,t,n)},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.richText=this.richText.toCollabJSON(),t},t.prototype.toHtml=function(e,t,n){var o,i,r,a=document.createElement("div"),s=$(a);return n=!0===n,s.attr("yne-bulb-block","paragraph").css("white-space","pre-wrap"),this.applyBlockStylesOnElement(s),e=e||0,t=null==t?this.getEndOffset():t,o=this.sliceText(e,t,!1),i=h.rich2html(o,{withDefault:n}),s.html(i),r=a.outerHTML,a=s=null,r},t.prototype.toPlain=function(e,t){var n;return e=e||0,n=this.sliceText(e,t,!1).toString(),n=c(n)},t.prototype.toJSON=function(t,n){t=t||0;var o=this.sliceText(t,n,!1),i=e.prototype.toJSON.call(this);return i.richText=o.toJSON(),i},t.prototype.toXml=function(t){var n,r,a=e.prototype.toXml.apply(this,[t]),s=t.createElement("text"),l=this.richText.toString(),c=t.createTextNode(l);return s.appendChild(c),a.appendChild(s),(r=this.richText.toXml(t))&&a.appendChild(r),n=t.createElement("styles"),o.toXml(this,n,t),a.appendChild(n),i.appendToXml(this.unknownTree,a),a},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=u.PARAGRAPH,null!=t.text?this.setText(t.text):this.setText("")},t.prototype.applyBlockStylesOnElement=function(e,t){var o,i=this,r=i.getBlockStyles(),a={};n.each(r,function(e,n){switch(n){case"align":a["text-align"]=e;break;case"indent":case"text-indent":t?(e=i.getBlockStyle("indent")+i.getBlockStyle("text-indent"),o="text-indent"):(e=e>0?e:0,o="indent"===n?"margin-left":"text-indent"),a[o]=e*l.INDENT_WIDTH||"";break;case"line-height":e>0&&(a["line-height"]=String(e));break;case"back-color":a["background-color"]=String(e);break;case"padding":a.padding=String(e);break;default:s.warn("unknown block style: "+n)}}),a["line-height"]||(o=g.getDefault("line-height",u.PARAGRAPH),a["line-height"]=o),o=h.getDefaultForHtml("font-size"),a["font-size"]=o,e.css(a)},t}(d)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(16)],void 0===(i=function(e,t,n){"use strict";return function(e){function t(t){return(t=t||{}).enableEvent=!0,e.call(this,t)||this}return a(t,e),t.prototype.on=function(e,t,n){return this.eventInst.on(e,t,n)},t.prototype.off=function(e,t,n){return this.eventInst.off(e,t,n)},t.prototype.trigger=function(e){for(var t,n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];return(t=this.eventInst).trigger.apply(t,[e].concat(n))},t.prototype.bind=function(e,t,n){return this.eventInst.bind(e,t,n)},t.prototype.unbind=function(e,t,n){return this.eventInst.unbind(e,t,n)},t.prototype.once=function(e,t,n){return this.eventInst.once(e,t,n)},t.prototype.listenTo=function(e,t,n){return this.eventInst.listenTo(e,t,n)},t.prototype.listenToOnce=function(e,t,n){return this.eventInst.listenToOnce(e,t,n)},t.prototype.stopListening=function(e,t,n){return this.eventInst.stopListening(e,t,n)},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(1)],void 0===(i=function(e,t,n){"use strict";return function(){function e(){}return e.getTemplate=function(e,t){var o=e+"/"+t,i=(this&&this.JST?this:window).JST[o];if(!i){if(n.DEBUG)throw new Error("JST has no template: "+o);n.error("JST has no template: "+o)}return i},e.render=function(e,t,o){var i=this.getTemplate(e,t);if(i)return i(o);n.error("no tempalte: "+e+"/"+t+".jst","template/jst.js")},e.trimTempalte=function(e){if(e=e||""){var t,n,o=e.split(/[\r\n]/),i=o.length;for(t=0;t<i;t++)n=(n=o[t]||"").trim(),o[t]=n;return o.join("")}},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(9),n(13),n(1),n(53)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromXml=function(e){throw new Error("The fromXml should be implemented by subclass!")},t.parseResourceList=function(e){var t=[];return $(e).find(">resource-list>resource-mono>res-id").each(function(e,n){var o=$(n).text();(o=$.trim(o))&&t.push(o)}),t},t.prototype.isSupportedBlockStyle=function(e){return l.isSupport(e,this.type)},t.prototype.isEmptyContent=function(){return!1},t.prototype.isEmpty=function(){return!1},t.prototype.setBlockStyle=function(e,t){var o=l.getConfig(e,this.type),i=/^-?\d+%$/;o&&("Enum"===o.type?o.possible[t]||(t=o.default):"Number"!==o.type||n.isNumber(t)?"Boolean"!==o.type||n.isBoolean(t)?n["is"+o.type]&&t&&!n["is"+o.type](t)&&(t=t.default):t="true"===t:(t=null===t||""===t?NaN:i.test(t)?t:Number(t),i.test(t)||!isNaN(t)&&t||(t=o.default)),t=t||o.default,this.styles[e]=t,this.trigger("style-change",e,t))},t.prototype.setBlockStyles=function(e){var t=this;e&&n.each(e,function(e,n){t.setBlockStyle(n,e)})},t.prototype.getBlockStyles=function(){return n.clone(this.styles)},t.prototype.getBlockStyle=function(e,t){var n=l.getConfig(e,this.type);return n?!0===t?this.styles[e]:this.styles[e]||n.default:null},t.prototype.getDefaultBlockStyles=function(){return l.getDefaultsOfBlock(this.type)},t.prototype.removeBlockStyles=function(){this.styles={},this.trigger("styles-reset")},t.prototype.removeAllStyles=function(){this.removeBlockStyles()},t.prototype.toXml=function(e){var n,o,i,r=this.getId();if(null!=r)return n=e.createElement(this.xmlNodeName),o=e.createElement(t.TAG_ID_NAME),i=e.createTextNode(r),o.appendChild(i),n.appendChild(o),n;s.debugAlert("The block has NO id",this)},t.prototype.getType=function(){return this.type},t.prototype.parseIdFromXml=function(e){var n,o;(n=this._getChildByTagName(e,t.TAG_ID_NAME))&&(o=n.textContent),o||i.IS_ANDROID||(n=this._getChildByTagName(e,t.LEGACY_TAG_ID_NAME))&&(o=n.textContent),null==o?this.validForCollab=!1:this.blockId=o},t.prototype.toJSON=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{blockId:this.getId(),blockType:this.type,styles:this.getBlockStyles(),type:this.type}},t.prototype.toHtml=function(e,t,n){throw new Error("toHtml() should be implemented by subclass!")},t.prototype.toPlain=function(e,t){throw new Error("toPlain() should be implemented by subclass!")},t.prototype.countWords=function(e){throw new Error("countWords() should be implemented by subclass!")},t.prototype.setResourceIds=function(e){e&&e.length&&(this.resourceIds=e)},t.prototype.getResourceIds=function(){return this.resourceIds},t.prototype.getExtraInfo=function(e){var t;return this.trigger("get-extra-info",e,function(e){t=e}),t},t.prototype.getDefaultSetFont=function(){var e;return this.trigger("get-default-set-font",function(t){e=t}),e},t.prototype.highlight=function(e,t,n){this.trigger("high-light",e,t,n)},t.prototype.getId=function(){var e=this.blockId;return null==e&&s.debugAlert("The blockId should NOT be null"),e},t.prototype.setId=function(e){null!=e?this.blockId=e:s.debugAlert("The param blockId should NOT be null")},t.prototype.setLocked=function(e,t){this.locked===e&&t&&!t.lockUpdated||(this.locked=e,this.trigger("locked-change",t))},t.prototype.isLocked=function(){return this.locked},t.prototype.getUnknownTree=function(){return this.unknownTree},t.prototype.isValidForCollab=function(){return this.validForCollab},t.prototype.resetLockState=function(){this.locked=!1},t.prototype.toCollabJSON=function(){return this.toJSON()},t.prototype.setReadOnly=function(e){this.readOnly=!!e},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.initialize=function(e){e=e||{},this.styles={},this.validForCollab=!0,null==this.blockId&&(null!=e.blockId||null!=e.id?this.blockId=e.blockId||e.id:this.blockId=o.newGUID()),this.unknownTree={}},t.prototype._getChildByTagName=function(e,t){if(e)for(var n=e.childNodes[0];n;){if(n.nodeName&&n.nodeName===t)return n;n=n.nextSibling}},t.TAG_ID_NAME="coId",t.LEGACY_TAG_ID_NAME="id",t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(20)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(e){(e=e||{}).enableEvent&&(this.eventInst={},n.extend(this.eventInst,o.Events)),this.options=n.extend({},e),this.initialize.apply(this,[e])}return e.extend=function(e,t){var o,i,r=this;return o=e&&n.has(e,"constructor")?e.constructor:function(){return r.apply(this,arguments)},n.extend(o,r,t),(i=function(){this.constructor=o}).prototype=r.prototype,o.prototype=new i,e&&n.extend(o.prototype,e),o.__super__=r.prototype,o},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(12),n(126),n(54),n(9),n(16),n(1),n(6),n(2),n(296)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(e&&e.startRange&&e.endRange)return new t(e);c.warn("options is unvalid!")},t.createForHeaderFooter=function(e){return new t({blockRanges:[new i({block:e})]})},t.createMock=function(){var e={},n=new o({}),i=new r({block:n,end:0,start:0});return e.startRange=i,e.endRange=e.startRange,new t(e)},t.fromCollabJSON=function(e,n){var o=null;if(e){var i=e.startBlockRange,r=e.endBlockRange,a={};a.startRange=n.buildBlockRangeFromJSON(i),e.isInSingleBlock?a.endRange=a.startRange:a.endRange=n.buildBlockRangeFromJSON(r),a.startRange&&a.endRange&&(o=t.create(a))}return o},t.fromNativeRange=function(e,o){if(e){if(e instanceof t)return e;var i=o.parseNativeRange(e);if(i&&i.length)return new t({endRange:n.last(i),startRange:n.first(i)});c.warn("Failed to parse native range to note range!")}else c.warn("no range")},t.isNoteRange=function(e){var n=!1;return e&&e.type===t.TYPE&&e.getStartBlockRange()&&e.getEndBlockRange()&&(n=!0),n},t.isValidType=function(e){return e===t.DATA_TYPES.JSON||e===t.DATA_TYPES.HTML||e===t.DATA_TYPES.PLAIN},t._getMethodName=function(e){var n="";switch(e){case t.DATA_TYPES.JSON:n="JSON";break;case t.DATA_TYPES.HTML:n="Html";break;case t.DATA_TYPES.PLAIN:n="Plain"}return n},t.getBlockRangeMethodName=function(e){var n=t._getMethodName(e);if(n)return"getDataAs"+n},t.prototype.canDrawedByNative=function(){return!this.isInSingleBlock()||this.getStartBlockRange().canDrawedByNative()},t.prototype.clone=function(e){var n,o;return!1===e?(n=this.startRange,o=this.endRange):(n=this.startRange.clone(),o=this.isInSingleBlock()?n:this.endRange.clone()),t.create({startRange:n,endRange:o})},t.prototype.collapse=function(e){var t=!1===e?this.getEndBlockRange():this.getStartBlockRange();t&&t.collapse?(t.collapse(e),this.startRange=t,this.endRange=t):c.warn("There is no blockRange or blockRange has no `collapse` method")},t.prototype.createWalker=function(e,t){return h.create(this,e,t)},t.prototype.getStartBlockRange=function(){return this.startRange},t.prototype.getEndBlockRange=function(){return this.endRange},t.prototype.getDataAsHtml=function(e){var t=this.startRange;return this._isSingleNotFullSelectedLI()?t.block.toHtml(t.start,t.end):e.toHtml(this)},t.prototype.getDataAsJSON=function(e,n){var o=this._getDataWithType(e,t.DATA_TYPES.JSON,n);return o=o||[],JSON.stringify(o)},t.prototype.getDataAsPlain=function(e,n){var o=this._getDataWithType(e,t.DATA_TYPES.PLAIN,n),i="";return o&&o.length&&(i=o.join(d.LINE_BREAK)),i},t.prototype.getDataWithType=function(e,t,n){return this._getDataWithType(e,t,n)},t.prototype.getType=function(){return this.type},t.prototype.isCollapsed=function(){return!(!this.startRange||!this.isInSingleBlock())&&this.startRange.isCollapsed()},t.prototype.isInSingleBlock=function(){return this.startRange===this.endRange},t.prototype.isInMultiBlock=function(){return!this.isInSingleBlock()},t.prototype.isMatchBlockTypes=function(e,t){if(!e)return c.warn("The param note does not exist!"),!1;var n,o,i,r=this.startRange.block,a=this.endRange.block,s=e.getBlockIndex(r),l=e.getBlockIndex(a);if(-1===s||-1===l)return c.warn("startIndex or endIndex is -1!"),!1;for(n=e.getAllBlocks(),o=s;o<=l;o++)if(i=u.getType(n[o]),-1===t.indexOf(i))return!1;return!0},t.prototype.isSingleTableSelected=function(){var e=this.startRange;return!(!this.isInSingleBlock()||!u.isTable(e.block))},t.prototype.setBlockRanges=function(e){this.startRange=n.first(e),this.endRange=n.last(e),this._checkValid()},t.prototype.toCollabJSON=function(e){var t={};return t.startBlockRange=this.startRange.toCollabJSON(e),this.isInSingleBlock()?t.isInSingleBlock=!0:(t.isInSingleBlock=!1,t.endBlockRange=this.endRange.toCollabJSON(e)),t},t.prototype.toNativeRange=function(e){var t,n,o;if(this.canDrawedByNative())if(t=this.getStartBlockRange().toNativeRange(e)){if(this.isInSingleBlock())return t;if(n=this.getEndBlockRange().toNativeRange(e))return(o=document.createRange()).setStart(t.startContainer,t.startOffset),o.setEnd(n.endContainer,n.endOffset),o;c.warn("no native range for end block!")}else c.warn("no native range for start block!")},t.prototype.initialize=function(e){e=e||{},delete this.options,this.type="note",e.startRange||e.endRange||!e.blockRanges?this.setBlockRanges([e.startRange,e.endRange]):this.setBlockRanges(e.blockRanges)},t.prototype._checkValid=function(){var e=this.startRange,t=this.endRange;if(!e||!t)throw new Error("starRange or endRange is not valid!");if(!e.block||!t.block)throw new Error("starRange.block or endRange.block is not valid!");if(e.block===t.block&&e!==t)throw new Error("startRange and endRange should be the same object when startRange.block === endRange.block")},t.prototype._getDataWithType=function(e,n,o){if(e&&e.getBlockAt){if(t.isValidType(n)){o=o||function(){return!0};var i,r,a,l,d=[],h=this.startRange,p=t.getBlockRangeMethodName(n);if(t.DATA_TYPES.PLAIN===n&&this._isSingleNotFullSelectedLI())return i=h.block.toPlain(h.start,h.end),d.push(i),d;if(!(l=this.createWalker(e,function(e){return o(e.block)})))return[];for(a=l.next();a;)null!=(i=a[p]())?Array.isArray(i)?d=d.concat(i):(r=a.block,(s.IS_WEB_NOTE||s.IS_WEB_GROUP)&&u.isAttachment(r)&&i.resource&&!/^http/i.test(i.resource)&&(i.resource=location.protocol+"//"+location.hostname+i.resource),d.push(i)):c.warn("data is null!"),a=l.next();return d}c.warn("type is unvalid!")}else c.warn("note is unvalid!")},t.prototype._isSingleNotFullSelectedLI=function(){var e=this.startRange,t=!1;return this.isInSingleBlock()&&u.isListItem(e.block)&&(0!==e.start||e.end!==e.block.getLength())&&(t=!0),t},t.TYPE="note",t.DATA_TYPES={JSON:1,HTML:2,PLAIN:3},t}(l)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(86),o=n(30),i=n(2),r=n(99),a=n(19),s=n(111),l=n(0),c=n(8),d=n(1),u=n(12),h=n(26),p=n(69),g=n(49),f=n(31),m=n(87),y=n(51),_=n(78),I=n(138),b=n(37),v=n(33),k=n(91),C=n(208),w=n(209),A=n(245),S=n(140),N=n(210),T=n(6),M=n(17),x=n(93),E=n(64);return{createNewListItem:function(e,t,n){var o=new h({id:t,level:e.getLevel(),list:e.getOwnerList(),text:n});return o.setBlockStyles(e.getBlockStyles()),o},createNewParagraph:function(e,t,n,o){var r=new u({blockId:t,text:o?new c({text:n.toString()}):n});return!e||i.isHeading(e)||i.isCatalogue(e)?e&&(r.setBlockStyle("back-color",e.getBlockStyle("back-color")),r.setBlockStyle("padding",e.getBlockStyle("padding"))):r.setBlockStyles(e.getBlockStyles()),r},createNewTodo:function(e,t){var n=new f(t);return e&&n.setBlockStyles(e.getBlockStyles()),n},createNewCode:function(e,t){var n=new y(t);return e&&n.setBlockStyles(e.getBlockStyles()),n},convertCodeToPara:function(e){var t=this,n=e;return i.isCode(e)&&(n=e.toCodeLines().map(function(n){return t.createNewParagraph(e,null,n)})).forEach(function(t){t.setBlockStyles(e.getBlockStyles())}),n},createNewQuote:function(e,t){var n=new m(t);return e&&n.setBlockStyles(e.getBlockStyles()),n},createNewHeading:function(e,t,n,o,r){var a,l;return n.getLength&&!r&&(l=n.getLength(),i.isHeading(e)&&"b"===e.getLevel()&&(n=this._clearHeadingInlineStyle("color",e,n)),n.setStyles(0,l,s.headingInlineStyles[o])),(a=new p({id:t,text:n,level:o})).setBlockStyles(e.getBlockStyles()),s.headingBlockStyles[o]&&!r&&a.setBlockStyles(s.headingBlockStyles[o]),a},_clearHeadingInlineStyle:function(e,t,n){var o,i=t.getLevel(),r=s.headingInlineStyles[i][e];for(o=0;o<n.getLength();o++)r===n.getStylesAtIndex(o)[e]&&delete n.richTextProps.data[o].styles[e];return n},createNewCatalogue:function(e,t){var n=new g(t);return!t.ownerList&&i.isCatalogue(e)&&(t.ownerList=e.getOwnerList()),n=new g(t),e&&n.setBlockStyles(e.getBlockStyles()),n},isForCatalogueBlock:function(e){return i.isHeading(e)&&e.getLevel()<4&&!e.isEmpty()&&e.getText().toString().trim()},deleteSelectedContent:function(e,t,n){var o,r,a,s,l;M.isNoteRange(n)?(o=n.getStartBlockRange(),a=n.getEndBlockRange(),r=o.block,s=a.block,i.isTextBlock(r)&&(i.isCode(r)?o.selectWholeBlock?e.executeAtomicCommand(new b({note:t,blocks:[r]})):e.executeAtomicCommand(new I({block:r,startBlockRange:o,endBlockRange:a})):e.executeAtomicCommand(new _({block:r,start:o.start,end:o.end}))),n.isInMultiBlock()&&((l=t.getInterBlocks(r,s))&&l.length>0&&e.executeAtomicCommand(new b({note:t,blocks:l})),i.isTextBlock(s)&&(i.isCode(s)?e.executeAtomicCommand(new I({block:s,startBlockRange:o,endBlockRange:a})):e.executeAtomicCommand(new _({block:s,start:a.start,end:a.end}))))):d.error("deleteSelectedContent: selectedNoteRange should be a NoteRange",n)},getBackwardBlockRange:function(e,t){var n=e.getPreBlock(t);if(n)return o.createRangeByBlock({block:n,allContent:!1,collapseToStart:!1})},getForwardBlockRange:function(e,t){var n=e.getNextBlock(t);if(n)return o.createRangeByBlock({block:n,allContent:!1,collapseToStart:!0})},getNoteView:function(e){return e._cmdArgs.collabProperties.coreEditor.noteView},insertTabChar:function(e,t,n,o){var i;(i=new c({text:"\t"})).setStyles(0,i.getLength(),o),e.executeAtomicCommand(new k({block:t,start:n,text:i}))},isInSameList:function(e){var t,n=!1;return i.isListItem(e[0])?n=l.every(e,function(e,n){if(i.isListItem(e)){if(0===n)return t=e.getOwnerList(),!0;if(e.getOwnerList()===t)return!0}return!1}):n},recogLink:function(e,t,n,o){var i,a,s={color:"#003884",underline:!0};i=t.getText().toString().slice(n,o);for(var l=o-1;l>=n;l--)if(t.getTextStyle("href",l,l+1)[0]){n=l;break}i=i.slice(n,o),(a=r.matchEnd(i))&&a.result&&(s.href=a.fullURI,e.executeAtomicCommand(new C({blocks:[t],styleNameValues:s,start:n+a.result.index,end:o})))},replaceBlockWithListItem:function(e,t,n,o,i,r){var a,s=o.getId();return e.executeAtomicCommand(new b({note:t,blocks:[o]})),a=this.createNewListItem(n,s,i),e.executeAtomicCommand(new v({note:t,newBlks:[a],preBlk:r})),a},replaceBlockWithParagraph:function(e,t,n,o,i,r){var a,s=n.getId(),l=t.getPreBlock(n);return(a=this.createNewParagraph(n,s,o,r)).setInlineStylesForEmpty(i),e.executeAtomicCommand(new b({note:t,blocks:[n]})),e.executeAtomicCommand(new v({note:t,newBlks:[a],preBlk:l})),a},replaceBlockWithHeading:function(e,t,n,o,i){var r,a=n.getId(),s=t.getPreBlock(n);return r=this.createNewHeading(n,a,o,i),e.executeAtomicCommand(new b({note:t,blocks:[n]})),e.executeAtomicCommand(new v({note:t,newBlks:[r],preBlk:s})),r},deleteHref:function(e,t,n,o){e.executeAtomicCommand(new C({blocks:[t],styleNameValues:{href:"",color:"#393939",underline:!1},start:n,end:o}))},resetAllStyles:function(e,t,n,o,i,r){this.setStylesOnNoteRange(e,t,n,o,i,r)},setNonTextBlockAsEndingRange:function(e,n){var o=t.buildNoteRangeFromNonTextBlock(n);e.setEndingRange(o)},setBlockStyle:function(e,t){e&&e.setInlineStylesForEmpty&&e.isEmpty()&&e.setInlineStylesForEmpty(t)},setResourceBlockStyleByPreBlock:function(e,t){e&&t&&(e.setBlockStyle("back-color",t.getBlockStyle("back-color")),e.setBlockStyle("padding",t.getBlockStyle("padding")))},setStylesOnNoteRange:function(e,t,n,o,r,s){var c,d=this,u=n.getStartBlockRange(),h=u.block,p=n.getEndBlockRange(),g=p.block,f=[],m=[],y=[],_=[],I=!!s&&s.resetAllStyles,b=!!s&&s.isRemoveFormat;return(void 0===o&&void 0===r||I)&&(c=!0,r||(r=a.getAllDefault(["href"]))),o=o||{},r=r||{},d._isFullSelected(u)?m.push(h):(c&&(o=h.getDefaultBlockStyles()),b||d._setBlocksBlockStyles(e,[h],o)),n.isInMultiBlock()&&(f=t.getInterBlocks(h,g),m=l.union(m,f),d._isFullSelected(p)?m.push(g):(c&&(o=g.getDefaultBlockStyles()),b||d._setBlocksBlockStyles(e,[g],o))),l.each(m,function(t){c&&(o=t.getDefaultBlockStyles()),d._setBlocksBlockStyles(e,[t],o),i.isTextBlock(t)&&y.push(t),i.isTable(t)&&_.push(t)}),l.isEmpty(r)||(i.isTextBlock(h)&&!d._isFullSelected(u)&&e.executeAtomicCommand(new C({blocks:[h],styleNameValues:c&&i.isHeading(h)?h.getDefaultInlineStyles():r,start:u.start,end:u.end})),n.isInMultiBlock()&&i.isTextBlock(g)&&!d._isFullSelected(p)&&e.executeAtomicCommand(new C({blocks:[g],styleNameValues:c&&i.isHeading(g)?g.getDefaultInlineStyles():r,start:p.start,end:p.end})),m.length>0&&(y=d._filterHeadingBlock(e,y,r,c),e.executeAtomicCommand(new C({blocks:y,styleNameValues:r,fullText:!0})))),this._filterTableBlocks({isStyleReset:c,startBlockRange:u,endBlockRange:p,noteRange:n,fullSelectedTableBlocks:_,inlineStyles:r,blockStyles:o,targetCmd:e})},_filterHeadingBlock:function(e,t,n,o){if(!o)return t;var r=t.filter(function(e){if(!i.isHeading(e))return e}),a=t.filter(function(e){if(i.isHeading(e))return e});return a.length>0&&a.forEach(function(t){e.executeAtomicCommand(new C({blocks:[t],styleNameValues:t.getDefaultInlineStyles(),fullText:!0}))}),r},_filterTableBlocks:function(e){var t=this,n=e.startBlockRange,o=e.endBlockRange,r=e.noteRange,a=e.fullSelectedTableBlocks,s=e.inlineStyles,c=e.blockStyles,d=e.targetCmd,u=n.block,h=o.block;n.isOnCellEdit&&n.isOnCellEdit()||t._adaptTableStylesInlineToBlock(s,c,e.isStyleReset),l.isEmpty(s)||(i.isTable(u)&&t._setTableCellInlineStyles({table:u,range:n,styles:s,cmd:d}),r.isInMultiBlock()&&i.isTable(h)&&t._setTableCellInlineStyles({table:h,range:o,styles:s,cmd:d}),a.forEach(function(e){t._setTableCellInlineStyles({table:e,styles:s,isAll:!0,cmd:d})})),l.isEmpty(c)||(i.isTable(u)&&t._setTableCellBlockStyles({table:u,range:n,styles:c,cmd:d}),r.isInMultiBlock()&&i.isTable(h)&&t._setTableCellBlockStyles({table:h,range:o,styles:c,cmd:d}),a.forEach(function(e){t._setTableCellBlockStyles({table:e,isAll:!0,styles:c,cmd:d})}))},_adaptTableStylesInlineToBlock:function(e,t,n){!l.isEmpty(e)&&e["back-color"]&&(t.backColor=e["back-color"],n||delete e["back-color"])},_setTableCellInlineStyles:function(e){var t,n,o=e.isAll,i=e.range,r=e.cmd,a=o?E.TYPES.ALL:E.TYPES.NORMAL;i?t=i.getAsRectRange():a===E.TYPES.ALL&&(t=(i=E.create({block:e.table,type:E.TYPES.ALL})).getAsRectRange()),n=t?t.getRect():null,r.executeAtomicCommand(new A({table:e.table,styles:e.styles,type:a,rect:n}))},_setTableCellBlockStyles:function(e){var t=e.isAll,n=e.range?e.range:E.create({block:e.table,type:E.TYPES.ALL}),o=e.cmd,i=n.getAsRectRange(),r=t?E.ALL:E.NORMAL,a=n&&i?i.getRect():null;o.executeAtomicCommand(new S({table:e.table,styles:e.styles,type:r,rect:a}))},setTextBlockAsEndingRange:function(e,n,o,i){var r=t.buildNoteRangeFromParagraph(n,o,i);e.setEndingRange(r)},setCodeBlockAsEndingRange:function(e,t,n,o){var i=x.createNewRange({preCodeRange:t,charOffset:n,lineOffset:o}),r=M.create({endRange:i,startRange:i});e.setEndingRange(r)},expandCodeRange:function(e,t,n,o){var i=x.createNewRange({preCodeRange:t,charOffset:n,lineOffset:o,needCollapse:!1}),r=M.create({endRange:i,startRange:i});return e.setEndingRange(r),i},updateBlocksIndentLevel:function(e,t,n){var o,i,r={},a={};l.each(t,function(e){o=e.getBlockStyle("indent"),!l.isNumber(o)||0===o&&n<0||(i=parseInt(e.getBlockStyle("text-indent"),10)||0,o=o<0?0:o+n,o=Math.min(o,T.MAX_LIST_ITEM_LEVEL-i),r[o]||(r[o]=[]),r[o].push(e))}),l.each(r,function(t,n){a.indent=n,e.executeAtomicCommand(new w({blocks:t,styleNameValues:a}))})},updateBlockTextIndentLevel:function(e,t,n){var o,i,r;o=t.getBlockStyle("text-indent"),r=parseInt(t.getBlockStyle("indent"),10)||0,o||(o=0),i=o+n,(i=Math.min(i,T.MAX_LIST_ITEM_LEVEL-r))>=0&&e.executeAtomicCommand(new w({blocks:[t],styleNameValues:{"text-indent":i}}))},_isFullSelected:function(e){var t=e.block;return i.isTextBlock(t)?0===e.start&&e.end===t.getLength()||void 0:!i.isTable(t)||e.isFullSelected()},_setBlocksBlockStyles:function(e,t,n){l.isEmpty(n)||e.executeAtomicCommand(new w({blocks:t,styleNameValues:n}))},fixMergeCellBeforeRowColChange:function(e){e.isCol?this._fixMergeCellColChange(e):this._fixMergeCellRowChange(e)},_fixMergeCellRowChange:function(e){var t,n,o,i,r=e.table,a=e.isCol,s=e.insertData,l=e.isDelete,c=e.index,u=r.getCells();if(u[c])for(n=0;n<u[c].length;n++)if((t=r.getCell(c,n))&&(t.isMergePoint()&&l&&(i=this._fixMergePointCellWhenDel({cell:t,row:c,col:n,table:r,isCol:a,cmd:e.cmd})),t.isMergedCell())){if((o=this._findMergePointCell({cell:t,row:c,col:n,table:r})).row===c)continue;if((i=this._fixMergePointWithMergeCell({pointCellInfo:o,table:r,isCol:a,isDelete:l,insertData:s,cmd:e.cmd,cellInfo:{row:c,col:n}})).col<n)return void d.error("New index should more then i");n=i.col}},_fixMergeCellColChange:function(e){var t,n,o,i,r=e.table,a=e.isCol,s=e.insertData,l=e.isDelete,c=e.index,u=r.getCells();for(n=0;n<u.length;n++)if((t=r.getCell(n,c))&&(t.isMergePoint()&&l&&(n=(i=this._fixMergePointCellWhenDel({cell:t,row:n,col:c,table:r,isCol:a,cmd:e.cmd})).row),t.isMergedCell())){if((o=this._findMergePointCell({cell:t,row:n,col:c,table:r})).col===c)continue;if((i=this._fixMergePointWithMergeCell({pointCellInfo:o,table:r,isCol:a,isDelete:l,insertData:s,cmd:e.cmd,cellInfo:{row:n,col:c}})).row<n)return void d.error("New index should more then i");n=i.row}},_findMergePointCell:function(e){var t=e.row,n=e.col;return e.table.getCell(t,n,{findMergePointIfNeeded:!0,withPosition:!0})},_fixMergePointWithMergeCell:function(e){var t,n,o,i=e.table,r=e.pointCellInfo,a=e.cellInfo,s=e.isDelete,l=e.isCol,c=e.cmd,d=e.insertData,u=r.cell,h=r.row,p=r.col,g=u.getMergePointAttr(),f=a.row,m=a.col,y=0,_=0;for(s?l?y=-1:_=-1:l?y=1:_=1,c.executeAtomicCommand(new N({table:i,type:N.TYPES.POINT,value:{width:g.width+y,height:g.height+_,fireChange:!1},rect:{row:h,col:p}})),t=f;t<h+g.height;t++)for(n=m;n<p+g.width;n++)o=i.getCell(t,n).getMergedCellAttr(),n===m&&!s&&l&&d[t]&&d[t].setMergedCellAttr(o.dx,o.dy),t!==f||s||l||!d[n]||d[n].setMergedCellAttr(o.dx,o.dy),c.executeAtomicCommand(new N({table:i,type:N.TYPES.CELL,value:{dx:o.dx+y,dy:o.dy+_,fireChange:!1},rect:{row:t,col:n}}));return{row:h+g.height-1,col:p+g.width-1}},_fixMergePointCellWhenDel:function(e){var t,n,o,i,r=e.cell,a=e.row,s=e.col,l=e.table,c=e.isCol,d=e.cmd,u=r.getMergePointAttr(),h=0,p=0;for(c?p=1:h=1,t=a+h;t<a+u.height;t++)for(n=s+p;n<s+u.width;n++)(o=l.getCell(t,n))&&(t!==a+h||n!==s+p?(i=o.getMergedCellAttr(),d.executeAtomicCommand(new N({table:l,type:N.TYPES.CELL,value:{dx:i.dx-p,dy:i.dy-h},rect:{row:t,col:n}}))):d.executeAtomicCommand(new N({table:l,type:N.TYPES.POINT,value:{width:u.width-p,height:u.height-h},rect:{row:t,col:n}})));return{row:a+u.height-1,col:s+u.width-1}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(153)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.getAllConfig=function(t){var o=e.getStyleNames(t),i={};return n.each(o,function(t){i[t]=e.getConfig(t)}),i},e.getAllDefault=function(t){var o=e.getStyleNames(t),i={};return n.each(o,function(t){i[t]=e.getDefault(t)}),i},e.getConfig=function(t){var i=o[t],r=e.overrideDefaults[t];return i&&r&&((i=n.clone(i)).default=r),i},e.getDefault=function(t){var n=e.overrideDefaults[t];return null!=n?n:(n=o[t])?n.default:void 0},e.getStyleNames=function(e){var t=n.keys(o);return e&&e.length?n.difference(t,e):t},e.isSupport=function(e){return null!=o[e]},e.reset=function(){e.overrideDefaults={}},e.setDefault=function(t,n){var o=e.getDefault(t);null!=n&&n!==o&&(e.overrideDefaults[t]=n)},e.overrideDefaults={},e}()}.apply(t,o))||(e.exports=i)},,function(e,t,n){var o,i;o=[n,t,n(0),n(6),n(79),n(1)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(){function e(){}return e.appendToTree=function(e,t){if(e&&t){var n=$(t).attr(o.COMPAT);i.isCompatible(n)&&(e.unknown||(e.unknown=[]),e.unknown.push(t.cloneNode(!0)))}else r.error("arguments are not valid!")},e.appendToXml=function(e,t){e&&t?e.unknown&&e.unknown.length&&n.each(e.unknown,function(e){var n;e&&e.cloneNode&&(n=e.nodeName,$(t).find(">"+n).length>0?r.error("unknown node <"+n+"> has already exist!"):t.appendChild(e.cloneNode(!0)))}):r.error("arguments are not valid!")},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(244),i=n(1);return t=o.extend({name:"UnknownSimpleCommand",isSimple:!0,initialize:function(){t.__super__.initialize.apply(this)},apply:function(){throw"Method not implemented."},doReapply:function(e){return i.log("doReapply(): `"+this.name+"`"),this.apply(e)},doUnapply:function(){throw i.log("doReapply(): `"+this.name+"`"),"Method not implemented."},isCollabCommand:function(){var e=this.options.args;return null!=e&&null!=e.collabProperties&&!0===e.collabProperties.isCollabCmd}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(53),n(21)],void 0===(i=function(e,t,n,o,i){"use strict";return function(){function e(){}return e.toXml=function(e,t,r){var a=e.getBlockStyles(),s=e.getType(),l=o.getStyleNamesOfBlock(s);n.each(l,function(e){var n=a[e],i=o.getConfig(e,s,!1);if(null!=n&&n!==i.default){var l=r.createElement(e),c=r.createTextNode(n);l.appendChild(c),t.appendChild(l)}});var c=e.getUnknownTree();c&&c.styles&&i.appendToXml(c.styles,t)},e.fromXml=function(e,t){var r=e.getUnknownTree(),a=e.getType(),s=o.getStyleNamesOfBlock(a),l=[];$(t).children().each(function(t,n){var o,a=n.nodeName;e.isSupportedBlockStyle(a)?(o=$(n).text(),e.setBlockStyle(a,o),l.push(a)):(r.styles||(r.styles={}),i.appendToTree(r.styles,n))}),n.each(s,function(t){var n;-1===l.indexOf(t)&&(n=o.getConfig(t,a,!1),e.setBlockStyle(t,n.default))})},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(62),n(107),n(8),n(19)],void 0===(i=function(e,t,n,o,i,r,a){"use strict";return function(){function e(){}return e.getCssRule=function(t){return e.globalInlineStyleRules[t]},e.getDefaultForHtml=function(t){var n,o,i,r=e.inlineStyleDefaultForHtml[t];return null==r&&(n=e.getCssRule(t),o=a.getDefault(t),n?((i={})[t]=o,r=n(i)):r=o,e.inlineStyleDefaultForHtml[t]=r),r},e.html2rich=function(e){return new r({text:$(e).text()})},e.rich2html=function(t,o){var r,a,s,l,c,d,u,h=t.getReadOnlyData(),p=t.getEntities(),g=h.length,f=[],m="";if(o=n.defaults(o||{},{customDefaultStyles:null,styleRules:null,withDefault:!0,styles:null}),0===g)return"<br>";for(r=t.getReadOnlyStylesList(o.withDefault,o.customDefaultStyles,o.styles),o.styleRules?(u=n.clone(o.styleRules),n.defaults(u,e.globalInlineStyleRules)):u=e.globalInlineStyleRules,u=i.getRules(u),p&&p.length&&(l=n.pluck(p,"start")),a=0;a<g;++a)s=h[a],d=r[a],e.isEqualStyles(c,d)||(e.handleEndStyles(f),m!==d.href&&(e.handleEndHref(f),e.handleStartHref(f,d.href)),e.handleStartStyles(f,d,u)),f.push(n.escape(s.toString())),l&&n.contains(l,a)&&f.push('<span class = "loading" ></span>'),c=d,m=d.href;return e.handleEndStyles(f),e.handleEndHref(f),f.join("")},e.resetCssRules=function(){e.globalInlineStyleRules={},e.resetInlineStyleDefaultForHtml()},e.resetInlineStyleDefaultForHtml=function(t){t?(t+="",delete e.inlineStyleDefaultForHtml[t]):e.inlineStyleDefaultForHtml={}},e.setCssRules=function(t){n.each(t,function(t,o){n.isFunction(t)&&(e.globalInlineStyleRules[o]=t,e.resetInlineStyleDefaultForHtml(o))})},e.anchorEndTag=function(){return"</a>"},e.anchorStartTag=function(e){return e+="",'<a href="'+o.safeHref(e)+'">'},e.handleEndHref=function(t){t.push(e.anchorEndTag())},e.handleEndStyles=function(t){t.push(e.spanEndTag())},e.handleStartHref=function(t,n){n&&t.push(e.anchorStartTag(n))},e.handleStartStyles=function(t,o,i){n.isEmpty(o)||t.push(e.spanStartTag(o,i))},e.isEqualStyles=function(t,n){if(!t||!n)return!1;var o,i=e.supportedInlineStyleNames.length;for(o=0;o<i;o++)if(t[e.supportedInlineStyleNames[o]]!==n[e.supportedInlineStyleNames[o]])return!1;return!0},e.spanEndTag=function(){return"</span>"},e.spanStartTag=function(e,t){var o=document.createElement("span");return n.each(t,function(t,n){var i=t(e);(i||0===i)&&(o.style[n]=i)}),o.outerHTML.replace(/<\/span>$/i,"")},e.globalInlineStyleRules={},e.inlineStyleDefaultForHtml={},e.supportedInlineStyleNames=a.getStyleNames(),e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return function(e,t,n,o){if(o=!0===o,e||o){var i,r,a,s,l=function(e,t){var n,o,i;if(t.implementation&&t.implementation.createHTMLDocument)return(n=t.implementation.createHTMLDocument("title")).body.innerHTML=e,n;if((i=t.defaultView||window).DOMParser){o=new i.DOMParser;try{n=o.parseFromString("","text/html")}catch(e){}if(n)return n.body.innerHTML=e,n}}(e,t=t||document);if(l){if(!1!==n)return l.body;for(i=(a=l.body.childNodes).length,s=[],r=0;r<i;r++)s.push(a[r]);return s}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(23),n(29),n(21),n(40),n(1),n(6),n(61),n(15),n(2),n(92),n(12),n(24),n(8)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y){"use strict";return function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.createBlank=function(){return new t({})},t.fromCollabJSON=function(e){return this.generalFromJSON(e,!0)},t.fromJSON=function(e){return this.generalFromJSON(e,!1)},t.fromXml=function(e){var n,o=$(e),r=parseInt(o.attr("level"),10)||1;return(n=new t({level:r})).setText(y.fromXml(e)),n.parseIdFromXml(e),$(e).children().each(function(e,t){switch(t.nodeName){case h.TAG_ID_NAME:case h.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":i.fromXml(n,t);break;default:s.appendToTree(n.unknownTree,t)}}),n},t.getOrCreateListById=function(e,t,n){var i,a,s=null,l=t;for(a=e.length-1;a>=0;--a)i=e[a],p.isListItem(i)&&i.getOwnerList()&&i.getOwnerList().getId()===t&&(i.getOwnerList().getType()===n?s=i.getOwnerList():l=o.newGUID());return s||(s=new r({listId:l,type:n})),s},t.generalFromJSON=function(t,n){var o=e.generalFromJSON.call(this,t,n);return o&&(t.listId&&o.setListId(t.listId),t.listType&&o.setListType(t.listType),t.level&&o.setLevel(t.level),t.index&&o.setIndex(t.index)),o},t.prototype.getIndex=function(){return this.index},t.prototype.getListId=function(){return this.ownerList?this.ownerList.getId():this.listItemProps.listId},t.prototype.getListType=function(){return this.ownerList?this.ownerList.getType():this.listItemProps.listType},t.prototype.getLevel=function(){return this.listItemProps.level},t.prototype.getOwnerList=function(){return this.ownerList},t.prototype.isOrdered=function(){return this.ownerList.isOrdered()},t.prototype.setIndex=function(e){n.isNumber(e)&&e>0&&(this.index=e,this.trigger("index-change",e))},t.prototype.setLevel=function(e){n.isNumber(e)&&(e=Math.max(e,1),e=Math.min(e,d.MAX_LIST_ITEM_LEVEL),this.listItemProps.level=e,this.ownerList&&this.ownerList.updateIndexes(),this.trigger("level-change",e))},t.prototype.setListId=function(e){this.listItemProps.listId?c.error("should not override existing listId"):this.listItemProps.listId=e},t.prototype.setListType=function(e){this.listItemProps.listType?c.error("should not override existing listType"):this.listItemProps.listType=e},t.prototype.setOwnerList=function(e){this.ownerList=e,this.ownerList&&(this.listItemProps.listId=this.ownerList.getId(),this.listItemProps.listType=this.ownerList.getType())},t.prototype.toCollabJSON=function(){return this._generalToJSON(null,null,!0)},t.prototype.toHtml=function(e,t,n){var o,i,r,a=document.createElement("li"),s=$(a);return n=!0===n,this.applyBlockStylesOnElement(s),s.css("list-style-position","inside").css("white-space","pre-wrap").css("word-break","break-word"),(r=g.makeHtmlMarker(this))&&r.listStyleType&&s.css("list-style-type",r.listStyleType),r&&r.markerStyles&&s.css(r.markerStyles),e=e||0,o=this.sliceText(e,t,!1),i=m.rich2html(o,{withDefault:n}),a.innerHTML=i,a.outerHTML},t.prototype.toJSON=function(e,t){return this._generalToJSON(e,t,!1)},t.prototype.toPlain=function(e,t){var n;return e=e||0,n=this.sliceText(e,t,!1).toString(),n=u(n)},t.prototype.toXml=function(t){var n,o=this.getOwnerList();if(o)return(n=e.prototype.toXml.apply(this,[t])).setAttribute("level",this.getLevel().toString()),n.setAttribute("list-id",this.listItemProps.listId),{listId:this.listItemProps.listId,listItem:n,listType:o.getType(),ownerList:o};c.error("The list item has no owner list!")},t.prototype.updateListType=function(){this.ownerList&&(this.listItemProps.listType=this.ownerList.getType())},t.prototype.initialize=function(t){var o=t.level||1;e.prototype.initialize.call(this,t),this.type=p.LIST_ITEM,this.listItemProps=n.clone(t),this.setLevel(o),this.setIndex(1),t.list&&(this.ownerList=t.list,this.listItemProps.listId=this.ownerList.getId(),this.listItemProps.listType=this.ownerList.getType()),!this.listItemProps.listId&&t.listId&&(this.listItemProps.listId=t.listId),!this.listItemProps.listType&&t.listType&&(this.listItemProps.listType=t.listType),t.id&&this.setId(t.id),t.text&&this.setText(t.text),this.on("attached",this._onAttached.bind(this)),this.on("detached",this._onDetached.bind(this))},t.prototype._onAttached=function(e){var n,o,i=this.getOwnerList(),r=e.getAllBlocks(),a=e.getBlockIndex(this),s=null;if(l(a>=0,"Block not attached yet.",a,this),!i&&this.getListId()&&(i=t.getOrCreateListById(r,this.getListId(),this.getListType()),this.setOwnerList(i)),0===i.getLength())i.insertAfter(this,null);else{for(n=a-1;n>=0;--n)if(o=r[n],p.isListItem(o)&&o.getOwnerList()===i){s=o;break}i.insertAfter(this,s)}},t.prototype._onDetached=function(){this.getOwnerList().removeItem(this)},t.prototype._generalToJSON=function(t,n,o){var i;return(i=o?e.prototype.toCollabJSON.call(this):e.prototype.toJSON.call(this,t,n)).level=this.getLevel(),i.index=this.getIndex(),this.listItemProps.listId&&(i.listId=this.listItemProps.listId),this.listItemProps.listType&&(i.listType=this.listItemProps.listType),i},t}(f)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){n(206);var t=n(205),o=n(0),i=n(1),r=n(14);return t.extend({className:"toolbar-item toolbar-button",events:{click:"onClick",mousedown:"onMouseDown"},name:"unknown",label:"",text:!1,defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:null,editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},initialize:function(e){this.editor=e.editor,this.render(),this.setState(this.defaultState),this.bindEditorEvents(),this.bindEvents()},render:function(){var e,t=this.$el,n=this.label;t.addClass("button-"+this.name),e=r.render("pc",this.templateName,{name:this.name,label:this.label,text:this.text,defaultState:this.defaultState}),t.html(e),null!=this.shortcut&&(n="<div><span>"+this.label+'</span><span class="split"></span><span>'+this.shortcut+"</span><div>"),t.find(".button-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300],content:n,contentAsHTML:!0}),this.isVisible||this.hide()},bindEvents:function(){},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})},onMouseDown:function(e){e.preventDefault()},onClick:function(){},setState:function(e){var t=this.$el;e=!0===e,this.state=e,e?t.find(".button").addClass("active"):t.find(".button").removeClass("active")},reset:function(){i.warn("Button ["+this.name+"] reset(): do nothing!")},onSelectionChange:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;!function(){function i(e,t){if(t=t||{},(e=e||"")instanceof i)return e;if(!(this instanceof i))return new i(e,t);var n=function(e){var t={r:0,g:0,b:0},n=1,o=!1,i=!1;return"string"==typeof e&&(e=function(e){e=e.replace(T,"").replace(M,"").toLowerCase();var t,n=!1;if(H[e])e=H[e],n=!0;else if("transparent"==e)return{r:0,g:0,b:0,a:0,format:"name"};return(t=G.rgb.exec(e))?{r:t[1],g:t[2],b:t[3]}:(t=G.rgba.exec(e))?{r:t[1],g:t[2],b:t[3],a:t[4]}:(t=G.hsl.exec(e))?{h:t[1],s:t[2],l:t[3]}:(t=G.hsla.exec(e))?{h:t[1],s:t[2],l:t[3],a:t[4]}:(t=G.hsv.exec(e))?{h:t[1],s:t[2],v:t[3]}:(t=G.hsva.exec(e))?{h:t[1],s:t[2],v:t[3],a:t[4]}:(t=G.hex8.exec(e))?{a:(o=t[1],A(o)/255),r:A(t[2]),g:A(t[3]),b:A(t[4]),format:n?"name":"hex8"}:(t=G.hex6.exec(e))?{r:A(t[1]),g:A(t[2]),b:A(t[3]),format:n?"name":"hex"}:!!(t=G.hex3.exec(e))&&{r:A(t[1]+""+t[1]),g:A(t[2]+""+t[2]),b:A(t[3]+""+t[3]),format:n?"name":"hex"};var o}(e)),"object"==typeof e&&(e.hasOwnProperty("r")&&e.hasOwnProperty("g")&&e.hasOwnProperty("b")?(r=e.r,a=e.g,s=e.b,t={r:255*C(r,255),g:255*C(a,255),b:255*C(s,255)},o=!0,i="%"===String(e.r).substr(-1)?"prgb":"rgb"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("v")?(e.s=N(e.s),e.v=N(e.v),t=function(e,t,n){e=6*C(e,360),t=C(t,100),n=C(n,100);var o=E.floor(e),i=e-o,r=n*(1-t),a=n*(1-i*t),s=n*(1-(1-i)*t),l=o%6;return{r:255*[n,a,r,r,s,n][l],g:255*[s,n,n,a,r,r][l],b:255*[r,r,s,n,n,a][l]}}(e.h,e.s,e.v),o=!0,i="hsv"):e.hasOwnProperty("h")&&e.hasOwnProperty("s")&&e.hasOwnProperty("l")&&(e.s=N(e.s),e.l=N(e.l),t=function(e,t,n){function o(e,t,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?e+6*(t-e)*n:.5>n?t:2/3>n?e+6*(t-e)*(2/3-n):e}var i,r,a;if(e=C(e,360),t=C(t,100),n=C(n,100),0===t)i=r=a=n;else{var s=.5>n?n*(1+t):n+t-n*t,l=2*n-s;i=o(l,s,e+1/3),r=o(l,s,e),a=o(l,s,e-1/3)}return{r:255*i,g:255*r,b:255*a}}(e.h,e.s,e.l),o=!0,i="hsl"),e.hasOwnProperty("a")&&(n=e.a)),n=k(n),{ok:o,format:e.format||i,r:L(255,O(t.r,0)),g:L(255,O(t.g,0)),b:L(255,O(t.b,0)),a:n};var r,a,s}(e);this._originalInput=e,this._r=n.r,this._g=n.g,this._b=n.b,this._a=n.a,this._roundA=D(100*this._a)/100,this._format=t.format||n.format,this._gradientType=t.gradientType,this._r<1&&(this._r=D(this._r)),this._g<1&&(this._g=D(this._g)),this._b<1&&(this._b=D(this._b)),this._ok=n.ok,this._tc_id=x++}function r(e,t,n){e=C(e,255),t=C(t,255),n=C(n,255);var o,i,r=O(e,t,n),a=L(e,t,n),s=(r+a)/2;if(r==a)o=i=0;else{var l=r-a;switch(i=s>.5?l/(2-r-a):l/(r+a),r){case e:o=(t-n)/l+(n>t?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return{h:o,s:i,l:s}}function a(e,t,n){e=C(e,255),t=C(t,255),n=C(n,255);var o,i,r=O(e,t,n),a=L(e,t,n),s=r,l=r-a;if(i=0===r?0:l/r,r==a)o=0;else{switch(r){case e:o=(t-n)/l+(n>t?6:0);break;case t:o=(n-e)/l+2;break;case n:o=(e-t)/l+4}o/=6}return{h:o,s:i,v:s}}function s(e,t,n,o){var i=[S(D(e).toString(16)),S(D(t).toString(16)),S(D(n).toString(16))];return o&&i[0].charAt(0)==i[0].charAt(1)&&i[1].charAt(0)==i[1].charAt(1)&&i[2].charAt(0)==i[2].charAt(1)?i[0].charAt(0)+i[1].charAt(0)+i[2].charAt(0):i.join("")}function l(e,t,n,o){var i;return[S((i=o,Math.round(255*parseFloat(i)).toString(16))),S(D(e).toString(16)),S(D(t).toString(16)),S(D(n).toString(16))].join("")}function c(e,t){t=0===t?0:t||10;var n=i(e).toHsl();return n.s-=t/100,n.s=w(n.s),i(n)}function d(e,t){t=0===t?0:t||10;var n=i(e).toHsl();return n.s+=t/100,n.s=w(n.s),i(n)}function u(e){return i(e).desaturate(100)}function h(e,t){t=0===t?0:t||10;var n=i(e).toHsl();return n.l+=t/100,n.l=w(n.l),i(n)}function p(e,t){t=0===t?0:t||10;var n=i(e).toRgb();return n.r=O(0,L(255,n.r-D(-t/100*255))),n.g=O(0,L(255,n.g-D(-t/100*255))),n.b=O(0,L(255,n.b-D(-t/100*255))),i(n)}function g(e,t){t=0===t?0:t||10;var n=i(e).toHsl();return n.l-=t/100,n.l=w(n.l),i(n)}function f(e,t){var n=i(e).toHsl(),o=(D(n.h)+t)%360;return n.h=0>o?360+o:o,i(n)}function m(e){var t=i(e).toHsl();return t.h=(t.h+180)%360,i(t)}function y(e){var t=i(e).toHsl(),n=t.h;return[i(e),i({h:(n+120)%360,s:t.s,l:t.l}),i({h:(n+240)%360,s:t.s,l:t.l})]}function _(e){var t=i(e).toHsl(),n=t.h;return[i(e),i({h:(n+90)%360,s:t.s,l:t.l}),i({h:(n+180)%360,s:t.s,l:t.l}),i({h:(n+270)%360,s:t.s,l:t.l})]}function I(e){var t=i(e).toHsl(),n=t.h;return[i(e),i({h:(n+72)%360,s:t.s,l:t.l}),i({h:(n+216)%360,s:t.s,l:t.l})]}function b(e,t,n){t=t||6,n=n||30;var o=i(e).toHsl(),r=360/n,a=[i(e)];for(o.h=(o.h-(r*t>>1)+720)%360;--t;)o.h=(o.h+r)%360,a.push(i(o));return a}function v(e,t){t=t||6;for(var n=i(e).toHsv(),o=n.h,r=n.s,a=n.v,s=[],l=1/t;t--;)s.push(i({h:o,s:r,v:a})),a=(a+l)%1;return s}function k(e){return e=parseFloat(e),(isNaN(e)||0>e||e>1)&&(e=1),e}function C(e,t){(function(e){return"string"==typeof e&&-1!=e.indexOf(".")&&1===parseFloat(e)})(e)&&(e="100%");var n=function(e){return"string"==typeof e&&-1!=e.indexOf("%")}(e);return e=L(t,O(0,parseFloat(e))),n&&(e=parseInt(e*t,10)/100),E.abs(e-t)<1e-6?1:e%t/parseFloat(t)}function w(e){return L(1,O(0,e))}function A(e){return parseInt(e,16)}function S(e){return 1==e.length?"0"+e:""+e}function N(e){return 1>=e&&(e=100*e+"%"),e}var T=/^\s+/,M=/\s+$/,x=0,E=Math,D=E.round,L=E.min,O=E.max,B=E.random;i.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var e=this.toRgb();return(299*e.r+587*e.g+114*e.b)/1e3},getLuminance:function(){var e,t,n,o=this.toRgb();return e=o.r/255,t=o.g/255,n=o.b/255,.2126*(.03928>=e?e/12.92:Math.pow((e+.055)/1.055,2.4))+.7152*(.03928>=t?t/12.92:Math.pow((t+.055)/1.055,2.4))+.0722*(.03928>=n?n/12.92:Math.pow((n+.055)/1.055,2.4))},setAlpha:function(e){return this._a=k(e),this._roundA=D(100*this._a)/100,this},toHsv:function(){var e=a(this._r,this._g,this._b);return{h:360*e.h,s:e.s,v:e.v,a:this._a}},toHsvString:function(){var e=a(this._r,this._g,this._b),t=D(360*e.h),n=D(100*e.s),o=D(100*e.v);return 1==this._a?"hsv("+t+", "+n+"%, "+o+"%)":"hsva("+t+", "+n+"%, "+o+"%, "+this._roundA+")"},toHsl:function(){var e=r(this._r,this._g,this._b);return{h:360*e.h,s:e.s,l:e.l,a:this._a}},toHslString:function(){var e=r(this._r,this._g,this._b),t=D(360*e.h),n=D(100*e.s),o=D(100*e.l);return 1==this._a?"hsl("+t+", "+n+"%, "+o+"%)":"hsla("+t+", "+n+"%, "+o+"%, "+this._roundA+")"},toHex:function(e){return s(this._r,this._g,this._b,e)},toHexString:function(e){return"#"+this.toHex(e)},toHex8:function(){return l(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:D(this._r),g:D(this._g),b:D(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+D(this._r)+", "+D(this._g)+", "+D(this._b)+")":"rgba("+D(this._r)+", "+D(this._g)+", "+D(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:D(100*C(this._r,255))+"%",g:D(100*C(this._g,255))+"%",b:D(100*C(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+D(100*C(this._r,255))+"%, "+D(100*C(this._g,255))+"%, "+D(100*C(this._b,255))+"%)":"rgba("+D(100*C(this._r,255))+"%, "+D(100*C(this._g,255))+"%, "+D(100*C(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":!(this._a<1)&&(z[s(this._r,this._g,this._b,!0)]||!1)},toFilter:function(e){var t="#"+l(this._r,this._g,this._b,this._a),n=t,o=this._gradientType?"GradientType = 1, ":"";e&&(n=i(e).toHex8String());return"progid:DXImageTransform.Microsoft.gradient("+o+"startColorstr="+t+",endColorstr="+n+")"},toString:function(e){var t=!!e;e=e||this._format;var n=!1,o=this._a<1&&this._a>=0;return!t&&o&&("hex"===e||"hex6"===e||"hex3"===e||"name"===e)?"name"===e&&0===this._a?this.toName():this.toRgbString():("rgb"===e&&(n=this.toRgbString()),"prgb"===e&&(n=this.toPercentageRgbString()),("hex"===e||"hex6"===e)&&(n=this.toHexString()),"hex3"===e&&(n=this.toHexString(!0)),"hex8"===e&&(n=this.toHex8String()),"name"===e&&(n=this.toName()),"hsl"===e&&(n=this.toHslString()),"hsv"===e&&(n=this.toHsvString()),n||this.toHexString())},clone:function(){return i(this.toString())},_applyModification:function(e,t){var n=e.apply(null,[this].concat([].slice.call(t)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(h,arguments)},brighten:function(){return this._applyModification(p,arguments)},darken:function(){return this._applyModification(g,arguments)},desaturate:function(){return this._applyModification(c,arguments)},saturate:function(){return this._applyModification(d,arguments)},greyscale:function(){return this._applyModification(u,arguments)},spin:function(){return this._applyModification(f,arguments)},_applyCombination:function(e,t){return e.apply(null,[this].concat([].slice.call(t)))},analogous:function(){return this._applyCombination(b,arguments)},complement:function(){return this._applyCombination(m,arguments)},monochromatic:function(){return this._applyCombination(v,arguments)},splitcomplement:function(){return this._applyCombination(I,arguments)},triad:function(){return this._applyCombination(y,arguments)},tetrad:function(){return this._applyCombination(_,arguments)}},i.fromRatio=function(e,t){if("object"==typeof e){var n={};for(var o in e)e.hasOwnProperty(o)&&(n[o]="a"===o?e[o]:N(e[o]));e=n}return i(e,t)},i.equals=function(e,t){return!(!e||!t)&&i(e).toRgbString()==i(t).toRgbString()},i.random=function(){return i.fromRatio({r:B(),g:B(),b:B()})},i.mix=function(e,t,n){n=0===n?0:n||50;var o,r=i(e).toRgb(),a=i(t).toRgb(),s=n/100,l=2*s-1,c=a.a-r.a,d=1-(o=((o=-1==l*c?l:(l+c)/(1+l*c))+1)/2);return i({r:a.r*o+r.r*d,g:a.g*o+r.g*d,b:a.b*o+r.b*d,a:a.a*s+r.a*(1-s)})},i.readability=function(e,t){var n=i(e),o=i(t);return(Math.max(n.getLuminance(),o.getLuminance())+.05)/(Math.min(n.getLuminance(),o.getLuminance())+.05)},i.isReadable=function(e,t,n){var o,r,a,s,l,c=i.readability(e,t);switch(r=!1,"AA"!==(s=((a=(a=n)||{level:"AA",size:"small"}).level||"AA").toUpperCase())&&"AAA"!==s&&(s="AA"),"small"!==(l=(a.size||"small").toLowerCase())&&"large"!==l&&(l="small"),(o={level:s,size:l}).level+o.size){case"AAsmall":case"AAAlarge":r=c>=4.5;break;case"AAlarge":r=c>=3;break;case"AAAsmall":r=c>=7}return r},i.mostReadable=function(e,t,n){var o,r,a,s,l=null,c=0;r=(n=n||{}).includeFallbackColors,a=n.level,s=n.size;for(var d=0;d<t.length;d++)(o=i.readability(e,t[d]))>c&&(c=o,l=i(t[d]));return i.isReadable(e,l,{level:a,size:s})||!r?l:(n.includeFallbackColors=!1,i.mostReadable(e,["#fff","#000"],n))};var R,P,j,H=i.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},z=i.hexNames=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[e[n]]=n);return t}(H),G=(P="[\\s|\\(]+("+(R="(?:[-\\+]?\\d*\\.\\d+%?)|(?:[-\\+]?\\d+%?)")+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",j="[\\s|\\(]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")[,|\\s]+("+R+")\\s*\\)?",{rgb:new RegExp("rgb"+P),rgba:new RegExp("rgba"+j),hsl:new RegExp("hsl"+P),hsla:new RegExp("hsla"+j),hsv:new RegExp("hsv"+P),hsva:new RegExp("hsva"+j),hex3:/^#?([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^#?([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/});e.exports?e.exports=i:void 0===(o=function(){return i}.call(t,n,t,e))||(e.exports=o)}()},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(40),n(13),n(1)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromCollabJSON=function(e){return new t({listId:e.id,type:e.type})},t.fromXml=function(e){var o=$(e),i=new t({listId:o.attr("id"),type:o.attr("type")});return n.each(e.attributes,function(e){switch(e.nodeName){case"id":case"type":break;default:i.unknownAttrs.push(e.cloneNode(!0))}}),i},t.prototype.addItem=function(e){e&&(this.listItems.push(e),this.updateIndexes())},t.prototype.getId=function(){return this.listProps.listId},t.prototype.getItems=function(){return this.listItems},t.prototype.getLength=function(){return this.listItems.length},t.prototype.getType=function(){return this.listProps.type},t.prototype.insertAfter=function(e,t){var n=this.listItems,o=t?n.indexOf(t):-1;this.insertItem(o+1,e)},t.prototype.insertItem=function(e,t){var n=this.listItems;return o(e>0||e<=n.length),o(!(t in n)),n.splice(e,0,t),this.updateIndexes(),e},t.prototype.isOrdered=function(){return this.listProps.type===t.ORDERED},t.prototype.isUnordered=function(){return this.listProps.type===t.UNORDERED},t.prototype.removeItem=function(e){var t=this.listItems,n=t.indexOf(e);return n>=0&&(t.splice(n,1),this.updateIndexes()),n},t.prototype.setType=function(e){o(e===t.ORDERED||e===t.UNORDERED),e!==this.listProps.type&&(this.listProps.type=e,this.updateIndexes(!0),this.trigger("type-change"))},t.prototype.toCollabJSON=function(){var e={};return e.id=this.listProps.listId,e.type=this.listProps.type,e},t.prototype.updateIndexes=function(e){var t,n,o,i=this.listItems,r=i.length,a=0,s={};for(t=0;t<r;++t)(o=(n=i[t]).getLevel())>a?s[o]=1:s[o]?s[o]++:s[o]=1,a=o,n.setIndex(s[o]),e&&n.updateListType()},t.prototype.initialize=function(e){this.listProps=n.clone(e),this.listItems=[],this.unknownAttrs=[],this.listProps.type!==t.ORDERED&&this.listProps.type!==t.UNORDERED&&(r.error("type should be ORDERED or UNORDERED",this.listProps.type),this.listProps.type=t.UNORDERED)},t.ORDERED="ordered",t.UNORDERED="unordered",t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};o=[n,t,n(0),n(2),n(126),n(1),n(127),n(154),n(155),n(128),n(54),n(64),n(167),n(93)],void 0===(i=function(e,t,n,o,i,a,s,l,c,d,u,h,p,g){"use strict";return function(){function e(){}return e.createRangeByBlock=function(e){if(e&&e.block){var t,n=e.block,f=n.getType(),m=0,y=0;switch(null!=e.start&&null!=e.end?(m=e.start,y=e.end):(null==e.allContent&&null==e.collapseToStart||!0===e.allContent)&&null!=n.getEndOffset?(m=0,y=n.getEndOffset()):e.collapseToStart||null==n.getEndOffset?(m=0,y=0):y=m=n.getEndOffset(),f){case o.QUOTE:case o.TODO:case o.PARAGRAPH:case o.LIST_ITEM:case o.CATALOGUE:case o.HEADING:t=new u({block:n,end:y,start:m});break;case o.IMAGE:t=new d({block:n});break;case o.ATTACHMENT:t=new s({block:n});break;case o.TABLE:e.allContent&&(e.type=h.TYPES.ALL,delete e.allContent),e.type||e.rect||a.warn("Bad tableRange options will select first table cell",e),t=new h({block:n,rect:e.rect,type:e.type});break;case o.HR:t=new c({block:n});break;case o.UNKNOWN:t=new p({block:n});break;case o.HEADER_FOOTER:t=new i({block:n});break;case o.HANDWRITE:t=new l({block:n});break;case o.CODE:t=e.hasOwnProperty("selectWholeBlock")?new g(r({block:n},e)):new g({block:n,selectWholeBlock:!0});break;default:a.error("block.type ["+f+"] is not valid!")}return t}a.warn("arguments is not valid!")},e.isBlockRange=function(e){return null!=e&&null!=e.getType&&null!=e.getType()&&n.contains(o.getAllBlockTypes(),e.getType())},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(23),n(21),n(61),n(15),n(2),n(12),n(24),n(8)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u){"use strict";return function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.createBlank=function(){return new t({})},t.fromCollabJSON=function(e){return t.generalFromJSON(e,!0)},t.fromJSON=function(e){return t.generalFromJSON(e,!1)},t.fromXml=function(e){var n=$(e),r=new t({checked:"true"===n.find("> checked:first").text()});return r.setText(u.fromXml(e)),r.parseIdFromXml(e),n.children().each(function(e,t){switch(t.nodeName){case s.TAG_ID_NAME:case s.LEGACY_TAG_ID_NAME:case"checked":case"text":case"inline-styles":break;case"styles":o.fromXml(r,t);break;default:i.appendToTree(r.unknownTree,t)}}),r},t.getMarker=function(e){if(!e)return"";var n=e.getChecked()?t.CHECKED_MARKER:t.UNCHEKED_MARKER;return n+=" "},t.generalFromJSON=function(t,n){var o=e.generalFromJSON.call(this,t,n);return o&&o.setChecked(!!t.checked),o},t.prototype.countWords=function(){return this.richText.getLength()},t.prototype.getChecked=function(){return this.todoProps.checked},t.prototype.getLegacyResId=function(){return this.todoProps.legacyResId},t.prototype.isFromOldTodo=function(){return!!this.todoProps.legacyResId},t.prototype.setChecked=function(e){e!==this.todoProps.checked&&(this.todoProps.checked=e,this.trigger("checked-change",e))},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.checked=this.getChecked(),t},t.prototype.toHtml=function(e,t,n){var o,i=document.createElement("div"),r=$(document.createElement("div")),a=$(document.createElement("div")),s=this.getChecked(),l=$(i);return l.attr("yne-bulb-block","todo").attr("yne-bulb-checked",s.toString()).attr("id",this.getId()).css("display","table"),r.css({border:"1px solid #bbb",display:"inline-flex",height:"1em","line-height":"1",position:"relative",width:"1em"}),s&&(r.css({"background-repeat":"no-repeat","background-position":"center","background-size":"100%","background-image":"url(data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+Cjxzdmcgdmlld0JveD0iMCAwIDUwIDUwIiBzdHlsZT0iaGVpZ2h0OiAxMDAlO3dpZHRoOiAxMDAlO3N0cm9rZS13aWR0aDogMjtzdHJva2U6IGJsYWNrO3RvcDogMDtsZWZ0OiAwO3Bvc2l0aW9uOiBhYnNvbHV0ZTsiICB2ZXJzaW9uPSIxLjEiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgeG1sbnM6eGxpbms9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkveGxpbmsiIHhtbG5zOnNrZXRjaD0iaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoL25zIj4KICAgIDxwYXRoIGZpbGw9Im5vbmUiIGQ9Ik0xNC4xIDI3LjJsNy4xIDcuMiAxNi43LTE2LjgiPjwvcGF0aD4KPC9zdmc+)"}),l.css("text-decoration","line-through")),this.applyBlockStylesOnElement(l),e=e||0,t=null==t?this.getEndOffset():t,o=this.sliceText(e,t,!1),a.html(d.rich2html(o,{withDefault:n})),a.attr("yne-bulb-todo-content","").css({display:"table-cell","word-break":"break-word","padding-left":"8px",width:"100%"}),l.append(r),l.append(a),i.outerHTML},t.prototype.toJSON=function(t,n){var o=e.prototype.toJSON.call(this,t,n);return o.checked=this.getChecked(),o},t.prototype.toPlain=function(e,t){e=e||0;var n=this.sliceText(e,t,!1);return r(n.toString())},t.prototype.toXml=function(t){var n,o;return o=e.prototype.toXml.call(this,t),(n=t.createElement("checked")).appendChild(t.createTextNode(this.getChecked().toString())),o.appendChild(n),i.appendToXml(this.unknownTree,o),o.setAttribute("compat","true"),o},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.todoProps=n.clone(t),this.type=l.TODO},t.CHECKED_MARKER="✔",t.UNCHEKED_MARKER="☐",t}(c)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(16),i=n(0),r=n(1),a=n(172),s=n(97);return t=o.extend({inheritStyleHandlers:null,uninheritStyleHandlers:null,tagHandler:null,el:null,parent:null,children:null,styles:null,parser:null,options:null,constructor:function(e,t,n,o,i){this.el=e,this.children=[],this.parent=t,this.internalStylesParser=n,this.parent&&this.parent.children&&this.parent.children.push(this),this._computeStyles(),this.computeBulbStyles(),this.parser=o,this.options=i},computeBulbStyles:function(){},_findStyleHandler:function(e,n){var o,a=(e?this.inheritStyleHandlers:this.uninheritStyleHandlers)[n];if(i.isFunction(a))return{action:a};if(i.isObject(a)&&a.action)return a;if(!0===a&&(o=t.styleHandlers[n])&&o.action){if(o.inheritable===e)return o;r.error("The inheritable value of "+n+" is unvalid!")}},_computeStyles:function(){var e=this.el,n={},o=this.tagHandler||t.tagHandlers[e.tagName.toLowerCase()];o&&o(n,e),this.styles={},this._computeInheritStyles(n),this._computeUninheritStyles(n)},_computeStyle:function(e,t){var n,o,r,a=this,s=null!=a.inheritStyleHandlers[t],l=a.parent,c=a.el;null==a.styles[t]&&(s&&!l||(n=a._findStyleHandler(s,t))&&n.action&&(n.requireValues&&n.requireValues.length&&i.each(n.requireValues,function(t){a._computeStyle(e,t)}),s?(o=(l.styles||{})[t],(r=n.action(c,a.styles,o))||!1===r||(r=e[t]),r||!1===r||(r=o)):(r=n.action(c,a.styles))||!1===r||(r=e[t]),(r||!1===r)&&(a.styles[t]=r)))},_computeInheritStyles:function(e){var t=this;t.inheritStyleHandlers&&i.each(t.inheritStyleHandlers,function(n,o){n&&t._computeStyle(e,o)})},_computeUninheritStyles:function(e){var t=this;t.uninheritStyleHandlers&&i.each(t.uninheritStyleHandlers,function(n,o){n&&t._computeStyle(e,o)})},setup:function(){},capture:function(){r.warn("Function capture should be implemented by SubClass")},finish:function(){},handleChildrenBySelf:function(){return!1},emit:function(e){this.parent&&this.parent.capture(e)},getRoot:function(){if(this.parent)return this.parent.getRoot()}},{tagHandlers:a,styleHandlers:s})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(139),s=n(3);return t=o.extend({name:"atom.InsertBlocks",_note:null,_newBlks:null,_newBlkIds:null,_preBlkId:null,initialize:function(){var e=this,n=e.options.args;s.isCollabCommand(n)||(e._note=e.options.note,e._newBlks=e.options.newBlks,e.options.preBlk&&(e._preBlkId=e.options.preBlk.getId()),e._newBlkIds=[],r.each(e._newBlks,function(t){e._newBlkIds.push(t.getId())})),t.__super__.initialize.apply(e)},apply:function(){var e,t,n,o=this,i=0;if(o._preBlkId){if(n=o._note.getBlockIndexById(o._preBlkId),e=o._note.getBlockById(o._preBlkId),t=e.getBlockStyles(),-1===n)return!1;i=n+1}return r.each(o._newBlks,function(e){t&&t["back-color"]&&e.setBlockStyle("back-color",t["back-color"]),o._note.insert(i,e),i++}),!0},doUnapply:function(){var e=this;r.each(e._newBlkIds,function(t){e._note.remove(e._note.getBlockIndexById(t))})},fromCollabJSON:function(){var e=this,n=e.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(e),e._note=n.coreEditor.getNote(),o.preBlockId&&(e._preBlkId=o.preBlockId),n.isCollabUndo?e._newBlkIds=o.insertedBlocks:n.isCollabRedo&&(e._newBlks=[],r.each(o.insertedBlocks,function(t){e._newBlks.push(a.buildBlockFromJSON(t,n.coreEditor))}))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this),n=[];return this.isCollabUndo?r.each(this._newBlks,function(e){n.push(e.getId())}):this.isCollabRedo&&r.each(this._newBlks,function(e){n.push(e.toCollabJSON())}),e.insertedBlocks=n,this._preBlkId&&(e.preBlockId=this._preBlkId),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},,function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0);return{bubble:function(e,n,i,r){if(e&&n&&i){var a=o.isArray(e);o.each(e,function(e,t){e&&(a?t=e:!0===e&&(e=t),!0===r&&n.off(t),n.on(t,i.trigger.bind(i,e)))})}else t.log("arguments are not valid",arguments)},addListeners:function(e,n,i,r){e&&n&&i?o.each(e,function(e,t){!0===r&&n.off(t),n.on(t,i[e].bind(i))}):t.log("arguments are not valid",arguments)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){var e=navigator.userAgent.toLowerCase();return{isSafari:function(){return e&&e.indexOf("applewebkit")>-1&&e.indexOf("chrome")<=-1},isEdge:function(){return e&&e.indexOf("applewebkit")>-1&&e.indexOf("edge")>-1}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(1),a=n(0),s=n(139),l=n(39),c=n(3);return t=o.extend({name:"atom.DeleteBlocks",_note:null,_deletedBlocks:null,_deletedBlockIds:null,_preBlockId:null,initialize:function(){var e=this,n=e.options.args;c.isCollabCommand(n)||(e._note=e.options.note,e._deletedBlocks=a.sortBy(e.options.blocks,function(t){return e._note.getBlockIndex(t)}),e._deletedBlockIds=[],a.each(e._deletedBlocks,function(t){e._deletedBlockIds.push(t.getId())})),t.__super__.initialize.apply(e)},apply:function(){var e,t,n=this;return n._deletedBlockIds&&0!==n._deletedBlockIds.length?((t=n._note.getBlockById(n._deletedBlockIds[0]))&&t instanceof l&&t.hideImageTitle(),e=n._note.getPreBlock(t),n._preBlockId=e?e.getId():0,a.each(n._deletedBlockIds,function(e,t){n._note.removeBlockById(e,n._deletedBlockIds.length===t+1)}),!0):(r.error("没有指定要删除的段落"),!1)},doUnapply:function(){var e=this,t=0;e._preBlockId&&(t=e._note.getBlockIndexById(e._preBlockId)+1),a.each(e._deletedBlocks,function(n){e._note.insert(t,n),t++})},fromCollabJSON:function(){var e=this,n=e.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(e),e._note=n.coreEditor.getNote(),o&&o.preBlockId&&(e._preBlockId=o.preBlockId),n.isCollabUndo?(e._deletedBlocks=[],a.each(o.deletedBlocks,function(t){e._deletedBlocks.push(s.buildBlockFromJSON(t,n.coreEditor))})):n.isCollabRedo&&(e._deletedBlockIds=[],a.each(o.deletedBlocks,function(t){e._deletedBlockIds.push(t)}))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this),n=[];return this.isCollabUndo?a.each(this._deletedBlocks,function(e){n.push(e.toCollabJSON())}):this.isCollabRedo&&a.each(this._deletedBlockIds,function(e){n.push(e)}),e.preBlockId=this._preBlockId,e.deletedBlocks=n,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(1),n(108)],void 0===(i=function(e,t,n,o,i){"use strict";return function(){function e(){}return e.getAllValueByFont=function(t){var n=e.getFont(t);if(n)return e.FONT_MAP[n].join(",");o.warn("Font does not exit in Font Maps: "+t)},e.getFontMap=function(){return e.FONT_MAP},e.getFont=function(t){var o,i;if((t=(t||"").toLowerCase())&&(i=e.splitFontFamily(t)))return n.some(i,function(t){if(n.some(e.FONT_MAP,function(n,i){if(i.toLowerCase()===t||e.CONTAIN_IGNORE_CASE(n,t))return o=i,!0}),o)return!0}),o},e.getFontFirstValue=function(t){var n,o=e.getFont(t);if(n=e.FONT_MAP[o])return n[0]},e.getItems=function(){var t=[];return n.each(e.FONT_MAP,function(e,n){t.push({fullValue:e.join(","),name:n,singleValue:e[0]})}),t},e.getNames=function(){return n.keys(e.FONT_MAP)},e.splitFontFamily=function(e){var t,o=[];return(e=$.trim(e||""))?(t=e.split(","),n.each(t,function(e){e=e||"",(e=$.trim(e.replace(/["']/g,"")))&&o.push(e)}),o):[]},e.CONTAIN_IGNORE_CASE=function(e,t){return n.some(e,function(e){return(e+"").toLowerCase()===t})},e.DEFAULT_FONT=i.DEFAULT_FONT,e.FONT_MAP={"微软雅黑":[i.DEFAULT_FONT,"STXihei"],"宋体":["SimSun","STSong"],"新宋体":["NSimSun"],"仿宋":["FangSong_GB2312","FangSong","STFangsong"],"楷体":["KaiTi_GB2312","KaiTi","STKaiti"],"黑体":["SimHei","STHeiti"],Arial:["Arial"],"Arial Black":["Arial Black"],"Times New Roman":["Times New Roman"],"Courier New":["Courier New"],Tahoma:["Tahoma"],Verdana:["Verdana"]},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(23),n(8),n(21),n(47),n(9),n(1),n(25),n(75),n(15),n(2)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromJSON=function(e){if(e&&e.type&&e.type===p.IMAGE&&e.source){var n=new t({source:e.source,title:e.title});return e.styles&&n.setStyles(e.styles),e.blockId&&n.setId(e.blockId),n}c.warn("jsonObj or jsonObj.source does NOT exist!")},t.fromXml=function(e){var n=$(e),i=new t({source:$.trim(n.find("> source:first").text()),title:$.trim(n.find("> text:first").text())});return i.parseIdFromXml(e),n.children().each(function(e,t){switch(t.nodeName){case h.TAG_ID_NAME:case h.LEGACY_TAG_ID_NAME:case"source":case"text":break;case"styles":o.fromXml(i,t);break;default:r.appendToTree(i.unknownTree,t)}}),i},t.prototype.countWords=function(){return 0},t.prototype.getFakeLoading=function(){return this.imageProps.fakeLoading},t.prototype.getHighlight=function(e,t){var o=this,r=[];if(null!=t.images&&t.images.length>0&&n.some(t.images,function(e){return e.resID===o.getSource()&&(r.push({imageInfo:e}),!0)}),null!=e&&e.length>0){var a=i.create(this.imageProps.title);n.each(e,function(e){for(var t=e.getLength(),n=a.indexOf(e,0,!0);-1!==n;)r.push({end:n+t,start:n}),n=a.indexOf(e,n+t,!0)})}return r.length?r:null},t.prototype.getImageInfo=function(){return this.imageInfo},t.prototype.getResId=function(){return this.imageProps.resId},t.prototype.getSource=function(e){var t,n=this.imageProps.source;return!0===e&&(t=this.getExtraInfo("pcResMap"))&&t[n]&&(n=t[n]),n},t.prototype.getStyles=function(e){return e?this.getBlockStyle(e):this.getBlockStyles()},t.prototype.getTitle=function(){return this.imageProps.title},t.prototype.setFakeLoading=function(e){this.imageProps.fakeLoading=e},t.prototype.setImageInfo=function(e){e&&e.resId&&"number"==typeof e.rawWide?this.imageInfo=e:c.error("The imageInfo is not valid in image: "+this.imageProps.resId)},t.prototype.setSource=function(e){return!(!e||e===this.imageProps.source)&&(this.imageProps.source=e+"",this.trigger("content-change"),!0)},t.prototype.setStyles=function(e,t){return n.isString(e)?this.setBlockStyle(e,t):n.isObject(e)&&this.setBlockStyles(e),!0},t.prototype.setTitle=function(e){return e!==this.imageProps.title&&(this.imageProps.title=e+"",this.trigger("content-change"),!0)},t.prototype.hideImageTitle=function(){this.trigger("hide-image-title")},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.source=this.getSource(),t.title=this.getTitle(),t},t.prototype.toHtml=function(e,t,o){var i,r,a=d("",document,!0,!0).ownerDocument,c=this.getStyles(),u=a.createElement("div"),h=$(u),p=$(a.createElement("img"));return h.attr("yne-bulb-block","image"),n.each(c,function(e,t){switch(t){case"align":h.css("text-align",e);break;case"width":null==e?p.css("width",""):p.css("width",e);break;case"float":h.css("float",e);break;case"back-color":h.css("background-color",e);break;case"padding":h.css("padding",e),"0px"===h.css("padding-top")&&h.css({"padding-top":"4px","padding-bottom":"4px"})}}),i=this.getSource(!0===o),r=this.getTitle(),l.IS_PC&&(i=s(i)),p.attr({alt:r,"data-media-type":"image",src:i}),h.append(p),u.outerHTML},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(t){var n,i,a,s,l,c,d=this.getSource(),u=this.getTitle()||"";if(d)return n=e.prototype.toXml.apply(this,[t]),i=t.createElement("source"),a=t.createTextNode(d),i.appendChild(a),n.appendChild(i),s=t.createElement("text"),l=t.createTextNode(u),s.appendChild(l),n.appendChild(s),c=t.createElement("styles"),o.toXml(this,c,t),n.appendChild(c),r.appendToXml(this.unknownTree,n),n},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=p.IMAGE,this.imageProps={source:t.source,title:t.title},this.imageProps.fakeLoading=t.fakeLoading||!1,this.imageProps.resId=u.parseImgSource(this.imageProps.source).resId},t}(h)}.apply(t,o))||(e.exports=i)},function(e,t,n){(function(o){var i;void 0===(i=function(e,t){"use strict";var n=this.DEBUG,o=this.console,i=function(){};return n&&o.assert&&(i=o.assert.bind(o)),i}.apply(t,[n,t]))||(e.exports=i)}).call(this,n(60))},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return{ATTACHMENT:"attachment",IMAGE:"image",TEXT:"text"}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(47),n(75),n(9),n(110),n(1),n(25),n(65)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(e&&e.source)return e.resId&&l.warn("Will create resId by url!"),new t(e);l.warn("Failed to create ImageResource",e)},t.fromCollabJSON=function(e){return e.resId&&e.source||l.error("jsonObj is wrong , ",e),t.create({height:e.height,resId:e.resId,source:e.source,title:"",type:d.TYPE_IMAGE,width:e.width})},t.fromJSON=function(e,o){e.resId&&o&&o.imageMap||l.error("jsonObj is or resourceList wrong , ",e,o);var r=o.imageMap[e.resId];return r||l.error("resourceList wrong"),r.source&&(e.resId=i.parseImgSource(r.source).resId),t.fromCollabJSON(n.extend(e,r))},t.fromXml=function(e,n){var o=$(n),i=o.children("source:first").text(),r=o.children("width:first").text(),a=o.children("height:first").text();return r&&(r=parseInt(r,10)),a&&(a=parseInt(a,10)),t.create({height:a,resId:e,source:i,title:"",type:d.TYPE_IMAGE,width:r})},t.prototype.getInfo=function(){var e=this.getSize();return null===e.width&&null===e.height&&(e=null),n.extend({source:this.getSource()},e)},t.prototype.getSize=function(){return{height:this.imageProps.height||null,width:this.imageProps.width||null}},t.prototype.getSource=function(e){var t=this.imageProps.source;return e&&e[t]&&(t=e[t]),t},t.prototype.setSource=function(e){return!(!e||e===this.imageProps.source)&&(this.imageProps.source=e+"",!0)},t.prototype.toCollabJSON=function(){var e={};return e.source=this.getSource(),e.width=this.imageProps.width||null,e.height=this.imageProps.height||null,e.resId=this.imageProps.resId,e},t.prototype.toHtml=function(e){var t,i=c("",document,!0,!0).ownerDocument,a=$(i.createElement("img"));return e=n.defaults(e||{},{resourceMap:null}),t=this.getSource(e.resourceMap)||"",r.IS_PC&&(t=o(t)),a.attr({"data-media-type":"image",height:"auto",src:t,width:"100%"}),a.get(0).outerHTML},t.prototype.toJSON=function(){return{resId:this.getResId()}},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(e,t){var o=e.createElement("resource-mono"),i=e.createElement("image"),r=this.getSize();s.appendText(e,o,"res-id",this.getResId()),s.appendText(e,i,"source",this.getSource()),r&&n.each(["width","height"],function(e){var t=r[e];t&&s.appendText(i,e,t+"")}),o.appendChild(i),t.appendChild(o)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.imageProps=this.resProps,this.imageProps.resId=t.resId||i.parseImgSource(t.source).resId,this.imageProps.type=d.TYPE_IMAGE},t}(d)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0);return{ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12,getType:function(e){if(e&&e.nodeType)return e.nodeType},isNode:function(e){var n=this.getType(e);return t.isNumber(n)&&n>=this.ELEMENT_NODE&&n<=this.NOTATION_NODE},isElement:function(e){return this.getType(e)===this.ELEMENT_NODE},isAttribute:function(e){return this.getType(e)===this.ATTRIBUTE_NODE},isText:function(e){return this.getType(e)===this.TEXT_NODE},isCDataSection:function(e){return this.getType(e)===this.CDATA_SECTION_NODE},isEntityReference:function(e){return this.getType(e)===this.ENTITY_REFERENCE_NODE},isEntity:function(e){return this.getType(e)===this.ENTITY_NODE},isProcessingInstruction:function(e){return this.getType(e)===this.PROCESSING_INSTRUCTION_NODE},isComment:function(e){return this.getType(e)===this.COMMENT_NODE},isDocument:function(e){return this.getType(e)===this.DOCUMENT_NODE},isDocumentType:function(e){return this.getType(e)===this.DOCUMENT_TYPE_NODE},isDocumentFragment:function(e){return this.getType(e)===this.DOCUMENT_TYPE_NODE},isNotation:function(e){return this.getType(e)===this.NOTATION_NODE}}}.call(t,n,t,e))||(e.exports=o)},function(e,t){e.exports=function(e){var t=[];return t.toString=function(){return this.map(function(t){var n=function(e,t){var n=e[1]||"",o=e[3];if(!o)return n;if(t&&"function"==typeof btoa){var i=(a=o,"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(a))))+" */"),r=o.sources.map(function(e){return"/*# sourceURL="+o.sourceRoot+e+" */"});return[n].concat(r).concat([i]).join("\n")}var a;return[n].join("\n")}(t,e);return t[2]?"@media "+t[2]+"{"+n+"}":n}).join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var o={},i=0;i<this.length;i++){var r=this[i][0];"number"==typeof r&&(o[r]=!0)}for(i=0;i<e.length;i++){var a=e[i];"number"==typeof a[0]&&o[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(e,t,n){var o,i;o=[n,t,n(0)],void 0===(i=function(e,t,n){"use strict";var o=function(e){var t=n.keys(e);return n.each(t,function(t){var n=e[t];"object"==typeof n&&null!==n&&o(n)}),Object.freeze(e)};return function(e,t){return e&&"object"==typeof e?(t=!1!==t,Object.freeze?t?o(e):Object.freeze(e):e):e}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(47),n(75),n(9),n(110),n(1),n(25),n(65)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(e&&e.source&&e.resource&&null!=e.fileLength&&e.fileName)return e.resId||l.warn("Will create resId by url!"),new t(e);l.warn("Failed to create AttachmentResource",e)},t.fromJSON=function(e,o){e.resId&&o&&o.attachMap||l.error("jsonObj or resourceList is wrong, ",e,o);var r=o.attachMap[e.resId];return r||l.error("resourceList is wrong"),r.resource&&(e.resId=i.parseImgSource(r.resource).resId),t.fromCollabJSON(n.extend(e,r))},t.fromCollabJSON=function(e){return e.fileLength&&e.fileName&&e.resId&&e.resource&&e.source||l.error("jsonObj is wrong, ",e),t.create({resId:e.resId,source:e.source,resource:e.resource,fileName:e.fileName,fileLength:e.fileLength})},t.fromXml=function(e,n){var o=$(n),i=o.children("source:first").text(),r=o.children("resource:first").text(),a=o.children("filename:first").text(),s=o.children("filelength:first").text();return s&&(s=parseInt(s,10)),t.create({resId:e,source:i,resource:r,fileName:a,fileLength:s,fakeLoading:!1,type:d.TYPE_ATTACHMENT})},t.prototype.getFileName=function(){return this.attachmentProps.fileName},t.prototype.getInfo=function(){return{fileLength:this.attachmentProps.fileLength,fileName:this.attachmentProps.fileName,resource:this.attachmentProps.resource,source:this.attachmentProps.source}},t.prototype.getResource=function(e){var t=this.attachmentProps.resource;return e&&e[t]&&(t=e[t]),t},t.prototype.getSource=function(e){var t=this.attachmentProps.source;return e&&e[t]&&(t=e[t]),t},t.prototype.toCollabJSON=function(){var e;return(e=this.getInfo()).resId=this.attachmentProps.resId,e},t.prototype.toHtml=function(e){var t,i=c("",document,!0,!0).ownerDocument,a=$(i.createElement("img"));return e=n.defaults(e||{},{resourceMap:null}),t=this.getSource(e.resourceMap)||"",r.IS_PC&&(t=o(t)),a.attr({alt:this.attachmentProps.fileName,"data-media-type":"attachment",filelength:this.attachmentProps.fileLength,filename:this.attachmentProps.fileName,path:this.getResource(),src:t,title:this.attachmentProps.fileName}),a.get(0).outerHTML},t.prototype.toJSON=function(){return{resId:this.getResId()}},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(e,t){var n=e.createElement("resource-mono"),o=e.createElement("attach"),i=this.getInfo();s.appendText(e,n,"res-id",this.getResId()),s.appendText(e,o,"source",i.source),s.appendText(e,o,"resource",i.resource),s.appendText(e,o,"filename",i.fileName),s.appendText(e,o,"filelength",i.fileLength),n.appendChild(o),t.appendChild(n)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.attachmentProps=this.resProps,this.attachmentProps.resId=t.resId||i.parseImgSource(t.resource).resId,this.attachmentProps.type=d.TYPE_ATTACHMENT},t}(d)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return function(e){if(!e||/^http/i.test(e))return e;var t,n=e.lastIndexOf("\\");return-1===n?e:(t=e.substring(n+1),e.substring(0,n+1)+encodeURIComponent(t))}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){this.listeners=[],this.maxListeners=null}return e.prototype.addListener=function(e,t){return this.on(e,t)},e.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var o=this._filterMatchedEvent(this.listeners,e);return o.length>0&&(this._invokeListeners.apply(this,[o].concat(t)),this.listeners=this._filterNotMatchedEvent(this.listeners,e,!0)),o.length>0},e.prototype.getMaxListeners=function(){return null===this.maxListeners?e.defaultMaxListeners:this.maxListeners},e.prototype.listenerCount=function(e){return this._filterMatchedEvent(this.listeners,e).length},e.prototype.on=function(e,t){return this._register({event:e,listener:t,once:!1}),this},e.prototype.off=function(e,t){return this._unregister({event:e,listener:t}),this},e.prototype.once=function(e,t){return this._register({event:e,listener:t,once:!0}),this},e.prototype.removeAllListeners=function(e){return this.listeners=null!=e?this._filterNotMatchedEvent(this.listeners,e):[],this},e.prototype.removeListener=function(e,t){return this.listeners=this._filterNotMatchedEvent(this.listeners,e,null,t),this},e.prototype.setMaxListeners=function(e){return this.maxListeners=e,this},e.prototype._invokeListeners=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e.map(function(e){return e.listener.apply(e,t)})},e.prototype._register=function(e){if(this._checkListenerLimitReached(e.event))throw new Error("Listner Limit Reached:"+this.maxListeners);this.listeners.unshift(e)},e.prototype._unregister=function(e){this.listeners=this._filterNotMatchedEvent(this.listeners,e.event,null,e.listener)},e.prototype._returnListenerLimit=function(){return null===this.maxListeners?e.defaultMaxListeners:this.maxListeners},e.prototype._checkListenerLimitReached=function(e){return this.listenerCount(e)===this._returnListenerLimit()},e.prototype._filterMatchedEvent=function(e,t,n){return e.filter(function(e,o,i){return null==n?e.event===t:e.event===t&&e.once===n},this)},e.prototype._filterNotMatchedEvent=function(e,t,n,o){return e.filter(function(e,i,r){var a=e.event!==t;return!1===a&&null!=n&&(a=e.once!==n),!1===a&&null!=o&&(a=e.listener!==o),a},this)},e.defaultMaxListeners=10,e}();t.YEvent=n}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(3),n(23),n(21),n(1),n(2),n(12),n(24),n(8),n(50),n(0)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(){return new t({})},t.fromCollabJSON=function(e){var n=t.generalFromJSON(e,!0);return e.ownerId&&(n.oldOwnerId=e.ownerId),n},t.fromJSON=function(e){return t.generalFromJSON(e,!1)},t.fromXml=function(e){var n,r=new t({});return r.parseIdFromXml(e),r.setText(d.fromXml(e)),$(e).children().each(function(e,t){switch(t.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":o.fromXml(r,t);break;case"href":n=$(t).find("value").text(),r.setHref(n);break;default:i.appendToTree(r.unknownTree,t)}}),r},t.generalFromJSON=function(t,n){var o=e.generalFromJSON.call(this,t,n);return o&&t.href&&o.setHref(t.href),o},t.prototype.blur=function(){this.trigger("blur")},t.prototype.findAndSetOwnerList=function(e){var t,n=e.getPreBlock(this),o=e.getNextBlock(this),i=this.oldOwnerId;return i?s.isCatalogue(o)&&i===o.getOwnerId()?(t=o.getOwnerList(),this.setOwnerList(t),t.insertBefore(this,o)):s.isCatalogue(n)&&i===n.getOwnerId()?(t=n.getOwnerList(),this.setOwnerList(t),t.insertAfter(this,n)):(t=new u({id:i}),this.setOwnerList(t),t.insertAfter(this,null)):r.error("No oldOwnerId!")},t.prototype.focus=function(){this.trigger("focus")},t.prototype.getHref=function(){return this.href},t.prototype.getHtmlHref=function(){return n.isGUID(this.href)?"#"+this.href:this.href||"#"},t.prototype.getOwnerId=function(){return this.getOwnerList().getId()},t.prototype.getOwnerList=function(){return this.ownerList||r.warn('No ownerList! check have "setOwnerList"'),this.ownerList},t.prototype.getViewHref=function(){return n.isGUID(this.href)?null:this.href},t.prototype.isFirst=function(){return this.isFirstProp},t.prototype.isLast=function(){return this.isLastProp},t.prototype.removeSorting=function(){var e=!1;this.isFirstProp&&(e=!0,this.isFirstProp=null),this.isLastProp&&(e=!0,this.isLastProp=null),e&&this.trigger("sorting-change")},t.prototype.setOwnerList=function(e){this.ownerList=e},t.prototype.setFirst=function(){this.isFirstProp||(this.isFirstProp=!0,this.trigger("sorting-change"))},t.prototype.setHref=function(e){this.href=e||null,this.trigger("style-change","href",e)},t.prototype.setIndent=function(e){e>0&&this.setBlockStyle("indent",e)},t.prototype.setLast=function(){this.isLastProp||(this.isLastProp=!0,this.trigger("sorting-change"))},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.href=this.getHref(),t.ownerId=this.getOwnerId(),t},t.prototype.toJSON=function(t,n){var o=this.sliceText(t,n,!1),i=e.prototype.toJSON.call(this);return i.text=o.toJSON(),i.href=this.getHref(),i.ownerId=this.getOwnerId(),i},t.prototype.toHtml=function(e,t,n){var o,i,r=document.createElement("div"),a=this.getBlockStyles(),s=$("<a></a>"),l=$(r),d="";return n=!0===n,l.attr("yne-bulb-block","catalogue").css("white-space","pre-wrap"),this.isFirst()&&(d="first"),this.isLast()&&(d+="last"),l.attr("yne-bulb-order",d),this.applyBlockStylesOnElement(l,!0),h.each(a,function(e,t){switch(t){case"back-color":l.css("background-color","rgba(255, 255, 255, 0.7)");break;case"padding":l.css("padding",e),l.css("margin",e)}}),e=e||0,t=null==t?this.getEndOffset():t,o=this.sliceText(e,t,!1),i=c.rich2html(o,{withDefault:n}),s.attr("href",this.getHtmlHref()).html(i),l.html(s[0].outerHTML),r.outerHTML},t.prototype.toXml=function(t){var n,o,i=e.prototype.toXml.apply(this,[t]);return this.getHref()&&(n=t.createElement("href"),o=t.createElement("value"),$(o).text(this.getHref()),n.appendChild(o),i.appendChild(n)),$(i).attr("catalogue-id",this.getOwnerId()),$(i).attr("compat","true"),i},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=s.CATALOGUE,this.setHref(t.href),this.setIndent(t.indent),this.options&&this.options.ownerList&&this.setOwnerList(this.options.ownerList),this.on("attached",this._onAttached.bind(this)),this.on("detached",this._onDetached.bind(this)),this.on("select",this._onSelect.bind(this)),this.on("remove-select",this._onRemoveSelect.bind(this))},t.prototype._onAttached=function(e){var t=this.getOwnerList(),n=e.getPreBlock(this),o=e.getNextBlock(this);if(!t)return this.findAndSetOwnerList(e);n&&s.isCatalogue(n)&&n.getOwnerId()===this.getOwnerId()?t.insertAfter(this,n):o&&s.isCatalogue(o)&&o.getOwnerId()===this.getOwnerId()?t.insertBefore(this,o):t.insertAfter(this,null)},t.prototype._onDetached=function(){this.getOwnerList().removeItem(this)},t.prototype._onRemoveSelect=function(){this.getOwnerList().removeSelect()},t.prototype._onSelect=function(){this.getOwnerList().select()},t}(l)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(40),n(13)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromXml=function(e){var o=new t({id:$(e).attr("id")});return n.each(e.attributes,function(e){switch(e.nodeName){case"id":case"type":break;default:o.unknownAttrs.push(e.cloneNode(!0))}}),o},t.prototype.getId=function(){return this.id},t.prototype.getItems=function(){return this.items},t.prototype.getLength=function(){return this.items.length},t.prototype.insertAfter=function(e,t){var n=this.items,o=t?n.indexOf(t):-1;this.insertItem(o+1,e)},t.prototype.insertBefore=function(e,t){var n=this.items,o=t?n.indexOf(t):0;this.insertItem(o,e)},t.prototype.insertItem=function(e,t){var n=this.items;return i(e>0||e<=n.length),n.splice(e,0,t),this.updateIndexes(),e},t.prototype.isLock=function(){return!!this.state},t.prototype.removeItem=function(e){var t=this.items,n=t.indexOf(e);return n>=0&&(t.splice(n,1),this.updateIndexes()),n},t.prototype.removeSelect=function(){var e=this.items;e[0]&&e[0].blur()},t.prototype.select=function(){var e=this.items;this.isLock()||e[0]&&e[0].focus()},t.prototype.updateIndexes=function(){var e=this.items;e.forEach(function(t,n){t.removeSorting(),0===n&&t.setFirst(),n===e.length-1&&t.setLast()})},t.prototype.updateLockState=function(e){this.state=e,this.state&&this.removeSelect()},t.prototype.initialize=function(e){this.id=e.id||o.newGUID(),this.items=[],this.unknownAttrs=[]},t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(61),n(62),n(2),n(12),n(15),n(8)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";var c,d="javascript",u="default";return(c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(){return new t({})},t.fromJSON=function(e){var t=r.fromJSON.apply(this,[e]);return t.language=e.language,t.theme=e.theme,t.isSelectedBlock=e.isSelectedBlock,t},t.fromXml=function(e){var t=r.fromXml.apply(this,[e]),n=this.prototype._getChildByTagName(e,"language").textContent,o=this.prototype._getChildByTagName(e,"theme").textContent;return t.setTheme(o),t.setLanguage(n),t},t.prototype.getLanguage=function(){return this.language},t.prototype.setLanguage=function(e){this.language=e,d=e,this.trigger("content-change")},t.prototype.getTheme=function(){return this.theme},t.prototype.setTheme=function(e){this.theme=e,u=e,this.trigger("content-change")},t.prototype.getLength=function(e){return this.richText.toString().replace(t.LINE_BREAK,"").length},t.prototype.getTextStyle=function(){return[]},t.prototype.getTextStylesAtIndex=function(){return{}},t.prototype.getLineInfo=function(e){if(--e<0)return null;var n=this.richText.toString().split(t.LINE_BREAK)[e],o=n.replace(n.trimLeft(),"").length,i=n.length;return{lineStartSpacesNum:o,lineLength:i,lineText:n,lineEndChar:n[i-1]}},t.prototype.pushNewLineText=function(e){"string"==typeof e&&(e=new l({text:l})),this.richText.append(e);var n=e.toString();(n&&n[n.length-1]!==t.LINE_BREAK||""===n)&&this.richText.append(new l({text:t.LINE_BREAK})),this.trigger("content-change")},t.prototype.getCharIndex=function(e,n){for(var o=0,i=this.richText.toString();o<i.length&&e>1;)i[o]===t.LINE_BREAK&&e--,o++;return o+n},t.prototype.insertText=function(e,t,n){var o=this.richText.clone(),i=this.getCharIndex(e,t);this.richText.insert(n,i);var r=this.richText.clone();return this.trigger("content-change",{preRichText:o,newRichText:r}),!0},t.prototype.deleteText=function(t,n,o,i){var r=this.richText.clone(),a=this.getCharIndex(t,n),s=this.getCharIndex(o,i);e.prototype.deleteText.apply(this,[a,s]);var l=this.richText.clone();this.trigger("content-change",{preRichText:r,newRichText:l})},t.prototype.setText=function(e){this.richText=e},t.prototype.sliceText=function(t,n,o,i){var r=this.getCharIndex(t,n),a=this.getCharIndex(o,i);return e.prototype.sliceText.apply(this,[r,a])},t.prototype.tokenizeText=function(e){var t,n,o=this.tokenizer.tokenize(e,this.tokenizer.languages[this.language]);return t=[],n=function(e,o){Array.isArray(e.content)?e.content.forEach(function(e){n(e,!0)}):"string"==typeof e&&o?t.push({type:"tag",content:e}):t.push(e)},o.map(function(e){return n(e)}),t},t.prototype.toPlain=function(e,t,o,i){var r;return r=(e&&o?this.sliceText(e,t,o,i):this.richText).toString(),r=n(r)},t.prototype.toJSON=function(e,t,n,o){var i;i=e&&n?this.sliceText(e,t,n,o):this.richText;var r=s.prototype.toJSON.apply(this);return r.richText=i.toJSON(),r.isSelectedBlock=this.isSelectedBlock,r.theme=this.theme,r.language=this.language,r},t.prototype.code2html=function(){var e=this;return this.toCodeLines().map(function(t){return e.tokenizeText(t)}).map(function(t,n){return e.codeLineToHtml(n+1,t)}).join("")},t.prototype.toHtml=function(e,t,n){var i='<div yne-bulb-block="code" id="'+this.blockId+'" data-theme="'+this.theme+'" data-language="'+this.language+'" style="white-space: pre-wrap;">'+o.escapeHtml(this.richText.toString())+"</div>";return n&&(i='<div class="block-view code-view yne-code-theme-'+this.theme+'">\n                            <div class="para-text">\n                            '+this.code2html()+"\n                            </div>\n                          </div>"),i},t.prototype.getRichTexts=function(){var e,t,n=this.richText.getReadOnlyData(),o=[],i=n.length,r=0;for(e=0;e<i;++e)n[e].char.replace(/\n/g,"")||(t=e,o.push(this.richText.slice(r,t)),r=t+1);return o},t.prototype.toCodeLines=function(e){var n=(void 0===e?this.richText.toString():e).split(t.LINE_BREAK);return""===n[n.length-1]&&1!==n.length&&n.pop(),n},t.prototype.codeLineToHtml=function(e,n){var i=this,r=this.toCodeLines();if(e>r.length)return null;n||(n=this.tokenizeText(r[e-1]));var a=this.YNE_HEAD_CLASS+"-token",s=function(e,t){return'<span class="'+(t?a+" ":"")+(i.YNE_HEAD_CLASS+"-"+e)+'">'},l=function(e){return"<pre>"+e+"</pre>"};return n.length<=1&&""===n[0]?l('<span class="place-holder">'+t.EMPTY_LINE_TAG+"</span>"):l(n.reduce(function(e,t){if("string"==typeof t){var n=o.escapeHtml(t);return e+s(i.PLAIN_STRING_CLASS,!1)+n+"</span>"}n=o.escapeHtml(t.content);return e+s(t.type,!0)+n+"</span>"},""))},t.prototype.injectTokenizer=function(e){e.languages&&e.tokenize&&(this.tokenizer=e)},t.prototype.injectRenderParams=function(e){var t=e.YNE_HEAD_CLASS,n=e.PLAIN_STRING_CLASS;this.YNE_HEAD_CLASS=t,this.PLAIN_STRING_CLASS=n},t.prototype.toXml=function(t){var n=e.prototype.toXml.apply(this,[t]),o=function(e,o){var i=t.createElement(e),r=t.createTextNode(o);i.appendChild(r),n.appendChild(i)};return o("language",this.language),o("theme",this.theme),n},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=i.CODE,this.language=t.language||d,this.theme=t.theme||u,this.richText=t.text||new l({text:""}),this.isSelectedBlock=t.isSelectedBlock},t}(r)).LINE_BREAK="\n",c.EMPTY_LINE_TAG="&#8203;",c}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(1),n(43)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.getRange=function(t){var o,i=e.getSelection(t);return i?i.rangeCount>0?o=i.getRangeAt(0):n.warn("The selection has no range!"):n.warn("The selection is null!"),o},e.getSelection=function(e){return(e=e||window).getSelection()},e.isNodeInRange=function(t,o){if(!t)return n.warn("The param node is unvalid!"),!1;var i,r=t.ownerDocument||document,a=r.defaultView,s=a.Range;return o=o||e.getRange(a),(i=r.createRange()).selectNode(t),o.compareBoundaryPoints(s.START_TO_START,i)<1&&o.compareBoundaryPoints(s.END_TO_END,i)>-1},e.isRangeInNode=function(t,o){if(!t)return n.warn("The param node is unvalid!"),!1;var i,r=(t.ownerDocument||document).defaultView;if(!(o=o||e.getRange(r)))return n.warn("The native range is null!"),!1;for(i=o.commonAncestorContainer;i;){if(i===t)return!0;i=i.parentNode}return!1},e.isRangeInSelector=function(t,n){if(!t)return!1;var i;if(i=(n=n||e.getRange()).commonAncestorContainer,!n||!i)return!1;for(o.isText(i)&&(i=i.parentElement||i.parentNode);i&&i.webkitMatchesSelector;){if(i.webkitMatchesSelector(t))return!0;i=i.parentNode}return!1},e.removeAllRanges=function(t){var n=e.getSelection(t);n&&n.removeAllRanges()},e.setRange=function(t,o){var i=e.getSelection(o);i&&t?(i.removeAllRanges(),i.addRange(t)):n.warn("The selection or range is null!")},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(1),n(2),n(151)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(){function e(){}return e.getAllStyleNames=function(){return e.ALL_KEYS||(e.ALL_KEYS=[],n.each(r,function(t){var o=n.keys(t);n.each(o,function(t){-1===e.ALL_KEYS.indexOf(t)&&e.ALL_KEYS.push(t)})})),[].concat(e.ALL_KEYS)},e.getConfig=function(e,t,n){return(this.getConfigsOfBlock(t,n)||{})[e]},e.getConfigsOfBlock=function(t,i){if(t){var a=r[t],s={};return i=!1!==i,n.each(a,function(o,r){var a=n.clone(o);i&&e.overrideDefaults[t]&&null!=e.overrideDefaults[t][r]&&(a.default=e.overrideDefaults[t][r]),s[r]=a}),s}o.error("parameter is not valid",t)},e.getDefault=function(e,t,n){if(e&&t){var i=(this.getConfigsOfBlock(t,n)||{})[e];return i&&null!=i.default?i.default:void 0}o.error("parameter is not valid",e,t)},e.getDefaultsOfBlock=function(e,t){var o=this.getConfigsOfBlock(e,t),i={};return n.each(o,function(e,t){i[t]=e.default}),i},e.getStyleNamesOfBlock=function(t){var o=e.getConfigsOfBlock(t);return o?n.keys(o):[]},e.isSupport=function(t,n){var o=(e.getConfigsOfBlock(n)||{})[t];return o&&null!=o.type},e.reset=function(){e.overrideDefaults={}},e.setDefault=function(t,r,a){t&&null!=r||o.error("parameter is not valid",t,r);var s=[];a?s.push(a):s=i.getAllBlockTypes(),n.each(s,function(n){e.overrideDefaults[n]||(e.overrideDefaults[n]={}),e.overrideDefaults[n][t]=r})},e.overrideDefaults={},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(1),n(63)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){return new t(e)},t.fromCollabJSON=function(e,r){var a=e.rangeType;if(a===n.PARAGRAPH){var s=i.getBlockById(e.blockId,r);if(s){var l={block:s,end:e.endPosition,start:e.startPosition};return t.create(l)}}else o.error("wrong block range type:",a)},t.prototype.isCollapsed=function(){return this.start===this.end},t.prototype.clone=function(){return t.create({block:this.block,end:this.end,start:this.start})},t.prototype.collapse=function(e){void 0===e&&(e=!0),e?this.end=this.start:this.start=this.end},t.prototype.expandToStart=function(){this.start=this.block.getStartOffset()},t.prototype.expandToEnd=function(){this.end=this.block.getEndOffset()},t.prototype.getDataAsJSON=function(){return this.block.toJSON(this.start,this.end)},t.prototype.getDataAsHtml=function(e){return this.block.toHtml(this.start,this.end,e)},t.prototype.getDataAsPlain=function(){return this.block.toPlain(this.start,this.end)},t.prototype.getContent=function(){return this.block.sliceText(this.start,this.end)},t.prototype.canDrawedByNative=function(){return!0},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.startPosition=this.start,t.endPosition=this.end,t},t.prototype.initialize=function(e){this.type=n.PARAGRAPH,this.start=e.start||0,this.end=e.end||0,this.block=e.block},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(6),n(23),n(8),n(56),n(41),n(156),n(83),n(21),n(106),n(158),n(1),n(43),n(15),n(2),n(67),n(159),n(76),n(66),n(160)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlankTable=function(e,n,o,i){var r,a,l,c=new t({}),d=[],u=[],h=[];for(o?c.setId(o):o=c.getId(),i&&(l=i/e),r=0;r<n;r++)for(h.push(_.DEFAULT_ROW_HEIGHT),d[r]=d[r]||[],a=0;a<e;a++)0===r&&u.push(l||_.DEFAULT_COL_WIDTH),d[r].push(v.create({cellId:v.makeCellId(o,r,a),content:s.createBlank()}));return c.setContentData(d,h,u),c},t.fromJSON=function(e,n){if(e&&e.type&&e.type===y.TABLE){var o=e.data,i=new t({colWidths:o.widths,rowHeights:o.heights,tableCells:d.cellsFromJSON({cellsJson:o.cells,height:o.heights.length,isUpdateCellId:n,resourceList:e.resourceList,width:o.widths.length})});return e.styles&&i.setBlockStyles(e.styles),e.blockId&&i.setId(e.blockId),i}g.warn("jsonObj is not valid!")},t.fromXml=function(e){var n,o,r,a,s,l=$(e),c=l.children("content:first").eq(0),d=$.trim(c.text()),h=t._resourceMapFromXml(l.children("resource-list:first").get(0)),p=new t({resourceMap:h});p.parseIdFromXml(e);try{n=JSON.parse(d)}catch(e){return void g.error(e,d)}return r=n.cells,a=t.validateRowHeights(n.heights),s=t.validateRowHeights(n.widths),o=t._tableCellsFromXml(r,a,s,{resourceMap:h,tableBlockId:p.getId()}),p.setContentData(o,a,s),l.children().each(function(e,t){switch(t.nodeName){case m.TAG_ID_NAME:case m.LEGACY_TAG_ID_NAME:case"content":case"resource-list":break;case"styles":i.fromXml(p,t);break;default:u.appendToTree(p.unknownTree,t)}}),p},t.validateRowHeights=function(e){return t._validateDimensionArray(e,_.DEFAULT_ROW_HEIGHT)},t.validColWidths=function(e){return t._validateDimensionArray(e,_.DEFAULT_COL_WIDTH)},t._resourceMapFromXml=function(e){var t={};return e?($(e).children("resource-mono").each(function(e,o){var i=$(o),r=i.find("res-id").text();r?n.some(I,function(e,n){var a,s=i.children(n+":first").get(0);if(s&&e&&e.fromXml&&(a=e.fromXml(r,s,o)),a)return t[r]=a,!0}):g.error("<resource-mono/> node has no res-id",o)}),t):t},t._tableCellsFromXml=function(e,t,n,o){var i,r,a,s=n.length,l=t.length,c=[];for(i=0;i<l;i++)for(c[i]=[],r=0;r<s;r++)a=i*s+r,c[i][r]=v.fromXml({cellRawData:e[a],colIndex:r,resourceMap:o.resourceMap,rowIndex:i,tableBlockId:o.tableBlockId});return c},t._validateDimensionArray=function(e,t){return e?n.map(e,function(e){return e>0?e:t}):[t]},t.prototype.clearCellAttr=function(e,t){if(!this.isLocked()){var n=this._getCellAt(e,t);n&&(n.clearMergePointAttr(),n.clearMergedCellAttr(),this.trigger("attribute-changed"))}},t.prototype.countWords=function(){var e=this.toPlain({filter:function(e){return e&&e.getType()===l.TEXT},returnString:!1,withLineBreak:!1}),t=0;return n.each(e,function(e){n.each(e,function(e){t+=h(e)})}),t},t.prototype.createCell=function(e){var t,n=(e=e||{}).content||s.createBlank(),o=e.styles;return t=v.create({content:n}),o&&t.setBlockStyles(o),t},t.prototype.creatRowData=function(){var e,t=this.getColumnCount(),n=[];for(e=0;e<t;e++)n.push(this.createCell());return n},t.prototype.deleteCols=function(e,t){if(!this.isLocked()){var n,o,i=[];if(!this.isLocked())return t=t||1,this.tableCells.forEach(function(n){for(o=0;o<t;o++)i[o]=i[o]||[],i[o].push(n.splice(e,1)[0])}),n=this.colWidths.splice(e,t),this.trigger("col-deleted",e,t),{colsData:i,widths:n}}},t.prototype.deleteRows=function(e,t){if(!this.isLocked()){var n,o,i=[];if(!this.isLocked()){for(t=t||1,o=0;o<t;o++)i[o]=this.tableCells.splice(e,1)[0];return n=this.rowHeights.splice(e,t),this.trigger("row-deleted",e,t),{heights:n,rowsData:i}}}},t.prototype.forEach=function(e,t){var n=this;n.forEachRow(function(o){return n.forEachColumn(function(t){return e(o,t)},t)},t)},t.prototype.forEachCell=function(e,t){var n=this,o={};n.forEach(function(t,i){var r,a=n.getCell(t,i,{findMergePointIfNeeded:!0,withPosition:!0});if(a&&(r=a.row+"-"+a.col,!0!==o[r]))return o[r]=!0,e(a.cell,a.row,a.col)},t)},t.prototype.forEachColumn=function(e,t){var n,o=this.getColumnCount();for(n=0;n<o;n++)if(!1===e(t?0+o-n:0+n))return!1},t.prototype.forEachRow=function(e,t){var n,o=this.getRowCount();for(n=0;n<o;n++)if(!1===e(t?0+o-n:0+n))return!1},t.prototype.getAllResourceInfo=function(){var e,t,n,o,i,r=this,a=[];return r.forEach(function(s,l){var c=r.getCell(s,l),d=r.getExtraInfo("pcResMap");c&&c.isImageCell()&&(e=c.getContent(),t=e.getSource(),n=e.getSource(d),t&&n&&a.push({blockId:r.getId(),extraSource:n,source:t})),c&&c.isAttachmentCell()&&(e=c.getContent(),t=e.getSource(),n=e.getSource(d),o=e.getResource(),i=e.getResource(d),t&&n&&o&&i&&a.push({extraResource:i,extraSource:n,resource:o,source:t}))}),a},t.prototype.getCell=function(e,t,o){var i,r;if(!(o=n.defaults(o||{},{findMergePointIfNeeded:!1,withPosition:!1})).findMergePointIfNeeded){if(!(r=this._getCellAt(e,t)))return;return!0===o.withPosition?{cell:r,col:t,row:e}:r}return i=this._findMergePoint(e,t),o.withPosition?i:i&&i.cell?i.cell:null},t.prototype.getCells=function(){return this.tableCells},t.prototype.getCellBlockStyles=function(e){var t,o=e.row,i=e.col,r=e.names,a=this._getCellAt(o,i);return!a.isMergedCell()&&(t=a.getBlockStyles(),r&&r.length>0?n.pick(t,r):t)},t.prototype.getCellById=function(e){if(f.isElement(e)&&(e=$(e).data("cellId")),e){var t,n,o,i=this.getRowCount(),r=this.getColumnCount();for(t=0;t<i;t++)for(n=0;n<r;n++)if((o=this.getCell(t,n))&&o.getCellId()===e)return{cell:o,col:n,row:t}}},t.prototype.getCellInlineStyles=function(e){var t=e.row,n=e.col,o=this._getCellAt(t,n);return o.isTextNoEmptyCell()?o.getInlineStyles(e.names):o.getStylesForEmpty(e.names)},t.prototype.getCellSize=function(e,t){var n=this.getCell(e,t,{findMergePointIfNeeded:!0,withPosition:!0});if(n&&n.cell)return this._getCellSize(n.cell,n.row,n.col)},t.prototype.getCellSizeById=function(e){var t=this.getCellById(e);if(t&&t.cell)return this._getCellSize(t.cell,t.row,t.col)},t.prototype.getColumnCount=function(){var e=(this.colWidths||[]).length;return Math.max(_.MIN_COL_COUNT,e)},t.prototype.getColumnWidth=function(e){return this.colWidths[e]||_.DEFAULT_COL_WIDTH},t.prototype.getCommonBlockStyle=function(e,t){var n;return t&&t.getAsRectRange&&(t=t.getAsRectRange()),t&&t.forEachCell?(t.forEachCell(function(t){var i=t.getBlockStylesAsBulb()||{};if(null==n)n=i[e];else if(n!==i[e])return n=o.INTERM,!1},!1),n===o.INTERM?null:n):(g.warn("Unvalid parameter",t),null)},t.prototype.getCommonInlineStyle=function(e,t){var n;return t&&t.getAsRectRange&&(t=t.getAsRectRange()),t&&t.forEachCell?(t.forEachCell(function(t){var i=t.getCommonInlineStyle(e);if(null==n)n=i;else if(n!==i)return n=o.INTERM,!1},!1),n===o.INTERM?null:n):(g.warn("Unvalid parameter",t),null)},t.prototype.getContentAt=function(e,t){var n=this.getCell(e,t);if(n)return{content:n.getContent(),type:n.getType()}},t.prototype.getMergedCellAttrAt=function(e,t){var n=this._getCellAt(e,t);return n?n.getMergedCellAttr():{}},t.prototype.getMergePointAttrAt=function(e,t){var n=this._getCellAt(e,t);return n?n.getMergePointAttr():{}},t.prototype.getPosition=function(e){if(e){var t,n,o=this.getRowCount(),i=this.getColumnCount();for(t=0;t<o;t++)for(n=0;n<i;n++)if(this.getCell(t,n)===e)return{col:n,row:t}}},t.prototype.getRowCount=function(){var e=(this.rowHeights||[]).length;return Math.max(_.MIN_ROW_COUNT,e)},t.prototype.highlight=function(e,t,n){this.trigger("high-light",e,t,n)},t.prototype.isEmptyContent=function(){var e=!0;return this.forEachCell(function(t){if(!t.isEmpty())return e=!1,!1}),e},t.prototype.getRowHeight=function(e){return this.rowHeights[e]||_.DEFAULT_ROW_HEIGHT},t.prototype.isMergedCell=function(e,t){var n=this.getCell(e,t);return n&&n.isMergedCell&&n.isMergedCell()},t.prototype.isMergePoint=function(e,t){var n=this.getCell(e,t);return n&&n.isMergePoint&&n.isMergePoint()},t.prototype.isMergeRect=function(e){var t;return!!this.isMergePoint(e.top,e.left)&&((t=this.getMergePointAttrAt(e.top,e.left)).width>=e.width&&t.height>=e.height)},t.prototype.insertCols=function(e,t,n){if(!this.isLocked()){var o=this,i=o.tableCells,r=e;n=n||[],t.forEach(function(e,t){i.forEach(function(t,n){t&&t.splice(r,0,e[n])}),o.colWidths.splice(r,0,n[t]||_.DEFAULT_COL_WIDTH),r+=1}),o.trigger("col-inserted",e)}},t.prototype.insertRows=function(e,t,o){if(!this.isLocked()){var i=this,r=e;o=o||[],n.forEach(t,function(e,t){i.tableCells.splice(r,0,e),i.rowHeights.splice(r,0,o[t]||_.DEFAULT_ROW_HEIGHT),r+=1}),i.trigger("row-inserted",e)}},t.prototype.setCellBlockStyles=function(e){if(!this.isLocked()){var t,o=e.row,i=e.col,r=e.styles,a=this._getCellAt(o,i);return!a.isMergedCell()&&(r&&!n.isEmpty(r)||a.clearStyles(),b.bulbStyles2TableStyles(r),a.setBlockStyles(r),t=a.getBlockStyles(),this.trigger("cell-block-style-change",o,i,r,t),!0)}},t.prototype.setCellContent=function(e,t,o){var i,a;if(!this.isLocked())if(null!=o){if(i=this.getCell(e,t))return n.isString(o)&&(o=r.create(o)),o instanceof r&&(o=s.create({richText:o})),(a=i.setContent(o))&&this.trigger("cell-content-change",i.getCellId()),a;g.warn("no cell at row/col",e,t)}else g.warn("content is not valid",o)},t.prototype.setCellInlineStyles=function(e){if(e&&e.styles&&!this.isLocked()){var t=e.row,n=e.col,o=e.styles,i=this._getCellAt(t,n);return i&&i.isTextNoEmptyCell()?(i.setInlineStyles(o),this.trigger("cell-inline-style-change",t,n)):i.setStylesForEmpty(o),!0}},t.prototype.setContentData=function(e,t,n){var o=this;e&&e.length&&t&&t.length&&n&&n.length&&(this.tableCells=e,this.rowHeights=t,this.colWidths=n,setTimeout(function(){o._checkAndFixTableData()}))},t.prototype.setColumnWidth=function(e,t){this.isLocked()||(this.colWidths[e]=t,this.trigger("col-width-set",e,t))},t.prototype.setMergedCellAttrAt=function(e,t,n,o){if(!this.isLocked()){var i=this._getCellAt(e,t);i&&(i.setMergedCellAttr(n,o),this.trigger("attribute-changed"))}},t.prototype.setMergePointAttrAt=function(e,t,n,o){if(!this.isLocked()){var i=this._getCellAt(e,t);i&&(i.setMergePointAttr(n,o),this.trigger("attribute-changed"))}},t.prototype.setRowHeight=function(e,t){this.isLocked()||(this.rowHeights[e]=t,this.trigger("row-height-set",e,t))},t.prototype.toHtml=function(e,t,o){var i=o?this.getExtraInfo("pcResMap"):null,r=c.renderTable(this,null,i),a=document.createElement("div"),s=$(a),l=this.getBlockStyles();return n.each(l,function(e,t){switch(t){case"back-color":s.css("background-color",e);break;case"padding":s.css("padding",e)}}),s.attr("yne-bulb-block","table").css({overflow:"auto"}).append(r),a.outerHTML.replace(/style="(.*?)"/g,function(e){if(e)return e.replace(/\&quot;/g,"")})},t.prototype.toJSON=function(t){var n=this,o=[].concat(n.colWidths),i=[].concat(n.rowHeights),r=[],a={},s={},l=e.prototype.toJSON.call(this);return n.forEach(function(e,o){var i,l=n.getCell(e,o);l&&l.isAttachmentCell()&&!t&&(i=l.getContent(),a[i.getResId()]=i.getInfo()),l&&l.isImageCell()&&!t&&(i=l.getContent(),s[i.getResId()]=i.getInfo()),r.push(l?l.toJSON(t):null)}),t?{cells:r,heights:i,widths:o}:(l.data={cells:r,heights:i,widths:o},l.resourceList={attachMap:a,imageMap:s},l)},t.prototype.toPlain=function(e){var t=this,o=[];return e=n.defaults(e||{},{filter:function(){return!0},returnString:!0,withLineBreak:!1}),t.forEach(function(n,i){var r=o[n],a=t.getCell(n,i),s="";r||(r=o[n]=[]),e.filter(a,n,i)&&(s=a?a.toPlain(e.withLineBreak):""),r.push(s)}),e.returnString?n.map(o,function(e){return e.join(" ")}).join("\n"):o},t.prototype.toXml=function(t){var o,r,a,s=this,l=e.prototype.toXml.call(this,t),c=t.createElement("resource-list"),d=t.createElement("content"),h={},p=[];return s.forEach(function(e,o){var i=s.getCell(e,o),r=i?i.toXml(t,c,h):{},a=n.keys(r);1===a.length&&"value"===a[0]&&""===r.value&&(r={}),p.push(r)}),l.appendChild(c),r={cells:p,heights:[].concat(s.rowHeights),widths:[].concat(s.colWidths)},a=JSON.stringify(r),d.appendChild(t.createTextNode(a)),l.appendChild(d),o=t.createElement("styles"),i.toXml(s,o,t),l.appendChild(o),u.appendToXml(s.unknownTree,l),l},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=y.TABLE,this.setContentData(t.tableCells,t.rowHeights,t.colWidths),this.resourceMap=t.resourceMap,delete this.options,n.bindAll(this,"_onDetached","_onAttached","_onLockedChange"),this.on("detached",this._onDetached),this.on("attached",this._onAttached),this.on("locked-change",this._onLockedChange)},t.prototype._checkAndFixTableData=function(){var e,t,n=this.toJSON();try{(e=k(n.data)).errors.length&&(window.console.warn("Table data fix errors:  \n"+e.errors.join("\n")),g.log(n),t=e.fixedData,this.tableCells=d.cellsFromJSON({cellsJson:t.cells,height:t.heights.length,resourceList:n.resourceList,width:t.widths.length}),this.rowHeights=t.heights,this.colWidths=t.widths,this.trigger("content-change"))}catch(e){g.error("Table data fix failed",e)}},t.prototype._getCellAt=function(e,t){var n,o=this.tableCells;return o[e]&&o[e][t]&&(n=o[e][t]),n||g.warn("Failed to get cell at row/col",e,t),n},t.prototype._findMergePoint=function(e,t){var n,o=this._getCellAt(e,t);if(o&&o.isMergedCell()&&(e-=(n=o.getMergedCellAttr()).dy,t-=n.dx,o=this._getCellAt(e,t)),o)return{cell:o,col:t,row:e};g.warn("Failed to find merge point row/col",e,t)},t.prototype._getCellSize=function(e,t,o){if(e&&!e.isMergedCell()){var i,r,a=this,s=function(e,t){return e+t};if(e&&!e.isMergedCell())return e.isMergePoint()?(i=e.getMergePointAttr())&&i.width&&i.height&&(r={cols:[],heights:[],rows:[],widths:[]},p(function(e){var t=o+e,n=a.getColumnWidth(t);r.widths.push(n),r.cols.push(t)},!1,i.width),p(function(e){var n=t+e,o=a.getRowHeight(n);r.heights.push(o),r.rows.push(n)},!1,i.height)):r={cols:[o],heights:[a.getRowHeight(t)],rows:[t],widths:[a.getColumnWidth(o)]},r&&(r.width=n.reduce(r.widths,s,0),r.height=n.reduce(r.heights,s,0)),r}},t.prototype._onDetached=function(){},t.prototype._onAttached=function(){},t.prototype._onLockedChange=function(){},t}(m)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(6),n(24),n(8),n(13),n(1)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(e&&e.richText)return new t(e);l.warn("Failed to create Lines",e)},t.createBlank=function(e){return e?t.create({richText:r.createBlank(!1)}):new t({})},t.fromCollabJSON=function(e){var o=t.createBlank();return n.map(e,function(e){o.appendRichText(r.fromCollabJSON(e))}),o},t.fromJSON=function(e){var o=t.createBlank();return n.map(e,function(e){o.appendRichText(r.fromJSON(e))}),o},t.splitRichText=function(e){if(e){if(0===e.getLength()||!e.isKeepLineBreak())return[e];var t,o=e.getReadOnlyData(),i=[],a=[],s=0;for(s=0;s<o.length;s++)(t=o[s]).isLineBreak()?(i.push(a),a=[]):a.push(t);return a.length&&i.push(a),i=n.map(i,function(e){var t=r.create("",!1);return t.appendRichChars(e),t})}},t.prototype.appendLines=function(e){e&&(this.richTextList=this.richTextList.concat(e.getAsRichTextList()))},t.prototype.appendRichText=function(e){var n=t.splitRichText(e);n&&n.length&&(this.richTextList=this.richTextList.concat(n))},t.prototype.getAsRichTextList=function(){return[].concat(this.richTextList)},t.prototype.getCommonStyles=function(e,t,n){var o=this.toRichText();return e=e||0,t=t||o.getLength(),o.getCommonStyles(e,t,n)},t.prototype.getCommonStyle=function(e){var t;return n.some(this.richTextList,function(n){if(n&&!n.isEmpty()){var i=n.getCommonStyle(0,n.getLength(),e,!0);if(null==t)null!=i&&(t=i);else if(t!==i)return t=o.INTERM,!0}}),t===o.INTERM&&(t=null),t},t.prototype.getCount=function(){return this.richTextList.length},t.prototype.getStyle=function(e){var t=[];return n.each(this.richTextList,function(n){var o=n.getStyle(0,n.getLength(),e);t.push(o)}),t},t.prototype.isEmpty=function(){var e=this.richTextList;return!e||!e.length||n.every(e,function(e){return e&&e.isEmpty()})},t.prototype.setStyle=function(e,t){var o;n.isArray(t)?(o=t,n.each(this.richTextList,function(t,n){var i=o[n];t.setStyle(0,t.getLength(),e,i)})):n.each(this.richTextList,function(n){n.setStyle(0,n.getLength(),e,t)})},t.prototype.toCollabJSON=function(){return n.map(this.richTextList,function(e){return e.toCollabJSON()})},t.prototype.toJSON=function(){return n.map(this.richTextList,function(e){return e.toJSON()})},t.prototype.toHtml=function(e){var t=(e=n.defaults(e||{},{handleLineWrapper:function(e){e.className="table-cell-line"}})).styleRules,o=n.map(this.richTextList,function(n,o){var r=i.rich2html(n,{styleRules:t}),a=document.createElement("div");return e.handleLineWrapper(a,n,o),a.innerHTML=r,a.outerHTML});return o=o.join("")},t.prototype.toPlain=function(){return n.map(this.richTextList,function(e){return e?e.toString():""})},t.prototype.toRichText=function(){var e,t=this.getCount(),n=this.richTextList,o=r.create("",!0);for(e=0;e<t;e++)o.append(n[e]),e<t-1&&o.append(r.create("\n",!0));return o},t.prototype.toString=function(){return this.toRichText().toString()},t.prototype.initialize=function(e){e=n.defaults(e||{},{richText:null}),this.richTextList=[],this.appendRichText(e.richText)},t}(s)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.setUnderscore=function(e){t.underscoreInst=e},e.setLogger=function(e){t.loggerInst=e},e}();t.ExternalLibs=n}.apply(t,[n,t]))||(e.exports=o)},,function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(5),i=n(0),r=n(6),a=n(2),s=n(1),l=n(104),c=n(435),d=o('<div class="collab-editing-view-wrapper"><div class="collab-session-view"></div></div>');return t.View.extend({className:"block-view unknown-block-view",_isReadOnly:!1,_pageInfo:null,_$pageBreakContainer:null,PAGE_HEIGHT:null,_viewHeightInlastPaging:null,block:null,_getSelector:function(){var e=this.tagName,t=this.className.split(/\s+/),n=this.id,o=this.cid,r=".note-view ";return r+=e,n&&(r+="#"+n),i.each(t,function(e){e&&(r+="."+e)}),r+='[data-yne-cid="'+o+'"]'},initialize:function(e){this.block=e.block,this._isReadOnly=e.isReadOnly,i.bindAll(this,"_onLockedChange"),this.block.on("locked-change",this._onLockedChange),e.inlineStyleViewMapper&&(this._inlineStyleViewMapper=e.inlineStyleViewMapper),this._pageInfo={},this.PAGE_HEIGHT=e.pageSize.height,i.isNumber(this.PAGE_HEIGHT)||(s.debugAlert("invalid PAGE_HEIGHT:"+this.PAGE_HEIGHT),this.PAGE_HEIGHT=r.PAGE_TYPE_NONE_HEIGHT),this._$pageBreakContainer=e.pageBreakContainer,this.noteView=e.noteView},render:function(){this.$el.attr("data-yne-cid",this.cid),this._updateLockState(this.isLocked()),a.isListItem(this.block)||this.trigger("view-height-changed",this.cid)},convertToNativeRange:function(){s.error("convertToNativeRange() should be implemented by subclass!")},parseNativeRange:function(){s.error("parseNativeRange() should be implemented by subclass!")},bindSelectionEvents:function(){i.bindAll(this,"onDrawRange"),this.on("draw-range",this.onDrawRange)},onDrawRange:function(){throw"Method not implemented."},_onLockedChange:function(e){this._updateLockState(this.isLocked()),this._updateLockIndicator(this.block.isLocked(),e),this.trigger("locked-change"),this.trigger("view-height-changed",this.cid)},isCollabLocked:function(){var e=this.block,t=!1;return e&&(t=e.isLocked()),t},isLocked:function(){var e=this.block,t=this._isReadOnly;return e&&(t=e.isLocked()||this._isReadOnly),t},_updateLockIndicator:function(e,t){var n,o,i=t&&t.lockColor,r=t&&t.nickname;null!=(n=this.$el.find(".collab-editing-view-wrapper"))&&0!==n.length||(n=d.clone(),this.$el.prepend(n)),o=n.find(".collab-session-view"),e?(this.$el.addClass("collab-editing-view"),null!=r&&o.text(r),null!=i&&o.css("background-color",i)):(this.$el.removeClass("collab-editing-view"),this.$el.find(".collab-editing-view-wrapper").remove())},_updateLockState:function(e){e?this.$el.addClass("collab-locked"):this.$el.removeClass("collab-locked")},onDestroy:function(){l.warn("onDestroy() was not implemented by "+this.block.type+" view")},clearHighlight:function(){},clearPageBreaks:function(){var e=this;i.each(e._pageInfo,function(t){t&&t.pageBreak&&e._removePageBreak(t.pageBreak)}),e._pageInfo={}},coincideAllPageBreaks:function(){var e=this;e._pageInfo?i.each(e._pageInfo,function(t){t&&t.pageBreak&&e._coincidePageBreak(t.pageBreak)}):s.debugAlert("pageInfo should not be null when coincideAllPageBreaks")},disablePageMode:function(){this.clearPageBreaks(),this.PAGE_HEIGHT=r.PAGE_HEIGHT_NONE},enablePageMode:function(e){this.clearPageBreaks(),e===r.PAGE_TYPE_A4?this.PAGE_HEIGHT=r.PAGE_HEIGHT_A4:e===r.PAGE_TYPE_B5?this.PAGE_HEIGHT=r.PAGE_HEIGHT_B5:e===r.PAGE_TYPE_TEST?this.PAGE_HEIGHT=r.PAGE_HEIGHT_TEST:this.PAGE_HEIGHT=r.PAGE_HEIGHT_NONE},getBottomPosInPage:function(e){var t;return this._pageInfo[e]?this._pageInfo[e].pageBreak?t=-1:(t=this._pageInfo[e].topPosInPage+this._getHeightInPage(e))>this.PAGE_HEIGHT&&s.warn("Unsplitted Block whose Height is more than PAGE_HEIGHT",this._pageInfo[e].topPosInPage,t,this.PAGE_HEIGHT):(s.debugAlert("should NOT invoke the getBottomPosInPage when the view is NOT on the page"),t=0),t},getFirstTransPageIndex:function(){var e={};return this._pageInfo?(i.each(this._pageInfo,function(t){t&&(null==e.pageIndex?e=t:t.pageIndex<e.pageIndex&&(e=t))}),e.pageIndex):(s.debugAlert("pageInfo should not be null when getFirstTransPageIndex"),null)},getLastTransPageIndex:function(){var e={};return this._pageInfo?(i.each(this._pageInfo,function(t){t&&(null==e.pageIndex?e=t:t.pageIndex>e.pageIndex&&(e=t))}),e.pageIndex):(s.debugAlert("pageInfo should not be null when getLastTransPageIndex"),null)},isOnFloat:function(){return"none"!==(this.$el.css("float")||"none").toLowerCase()},resetPageInfo:function(e,t){var n,o,r,a=!1;return this._pageInfo?i.isNumber(t)?null==e?(s.debugAlert("pageIndex should NOT be null"),a):null==this._$pageBreakContainer?(s.debugAlert("pageBreakContainer should not be null"),a):(this._pageInfo[e]&&(n=this._pageInfo[e].topPosInPage),t=Math.ceil(t),this.clearPageBreaks(),this._updatePageInfo(e,t),this.$el.css("height","auto"),o=this.$el.find(".page-break-placeholder"),this.$el.hasClass("quote-view")&&o.length&&this.$el.find(".para-text").css("display","inline-block"),r=this.$el.outerHeight(!0),t!==n?a=!0:this._isViewHeightChanged(r)?a=!0:this._isPagingContinue()&&(a=!0),a&&(this._viewHeightInlastPaging=r),a):(s.debugAlert("topPosInPage should be a number:"+t),a):(s.debugAlert("pageInfo should not be null when resetPageInfo"),a)},_coincidePageBreak:function(e){e.coincide(),this.trigger("pageBreak-positionChanged",e.getPageBreak().attr("data-page-id")),this._showPageBreakInfo(e)},_createPageBreak:function(e,t,n,o){return new c({pageIndex:e,topBlankHeight:t,bottomBlankHeight:n,container:this._$pageBreakContainer,noteView:this.noteView,placeholder:o})},_getContentContainer:function(){return this.$el},_getContentContainerBottomInView:function(){return this._getOffsetTopPos(this._getContentContainer())+this._getContentContainer().outerHeight()-this._getOffsetTopPos(this.$el)},_getOffsetTopPos:function(e){return e.offset().top},_getHeightInPage:function(e){var t,n,o=this._pageInfo[e-1],i=this._pageInfo[e];return i?o&&!o.pageBreak?(s.debugAlert("previous pageBreak should NOT be null"),0):o&&0===o.pageBreak.getPlaceholder().next().length?0:a.isTable(this.block)&&0===this._getContentContainer().find("tbody").children().length?0:"none"!==this.$el.css("float")?0:o&&o.pageBreak&&i&&i.pageBreak?(s.debugAlert("_getHeightInPage: should NOT there when crossing previous/current page"),this.PAGE_HEIGHT):(t=o?this._getPageBreakBottomPosInView(e-1):0,i&&i.pageBreak?(s.debugAlert("_getHeightInPage: shoud not be there when current pageBreak ready"),n=this._getPageBreakTopPosInView(e)):n=this._getContentContainerBottomInView(),Math.ceil(n-t)):(s.debugAlert("should NOT invoke the method when not on the page"),0)},_getPageBreakBottomPosInView:function(e){var t,n;return(t=this._pageInfo[e])&&t.pageBreak?(n=t.pageBreak.getPlaceholder(),this._getOffsetTopPos(n)+n.height()-this._getOffsetTopPos(this.$el)):0},_getPageBreakTopPosInView:function(e){var t;return t=this._pageInfo[e].pageBreak.getPlaceholder(),this._getOffsetTopPos(t)-this._getOffsetTopPos(this.$el)},_getTopPosInPage:function(e){var t=0;return this._pageInfo[e-1]&&this._pageInfo[e-1].pageBreak?t=0:this._pageInfo[e]?t=this._pageInfo[e].topPosInPage:s.debugAlert("should NOT invoke the _getTopPosInPage when the view is NOT on the page"),t},_handlePageOverflow:function(e,t){var n,o,i=this._getHeightInPage(e),r=this._pageInfo[e-1];return o=this.PAGE_HEIGHT-t,r&&r.pageBreak&&0!==t?(s.debugAlert("toPosInPage should be 0 when crossing the previous page"),!1):(o<0&&(o=0),0===t||this.isOnFloat()||o>i?(this._setViewMaxHeight(e),n=!1):(this._insertPageBreak(e,o),n=!0),n)},_insertPageBreak:function(e,t){var n;(n=this._createPageBreak(e,t)).getPlaceholder().prependTo(this.$el),this._pageInfo[e].pageBreak=n,this.trigger("pageBreak-inserted",n.getPageBreak().attr("data-page-id")),this._coincidePageBreak(n)},_isInPageMode:function(){return this.PAGE_HEIGHT!==r.PAGE_HEIGHT_NONE},_isPagingContinue:function(){return!1},_isViewHeightChanged:function(e){var t=!1;return(!this._viewHeightInlastPaging||Math.round(Math.abs(e-this._viewHeightInlastPaging))>r.TOLERABLE_HEIGHT_CHANGE)&&(t=!0),t},_removePageBreak:function(e){e.destroy()},_setViewMaxHeight:function(){},_showPageBreakInfo:function(e){var t,n,o,i,r,a,l=e.getPageBreak();s.DEBUG&&((t=l.find(".bottomSpan")).css("border-bottom","2px dashed #b6b9b6"),(n=l.find(".topSpan")).css("border-top","2px dashed #b6b9b6"),r=l.attr("data-page-id"),o=this._getOffsetTopPos(l),i=this._getOffsetTopPos(e.getPlaceholder()),a="Page:"+r+" OffsetTop(mark/placeholder):("+Math.round(o)+"/"+Math.round(i)+") TopBlank:"+n.outerHeight(),n.text(a),r*=1,a="TopOnPage:"+this._pageInfo[r].pageIndex+" BottomBlank:"+t.outerHeight(),t.text(a))},_updatePageInfo:function(e,t){this._pageInfo[e]={pageIndex:e,topPosInPage:t},this._handlePageOverflow(e,t)&&this._updatePageInfo(e+1,0)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(e){return e.replace(/\xA0/g," ")}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){var e=/</g,t=/>/g,n=/"/g,o=/&quot;/g,i=/&#([a-zA-Z0-9]*);?/gim,r=/&colon;?/gim,a=/&newline;?/gim,s=/((j\s*a\s*v\s*a|v\s*b|l\s*i\s*v\s*e)\s*s\s*c\s*r\s*i\s*p\s*t\s*|m\s*o\s*c\s*h\s*a)\:/gi,l=/e\s*x\s*p\s*r\s*e\s*s\s*s\s*i\s*o\s*n\s*\(.*/gi,c=/u\s*r\s*l\s*\(.*/gi,d=/<!--[\s\S]*?-->/g;function u(n){return n.replace(e,"&lt;").replace(t,"&gt;")}function h(e){return e.replace(n,"&quot;")}function p(e){return e.replace(o,'"')}function g(e){return e.replace(i,function(e,t){return"x"===t[0]||"X"===t[0]?String.fromCharCode(parseInt(t.substr(1),16)):String.fromCharCode(parseInt(t,10))})}function f(e){return e.replace(r,":").replace(a," ")}function m(e){for(var t="",n=0,o=e.length;n<o;n++)t+=e.charCodeAt(n)<32?" ":e.charAt(n);return t.trim()}function y(e){return e=m(e=f(e=g(e=p(e))))}function _(e){return e=u(e=h(e))}var I={safeAttrValue:function(e,t){if(t=y(t),"href"===e||"src"===e){if("#"===(t=t.trim(t)))return"#";if("http://"!==t.substr(0,7)&&"https://"!==t.substr(0,8)&&"mailto:"!==t.substr(0,7)&&"#"!==t[0]&&"/"!==t[0])return""}else if("background"===e){if(s.lastIndex=0,s.test(t))return""}else if("style"===e){if(l.lastIndex=0,l.test(t))return"";if(c.lastIndex=0,c.test(t)&&(s.lastIndex=0,s.test(t)))return""}return t=_(t)},safeHref:function(e){return e=y(e),s.lastIndex=0,s.test(e)?"":e=_(e)}};return I.escapeHtml=u,I.escapeQuote=h,I.unescapeQuote=p,I.escapeHtmlEntities=g,I.escapeDangerHtml5Entities=f,I.clearNonPrintableCharacter=m,I.friendlyAttrValue=y,I.escapeAttrValue=_,I.onIgnoreTagStripAll=function(){return""},I.StripTagBody=function(e,t){"function"!=typeof t&&(t=function(){});var n=!Array.isArray(e),o=[],i=!1;return{onIgnoreTag:function(r,a,s){if(function(t){return!!n||-1!==e.indexOf(t)}(r)){if(s.isClosing){var l="[/removed]",c=s.position+l.length;return o.push([!1!==i?i:s.position,c]),i=!1,l}return i||(i=s.position),"[removed]"}return t(r,a,s)},remove:function(e){var t="",n=0;return o.forEach(function(o){t+=e.slice(n,o[0]),n=o[1]}),t+=e.slice(n)}}},I.stripCommentTag=function(e){return e.replace(d,"")},I.stripBlankChar=function(e){var t=e.split("");return(t=t.filter(function(e){var t=e.charCodeAt(0);return!(127===t||t<=31&&10!==t&&13!==t)})).join("")},I}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(16),n(1)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.getBlockById=function(e,t){var n=t.getBlockById(e);return n||o.warn("Failed to find block",e),n},t.fromCollabJSON=function(e,n){var o=t.getBlockById(e.blockId,n);return o?new t({block:o}):null},t.prototype.isCollapsed=function(){throw new Error("isCollapsed () should be implemented by subclass")},t.prototype.getType=function(){return this.type},t.prototype.clone=function(e){throw new Error("Every subclass of BlockRange should implement the `clone` method")},t.prototype.collapse=function(e){throw new Error("Every subclass of BlockRange should implement the `collapse` method")},t.prototype.expandToStart=function(){},t.prototype.expandToEnd=function(){},t.prototype.getDataAsJSON=function(){throw new Error("toJSON() should be implemented by subclass!")},t.prototype.getDataAsHtml=function(e){throw new Error("toHtml() should be implemented by subclass!")},t.prototype.getDataAsPlain=function(){throw new Error("toPlain() should be implemented by subclass!")},t.prototype.canDrawedByNative=function(){throw new Error("canDrawedByNative() should be implemented by subclass!")},t.prototype.toNativeRange=function(e){if(e&&e.getBlockViewByBlock){var t=e.getBlockViewByBlock(this.block);if(t)return t.convertToNativeRange(this);o.warn("No blockView")}else o.error("note view is unvalid!")},t.prototype.extendToBlockEnd=function(){o.warn('Show sub block range do! "extendToBlockEnd"')},t.prototype.extendToBlockStart=function(){o.warn('Show sub block range do! "extendToBlockStart"')},t.prototype.getBlockId=function(){return this.block?this.block.getId():null},t.prototype.toCollabJSON=function(e){return{blockId:this.block.getId(),rangeType:this.type}},t.prototype.initialize=function(e){e=e||{block:null},this.type="block",this.block=e.block},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(2),n(297),n(1),n(63)],void 0===(i=function(e,t,n,o,i,r,s){"use strict";var l="1",c="2",d="3",u="4",h="5";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(e&&e.block&&e.type){if(e.type!==l||t._isValidRect(e.rect))return new t(e);r.error("Failed to create TableRange, rect is NOT valid",e)}else r.error("Failed to create TableRange",e)},t.fromCollabJSON=function(e,n){var i=e.rangeType;if(i===o.TABLE){var a=s.getBlockById(e.blockId,n);return a?t.create({block:a,type:e.simpleValue2,rect:e.simpleValue1}):void 0}r.error("wrong block type:",i)},t._isValidRect=function(e){return e&&e.left>=0&&e.top>=0&&e.width>=1&&e.height>=1},t.prototype.getType=function(){return this.type},t.prototype.getAsRectRange=function(){var e,t=this.type,n=this.block;switch(t){case d:case u:e=i.create({table:n,width:1,height:1,top:t===d?0:n.getRowCount()-1,left:t===d?0:n.getColumnCount()-1});break;case c:e=i.create({table:n,top:0,left:0,width:n.getColumnCount(),height:n.getRowCount()});break;case l:if(!this.rect)return void r.warn("Bad range, please check code, range:",this);e=i.create({table:n,top:this.rect.top,left:this.rect.left,width:this.rect.width,height:this.rect.height});break;case h:return null;default:r.error("Failed to create RectRange",t)}return e},t.prototype.isCollapsed=function(){return this.type===h},t.prototype.isFullSelected=function(){return this.type===c},t.prototype.isOnCellEdit=function(){var e;return this.block.trigger("get-block-view",this.block,function(t){e=t}),e&&e.isOnCellEdit()},t.prototype.isInBlank=function(){return this.type===h},t.prototype.clone=function(){return t.create({block:this.block,type:this.type,rect:this.rect})},t.prototype.collapse=function(){},t.prototype.getDataAsJSON=function(e){var t=this.getAsRectRange();return t?t.getDataAsJSON(e):null},t.prototype.getDataAsHtml=function(){var e=this.getAsRectRange();return e?e.getDataAsHtml():null},t.prototype.getDataAsPlain=function(){var e=this.getAsRectRange();return e?e.getDataAsPlain():null},t.prototype.canDrawedByNative=function(){return!1},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.simpleValue1=this.getAsRectRange()||null,t.simpleValue2=this.getType()||null,t},t.prototype.initialize=function(i){e.prototype.initialize.call(this,i),i=n.defaults(i||{},{type:d,rect:null}),this.block=i.block,this.type=i.type||o.TABLE,this.type===l&&(t._isValidRect(i.rect)?this.rect=i.rect:this.type=d)},t.TYPES={NORMAL:"1",ALL:"2",FIRST_CELL:"3",LAST_CELL:"4",BLANK:"5"},t}(s)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(13),n(1)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromXml=function(e,t){o.error("fromXml() should be implemented by sub-class")},t.fromCollabJSON=function(e){return o.error("fromCollabJSON() should be implemented by sub-class"),null},t.prototype.getResId=function(){return this.resProps.resId||o.error("No resId"),this.resProps.resId},t.prototype.getType=function(){return this.resProps.type},t.prototype.isType=function(e){return this.resProps.type===e},t.prototype.toHtml=function(e){return o.error("toHtml() should be implemented by sub-class"),""},t.prototype.toJSON=function(){o.error("toJSON() should be implemented by sub-class")},t.prototype.toCollabJSON=function(){o.error("toCollabJSON() should be implemented by sub-class")},t.prototype.toPlain=function(){o.error("toPlain() should be implemented by sub-class")},t.prototype.toXml=function(e,t){o.error("toXml() should be implemented by sub-class")},t.prototype.initialize=function(e){this.resProps=e||{resId:"",type:t.TYPE_IMAGE}},t.TYPE_IMAGE="image",t.TYPE_ATTACHMENT="attachment",t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(34),n(3),n(2),n(92),n(8),n(56),n(31),n(13),n(1),n(46),n(42),n(65),n(76),n(41),n(82)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.blockToCell=function(e){var n,o=t.blockToCellContent(e);return o&&(n=t.create({content:o})),n},t.blockToCellContent=function(e){if(e){var t,i,a,u,f,m,y=r.getType(e);switch(y){case r.PARAGRAPH:case r.QUOTE:case r.CATALOGUE:case r.CODE:case r.HEADING:i=c.create({richText:e.getText()});break;case r.IMAGE:case r.HANDWRITE:i=g.create({source:e.getSource()});break;case r.ATTACHMENT:i=p.create({fileLength:e.getFileLength(),fileName:e.getFileName(),resource:e.getResource(),source:e.getSource()});break;case r.LIST_ITEM:(t=e.getText()).getLength()&&(m={},n.each(t.getStylesAtIndex(0),function(e,t){s.isSupportedStyle(t)&&(m[t]=e)})),u=s.makePlainMarker(e,!1),u=l.create(u,!1),m&&u.setStyles(0,u.getLength(),m),u.append(l.create(" ",!1)),a=e.getLevel()||1,f=o.repeat(" ",4*(a-1)),(f=l.create(f,!1)).append(u),f.append(t),i=c.create({richText:f});break;case r.TODO:f=d.getMarker(e),f=l.create(f,!1),t=e.getText(),e.getChecked()&&t.setStyles(0,t.getLength(),{strike:!0}),f.append(t),i=c.create({richText:f});break;default:h.warn("Failed to handle block to cell",y,e)}return i}},t.create=function(e){if(e&&e.content){var n=e.content;if(n instanceof c||n instanceof f)return new t(e);h.warn("Failed to create TableCell",e)}else h.warn("Failed to create TableCell",e)},t.createByTable=function(e,n,o,i){var r=e.getId(),a=t.makeCellId(r,n,o);return t.create({cellId:a,content:i})},t.fromCollabJSON=function(e){var n={cellId:e.cellId,content:_.contentFromCollabJSON(e.content),styles:e.styles};return e.attr&&(n.mergeWidth=e.attr.width,n.mergeHeight=e.attr.height,n.mergePointDX=e.attr.dx,n.mergePointDY=e.attr.dy),t.create(n)},t.fromJSON=function(e,o,i){e||h.error("Bad json data!");var r={};return r.styles=n.pick(e,m.getAllStyleNames()),n.extend(r,n.pick(e,t.ATTRIBUTE_NAMES),{cellId:e.cellId,content:_.contentFromJSON(e.content,!1,i)||c.createBlank()}),o&&delete r.cellId,t.create(r)},t.fromXml=function(e){if(e&&e.tableBlockId&&null!=e.rowIndex&&null!=e.colIndex){var o,i={cellId:t.makeCellId(e.tableBlockId,e.rowIndex,e.colIndex)},r=e.cellRawData,a=e.resourceMap,s=t._resourceFromJSON(r,a),l=t.ATTRIBUTE_NAMES,d=m.getAllStyleNames(),u=["value","resource","inlineStyles"].concat(l,d);return s?i.content=s:(o=t._linesFromJSON(r),i.content=o||c.createBlank()),r=r||{},i.unknown=n.omit(r,u.concat(n.keys(_.oldStyleNameMap))),i.styles=n.pick(r,d),n.extend(i,n.pick(r,l)),t.create(i)}h.warn("Failed to create TableCell from JSON",e)},t.makeCellId=function(e,t,n){return[e,"cell",t,n].join("-")},t._linesFromJSON=function(e){var n=t._richTextFromJSON(e);return n?c.create({richText:n}):c.createBlank()},t._resourceFromJSON=function(e,t){if(e&&e.resource){var n=e.resource,o=t[n];return o&&o.getResId&&o.getResId()===n?o:void 0}},t._richTextFromJSON=function(e){if(e&&e.value){var t=e.value,o=new l({text:t}),i=_.oldStyleNameMap,r=o.getLength();return n.each(i,function(t,i){var a=t,s=e[i];null!=s&&("font-size"===a&&n.isString(s)&&(s=s.replace("px","")),o.setStyle(0,r,a,s))}),e.inlineStyles&&n.each(e.inlineStyles,function(e,t){n.each(e,function(e){o.setStyle(e.from,e.to,t,e.value)})}),o}},t.prototype.clearMergedCellAttr=function(){delete this.mergePointDX,delete this.mergePointDY},t.prototype.clearMergePointAttr=function(){delete this.mergeWidth,delete this.mergeHeight},t.prototype.clearStyles=function(){this.styles={}},t.prototype.clearStylesForEmpty=function(){this.stylesForEmpty={}},t.prototype.getBlockStyles=function(){return this.styles},t.prototype.getBlockStylesAsBulb=function(){var e=n.clone(this.styles);return m.tableStyles2BulbStyles(e)},t.prototype.getCellId=function(){return this.cellId},t.prototype.getCommonInlineStyle=function(e){var t=this.getContent();return this.isTextNoEmptyCell()&&t.getCommonStyle?t.getCommonStyle(e):this.stylesForEmpty[e]},t.prototype.getCommonInlineStyles=function(){var e=this.getContent();return this.isTextNoEmptyCell()&&e.getCommonStyles?e.getCommonStyles():this.stylesForEmpty},t.prototype.getContent=function(){return this.content},t.prototype.getInlineStyles=function(e){if(this.isTextNoEmptyCell()){var t=this.getContent(),n={};return e.forEach(function(e){n[e]=t.getStyle(e)}),n}},t.prototype.getMergedCellAttr=function(){return{dx:this.mergePointDX||0,dy:this.mergePointDY||0}},t.prototype.getMergePointAttr=function(){var e=this.mergeWidth||0;return{height:this.mergeHeight||0,width:e}},t.prototype.getStylesForEmpty=function(e){var t,o=this;return e?(t={},n.each(e,function(e){t[e]=o.stylesForEmpty[e]}),t):o.stylesForEmpty},t.prototype.getType=function(){var e=y.TEXT,t=this.getContent();if(t&&t.getType)switch(t.getType()){case f.TYPE_IMAGE:e=y.IMAGE;break;case f.TYPE_ATTACHMENT:e=y.ATTACHMENT}return e},t.prototype.isAttachmentCell=function(){return this.getType()===y.ATTACHMENT},t.prototype.isEmpty=function(){var e=this.getType(),t=this.content;return e===y.TEXT&&(!t||t.isEmpty())},t.prototype.isImageCell=function(){return this.getType()===y.IMAGE},t.prototype.isLocked=function(){return this.locked},t.prototype.isMergedCell=function(){var e=this.getMergedCellAttr();return e.dx>=1||e.dy>=1},t.prototype.isMergePoint=function(){var e=this.getMergePointAttr();return e.width>1||e.height>1},t.prototype.isTextNoEmptyCell=function(){var e=this.getContent();return!!e&&(this.getType()===t.TYPE_TEXT&&!e.isEmpty())},t.prototype.setBlockStyle=function(e,t){var o=m.getConfig(e);o&&(this.isLocked()||("Enum"===o.type?o.possible[t]||(t=o.default):"Number"!==o.type||n.isNumber(t)?"Boolean"!==o.type||n.isBoolean(t)?n["is"+o.type]&&(n["is"+o.type](t)||(t=t.default)):t="true"===t:(t=null===t||""===t?NaN:Number(t),!isNaN(t)&&t||(t=o.default)),t=t||o.default,this.styles[e]=t))},t.prototype.setBlockStyles=function(e){var t=this;if(!t.isLocked())return e?(n.each(e,function(e,n){t.setBlockStyle(n,e)}),!0):void 0},t.prototype.setInlineStyles=function(e){if(e&&this.isTextNoEmptyCell()){var t=this.getContent();n.each(e,function(e,n){t.setStyle(n,e)})}},t.prototype.setContent=function(e){var t=!1;if(!this.isLocked())return e instanceof c?(this.content=e,t=!0,this.isTextNoEmptyCell()&&this.clearStylesForEmpty()):e instanceof f&&(this.content=e,t=!0),t},t.prototype.setLocked=function(e){this.locked=!0===e},t.prototype.setMergedCellAttr=function(e,t){if(null!=e&&null!=t&&e>=0&&t>=0&&(e>0||t>0))return this.mergePointDX=e,this.mergePointDY=t,this.clearMergePointAttr(),!0},t.prototype.setMergePointAttr=function(e,t){return!(!e&&!t)&&(e>=1&&!t&&(h.warn("No valid mergeHeight, will set 1"),t=1),t>=1&&!e&&(h.warn("No valid mergeWidth, will set 1"),e=1),this.mergeWidth=e,this.mergeHeight=t,this.clearMergedCellAttr(),!0)},t.prototype.setStylesForEmpty=function(e){h.log("setStylesForEmpty",e),n.extend(this.stylesForEmpty,e)},t.prototype.setUnknown=function(e){e&&(this.unknown=e)},t.prototype.toCollabJSON=function(){var e,t={};return this.isMergedCell()&&(t=n.extend(t,this.getMergedCellAttr())),this.isMergePoint()&&(t=n.extend(t,this.getMergePointAttr())),e={cellId:this.getCellId(),content:_.contentToCollabJSON(this.content),styles:n.extend({},this.styles)},n.isEmpty(t)||(e.attr=t),e},t.prototype.toHtml=function(){h.error("Should not call TabelCell.toHtml()")},t.prototype.toJSON=function(e){var t,o={},i={};return this.isMergedCell()&&(o=n.extend(o,this.getMergedCellAttr()),n.extend(i,{mergePointDX:o.dx,mergePointDY:o.dy})),this.isMergePoint()&&(o=n.extend(o,this.getMergePointAttr()),n.extend(i,{mergeHeight:o.height,mergeWidth:o.width})),this.isTextNoEmptyCell()&&(i.value=this.content.toString(),e&&(t=this.content.getCommonStyles(null,null,!0),n.extend(i,_.inlineStyle2oldCell(t)))),e?n.extend(i,_.blockStyle2oldCell(this.styles)):n.extend(i,{cellId:this.getCellId(),content:_.contentToJSON(this.content)},_.blockStyle2oldCell(this.styles)),i},t.prototype.toPlain=function(e){return this.isMergedCell()?"":_.contentToPlain(this.content,e)},t.prototype.toXml=function(e,t,o){var i,r,a,s,l,c={};if(this.isMergedCell())return{mergePointDX:(i=this.getMergedCellAttr()).dx,mergePointDY:i.dy,value:""};switch(this.isMergePoint()&&(c={mergeHeight:(i=this.getMergePointAttr()).height,mergeWidth:i.width}),r=this.getType(),a=this.getContent(),n.isEmpty(this.styles)||n.extend(c,this.styles),n.isEmpty(this.unknown)||n.extend(c,this.unknown),r){case y.TEXT:s=a.toRichText().toJSON(!0),c.value=s.text,s.inlineStyles&&(c.inlineStyles=s.inlineStyles);break;case y.IMAGE:case y.ATTACHMENT:l=a.getResId(),c.value="",c.resource=l,l&&!0===o[l]?h.warn("resource has already in <resource-list>",l,a):(a.toXml(e,t),o[l]=!0);break;default:h.error("unvalid type",r)}return c},t.prototype.initialize=function(e){e=e||{},this.styles={},this.cellId=e.cellId||i.newGUID(),this.setContent(e.content),this.setBlockStyles(e.styles),this.setMergePointAttr(e.mergeWidth,e.mergeHeight),this.setMergedCellAttr(e.mergePointDX,e.mergePointDY),this.setUnknown(e.unknown),this.stylesForEmpty={}},t.TYPE_TEXT="text",t.ATTRIBUTE_NAMES=["mergeWidth","mergeHeight","mergePointDX","mergePointDY"],t}(u)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(45)],void 0===(i=function(e,t,n){"use strict";return n({DEFAULT_ROW_HEIGHT:40,DEFAULT_COL_WIDTH:70,MIN_ROW_COUNT:1,MIN_COL_COUNT:1,MAX_ROW_COUNT:500,MAX_COL_COUNT:35,ATTACHMENT_MIN_WIDTH:285,ATTACHMENT_MIN_HEIGHT:64,DEFAULT_TABLE_WIDTH:620},!0)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(32),i=n(2),r=n(69),a=n(12),s=n(31),l=n(8),c=n(174),d=n(6),u=n(0),h=n(49),p=n(50),g=n(5),f=n(3);return t=null,o.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0,align:!0,"line-height":!0,indent:!0,"text-indent":!0},computeBulbStyles:function(){var e,n=this.el,o=n.getAttribute("yne-bulb-block");this.bulbBlock=o,o===i.PARAGRAPH?(e=n.style.marginLeft,e=parseInt(e,10),isNaN(e)||(e=Math.ceil(e/d.INDENT_WIDTH),this.styles.indent=(this.styles.indent||0)+e)):o===i.TODO&&(e=n.querySelector("[yne-bulb-todo-content]"))?n.innerHTML=e.innerHTML:("catalogue-wrap"===n.getAttribute("yne-bulb-type")||!t&&o===i.CATALOGUE)&&(t=new p({}))},setup:function(){this.block=null},capture:function(e){e&&!0===e.isBr?this.emitBlock(!0):e&&!0===e.isText?this._appendText(e):e&&!0===e.isEmptyPara?this.emitBlock():this.captureBlock(e),this._hasChild=!0},captureBlock:function(e){this.emitBlock(),this.emit(e)},finish:function(){this.emitBlock(),this._hasChild||this.emit({isEmptyPara:!0})},_getBlock:function(){return this.block||(this.block=this.createBlock()),this.block},createBlock:function(){var e,n=this.el;switch(this.bulbBlock){case i.HEADING:return new r({level:n.getAttribute("yne-bulb-level"),id:n.id});case i.CATALOGUE:return e=g(n).find("a").attr("href"),/#\w+$/.test(e)&&(e=e.match(/\w+$/)[0]),new h({id:f.newGUID(),href:e,ownerList:t});case i.TODO:return new s({id:f.newGUID(),checked:"true"===n.getAttribute("yne-bulb-checked")});default:return new a}},_appendText:function(e){this.txtList=this.txtList||[],this.txtList.push(e)},emitBlock:function(e){var t,n,o,r=this,a=r.txtList;n=r._getBlock(),a&&(r.options&&r.options.holdSpaces||(a=c(a)),u.each(a,function(e){r.bulbBlock===i.CATALOGUE&&(e.styles.href=""),e.text&&(o=new l({text:e.text}),t=o.getLength(),u.each(e.styles,function(e,n){o.setStyle(0,t,n,e)}),n.append(o))})),(e||n.getLength()>0)&&(n.setBlockStyles(r.styles),r.emit(n)),r.block=null,r.txtList=null}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(23),n(21),n(111),n(2),n(12),n(24),n(8)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(){return new t({})},t.fromCollabJSON=function(e){return this.generalFromJSON(e,!0)},t.fromJSON=function(e){return this.generalFromJSON(e,!1)},t.fromXml=function(e){var n=new t({});return n.parseIdFromXml(e),n.setText(d.fromXml(e)),t.fromXmlHelp(n,$(e)),$(e).children().each(function(e,t){switch(t.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"text":case"inline-styles":break;case"styles":o.fromXml(n,t);break;default:i.appendToTree(n.unknownTree,t)}}),n},t.generalFromJSON=function(t,n){var o=e.generalFromJSON.call(this,t,n);return o&&t.level&&o.setLevel(t.level),o},t.toXmlHelp=function(e,t){var n=e.getLevel();n&&$(t).attr("level",n),$(t).attr("compat","true")},t.fromXmlHelp=function(e,t){var n=$(t).attr("level");e.setLevel(n)},t.prototype.getBlockStyle=function(t,n){return"heading"===t?this.level:e.prototype.getBlockStyle.call(this,t,n)},t.prototype.getDefaultBlockStyles=function(){return n.extend({},e.prototype.getDefaultBlockStyles.apply(this,[]),r.headingBlockStyles[this.level])},t.prototype.getDefaultInlineStyles=function(){return n.extend({},e.prototype.getDefaultInlineStyles.call(this),r.headingInlineStyles[this.level])},t.prototype.getInlineStylesForEmpty=function(){return n.extend({heading:this.level},this.getDefaultInlineStyles())},t.prototype.getLevel=function(){return this.level},t.prototype.setLevel=function(e){e&&(this.level=e,this.trigger("content-change",this))},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.richText=this.richText.toCollabJSON(),t.level=this.getLevel(),t},t.prototype.toHtml=function(e,t,n){var o,i,r,a=document.createElement("div"),s=$(a);return n=!0===n,s.attr("yne-bulb-block","heading").attr("yne-bulb-level",this.getLevel()).attr("id",this.getId()).css("white-space","pre-wrap"),this.applyBlockStylesOnElement(s),e=e||0,t=null==t?this.getEndOffset():t,o=this.sliceText(e,t,!1),i=c.rich2html(o,{withDefault:n}),s.html(i),r=a.outerHTML,a=s=null,r},t.prototype.toJSON=function(t,n){var o=this.sliceText(t,n,!1),i=e.prototype.toJSON.call(this,t,n);return i.richText=o.toJSON(),i.level=this.getLevel(),i},t.prototype.toXml=function(n){var o=e.prototype.toXml.apply(this,[n]);return t.toXmlHelp(this,o),o},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=s.HEADING,this.setLevel(t.level)},t}(l)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(32);return o.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0},inheritBlockStyles:{align:!0,"line-height":!0,indent:!0,"text-indent":!0},_computeInheritStyles:function(){o.prototype._computeInheritStyles.apply(this,arguments),this._computeInheritBlockStyles()},_computeInheritBlockStyles:function(){var e,n=this,o=n.parent,i=n.inheritBlockStyles;o&&o.styles&&(e=o.styles,t.each(i,function(t,o){if(!0===t){var i=e[o];i&&(n.styles[o]=i)}}))},capture:function(e){this.emit(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(23),n(21),n(1),n(15),n(2)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromCollabJSON=function(e){var t=this.fromJSON(e);return e.blockId&&t.setId(e.blockId),t},t.fromJSON=function(e){if(e&&e.type===l.HR){var o=new t({});return n.each(e.styles,function(e,t){o.setBlockStyle(t,e)}),o}r.error("invalid jsonObj")},t.fromXml=function(e){var n=new t({}),r=$(e);return n.parseIdFromXml(e),r.children().each(function(e,t){switch(t.nodeName){case s.TAG_ID_NAME:case s.LEGACY_TAG_ID_NAME:break;case"styles":o.fromXml(n,t);break;default:i.appendToTree(n.unknownTree,t)}}),n},t.prototype.countWords=function(){return 0},t.prototype.toCollabJSON=function(){return this.toJSON()},t.prototype.toHtml=function(){var e=document.createElement("div"),t=document.createElement("div"),o=$(e),i=this.getBlockStyles();return o.attr("yne-bulb-block","hr"),n.each(i,function(e,t){switch(t){case"back-color":o.css("background-color",e);break;case"padding":o.css("padding",e),"0px"===o.css("padding-top")&&o.css({"padding-top":"4px","padding-bottom":"4px"});break;default:o.attr("yne-style-"+t,e)}}),n.each(i,function(e,t){o.attr("yne-style-"+t,e)}),$(t).css({width:"100%",height:"1px","background-color":"rgb(200, 200, 200)"}),o.append(t),o.css("clear","both"),e.outerHTML},t.prototype.toJSON=function(){return e.prototype.toJSON.call(this)},t.prototype.toPlain=function(){return new Array(81).join("-")},t.prototype.toXml=function(t){var n=e.prototype.toXml.apply(this,[t]),r=t.createElement("styles");return o.toXml(this,r,t),n.appendChild(r),i.appendToXml(this.unknownTree,n),n},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=l.HR},t}(s)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(47),n(9),n(1),n(25),n(15),n(23),n(2),n(21)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromJSON=function(e){if(e&&e.type&&e.type===d.ATTACHMENT&&e.source&&e.resource){var n=new t({fakeLoading:!!e.fakeLoading,fileLength:e.fileLength,fileName:e.fileName,resource:e.resource,source:e.source});return e.styles&&n.setStyles(e.styles),e.blockId&&n.setId(e.blockId),n}r.warn("jsonObj or jsonObj.source/resource does NOT exist!")},t.fromXml=function(e){var n,o,i=$(e),r=$.trim(i.find("source").text()),a=$.trim(i.find("resource").text()),s=$.trim(i.find("filename").text())||"无文件名",d=$.trim(i.find("filelength").text());return o=parseInt(d,10),isNaN(o)&&(o=0),(n=new t({fakeLoading:!1,fileLength:o,fileName:s,resource:a,source:r})).parseIdFromXml(e),i.children().each(function(e,t){switch(t.nodeName){case l.TAG_ID_NAME:case l.LEGACY_TAG_ID_NAME:case"source":case"resource":case"filename":case"filelength":break;case"styles":c.fromXml(n,t);break;default:u.appendToTree(n.unknownTree,t)}}),n},t.prototype.countWords=function(){return 0},t.prototype.getFakeLoading=function(){return this.attachmentProps.fakeLoading},t.prototype.getFileLength=function(){return this.attachmentProps.fileLength},t.prototype.getFileName=function(){return this.attachmentProps.fileName},t.prototype.getResource=function(e){var t,n=this.attachmentProps.resource;return!0===e&&(t=this.getExtraInfo("pcResMap"))&&t[n]&&(n=t[n]),n},t.prototype.getSource=function(e){var t,n=this.attachmentProps.source;return!0===e&&(t=this.getExtraInfo("pcResMap"))&&t[n]&&(n=t[n]),n},t.prototype.getStyles=function(e){return e?this.getBlockStyle(e,!1):this.getBlockStyles()},t.prototype.setFakeLoading=function(e){this.attachmentProps.fakeLoading=e},t.prototype.setFileLength=function(e){var t=parseInt(e,10);return!isNaN(t)&&t!==this.attachmentProps.fileLength&&(this.attachmentProps.fileLength=t,this.trigger("content-change"),!0)},t.prototype.setFileName=function(e){return!(!(e=String(e||""))||e===this.attachmentProps.fileName)&&(this.attachmentProps.fileName=e,this.trigger("content-change"),!0)},t.prototype.setResource=function(e){return!(!(e=(e||"")+"")||e===this.attachmentProps.resource)&&(this.attachmentProps.resource=e,this.trigger("content-change"),!0)},t.prototype.setSource=function(e){return!(!(e=(e||"")+"")||e===this.attachmentProps.source)&&(this.attachmentProps.source=e,this.trigger("content-change"),!0)},t.prototype.setStyles=function(e,t){var o=this;return n.isString(e)?this.setBlockStyle(e,t):n.isObject(e)&&n.each(e,function(e,t){o.setBlockStyle(t,e)}),!0},t.prototype.toHtml=function(e,t,r){var a,l,c=this.getStyles(null),d=s("",document,!0,!0).ownerDocument,u=d.createElement("div"),h=$(u),p=$(d.createElement("img"));return h.attr("yne-bulb-block","attachment"),n.each(c,function(e,t){switch(t){case"align":h.css("text-align",e);break;case"float":h.css("float",e);break;case"back-color":h.css("background-color",e);break;case"padding":h.css("padding",e)}}),l=this.getSource(!0===r),i.IS_PC&&(l=o(l)),p.attr({alt:this.attachmentProps.fileName,"data-media-type":"attachment",filelength:this.attachmentProps.fileLength,filename:this.attachmentProps.fileName,path:this.getResource(!1),src:l,title:this.attachmentProps.fileName}),h.append(p),a=u.outerHTML,u=h=p=null,a},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.source=this.getSource(!1),t.resource=this.getResource(!1),t.fileName=this.getFileName(),t.fileLength=this.getFileLength(),t},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(t){var o,i,r=this;if(r.getSource(!1))return o=e.prototype.toXml.apply(r,[t]),n.each(["Source","Resource","FileName","FileLength"],function(e){var n=t.createElement(e.toLowerCase()),i=r["get"+e](),a=t.createTextNode(i);n.appendChild(a),o.appendChild(n)}),i=t.createElement("styles"),c.toXml(r,i,t),o.appendChild(i),u.appendToXml(r.unknownTree,o),o},t.prototype.initialize=function(t){if(null==t||null==t.source||null==t.resource||null==t.fileLength||null==t.fileName)throw new Error("props or prop(source, resource, fileName, fileLength) in props cannot be null");e.prototype.initialize.call(this,t),this.attachmentProps=n.clone(t),this.attachmentProps.fakeLoading=!!t.fakeLoading,this.type=d.ATTACHMENT},t}(l)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return{LEFT:1,RIGHT:2,UP:3,DOWN:4}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(1);function i(e){this.name=e.name,this.value=e.value,this.isNative=!0===e.isNative,this.tryNativeIfNeeded=!1!==e.tryNativeIfNeeded,this.stopSelectionChange=!0===e.stopSelectionChange,this.callback=t.isFunction(e.callback)?e.callback:null}return i.prototype.isCmdBall=!0,i.prototype.clone=function(){return new i(this)},i.create=function(e){return e&&e.isCmdBall?e:e&&e.name?new i(e):void o.warn("Failed to create cmdBall",e)},i}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{parseImgSource:function(e){var t=e.split("?")[0].replace(/^\//,"").split("/");return{resId:t[t.length-1]}},isNoteImageSource:function(e){return/(http|https):\/\/note.youdao.com\/([\w.]+\/?)\s*/.test(e)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(157)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.bulbStyles2TableStyles=function(e){return e.align&&(e.textAlign=e.align,delete e.align),e},e.getAllDefaults=function(){var t={};return n.each(e.STYLE_NAMES,function(n){t[n]=e.getDefault(n)}),t},e.getAllStyleNames=function(){return[].concat(e.STYLE_NAMES)},e.getConfig=function(t){var n;return e.isSupport(t)&&(n=o[t]),n},e.getDefault=function(t){return(e.getConfig(t)||{}).default},e.isSupport=function(t){return e.STYLE_NAMES.indexOf(t)>-1},e.tableStyles2BulbStyles=function(e){return e.textAlign&&(e.align=e.textAlign,delete e.textAlign),e},e.STYLE_NAMES=n.keys(o)||[],e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){for(var t=n(0),o=n(6),i={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",19:"pause",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",44:"printscreen",45:"ins",46:"del",106:"*",107:"+",109:"-",110:".",111:"/",144:"numlock",186:";",189:"-",187:"=",188:",",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},r=o.IS_MAC?{3:"enter",91:"meta",93:"meta",224:"meta"}:{91:"win",92:"win",93:"menu",224:"win",229:"ime"},a=function(e,n,o){return t.some(e,function(e,t){return e===n&&parseInt(t,10)===o})},s={},l="A".charCodeAt(0),c="Z".charCodeAt(0);l<=c;l++)i[l]=String.fromCharCode(l).toLowerCase();for(l=1;l<20;++l)i[111+l]="f"+l;for(l=0;l<=9;l++)i[48+l]=l+"";for(l=0;l<=9;++l)i[l+96]=l+"";return{isMatch:function(e,t){var n=e+"-"+t,o=s[n];return null==o&&(o=a(r,e,t)||a(i,e,t),s[n]=o),o},getKey:function(e){if(t.isNumber(e))return i[e+=""]||r[e]}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(8),a=n(3);return t=o.extend({name:"atom.DeleteBlockText",_textBlock:null,_start:null,_end:null,_deletedText:null,_inlineStyles:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._textBlock=this.options.block,this._start=this.options.start,this._end=this.options.end,this._inlineStyles=this.options.inlineStyles),t.__super__.initialize.apply(this)},apply:function(){var e=this._textBlock,t=e.sliceText(this._start,this._end);return!!t&&(this._deletedText=t,e.deleteText(this._start,this._end,this._inlineStyles),!0)},doUnapply:function(){var e=this._deletedText;this._textBlock&&this._deletedText&&this._textBlock.insertText(this._start,e)},fromCollabJSON:function(){var e=this.options.args,n=e.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),n&&(this._deletedText=r.fromCollabJSON(n.richText),this._textBlock=e.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition,this._end=n.endPosition)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._textBlock.getId(),e.richText=this._deletedText.toCollabJSON(),e.startPosition=this._start,e.endPosition=this._end,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0===(i=function(e,t,n){"use strict";var o,i;return function(e){e[e.major=1]="major",e[e.minor=0]="minor",e[e.revision=3]="revision"}(o||(o={})),function(e){e[e.GRETER=1]="GRETER",e[e.EQUAL=0]="EQUAL",e[e.LESS=-1]="LESS"}(i||(i={})),function(){function e(){}return e.getDefaultAsString=function(){return o.major+"."+o.minor+"."+o.revision},e.parse=function(t){if(t){var n=(t+"").split(".");return{major:e.getAsInt(n[0]),minor:e.getAsInt(n[1]),revision:e.getAsInt(n[2])}}},e.isLessThanDefault=function(t){if(!t)return!0;var n=e.parse(t);return e.compare(n,o)===i.LESS},e.isCompatible=function(t){if(!(t=t||"")||"true"===t)return!0;var n=e.parse(t);return e.compare(o,n)!==i.LESS},e.getAsInt=function(e){e=e||"";var t=parseInt(e+"",10);return isNaN(t)?0:t},e.compareInt=function(e,t){return e===t?i.EQUAL:e>t?i.GRETER:i.LESS},e.compare=function(t,o){var r=i.EQUAL;return n.some(["major","minor","revision"],function(n){var a=e.compareInt(t[n]||0,o[n]||0);if(a!==i.EQUAL)return r=a,!0}),r},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return{getNamespace:function(){return"note.youdao.com"}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(109)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.checkValid=function(e){var t,i,r=e.length;if(!n.isString(e))return!1;for(t=0;t<r;t++)if(!(9===(i=o(e,t))||10===i||13===i||i>=32&&i<=55295||i>=57344&&i<=65533)){if(!(i>=65536&&i<=1114111))return!1;t++}return!0},e.clear=function(e){var t,i,r="",a=e.length;if(!n.isString(e))return e;for(t=0;t<a;t++)9===(i=o(e,t))||10===i||13===i||i>=32&&i<=55295||i>=57344&&i<=65533?r+=e[t]:i>=65536&&i<=1114111&&(r+=e[t],r+=e[++t]);return r},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(56),n(1),n(46),n(42),n(65),n(41)],void 0===(i=function(e,t,n,o,i,r,a,s,l){"use strict";return function(){function e(){}return e.boolean2string=function(e){return n.isBoolean(e)?String(e):e},e.blockStyle2oldCell=function(t){var o={};return n.map(t,function(t,n){o[n]=e.boolean2string(t)}),o},e.contentFromCollabJSON=function(t){return e.contentFromJSON(t,!0)},e.contentFromJSON=function(e,t,n){if(e){var s,c=e.type,d=e.data;switch(c){case l.IMAGE:s=t?a.fromCollabJSON(d):a.fromJSON(d,n);break;case l.ATTACHMENT:s=t?r.fromCollabJSON(d):r.fromJSON(d,n);break;case l.TEXT:s=t?o.fromCollabJSON(d):o.fromJSON(d);break;default:i.error("do not support type",c)}return s}},e.contentToCollabJSON=function(t){return e.contentToJSON(t,!0)},e.contentToHtml=function(e,t){if(!e)return"";var n={resourceMap:t};return e instanceof o||e instanceof a||e instanceof r?e.toHtml(n):(i.warn("unvalid content",e),"")},e.contentToJSON=function(e,t){t=!0===t;var n=l.TEXT;if(e){if(e.getType)switch(e.getType()){case s.TYPE_IMAGE:n=l.IMAGE;break;case s.TYPE_ATTACHMENT:n=l.ATTACHMENT}return{data:t?e.toCollabJSON():e.toJSON(),type:n}}},e.contentToPlain=function(e,t){return e?e instanceof o?e.toPlain().join(t?"\n":""):e instanceof a?e.toPlain():e instanceof r?e.toPlain():(i.warn("unvalid content",e),""):""},e.inlineStyle2oldCell=function(t){var o=this.oldStyleNameMap,i={};return n.map(o,function(n,o){null==t[n]||(i[o]=e.boolean2string(t[n]))}),i},e.oldStyleNameMap={bold:"bold",italic:"italic",underline:"underline",lineThrough:"strike",fontName:"font-family",fontSize:"font-size",textColor:"color",link:"href"},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(1),n(66)],void 0===(i=function(e,t,n,o,i){"use strict";return function(){function e(){}return e.cellsFromCollabJSON=function(e){return e?n.map(e,function(e){return n.map(e,function(e){return i.fromCollabJSON(e)})}):null},e.cellsFromJSON=function(e){var t,n,r,a=e.cellsJson,s=e.height,l=e.width,c=e.isUpdateCellId,d=e.resourceList,u=[];if(!a)return null;for(t=0;t<s;t++)for(u[t]=[],n=0;n<l;n++)a[r=t*l+n]||o.error("Bag json data, no cellData json, row, col: ",a,t,n),u[t][n]=i.fromJSON(a[r],c,d);return u},e.cellsToCollabJSON=function(e){return e?n.map(e,function(e){return n.map(e,function(e){return e.toCollabJSON?e.toCollabJSON():e})}):null},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(){return{value:""}}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.WS_OPENED="WS_OPENED",e.WS_MESSAGE="WS_MESSAGE",e.WS_CLOSED="WS_CLOSED",e.SESSION_CHNAGED="SESSION_CHNAGED",e.SESSION_JOINED="SESSION_JOINED",e.SESSION_QUIT="SESSION_QUIT",e.SESSION_PROP_UPDATE="SESSION_PROP_UPDATE",e.SESSION_LOCK_UPDATE="SESSION_LOCK_UPDATE",e.SESSION_INIT_DONE="SESSION_INIT_DONE",e.SESSION_INIT_BUILT="SESSION_INIT_BUILT",e.NONDATACMD_MODIFIERS_RESULT="NONDATACMD_MODIFIERS_RESULT",e.LOCK_RELEASED="LOCK_RELEASED",e.LOCK_LOCKED="LOCK_LOCKED",e.LOCK_PROP_UPDATE="LOCK_PROP_UPDATE",e.CONFLICT_LOCKED_BY_ME="CONFLICT_LOCKED_BY_ME",e.CONFLICT_LOCKED_BY_OTHERS="CONFLICT_LOCKED_BY_OTHERS",e.CONFLICT_BLOCK_CHANGED="CONFLICT_BLOCK_CHANGED",e.DATACMD_FAILURE="DATACMD_FAILURE",e.DATACMD_NO_PENDING="DATACMD_NO_PENDING",e.DATACMD_SUCCESS="DATACMD_SUCCESS",e.ENGINE_EXCEPTION="ENGINE_EXCEPTION",e}();t.default=n}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(2),n(17),n(64),n(30)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(){function e(){}return e.buildNoteRangeFromJSON=function(e,t){return o.fromCollabJSON(e,t)},e.buildNoteRangeFromNonTextBlock=function(e){var t,a={};return a.block=e,n.isTable(e)&&(a.type=i.TYPES.ALL),t=r.createRangeByBlock(a),o.create({endRange:t,startRange:t})},e.buildNoteRangeFromParagraph=function(e,t,n){var i=r.createRangeByBlock({block:e,start:t,end:n});return o.create({endRange:i,startRange:i})},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(6),n(0),n(2),n(12),n(24),n(115)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";var c;return(c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(){return new t({})},t.prototype.getTextStylesAtIndex=function(e){return this.richText.getStylesAtIndex(e,this.getDefaultSetFont())},t.prototype.getInlineStyleForEmpty=function(e,t){return(this.getInlineStylesForEmpty(t)||this.getDefaultSetFont())[e]},t.prototype.getCommonInlineStyle=function(e,t){var n,o;return t?(n=t.start,o=t.end):(n=this.getStartOffset(),o=this.getEndOffset()),this.richText.getCommonStyle(n,o,e,l.getQuoteDefaultStyles())},t.prototype.getTextStyle=function(e,t,n){var i=this.richText;return o.isObject(t)&&null!=t.start&&(n=t.end,t=t.start),i.getStyle(t,n,e,this.getDefaultSetFont())},t.prototype.setTextStyle=function(e,t,n,i){var r=this.richText;o.isObject(n)&&null!=n.start&&(i=n.end,n=n.start),r.setStyle(n,i,e,t,this.getDefaultSetFont()),this.trigger("content-change")},t.prototype.toHtml=function(e,t,i){e=e||0,t=null==t?this.getEndOffset():t,i=!0===i;var r=document.createElement("div"),a=document.createElement("div"),l=$(r),c=$(a),d=this.getBlockStyles();return c.attr("yne-bulb-block","quote").css("white-space","pre-wrap").css("padding",n.QUOTE_PADDING).css("border-left",n.QUOTE_BORDER_LEFT).css("margin",n.QUOTE_MARGIN),d&&o.each(d,function(e,t){switch(t){case"back-color":e&&l.css("background-color",e);break;case"padding":e&&(c.css("padding",e),c.css("margin",e))}}),c.html(s.rich2html(this.sliceText(e,t,!1),{withDefault:i})),l.append(c),r.outerHTML},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=i.QUOTE},t}(r)).DEFAULT_STYLES={color:"#999999",bold:300,"font-family":"宋体","font-size":"14"},c}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(5);return{isNoteLinkUrl:function(e){return/^note:\/\/[a-z0-9\-]+$/i.test(e)},getNoteId:function(e){if(e=t.trim(e||"")){var n=/^note:\/\/([a-z0-9\-]+)$/i.exec(e);if(n&&n[1])return n[1]}},fillAsUrl:function(e){if(e=t.trim(e||"")){if(this.isNoteLinkUrl(e)&&(e=this.getNoteId(e)),e)return"note://"+e}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onEditingStateChange:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(5),i=n(28),r=n(59),a=n(54),s=n(8),l=n(43),c=n(2),d=n(6),u=n(1),h=n(14),p=n(24),g=n(124),f=n(88),m=n(19),y=n(38),_=n(115);return r.extend({className:"block-view paragraph-view",_template:h.getTemplate("common","paragraph_view"),_tempPlaceholder:null,_selectToStartTimer:null,initialize:function(){r.prototype.initialize.apply(this,arguments);var e=this.block;t.bindAll(this,"_onContentChange","_onStyleChange","_onHighlight"),e.on("content-change",this._onContentChange),e.on("style-change",this._onStyleChange),e.on("high-light",this._onHighlight),this._tempPlaceholder=o("<div></div>"),this._tempPlaceholder.height(0),this._tempPlaceholder.width(this.$el.width()),this._tempPlaceholder.css("display","inline-block")},render:function(){this._renderTemplate(),this._renderText(),this._renderStyles(),r.prototype.render.apply(this,arguments)},_renderTemplate:function(){this.$el.html(this._template())},convertToNativeRange:function(e){if(e){var t,n;if(n=this._getCharacterInfo(e.start)){if((t=document.createRange()).setStart(n.node,n.offset),n=this._getCharacterInfo(e.end))return t.setEnd(n.node,n.offset),t;u.error("_getCharacterInfo blockRange.end error!")}else u.error("_getCharacterInfo blockRange.start error!")}else u.warn("block range is unvalid!")},parseNativeRange:function(e,t,n){var o,i,r;return clearTimeout(this._selectToStartTimer),n?new a({start:0,end:t.getEndOffset(),block:t}):((r=this.el.querySelector(".place-holder"))&&" "===r.innerText?(o=i=0,e.collapsed&&(this._selectToStartTimer=setTimeout(function(){e.setStart(e.startContainer,o),e.setEnd(e.endContainer,i)},150))):(o=this._getCharacterIndex(e.startContainer,e.startOffset,!0),-1===(i=this._getCharacterIndex(e.endContainer,e.endOffset,!1))&&(i=t.getEndOffset())),new a({start:o,end:i,block:t}))},_getCharacterInfo:function(e){var t,n=this.$el.find(".para-text").get(0),i=document.createNodeIterator(n,NodeFilter.SHOW_TEXT),r=i.nextNode(),a=0,s=0;if(0===e||!r)return o(n).children().first().hasClass("page-break-placeholder")&&(s=1),{node:r||n,offset:s};for(;r;){if((t=g(r.nodeValue)).length>0&&a<e&&a+t.length>=e)return{node:r,offset:t.slice(0,e-a).reduce(function(e,t){return e+t.length},0)};a+=t.length,r=i.nextNode()}},_getTextOfNode:function(e){if(l.isText(e))return e.nodeValue;var t,n=document.createNodeIterator(e,NodeFilter.SHOW_TEXT),o="";if(!n)return"";for(t=n.nextNode();t;)o+=t.nodeValue,t=n.nextNode();return o},_charArrayLengthOfNode:function(e){var t=this._getTextOfNode(e);return g(t).length},_charArrayOffset:function(e,t){var n,o=g(e);for(n=0;n<o.length&&t>0;n++)t-=o[n].length;return n},_getCharacterIndex:function(e,t,n){var i,r,a=this.$el.find(".para-text").get(0),s=0;if(!o.contains(a,e)&&e!==a)return n?0:-1;for(l.isText(e)?s+=this._charArrayOffset(e.nodeValue,t):l.isElement(e)&&t>0&&(s+=this._charArrayLengthOfNode(e)),i=e;i!==a;){for(r=i.previousSibling;r;)"page-break"!==r.className&&"page-break-placeholder"!==r.className&&(s+=this._charArrayLengthOfNode(r)),r=r.previousSibling;i=i.parentNode}return s},_createHtmlForBlankLine:function(e){var n,o,i,r=new s({text:" "}),a=document.createElement("span"),l={},c=function(e,t){["bold","italic","font-family","font-size"].indexOf(t)>-1&&(l[t]=e)};return e?t.each(e,c):t.each(this.block.getInlineStylesForEmpty(),c),n=p.rich2html(r),a.innerHTML=n,(o=a.getElementsByTagName("span"))&&o.length?1===o.length?((i=o[0]).setAttribute("class","place-holder"),n=i.outerHTML):(u.error("_createHtmlForBlankLine error",a),n='<span class="place-holder">&nbsp;</span>'):(a.setAttribute("class","place-holder"),n=a.outerHTML),n},_renderText:function(e){var n,r,s=this,l=s.block,c=l.getReadOnlyText(),d=c.getEntities(),u=s._inlineStyleViewMapper,h=s.$el.find(".para-text");if(n=c.isEmpty()?this._createHtmlForBlankLine(e):p.rich2html(c,{styleRules:{color:function(e){var t=e.color;return e.href!==m.getDefault("href")&&i.equals(e.color,"blue")?"#003884":null!=t&&u?u.valueToView("color",t):void 0},"font-family":function(e){var t,n=e["font-family"];return null!=n&&u&&(t=u.valueToView("font-family",n)),n!==t?t:y.getAllValueByFont(n)||n}}}),h.html(n),d&&d.length){var g=t.pluck(d,"type");setTimeout(function(){s.trigger("get-entity",l.blockId,g)})}r=l.getStyleRanges("href"),t.each(r,function(e){var t,n,i;t=new a({start:e.from,end:e.to,block:l}),n=s.convertToNativeRange(t),(i=s._findLinkNode(n.endContainer))&&("file://"===i.origin&&o(i).click(function(){return!1}),o(i).off("hover"),o(i).hover(function(){f.isNoteLinkUrl(i.href)||s.isCollabLocked()||s.trigger("link-menu-show",{linkNode:i,range:t,block:l})},function(){s.trigger("link-menu-hide")}))})},_findLinkNode:function(e){for(var t=e;t&&"A"!==t.tagName;)t=t.parentNode;return t},_renderStyles:function(){var e=this,n=e.block.getBlockStyles();t.each(n,function(t,n){e._setStyle(n,t)}),e._renderStylesFix()},_renderStylesFix:function(){this.$el.find(".para-text").css("fontSize",p.getDefaultForHtml("font-size"))},_setStyle:function(e,t){var n=this.$el,o=n.find(".para-text");switch(e){case"align":o.css("text-align",t);break;case"line-height":t>0?o.css("line-height",String(t)):o.css("line-height","normal");break;case"indent":t=t>0?t:0,n.css("padding-left",t*d.INDENT_WIDTH||"");break;case"text-indent":t=t>0?t:0,o.css("text-indent",t*d.INDENT_WIDTH||"");break;case"back-color":(c.isParagraph(this.block)||c.isHeading(this.block))&&o.parent().css("background-color",t);break;case"padding":(c.isParagraph(this.block)||c.isHeading(this.block))&&o.css("padding",t);break;default:u.warn("unknown block style: "+e)}},_onContentChange:function(){var e,n=!1,o=this.block;t.some(this._pageInfo,function(e){return e&&e.pageBreak&&(n=!0),n}),n&&this.$el.css("height",this.$el.height()),c.isQuote(o)&&(e=_.getQuoteDefaultStyles()),c.isCode(o)||this._renderText(e),this.trigger("view-height-changed",this.cid),n&&this.$el.css("height","auto")},_onStyleChange:function(e,t){this._setStyle(e,t),this.trigger("view-height-changed",this.cid)},_convertToData:function(e,n){var o,i=this,r=i.block;t.each(e,function(e){o=new a({block:r,start:e.start,end:e.end}),n(i.convertToNativeRange(o))})},_onHighlight:function(e,t,n){var o=this.block.getHighlight(e,t);o&&this._convertToData(o,n)},_findOverflowSpan:function(e,t){var n,o,i,r,a,s=this._pageInfo[e-1];for(s?(o=s.pageBreak.isAtViewBeginning()?this.$el.find(".para-text").children().first():s.pageBreak.getPlaceholder().next(),r=this._getOffsetTopPos(s.pageBreak.getPlaceholder())+s.pageBreak.getPlaceholder().height()):(o=this.$el.find(".para-text").children().first(),r=this._getOffsetTopPos(this.$el)),o.is("span")||o.is("pre")||(o=o.find("span").first()),n=o,i=o;n.length>0&&(n.after(this._tempPlaceholder),a=this._getOffsetTopPos(this._tempPlaceholder)-r-t,n.outerHeight(!0)>0&&(i=n),!(a>0));)n=this._tempPlaceholder.next();return this._tempPlaceholder.remove(),{textSpan:i,overflowHeight:a,isFirstSpan:o===i}},_getContentContainer:function(){return this.$el.find(".para-text")},_handlePageOverflow:function(e,t){var n,o=this._getHeightInPage(e);return!((n=this.PAGE_HEIGHT-t)>o)&&(this._insertPageBreak(e,n),!0)},_insertPageBreak:function(e,t){var n,o,i,r,a,s;this.block.isEmpty()||t<=0||this._forcePageBreakBegin?n=this._insertPageBreakAtViewBeginning(e,0):(o=this._findOverflowSpan(e,t)).overflowHeight<=0?(n=this._createPageBreak(e,Math.abs(o.overflowHeight)),0===o.textSpan.height()?o.textSpan.before(n.getPlaceholder()):o.textSpan.parent().parent().after(n.getPlaceholder())):this._isSplitAvailable(o.textSpan,o.overflowHeight)?(r=o.textSpan.height()-o.overflowHeight,i=this._splitTextSpan(o.textSpan,r),n=this._createPageBreak(e,r-i[0].height()),i[0].after(n.getPlaceholder())):o.isFirstSpan?n=this._insertPageBreakAtViewBeginning(e,t):((s=(a=this._pageInfo[e-1])&&a.pageBreak?t-(this._getOffsetTopPos(o.textSpan)-this._getOffsetTopPos(a.pageBreak.getPlaceholder())-a.pageBreak.getPlaceholder().height()):t-(this._getOffsetTopPos(o.textSpan)-this._getOffsetTopPos(this.$el)))<0&&(s=0),n=this._createPageBreak(e,s),o.textSpan.before(n.getPlaceholder())),this._coincidePageBreak(n),this._pageInfo[e].pageBreak=n},_insertPageBreakAtViewBeginning:function(e,t){var n;return(n=this._createPageBreak(e,t)).setAtViewBeginning(!0),this.$el.prepend(n.getPlaceholder()),n},_isSplitAvailable:function(e,t){var n,o,i;if(0===e.length||""===e.text())return!1;for(o=e.height()-t,n=document.createRange(),i=e[0].firstChild;null!=i&&("#text"!==i.nodeName.toLowerCase()||0===i.textContent.length);)i=i.nextSibling;return null!=i&&(n.setStart(i,0),n.setEnd(i,1),!(n.getBoundingClientRect().height>o)&&(n.setEnd(i,i.textContent.length),!(n.getBoundingClientRect().height<o)))},_splitTextSpan:function(e,t){var n,o,i,r=e[0].firstChild,a=0,s=e.text().length,l=[];for((n=document.createRange()).setStart(r,0);s-a>1&&(i=Math.ceil((s+a)/2),n.setEnd(r,i),(o=n.getBoundingClientRect().height)!==t);)o>t?s=i:a=i;if(o<=t){for(;i<e.text().length&&o<=t;)i++,n.setEnd(r,i),o=n.getBoundingClientRect().height;i-=1}else for(;i>0&&o>t;)i--,n.setEnd(r,i),o=n.getBoundingClientRect().height;return l[0]=e.clone(),l[1]=e.clone(),l[0].text(e.text().substr(0,i)),l[1].text(e.text().substr(i)),e.before(l[0]),e.before(l[1]),e.remove(),l}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(8),a=n(3);return t=o.extend({name:"atom.InsertBlockText",_textBlock:null,_start:null,_insertedText:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._textBlock=this.options.block,this._start=this.options.start,this._insertedText=this.options.text),t.__super__.initialize.apply(this)},apply:function(){return!!this._insertedText&&(this._textBlock.insertText(this._start,this._insertedText),!0)},doUnapply:function(){this._textBlock&&this._insertedText&&this._textBlock.deleteText(this._start,this._start+this._insertedText.getLength())},fromCollabJSON:function(){var e=this.options.args,n=e.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),n&&(this._insertedText=r.fromCollabJSON(n.richText),this._textBlock=e.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._textBlock.getId(),e.richText=this._insertedText.toCollabJSON(),e.startPosition=this._start,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(1),n(0),n(107),n(19)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(){function e(){}return e.convertToCssStyle=function(e,t){if(e){var n=o.pick(e,this.SUPPORTED_STYLES);return n=o.defaults(n,r.getAllDefault()),t&&o.each(n,function(e,o){null!=e&&(n[o]=t.valueToView(o,e))}),i.convertToCssStyle(n)}},e.isSupportedStyle=function(t){return e.SUPPORTED_STYLES.indexOf(t)>-1},e.makeHtmlMarker=function(t){if(t){var o,i,r=t.getLevel(),a=t.getText();return o=t.isOrdered()?e.ORDERED_STYLE_TYPES[r%3]:e.UNORDERED_STYLE_TYPES[r%3],a.getLength()&&(i=this.convertToCssStyle(a.getStylesAtIndex(0))),{listStyleType:o,markerStyles:i}}n.warn("Failed to create marker",t)},e.makePlainMarker=function(t,o){if(!t)return n.warn("Failed to create marker",t),"";o=!1!==o;var i,r="",a=t.getLevel();if(t.isOrdered()){switch(i=t.getIndex(),a%3){case 0:r=e.toRoman(i);break;case 2:r=e.toAlphabet(i);break;default:case 1:r=i}r+="."}else switch(a%3){case 0:r="■";break;case 2:r="○";break;default:case 1:r="●"}return o&&(r+=" "),r},e.toAlphabet=function(e){if(isNaN(e))return"";var t="a".charCodeAt(0),n="z".charCodeAt(0)-t+1,o="";for(e--;e>=0;)o=String.fromCharCode(e%n+t)+o,e=Math.floor(e/n)-1;return o},e.toRoman=function(e){if(isNaN(e))return"";for(var t=[["","i","ii","iii","iv","v","vi","vii","viii","ix"],["","x","xx","xxx","xl","l","lx","lxx","lxxx","xcc"],["","c","cc","ccc","cd","d","dc","dcc","dcc","cm"]],n="",o=0,i=0,r=1e3;i<3;i++,r/=10)o=Math.floor(e%r/(r/10)),n+=t[2-i][o];return n},e.SUPPORTED_STYLES=["font-size","font-family","color","bold","italic"],e.ORDERED_STYLE_TYPES=["lower-roman","decimal","lower-alpha"],e.UNORDERED_STYLE_TYPES=["square","disc","circle"],e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};o=[n,t,n(2),n(63)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromCollabJSON=function(e,n){var i=o.getBlockById(e.blockId,n);return new t(s({block:i},e))},t.createSelectToEndRange=function(e,n,o){var i=e.toCodeLines();return new t({block:e,startLineIndex:n||1,endLineIndex:i.length,startLineCharIndex:o||0,endLineCharIndex:i.pop().length})},t.createBeginRange=function(e){return new t({block:e,startLineIndex:1,endLineIndex:1,startLineCharIndex:0,endLineCharIndex:0})},t.createNewRange=function(e){var t=e.preCodeRange,n=e.charOffset,o=e.lineOffset,i=e.needCollapse,r=void 0===i||i,a=t.clone();return o?(a.endLineIndex=t.startLineIndex+o,a.endLineCharIndex=0+n,r&&(a.startLineIndex=t.startLineIndex+o,a.startLineCharIndex=0+n)):(a.endLineCharIndex=t.startLineCharIndex+n,a.endLineIndex=t.startLineIndex,r&&(a.startLineCharIndex=t.startLineCharIndex+n,a.startLineIndex=t.startLineIndex)),a},t.prototype.convertToParaRangeStartEnd=function(){var e=this.block.toCodeLines(),t=function(t,n){return e.slice(0,t-1).join().length+n+t-1};return{start:t(this.startLineIndex,this.startLineCharIndex),end:t(this.endLineIndex,this.endLineCharIndex)}},t.prototype.isCollapsed=function(){return!this.selectWholeBlock&&(this.startLineIndex===this.endLineIndex&&this.startLineCharIndex===this.endLineCharIndex)},t.prototype.canDrawedByNative=function(){return!0},t.prototype.getDataAsJSON=function(){return this.block.toJSON(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},t.prototype.getDataAsPlain=function(){return this.block.toPlain(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},t.prototype.getDataAsHtml=function(){return this.block.toPlain(this.startLineIndex,this.startLineCharIndex,this.endLineIndex,this.endLineCharIndex)},t.prototype.collapse=function(e){void 0===e&&(e=!0),e?(this.startLineIndex=this.endLineIndex,this.startLineCharIndex=this.endLineCharIndex):(this.endLineIndex=this.startLineIndex,this.endLineCharIndex=this.startLineCharIndex)},t.prototype.clone=function(){return new t({startLineIndex:this.startLineIndex,endLineIndex:this.endLineIndex,startLineCharIndex:this.startLineCharIndex,endLineCharIndex:this.endLineCharIndex,selectWholeBlock:this.selectWholeBlock,block:this.block})},t.prototype.toCollabJSON=function(){var t=e.prototype.toCollabJSON.call(this);return t.selectWholeBlock=!!this.selectWholeBlock,t.startLineIndex=this.startLineIndex,t.startLineCharIndex=this.startLineCharIndex,t.endLineCharIndex=this.endLineCharIndex,t.endLineIndex=this.endLineIndex,t},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.CODE,this.selectWholeBlock=t.selectWholeBlock,this.startLineIndex=t.startLineIndex,this.startLineCharIndex=t.startLineCharIndex,this.endLineCharIndex=t.endLineCharIndex,this.endLineIndex=t.endLineIndex},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.NONDATACMD_BLOCKSELECTION="nb_BlkSelection",e.NONDATACMD_CLINTPONG="nb_clientPong",e.NONDATACMD_COLLABCLOSE="nb_CollabClose",e.NONDATACMD_COLLABINFO="nb_CollabInfo",e.NONDATACMD_DATACMDFAILED="nb_dataCmdFailed",e.NONDATACMD_GETMODIFIERS="nb_getModifiers",e.NONDATACMD_NOTESAVE="nb_noteSave",e.NONDATACMD_LOCKRELEASE="nb_lockRelease",e.NONDATACMD_SESSIONINITIALIZED="nb_sessionInitialized",e.NONDATACMD_SEVERPING="nb_serverPing",e}();t.CmdNames=n,function(e){e[e.EXCEPTION=0]="EXCEPTION",e[e.NO_ERROR=1]="NO_ERROR",e[e.TIME_OUT=100]="TIME_OUT",e[e.STOP_CALL=101]="STOP_CALL"}(t.CustomResultCode||(t.CustomResultCode={})),function(e){e[e.FAILED_RECEIVE_COLLAB_CMD=4001]="FAILED_RECEIVE_COLLAB_CMD",e[e.FAILED_SEND_LOCAL_CMD=4002]="FAILED_SEND_LOCAL_CMD",e[e.MESSAGE_TOO_BIG=4003]="MESSAGE_TOO_BIG",e[e.SESSION_NOT_OPENED=4004]="SESSION_NOT_OPENED",e[e.CLOSED_BY_HOST=4500]="CLOSED_BY_HOST",e[e.COLLAB_SERVER_UNREACHABLE=9e3]="COLLAB_SERVER_UNREACHABLE",e[e.COLLAB_SERVER_SHUTDOWN=9003]="COLLAB_SERVER_SHUTDOWN",e[e.COLLAB_SESSION_CLOSED=9004]="COLLAB_SESSION_CLOSED"}(t.WSCustomCode||(t.WSCustomCode={})),function(e){e[e.LOCAL_INVALID_STARTRANGE=5001]="LOCAL_INVALID_STARTRANGE",e[e.LOCAL_INVALID_CMDJSON=5002]="LOCAL_INVALID_CMDJSON",e[e.LOCAL_TARGET_BLOCK_LOCKED=5003]="LOCAL_TARGET_BLOCK_LOCKED",e[e.LOCAL_EMPTY_CMD=5004]="LOCAL_EMPTY_CMD",e[e.LOCAL_CMD_TOO_FAST=5005]="LOCAL_CMD_TOO_FAST",e[e.LOCAL_INVALID_FOR_COLLAB=5006]="LOCAL_INVALID_FOR_COLLAB",e[e.LOCAL_BLOCKS_MISSING=5008]="LOCAL_BLOCKS_MISSING",e[e.LOCAL_NOT_READY_APPLY=5009]="LOCAL_NOT_READY_APPLY",e[e.LOCAL_DIRTY_BLOCKS=5010]="LOCAL_DIRTY_BLOCKS",e[e.COLLAB_TARGET_BLOCK_LOCKED=5500]="COLLAB_TARGET_BLOCK_LOCKED",e[e.COLLAB_NOTEVERSION_MISMATCH=5507]="COLLAB_NOTEVERSION_MISMATCH",e[e.COLLAB_BLOCKS_MISSING=5508]="COLLAB_BLOCKS_MISSING",e[e.COLLAB_DIRTY_BLOCKS=5510]="COLLAB_DIRTY_BLOCKS"}(t.DataCmdFailureCode||(t.DataCmdFailureCode={}))}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(6);return{parseToBoolean:function(e,n){var o=null;return t.isBoolean(e)?o=e:t.isNumber(e)?0===e?o=!1:1===e&&(o=!0):t.isString(e)&&("0"===e.toLowerCase()||"false"===e.toLowerCase()?o=!1:"1"!==e.toLowerCase()&&"true"!==e.toLowerCase()||(o=!0)),null===o&&t.isBoolean(n)&&(o=n),o},parseToNumber:function(e,n){var o=null;return t.isNumber(e)?o=e:t.isString(e)&&(o=window.parseInt(e)),(isNaN(o)||null===o)&&t.isNumber(n)&&(o=n),o},parseToPageType:function(e){var t=o.PAGE_TYPE_NONE;return e&&(e.trim().toUpperCase()===o.PAGE_TYPE_B5?t=o.PAGE_TYPE_B5:e.trim().toUpperCase()===o.PAGE_TYPE_A4?t=o.PAGE_TYPE_A4:e.trim().toUpperCase()===o.PAGE_TYPE_TEST&&(t=o.PAGE_TYPE_TEST)),t}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(129),o=n(194),i=n(197),r=n(199),a=n(1);return{parseHtml:function(e){var n=t(e);return a.log("parseHtml OK",n),n},parsePlain:function(e,t,n,i){return o(e,t,n,i)},parseJSON:function(e,t){return i(e,t)},parseOCR:function(e,t){return r(e,t)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(34),o=n(6),i=n(0),r=n(173),a=["bold","bolder","700","800","900"],s=n(38),l={"xx-small":12,"x-small":12,small:13,medium:16,large:18,"x-large":24,"xx-large":32};return{bold:{inheritable:!0,action:function(e){var n=e.style.fontWeight;return(n=n&&t.trim(n).toLowerCase())&&"inherit"!==n?-1!==i.indexOf(a,n):null}},italic:{inheritable:!0,action:function(e){var t=e.style.fontStyle;return t?"italic"===t:null}},underline:{inheritable:!0,action:function(e,t,n){var o=e.style.textDecoration;return!!/(^|\s)underline($|\s)/i.test(o)||!(o&&!n)&&n}},strike:{inheritable:!0,action:function(e,t,n){var o=e.style.textDecoration;return!!/(^|\s)line-through($|\s)/i.test(o)||!(o&&!n)&&n}},"font-family":{inheritable:!0,action:function(e){var t=e.style.fontFamily;return 0===t.trim().indexOf("-apple-system")?s.DEFAULT_FONT:s.getFontFirstValue(t)}},"font-size":{inheritable:!0,action:function(e,n,o){var i=e.style.fontSize;if(i=t.trim(i+""),/^[\d.]+px$/.test(i)?i=parseInt(i,10):/^[\d.]+pt$/.test(i)?i=Math.floor(4*parseFloat(i,10)/3):/^[\d.]+em$/.test(i)?(i=parseFloat(i,10),i*=o||14,i=Math.floor(i)):/^[\d.]+rem$/.test(i)?(i=parseFloat(i,10),i*=10,i=Math.floor(i)):i=l[i],i&&!isNaN(i))return i}},color:{inheritable:!0,action:function(e){var t=e.style.color;return r(t,!1)}},"back-color":{inheritable:!0,action:function(e){var t=e.style.backgroundColor;return r(t,!0)}},align:{inheritable:!0,action:function(e){var n=e.style.textAlign||e.align;if((n=n&&t.trim(n).toLowerCase())&&"inherit"!==n)return n}},"line-height":{inheritable:!0,requireValues:["font-size"],action:function(e,n){var o=t.trim(e.style.lineHeight+""),i=n["font-size"]||14;if(/^[\d.]+$/.test(o)?o=parseFloat(o,10):/^[\d.]+px$/.test(o)?(o=parseFloat(o,10),o/=i):o=0,o&&!isNaN(o)&&o>1)return o}},indent:{inheritable:!0,action:function(e,t,n){var o=0;return"BLOCKQUOTE"===e.tagName&&(o=1),o+=n||0}},"text-indent":{inheritable:!0,action:function(e){var n=e.style.textIndent;if(n=t.trim(n+""),n=/^[\d.]+px$/.test(n)?parseFloat(n,10):/^[\d.]+pt$/.test(n)?4*parseFloat(n,10)/3:null)return(n=Math.floor(n/o.INDENT_WIDTH))||1}},width:{inheritable:!1,action:function(e){var n=e.style.width||e.width;if(n=t.trim(n+""),/^[\d.]+(px)?$/.test(n)&&(n=parseInt(n,10)),n&&!isNaN(n))return n}},float:{inheritable:!1,action:function(e){return e.style.float}},"white-space":{inheritable:!0,action:function(e){var t=e.style.whiteSpace;if(t&&"inherit"!==t)return t}}}}.call(t,n,t,e))||(e.exports=o)},,function(e,t,n){var o;void 0===(o=function(){return{test:function(e){return e=String(e),/(https?:\/\/|www\.|ssh:\/\/|ftp:\/\/)[a-z0-9&_+\-\?\/\.=\#,:,@]+$/i.test(e)||/[a-z0-9_+\-\.]+@[a-z0-9_+\-\.]+$/i.test(e)||!1},matchEnd:function(e){var t,n;return e=String(e),(t=/(https?:\/\/|www\.|ssh:\/\/|ftp:\/\/)[a-z0-9&_+\-\?\/\.=\#,:@%\(\)~]+$/i.exec(e))?{mail:!1,fullURI:0===(n=t[0]).toLowerCase().indexOf("www.")?"http://"+n:n,result:t}:(t=/[a-z0-9_+\-\.]+@[a-z0-9_+\-\.]+$/i.exec(e))?{mail:!0,fullURI:"mailto:"+(n=t[0]),result:t}:void 0}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(202),o=n(203),i=n(0),r=n(5);return t.extend({className:"tool-panel",buttonConfig:[],initialize:function(e){this._editor=e.editor,t.prototype.initialize.apply(this,arguments),this._shrinkOffset=e.shrinkOffset,this._addButtons(),this.hide(),this.render(),this._bindEvents()},_bindEvents:function(){var e=this,t=e._items;r(window).on("resize",i.throttle(function(){e.isRendered&&e._reShrink()},100)),i.each(t,function(t){t.on("re-shrink",i.throttle(e._reShrink.bind(e),100))})},_getShrinkOffset:function(){return i.isFunction(this._shrinkOffset)?this._shrinkOffset():this._shrinkOffset},_reShrink:function(){var e=this._items,t=this.$el;i.each(e,function(e){t.append(e.$el)}),this._shrink()},_shrink:function(){var e,t=this._items,n=this.$el.parent().width()+this._getShrinkOffset(),o=i.last(t).$el.outerWidth(!0),r=[];return i.each(t,function(i,a){e=i.isVisible,a!==t.length-1?(e&&(o+=i.$el.outerWidth(!0)),n<o&&r.push(i)):"showmore"===i.name&&(i.items=r,i.resetMenu())}),r},_addButtons:function(e){var t,n,r=this;t=i.map(r.buttonConfig,function(e){return new(o.get(e))({editor:r._editor})}),!1!==e&&r._editor.isLegacyHost()&&(n=o.get("showmore"),t.push(new n({editor:r._editor,items:[]}))),r.addItems(t)},show:function(){t.prototype.show.apply(this,arguments),this._reShrink()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(27);return t.extend({className:t.prototype.className+" toolbar-text-button",state:!0,editorEvents:null,render:function(){this.$el.addClass("text-button-"+this.name).text(this.text),this.setState(this.state)},setState:function(e){var t=this.$el;e=!0===e,this.state=e,e?t.addClass("active"):t.removeClass("active")},onClick:function(){this.trigger("on-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(118).extend({editorEvents:{"yne-selection-change":"onSelectionChange"},onChange:function(e){var t={};t[this.name]=e,this.editor.execCommandByToolbar("comp.ApplyStyles",{blockStyles:t})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(1),a=n(67),s=n(46),l=n(3),c=n(82);return t=o.extend({name:"atom.SetTableCellContent",_table:null,_cellRect:null,_oldContent:null,effected:!1,initialize:function(){var e=this.options.args;l.isCollabCommand(e)||(this._table=this.options.table,this._cellRect=this.options.cellRect,this._content=this.options.content),t.__super__.initialize.apply(this)},_computeSizeChange:function(e){if(e){var t=this._table.getCellSize(e.row,e.col),n={rowHeight:0,rowIndex:-1,colWidth:0,colIndex:-1};if(t)return t.height<a.ATTACHMENT_MIN_HEIGHT&&(n.rowHeight=t.heights[0]+a.ATTACHMENT_MIN_HEIGHT-t.height,n.rowIndex=t.rows[0]),t.width<a.ATTACHMENT_MIN_WIDTH&&(n.colWidth=t.widths[0]+a.ATTACHMENT_MIN_WIDTH-t.width,n.colIndex=t.cols[0]),n.rowHeight||n.colWidth?n:null}},apply:function(){var e,t=this._table,n=this._getCellInfo(this._cellRect)||{},o=this._contentInfo||t.getContentAt(n.row,n.col);return!!o&&(!!t.setCellContent(n.row,n.col,this._content)&&(this._content instanceof s&&(e=this._sizeChanged||this._computeSizeChange(n)),e&&e.rowHeight&&(this._oldSize={rowIndex:e.rowIndex,rowHeight:t.getRowHeight(e.rowIndex)},t.setRowHeight(e.rowIndex,e.rowHeight)),e&&e.colWidth&&(this._oldSize=this._oldSize||{},this._oldSize.colIndex=e.colIndex,this._oldSize.colWidth=t.getColumnWidth(e.colIndex),t.setColumnWidth(e.colIndex,e.colWidth)),this._sizeChanged=e,this._oldContent=o.content,this.effected=!0,this.effected))},doUnapply:function(){var e,t=this._table,n=this._getCellInfo(this._cellRect),o=this._oldSize;if(n)return e=t.setCellContent(n.row,n.col,this._oldContent),o&&o.rowHeight&&t.setRowHeight(o.rowIndex,o.rowHeight),o&&o.colWidth&&t.setColumnWidth(o.colIndex,o.colWidth),e},_getCellInfo:function(e){var t=this._table;if(null!=e.row&&null!=e.col)return{row:e.row,col:e.col,cell:t.getCell(e.row,e.col)};r.error("No cellRect!")},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._content=c.contentFromCollabJSON(o.simpleValue1),this._oldContent=c.contentFromCollabJSON(o.simpleValue2),this._sizeChanged=o.sizeChanged,this._oldSize=o.oldSize,this._cellRect=o.newBlkId)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=c.contentToCollabJSON(this._content),e.simpleValue2=c.contentToCollabJSON(this._oldContent),e.sizeChanged=this._sizeChanged,e.oldSize=this._oldSize,e.newBlkId=this._cellRect,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";var n=function(e,t,n,o,i){void 0===n&&(n="black"),void 0===o&&(o="white"),t&&1===t.length&&(t=t[0])};return{log:n,breakPointsLog:function(e,t){var o={fontColor:"white",backColor:"grey"};switch(e){case"execCommand":o.backColor="#3399FF";break;case"execEditorApi":o.backColor="#663399"}n(0,t,o.fontColor,o.backColor)},warn:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length&&(e=e[0]),n(0,e,"#333333","#FFFF33")},error:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];1===e.length&&(e=e[0]),n(0,e,"red","#FFCCCC")}}}.apply(t,[n,t]))||(e.exports=o)},function(e,t){e.exports=function(e){return"string"!=typeof e?e:(/^['"].*['"]$/.test(e)&&(e=e.slice(1,-1)),/["'() \t\n]/.test(e)?'"'+e.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':e)}},function(e,t,n){"use strict";var o;void 0===(o=function(){return function(e){var t=0;return e?t=("string"==typeof e?e:e.toString()).replace(/(\s)/g,"").length:t}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(38)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.getRules=function(t){var o=t?n.clone(t):{};return n.defaults(o,e.DEFAULT_RULES),o},e.convertToCssStyle=function(t,o,i){var r={},a=e.getRules(i);return n.isArray(o)&&(a=n.pick(a,o)),n.isObject(t)&&n.each(a,function(e,n){r[n]=e(t)}),r},e.DEFAULT_RULES={"font-size":function(e){var t=e["font-size"];if(null!=t)return t+"px"},"font-family":function(e){var t=e["font-family"];return t=o.getAllValueByFont(t)||t},color:function(e){return e.color},"background-color":function(e){return e["back-color"]},"font-weight":function(e){return{true:"bold",false:"normal"}[e.bold+""]},"font-style":function(e){return{true:"italic",false:"normal"}[e.italic+""]},"text-decoration":function(e){if(!1===e.underline&&!1===e.strike)return"none";var t=[];return e.underline&&t.push("underline"),e.strike&&t.push("line-through"),t.join(" ")||""}},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(45)],void 0===(i=function(e,t,n){"use strict";return n({DEFAULT_FONT:"Microsoft YaHei"})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(e,t){if(null!=String.prototype.codePointAt)return String.prototype.codePointAt.call(e,t);if(null==e)throw new TypeError("codePointAt第一个参数必须为String");var n,o,i=(e=String(e)).length,r=isNaN(t)?0:Number(t);return r<0||r>=i?void 0:(n=e.charCodeAt(r))>=55296&&n<=56319&&i>r+1&&(o=e.charCodeAt(r+1))>=56320&&o<=57343?1024*(n-55296)+o-56320+65536:n}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1);return{appendText:function(e,n,o,i){if(e&&n&&o&&i){var r=e.createElement(o),a=e.createTextNode(i);r.appendChild(a),n.appendChild(r)}else t.warn("unvalid parameters")}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o,i,r,a=n(0),s={};for(r in o=[(t={default:{name:"普通文本","font-size":14},a:{name:"标题","font-size":32,bold:!0},b:{name:"副标题","font-size":18,color:"#595959",bold:!0},1:{name:"标题1","font-size":28,bold:!0},2:{name:"标题2","font-size":20,bold:!0},3:{name:"标题3","font-size":16,bold:!0},4:{name:"标题4","font-size":14,bold:!0}}).default,t.a,t.b,t[1],t[2],t[3],t[4]],i={},t)"default"!==r&&(s[r]=a.clone(t[r]),delete s[r].name,delete s[r].align);return{headingMap:t,headingArray:o,headingBlockStyles:i,headingInlineStyles:s}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(70),i=n(39),r=n(72),a=n(113),s=n(31),l=n(0);return t=o.extend({inheritStyleHandlers:!1,uninheritStyleHandlers:{width:!0,float:!0},inheritBlockStyles:{align:!0},_handleNoteLink:function(){var e,t,n,o=this.el;e=o.getAttribute("data-attr-noteid"),t=o.getAttribute("alt"),e&&t&&((n=this.parent&&this.parent.styles?l.clone(this.parent.styles):{}).href="note://"+e,n.color="#003884",n.underline=!0,this.emit({text:t,styles:n,isText:!0}))},_handleNoteTodo:function(){var e=this.el.getAttribute("data-res-todo"),t=new s({legacyResId:e});this.emit(t)},finish:function(){var e,n,o,s,c,d=this,u=d.el,h=u.getAttribute("src")||u.getAttribute("data-src"),p=function(e,t){l.each(e,function(e,n){var o=t.style[e];o&&(d.styles[n]=o)})};t.isNoteLink(u)?d._handleNoteLink():t.isTodo(u)?d._handleNoteTodo():h&&((o=u.parentNode)&&(s=o.getAttribute("yne-bulb-block")),t.isAttachment(u)?(n=u.getAttribute("path"),e=new r({source:h,resource:n,fileName:t.getAttachmentFileName(u),fileLength:t.getAttachmentFileLength(u)}),"attachment"===s&&p({align:"textAlign",float:"float"},o)):t.isImage(u)?("image"===s&&p({align:"textAlign",width:"width",float:"float"},o),e=new i({source:h}),d.styles.width&&d.styles.width>620&&(d.styles.width=620)):t.isHandWrite(u)&&(e=(c=u.getAttribute("data-res-handwrite"))?new a({source:h,resource:c}):new i({source:h})),e&&(e.setStyles(d.styles),d.emit(e)))}},{isAttachment:function(e){var t=e.getAttribute("path"),n=e.dataset.mediaType;return t&&("attachment"===n||!n)},isImage:function(e){var t=e.dataset.mediaType;return!e.getAttribute("path")&&(!t||["image"].indexOf(t)>-1)},isHandWrite:function(e){return"handwrite"===e.dataset.mediaType},isNoteLink:function(e){return"notelink"===e.dataset.mediaType},isTodo:function(e){return"todo"===e.dataset.mediaType},getAttachmentFileName:function(e){return e.getAttribute("filename")||e.getAttribute("alt")||e.getAttribute("title")||""},getAttachmentFileLength:function(e){return e.getAttribute("filelength")||""}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(25),n(15),n(2)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.fromXml=function(e){throw new Error("HandWrite do NOT support fromXml till now")},t.fromJSON=function(e){if(!(e&&e.type&&e.type===r.HANDWRITE&&e.source&&e.resource))throw new Error("jsonObj or jsonObj.source/resource does NOT exist!");var n=new t({resource:e.resource,source:e.source});return e.blockId&&n.setId(e.blockId),n},t.prototype.getSource=function(e){var t,n=this.handWriteProps.source;return!0===e&&(t=this.getExtraInfo("pcResMap"))&&t[n]&&(n=t[n]),n},t.prototype.getResource=function(e){var t,n=this.handWriteProps.resource;return!0===e&&(t=this.getExtraInfo("pcResMap"))&&t[n]&&(n=t[n]),n},t.prototype.setStyles=function(){},t.prototype.toHtml=function(e,t,n){var i=o("",document,!0,!0).ownerDocument,r=i.createElement("div"),a=$(r),s=$(i.createElement("img"));return a.attr("yne-bulb-block","handwrite"),s.attr({"data-media-type":"handwrite","data-res-handwrite":this.handWriteProps.resource,src:this.getSource(n)}),a.append(s),r.outerHTML},t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);return t.source=this.getSource(!1),t.resource=this.getResource(!1),t},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(){throw new Error("HandWrite do NOT support toXml till now")},t.prototype.initialize=function(t){if(null==t||null==t.source||null==t.resource)throw new Error("props and props.source and props.resource  cannot be null");e.prototype.initialize.apply(this,[t]),this.handWriteProps=n.clone(t),this.type=r.HANDWRITE},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(32),i=n(29),r=n(26),a=n(0),s=n(3);return t=o.extend({list:null,level:null,type:null,_itemCounter:null,prevSimilar:null,inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0,align:!0,"line-height":!0,indent:!0,"text-indent":!0},_parseTypeFromElement:function(){return"ul"===this.el.tagName.toLowerCase()?i.UNORDERED:i.ORDERED},_getStartIndexFromElement:function(){var e=this.type,t=this.el,n=-1;return e!==i.ORDERED?n:("list"===t.getAttribute("yne-block-type")&&(n=parseInt(t.getAttribute("start"),10),isNaN(n)&&(n=-1)),n)},increaseItemCounter:function(){var e,t=this.prevSimilar;t&&t.increaseItemCounter?t.increaseItemCounter():(e=this._itemCounter||0,e+=1,this._itemCounter=e)},getItemCounter:function(){var e=this.prevSimilar;return e?e.getItemCounter():this._itemCounter||0},setup:function(){var e,t,n,o=this._findParentListHandler();this.list=null,this.level=1,o&&(this.level=o.level+1),n=this._parseTypeFromElement(),this.type=n,(t=this._getStartIndexFromElement())>1&&(e=this._getPreviousSimilar())&&e.getItemCounter()===t-1&&(this.prevSimilar=e,this.list=e.list),this.list||(this.list=new i({type:n,listId:s.newGUID()}))},capture:function(e){var t=this.level;e instanceof r&&e.getLevel()<t&&e.setLevel(t),this.emit(e)},_findParentListHandler:function(){for(var e=this.parent;e;){if(e instanceof t)return e;e=e.parent}},_getPreviousSimilar:function(){var e,n=this.level,o=this.type,i=this.parent.children;return a.some(i,function(i){if(i instanceof t&&i.level===n&&i.type===o)return e=i,!0}),e}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){var e={color:"#999999",bold:300,"font-family":"宋体","font-size":"14"};return{getQuoteDefaultStyles:function(){return e},getQuoteSize:function(){return e["font-size"]},getQuoteColor:function(){return e.color}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(15),n(2)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromJSON=function(){},t.fromXml=function(e){var n=new t({xmlNode:e});return n.parseIdFromXml(e),n},t.prototype.countWords=function(){return 0},t.prototype.setBlockStyle=function(){},t.prototype.setBlockStyles=function(){},t.prototype.getBlockStyles=function(){return null},t.prototype.getBlockStyle=function(){return null},t.prototype.getDefaultBlockStyles=function(){return null},t.prototype.toJSON=function(){return null},t.prototype.toHtml=function(){return""},t.prototype.toPlain=function(){return""},t.prototype.toXml=function(e){var t,r,a=!1;return n.some(this.unknownProps.xmlNode.childNodes,function(e){return e.nodeName===i.TAG_ID_NAME&&(a=!0),a}),a||(t=e.createElement(i.TAG_ID_NAME),r=e.createTextNode(o.newGUID()),t.appendChild(r),this.unknownProps.xmlNode.appendChild(t)),this.unknownProps.xmlNode},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.unknownProps=n.clone(t),this.type=r.UNKNOWN},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0);return{getFileType:function(e){if(t.isUndefined(e))return null;var n=e.toLowerCase().split(".");return{table:"table",pdf:"pdf",txt:"txt",text:"txt",mht:"html",doc:"word",docx:"word",excel:"excel",xls:"excel",xlsx:"excel",csv:"excel",ppt:"ppt",pps:"ppt",pptx:"ppt",ppsx:"ppt",flash:"flash",swf:"flash",flv:"flash",compress:"compress",zip:"compress",rar:"compress","7z":"compress",audio:"audio",mp3:"music",aac:"music",ogg:"music",wav:"music",flac:"music",m4a:"music",ape:"music",wma:"music",video:"video",rm:"video",rmvb:"video",avi:"video",mkv:"video",mpg:"video",mpeg:"video",wmv:"video",ts:"video",m4v:"video",mp4:"video",image:"image",jpg:"image",jpeg:"image",gif:"image",png:"image",bmp:"image",md:"md",scan:"scan",html:"html",htm:"html"}[n[n.length-1]]||"other"},getSizeString:function(e){var t=0,n=parseInt(e);if(n=n||0,isNaN(n))return"未知大小";if(n<=0)return"";for(;n>=1024&&t<3;)t++,n/=1024;return String(Math.floor(100*n)/100)+["B","KB","MB","GB","TB"][t]},splitFileFullName:function(e){if(t.isUndefined(e))return null;var n,o,i=e.lastIndexOf(".");return i<0?(n=e,o=""):0===i?(n="",o=e):(n=e.substring(0,i-1),o=e.substring(i-1)),{fileName:n,fileType:o}},getFileIconByName:function(e){var t="src--svg--type_other_large",n=this.getFileType(e);return n&&(t="src--svg--type_"+n+"_large"),t}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(205),o=n(0),i=n(5),r=n(14);return t.extend({className:"toolbar-item toolbar-combo-box",events:{"click .combo-value-wrapper":"onValueWrapperElClick","click .combo-expand-wrapper":"onExpandWrapperElClick","click .combo-menu-wrapper":"onMenuWrapperClick","click .combo-display-wrapper":"onClickDisplayWrapper",mousedown:"onMouseDown"},name:"unknown",label:"unknown",defaultValue:"",items:{},value:"",templateName:"toolbar-combo-box-template",_isForceSelectWhenClick:!1,initialize:function(e){this.editor=e.editor,this.render(),this.defaultSetValue?this.select(this.defaultSetValue):this.select(this.defaultValue),this.bindEvents(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var e,t=this.$el;if(t.addClass("combo-box-"+this.name),e=r.render("pc",this.templateName,{name:this.name,label:this.label,defaultValue:this.defaultValue,items:this.items,text:!1}),t.html(e),this.valueWrapperEl=t.find(".combo-value-wrapper")[0],this.expandWrapperEl=t.find(".combo-expand-wrapper")[0],this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],this.displayWrapperEl=t.find(".combo-display-wrapper")[0],i(this.displayWrapperEl).tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]}),this.isVisible||this.hide(),"heading"===this.name)for(var n=3;n<=6;n++)i(i(this.menuWrapperEl).find("li[data-value="+n+"]")[0]).tooltipster({animation:"",animationDuration:0,theme:["tooltipster-heading","tooltipster-heading-customized"],side:"right",delay:[800,300],content:"Ctrl+"+(n-2)})},bindEvents:function(){},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})},onValueWrapperElClick:function(){this.toggleMenu()},onExpandWrapperElClick:function(){this.toggleMenu()},onClickDisplayWrapper:function(){this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")},onMenuWrapperClick:function(e){var t=e.target,n=i(t).closest(".combo-item")[0];n&&(this.hideMenu(),this.onItemClick(n))},onItemClick:function(e){var t=i(e).data("value"),n=this.editor.getNoteRange(),o=n.startRange,r=o.getAsRectRange?o.getAsRectRange():null,a=t!==this.value||this._isForceSelectWhenClick||n.isInMultiBlock(),s=n.isSingleTableSelected()&&r&&!r.onlyOneCell();(t&&a||s)&&(this.select(t),this.onChange(t)),t&&this._isForceSelectWhenClick&&(this._isForceSelectWhenClick=!1)},select:function(e){this.value=e,this.updateValueUI(e)},updateValueUI:function(){},onChange:function(){},showMenu:function(){var e=this.menuWrapperEl;i(e).removeClass("menu-position-fix"),i(e).addClass("show"),e.getBoundingClientRect().right>document.documentElement.offsetWidth&&i(e).addClass("menu-position-fix")},hideMenu:function(){i(this.menuWrapperEl).removeClass("show")},toggleMenu:function(){i(this.menuWrapperEl).hasClass("show")?this.hideMenu():this.showMenu()},onDocumentMouseDown:function(e){var t=e.target;i.contains(this.el,t)||this.hideMenu()},onMouseDown:function(e){e.preventDefault()},reset:function(){this.hideMenu(),this.defaultSetValue?this.select(this.defaultSetValue):this.select(this.defaultValue)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(118),o=n(5),i=n(0);return t.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onChange:function(e){var t={};t[this.name]=e,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:t})},updateValueUI:function(e){var t=o(this.valueWrapperEl).find(".combo-value")[0];this.items[e]?o(t).text(this.items[e]):o(t).text(this.getUnlistedText(e)||"")},getUnlistedText:function(){return""},onEditingStateChange:function(e,t){this._isForceSelectWhenClick=!1,i.has(e,this.name)&&(t&&i.has(t,this.name)&&e[this.name]!==t[this.name]&&(this._isForceSelectWhenClick=!0),this.select(e[this.name]))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1);return{_getHref:function(e,t){if(!(t<0||t>=e.getLength()))return(e.getTextStylesAtIndex(t)||{}).href},_hasHref:function(e,t,n){var o=this._getHref(e,t);return n?o===n:o&&o.length>0},isAtHrefBorder:function(e,t,n){var o=n?t-1:t,i=this._getHref(e,o),r=this._getHref(e,n?o+1:o-1);return i&&i.length>0&&i!==r},findHrefBorder:function(e,n,o){if(!e||!e.getText)return t.error("param is not valid!"),-1;var i,r,a,s=-1,l=e.getText().getLength();if(n>l)return-1;if(o){if(i=n-1,!(a=this._getHref(e,i)))return-1;for(r=i-1;r>=-1;r--)if(!this._hasHref(e,r,a)){s=r+1;break}}else{if(i=n,!(a=this._getHref(e,i)))return-1;for(r=i+1;r<=l;r++)if(!this._hasHref(e,r,a)){s=r-1;break}}return s},completeUrl:function(e){return!e||/\:\/\//.exec(e)?e:"http://"+e}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(8),a=n(3);return t=o.extend({name:"atom.InsertCodeText",_textBlock:null,_startLineIndex:null,_insertedText:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._textBlock=this.options.block,this._startLineIndex=this.options.startBlockRange.startLineIndex,this._startLineCharIndex=this.options.startBlockRange.startLineCharIndex,this._insertedText=this.options.text),t.__super__.initialize.apply(this)},apply:function(){return!!this._insertedText&&(this._textBlock.insertText(this._startLineIndex,this._startLineCharIndex,this._insertedText),!0)},doUnapply:function(){this._textBlock&&this._insertedText&&this._textBlock.deleteText(this._startLineIndex,this._startLineCharIndex,this._startLineIndex,this._startLineCharIndex+this._insertedText.getLength())},fromCollabJSON:function(){var e=this.options.args,n=e.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),n&&(this._insertedText=r.fromCollabJSON(n.richText),this._textBlock=e.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._textBlock.getId(),e.richText=this._insertedText.toCollabJSON(),e.startPosition=this._start,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(2),a=n(18),s=n(1),l=n(37),c=n(78),d=n(3);return t=o.extend({name:"abstract.comp.InsertResource",_cmdArgs:null,_note:null,_newStartBlkId:null,_newEndBlkId:null,_resourceBlock:null,_retainStartBlock:null,insertResource:function(e,t,n){throw s.error("Method not implemented with:",e,t,n),"Method not implemented"},initialize:function(){var e;this._note=this.options.note,e=this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),d.isCollabCommand(e)||(this._newStartBlkId=d.newGUID(),this._newEndBlkId=d.newGUID(),1===e.retainStartBlock||"1"===e.retainStartBlock||!0===e.retainStartBlock?this._retainStartBlock=!0:this._retainStartBlock=!1)},apply:function(){var e=this._cmdArgs.range,t=e.getStartBlockRange().block;return e?(e.isCollapsed()||e.isSingleTableSelected()||r.isCode(t)||a.deleteSelectedContent(this,this._note,e),e.isInMultiBlock()?this._handleMultiBlockSelection(e):r.isTable(t)?this._handleSingleTableSelection(e,t):this._handleSingleBlockSelection(e)):(s.error(this.name+":note range should NOT be null"),!1)},_deleteBlocks:function(e){this.executeAtomicCommand(new l({note:this._note,blocks:e}))},_deleteBlockText:function(e,t,n){var o="";return t<n&&(o=e.sliceText(t,n),this.executeAtomicCommand(new c({block:e,start:t,end:n}))),o},_handleMultiBlockSelection:function(e){var t,n,o,i,s,l,c,d,u=[],h=[];return t=e.getStartBlockRange().block,s=(i=e.getEndBlockRange()).block,r.isListItem(t)?(d=this._note.getNextBlock(s),i.start!==s.getLength()?(c=s.getText?s.getText():"",l=a.createNewListItem(t,s.getId(),c),h.push(l.getId())):r.isTextBlock(d)||(l=a.createNewParagraph(s,s.getId(),"")),this._deleteBlocks([s]),this._resourceBlock=this.insertResource(t,null,l),h.push(s.getId(),this._resourceBlock.getId()),l||(l=d)):r.isTextBlock(t)?r.isListItem(s)||!r.isTextBlock(s)?(c=s.getText?s.getText():"",l=a.createNewParagraph(s,s.getId(),c),this._deleteBlocks([s]),this._resourceBlock=this.insertResource(t,null,l),h.push(s.getId(),this._resourceBlock.getId())):(l=s,this._resourceBlock=this.insertResource(t),h.push(this._resourceBlock.getId())):(o=this._note.getPreBlock(t),r.isTextBlock(o)&&!r.isCode(o)||(n=a.createNewParagraph(o,this._newStartBlkId,""),h.push(this._newStartBlkId)),u.push(t),h.push(t.getId()),r.isTextBlock(s)||(u.push(s),l=a.createNewParagraph(s,s.getId(),""),h.push(s.getId())),this._deleteBlocks(u),this._resourceBlock=this.insertResource(o,n,l),h.push(this._resourceBlock.getId()),l||(l=s)),a.setTextBlockAsEndingRange(this,l,0,0),this.pushAffectedBlockIds(h),!0},_handleSingleBlockSelection:function(e){var t,n,o,i,s,l,c=[];if(n=(t=e.getStartBlockRange()).block,e.getEndBlockRange().block,!r.isTextBlock(n,t)||n.isEmpty()&&!r.isCode(n))i=this._note.getPreBlock(n),(s=this._note.getNextBlock(n))&&r.isTextBlock(s)||(l=a.createNewParagraph(n,this._newEndBlkId,""),c.push(this._newEndBlkId)),this._retainStartBlock&&(r.isTable(n)||r.isAttachment(n)||r.isImage(n))||r.isCatalogue(n)?(i=n,o=a.createNewParagraph(n,this._newStartBlkId,""),c.push(this._newStartBlkId)):(i&&r.isTextBlock(i)&&!r.isCode(i)||(o=a.createNewParagraph(n,this._newStartBlkId,""),c.push(this._newStartBlkId)),this._deleteBlocks([n]),c.push(n.getId())),this._resourceBlock=this.insertResource(i,o,l);else{if(r.isCode(n))return;s=this._note.getNextBlock(n),t.start!==n.getLength()?l=this._handleSingleParaBlock(t,n):r.isTextBlock(s)||(l=a.createNewParagraph(n,this._newEndBlkId,"")),c.push(this._newEndBlkId),this._resourceBlock=this.insertResource(n,null,l)}return c.push(this._resourceBlock.getId()),l||(l=s),a.setTextBlockAsEndingRange(this,l,0,0),this.pushAffectedBlockIds(c),!0},_handleSingleParaBlock:function(e,t){var n;return n=this._deleteBlockText(t,e.start,t.getLength()),r.isHeading(t)?a.createNewHeading(t,this._newEndBlkId,n,t.getLevel()):r.isCatalogue(t)?a.createNewCatalogue(t,{paraId:this._newEndBlkId,text:n,href:t.getHref()}):r.isListItem(t)?a.createNewListItem(t,this._newEndBlkId,n):r.isQuote(t)?a.createNewQuote(t,{id:this._newEndBlkId,text:n}):r.isTodo(t)?a.createNewTodo(t,{id:this._newEndBlkId,text:n,checked:!1}):a.createNewParagraph(t,this._newEndBlkId,n)},_handleSingleTableSelection:function(e,t){return this._resourceBlock=this.insertResource(t),this.setEndingRange(e),!0},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._newStartBlkId=e.newStartBlkId,this._newEndBlkId=e.newEndBlkId,this._retainStartBlock=e.abstractSimpleValue1)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newStartBlkId=this._newStartBlkId,e.newEndBlkId=this._newEndBlkId,e.abstractSimpleValue1=this._retainStartBlock),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o=n(105);(e.exports=n(44)(!1)).push([e.i,".svg-common {\n  background-image: url("+o(n(143))+");\n  background-repeat: no-repeat;\n}\n.src--svg--align_center {\n  background-position: 58.11965811965812% 63.06306306306306%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--align_justify {\n  background-position: 67.52136752136752% 63.06306306306306%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--align_left {\n  background-position: 81.19658119658119% 0;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--align_right {\n  background-position: 81.19658119658119% 9.90990990990991%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--attachment {\n  background-position: 81.19658119658119% 19.81981981981982%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--attacthment_download {\n  background-position: 65.54621848739495% 51.81818181818182%;\n  width: 18px;\n  height: 24px;\n}\n.src--svg--auto_wrap {\n  background-position: 81.19658119658119% 29.72972972972973%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--bold {\n  background-position: 81.19658119658119% 39.63963963963964%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--border_color {\n  background-position: 81.19658119658119% 49.549549549549546%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--catalogue {\n  background-position: 56.90376569037657% 44.54148471615721%;\n  width: 17px;\n  height: 15px;\n}\n.src--svg--catalogue-refresh {\n  background-position: 52.58620689655172% 34.54545454545455%;\n  width: 24px;\n  height: 24px;\n}\n.src--svg--catalogue_remove {\n  background-position: 37.93103448275862% 17.272727272727273%;\n  width: 24px;\n  height: 24px;\n}\n.src--svg--checked {\n  background-position: 81.19658119658119% 59.45945945945946%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--clean_format {\n  background-position: 81.19658119658119% 69.36936936936937%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--clean_format_active {\n  background-position: 0 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--code {\n  background-position: 56.90376569037657% 51.541850220264315%;\n  width: 17px;\n  height: 17px;\n}\n.src--svg--combo_expand {\n  background-position: 70.44534412955466% 55.27426160337553%;\n  width: 9px;\n  height: 7px;\n}\n.src--svg--export {\n  background-position: 9.401709401709402% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--fixed_top {\n  background-position: 18.803418803418804% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--format_painter {\n  background-position: 28.205128205128204% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--hr {\n  background-position: 37.60683760683761% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--image {\n  background-position: 47.00854700854701% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--image_error {\n  background-position: 0 0;\n  width: 54px;\n  height: 64px;\n}\n.src--svg--indent {\n  background-position: 56.41025641025641% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--inline_height {\n  background-position: 65.8119658119658% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--italic {\n  background-position: 75.21367521367522% 80.18018018018019%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--line_through {\n  background-position: 90.5982905982906% 0;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--link {\n  background-position: 90.5982905982906% 9.90990990990991%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--list_ol {\n  background-position: 90.5982905982906% 19.81981981981982%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--list_ul {\n  background-position: 90.5982905982906% 29.72972972972973%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--normal_mode {\n  background-position: 72.5% 50.220264317180614%;\n  width: 16px;\n  height: 17px;\n}\n.src--svg--note_background {\n  background-position: 27.615062761506277% 97.79735682819383%;\n  width: 17px;\n  height: 17px;\n}\n.src--svg--outdent {\n  background-position: 90.5982905982906% 39.63963963963964%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--page_mode {\n  background-position: 34.583333333333336% 97.79735682819383%;\n  width: 16px;\n  height: 17px;\n}\n.src--svg--quote {\n  background-position: 43.220338983050844% 28.571428571428573%;\n  width: 20px;\n  height: 20px;\n}\n.src--svg--read_mode {\n  background-position: 90.5982905982906% 49.549549549549546%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--redo {\n  background-position: 90.5982905982906% 59.45945945945946%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--redo_active {\n  background-position: 90.5982905982906% 69.36936936936937%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--reference {\n  background-position: 90.5982905982906% 79.27927927927928%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--resize_view {\n  background-position: 0 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--screenshot {\n  background-position: 9.401709401709402% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--screenshot_x {\n  background-position: 18.803418803418804% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--sync {\n  background-position: 28.205128205128204% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table {\n  background-position: 37.60683760683761% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_align_bottom {\n  background-position: 47.00854700854701% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_align_mid {\n  background-position: 56.41025641025641% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_align_top {\n  background-position: 65.8119658119658% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_all {\n  background-position: 75.21367521367522% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_left {\n  background-position: 84.61538461538461% 90.09009009009009%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_none {\n  background-position: 100% 0;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_out {\n  background-position: 100% 9.90990990990991%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_right {\n  background-position: 100% 19.81981981981982%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_border_top {\n  background-position: 100% 29.72972972972973%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_broder_bottom {\n  background-position: 100% 39.63963963963964%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_cell_merge {\n  background-position: 23.275862068965516% 17.117117117117118%;\n  width: 24px;\n  height: 22px;\n}\n.src--svg--table_hide_border {\n  background-position: 100% 49.549549549549546%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--table_insert_delete {\n  background-position: 100% 59.45945945945946%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--text_background {\n  background-position: 100% 69.36936936936937%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--text_color {\n  background-position: 100% 79.27927927927928%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--todo {\n  background-position: 42.857142857142854% 37.00440528634361%;\n  width: 18px;\n  height: 17px;\n}\n.src--svg--toggle_tab {\n  background-position: 100% 89.1891891891892%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--type_audio_large {\n  background-position: 24.324324324324323% 0;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_compress_large {\n  background-position: 39.63963963963964% 0;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_csv_large {\n  background-position: 0 31.067961165048544%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_excel_large {\n  background-position: 15.315315315315315% 31.067961165048544%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_flash_large {\n  background-position: 30.63063063063063% 31.067961165048544%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_html_large {\n  background-position: 54.95495495495496% 0;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_image_large {\n  background-position: 54.95495495495496% 18.446601941747574%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_md_large {\n  background-position: 0 49.51456310679612%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_music_large {\n  background-position: 15.315315315315315% 49.51456310679612%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_note_large {\n  background-position: 30.63063063063063% 49.51456310679612%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_other_large {\n  background-position: 45.945945945945944% 49.51456310679612%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_pdf_large {\n  background-position: 70.27027027027027% 0;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_ppt_large {\n  background-position: 70.27027027027027% 18.446601941747574%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_scan_large {\n  background-position: 70.27027027027027% 36.89320388349515%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_table_large {\n  background-position: 0 67.96116504854369%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_txt_large {\n  background-position: 15.315315315315315% 67.96116504854369%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_video_large {\n  background-position: 30.63063063063063% 67.96116504854369%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--type_word_large {\n  background-position: 45.945945945945944% 67.96116504854369%;\n  width: 34px;\n  height: 38px;\n}\n.src--svg--underline {\n  background-position: 0 100%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--undo {\n  background-position: 9.401709401709402% 100%;\n  width: 22px;\n  height: 22px;\n}\n.src--svg--undo_active {\n  background-position: 18.803418803418804% 100%;\n  width: 22px;\n  height: 22px;\n}\n/**\n* z-index 的级别：\n*  普通元素 normal: 0\n*  普通设为上层元素 medium: 9\n*  设为最上层元素 top: 99\n*  设为绝对最上层元素 absolute top: 999\n**/\n.attachment-container {\n  margin: 5px 0;\n  display: inline-block;\n  position: relative;\n  outline: none;\n  width: 280px;\n  height: 64px;\n  border-radius: 4px;\n  background-color: #ffffff !important;\n  border: solid 1px #e0e1e5;\n  vertical-align: middle;\n  font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'Microsoft YaHei', '\\5FAE\\8F6F\\96C5\\9ED1', SimSun, '\\5B8B\\4F53', Heiti, '\\9ED1\\4F53', sans-serif;\n}\n.attachment-container .attachment-icon {\n  margin: 13px 17px 15px 15px;\n  float: left;\n  -webkit-print-color-adjust: exact;\n}\n.attachment-container .attachment-title {\n  height: 18px;\n  font-size: 12px;\n  font-weight: 500;\n  font-style: normal;\n  font-stretch: normal;\n  text-align: justify;\n  color: #393939;\n  margin-top: 16px;\n  width: 166px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  cursor: default;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.attachment-container .attachment-title .attachment-title-name {\n  max-width: 115px;\n  display: inline-block;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  margin: 0;\n}\n.attachment-container .attachment-title .attachment-title-type {\n  display: inline-block;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n  margin: 0;\n}\n.attachment-container .attachment-size {\n  font-size: 12px;\n  font-weight: normal;\n  font-style: normal;\n  font-stretch: normal;\n  text-align: justify;\n  color: #797979;\n  cursor: default;\n  height: 14px;\n  -webkit-touch-callout: none;\n  -webkit-user-select: none;\n  -khtml-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.img-title {\n  margin-top: 7px;\n  min-height: 18px;\n  font-size: 12px;\n  line-height: 1.29;\n  color: #595959;\n  word-break: break-word;\n  white-space: pre-wrap;\n  font-family: -apple-system, BlinkMacSystemFont, 'PingFang SC', Helvetica, Tahoma, Arial, 'Hiragino Sans GB', 'Microsoft YaHei', '\\5FAE\\8F6F\\96C5\\9ED1', SimSun, '\\5B8B\\4F53', Heiti, '\\9ED1\\4F53', sans-serif;\n}\n[yne-bulb-block=\"catalogue\"] {\n  border-left: 1px solid #f2f2f2;\n  border-right: 1px solid #f2f2f2;\n  background: rgba(255, 255, 255, 0.7);\n  line-height: 1.75;\n  padding: 0 20px;\n}\n[yne-bulb-block=\"catalogue\"] > a {\n  padding: 8px 0;\n  text-decoration: none;\n  border-bottom: 1px dashed #e6e6e6;\n  display: block;\n  color: #003884;\n  background: initial;\n}\n[yne-bulb-order=\"first\"] {\n  border-top: 1px solid #f2f2f2;\n  margin-top: 20px;\n}\n[yne-bulb-order=\"last\"] {\n  border-bottom: 1px solid #f2f2f2;\n  margin-bottom: 20px;\n}\n[yne-bulb-order=\"last\"] > a {\n  border-bottom: 0px;\n}\n[yne-bulb-order=\"firstlast\"] {\n  border-top: 1px solid #f2f2f2;\n  margin-top: 20px;\n  border-bottom: 1px solid #f2f2f2;\n  margin-bottom: 20px;\n}\n[yne-bulb-order=\"firstlast\"] > a {\n  border-bottom: 0px;\n}\n",""])},function(e,t,n){var o,i;o=[n,t,n(109)],void 0===(i=function(e,t,n){"use strict";return function(e){var t,o=[];for(t=0;t<e.length;t++)n(e,t)>65535?(o.push(e.slice(t,t+2)),t++):o.push(e[t]);return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(19)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.add=function(t){t&&!o.isSupport(t)&&(n.contains(e.unknownInlineStyleNames,t)||e.unknownInlineStyleNames.push(t))},e.get=function(){return e.unknownInlineStyleNames},e.reset=function(){e.unknownInlineStyleNames=[]},e.unknownInlineStyleNames=[],e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(63)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(t){return e.call(this,t)||this}return a(t,e),t.isHeaderFooterRange=function(e){return n.isHeaderFooter(e.block)},t.prototype.collapse=function(e){void 0===e&&(e=!0),e?this.end=this.start:this.start=this.end},t.prototype.isCollapsed=function(){return this.start===this.end},t.prototype.clone=function(){return new t({block:this.block,end:this.end,start:this.start})},t.prototype.getDataAsPlain=function(){return""},t.prototype.canDrawedByNative=function(){return!0},t.prototype.toNativeRange=function(e){return null},t.prototype.toCollabJSON=function(){var e=this.block.toCollabJSON();return e.rangeType=this.type,e.blockId=this.block.getId(),e},t.prototype.countWords=function(){return this.end-this.start},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.HEADER_FOOTER,this.start=t.start||0,this.end=t.end||0,this.block=t.block},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(9),n(1),n(63)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromCollabJSON=function(e,o){var a,s=e.rangeType;if(s===n.ATTACHMENT)return(a=r.getBlockById(e.blockId,o))?new t({block:a}):void 0;i.error("wrong block range type:",s)},t.prototype.canDrawedByNative=function(){return!1},t.prototype.clone=function(){return new t({block:this.block})},t.prototype.collapse=function(e){},t.prototype.getDataAsHtml=function(e){return this.block.toHtml(null,null,e)},t.prototype.getDataAsJSON=function(){var e=this.block.toJSON();return(o.IS_WEB_NOTE||o.IS_WEB_GROUP)&&e.resource&&!/^http/i.test(e.resource)&&(e.resource=location.protocol+"//"+location.hostname+e.resource),e},t.prototype.getDataAsPlain=function(){return this.block.toPlain()},t.prototype.isCollapsed=function(){return!1},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.ATTACHMENT},t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(1),n(2),n(63)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromCollabJSON=function(e,r){var a=e.rangeType;if(a===o.IMAGE){var s=i.getBlockById(e.blockId,r);return s?new t({block:s}):void 0}n.error("wrong block range type:",a)},t.prototype.isCollapsed=function(){return!1},t.prototype.clone=function(){return new t({block:this.block})},t.prototype.collapse=function(){},t.prototype.getDataAsJSON=function(){return this.block.toJSON()},t.prototype.getDataAsHtml=function(e){return this.block.toHtml(null,null,e)},t.prototype.getDataAsPlain=function(){return this.block.toPlain()},t.prototype.canDrawedByNative=function(){return!1},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=o.IMAGE},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(170),i=n(132),r=n(193);return function(e,n){return t||(t=new o(i)).define(".MsoListParagraph",r,o.PRIORITY.HIGH),t.parse(e,n)}}.call(t,n,t,e))||(e.exports=o)},,,function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(183),i=n(184),r=n(185),a={a:r.AnchorHandler,abbr:r.InlineHandler,acronym:r.InlineHandler,address:r.ParagraphHandler,applet:!1,area:!1,article:r.ParagraphHandler,aside:r.ParagraphHandler,audio:!1,b:r.InlineHandler,base:!1,basefont:!1,bdi:r.InlineHandler,bdo:r.InlineHandler,bgsound:!1,big:r.InlineHandler,blink:r.InlineHandler,blockquote:r.ParagraphHandler,body:r.ParagraphHandler,br:r.BreakHandler,button:!1,canvas:!1,center:r.ParagraphHandler,cite:r.InlineHandler,code:r.InlineHandler,command:!1,content:!1,data:!1,datalist:!1,dd:r.ParagraphHandler,del:r.InlineHandler,details:r.ParagraphHandler,dfn:r.InlineHandler,dialog:!1,dir:r.InlineHandler,div:r.ParagraphHandler,dl:r.ParagraphHandler,dt:r.ParagraphHandler,element:!1,em:r.InlineHandler,embed:!1,fieldset:r.ParagraphHandler,figcaption:r.ParagraphHandler,figure:r.ParagraphHandler,font:r.InlineHandler,footer:r.ParagraphHandler,form:r.ParagraphHandler,frame:!1,frameset:!1,h1:r.ParagraphHandler,h2:r.ParagraphHandler,h3:r.ParagraphHandler,h4:r.ParagraphHandler,h5:r.ParagraphHandler,h6:r.ParagraphHandler,header:r.ParagraphHandler,hgroup:r.ParagraphHandler,hr:r.HrHandler,html:r.ParagraphHandler,i:r.InlineHandler,iframe:!1,image:!1,img:r.ImageHandler,input:r.TodoHandler,ins:r.InlineHandler,isindex:!1,kbd:r.InlineHandler,keygen:!1,label:r.InlineHandler,legend:r.ParagraphHandler,li:r.ListItemHandler,link:!1,listing:!1,main:r.ParagraphHandler,map:!1,mark:r.InlineHandler,marquee:r.ParagraphHandler,menu:!1,menuitem:!1,meta:!1,meter:r.InlineHandler,multicol:r.ParagraphHandler,nav:r.ParagraphHandler,nobr:r.InlineHandler,noembed:!1,noframes:!1,noscript:!1,object:!1,ol:r.ListHandler,optgroup:!1,option:!1,output:r.InlineHandler,p:r.ParagraphHandler,param:!1,picture:!1,plaintext:r.ParagraphHandler,pre:r.ParagraphHandler,progress:!1,q:r.InlineHandler,rp:r.InlineHandler,rt:r.InlineHandler,rtc:r.InlineHandler,ruby:r.ParagraphHandler,s:r.InlineHandler,samp:r.InlineHandler,script:!1,section:r.ParagraphHandler,select:!1,shadow:!1,small:r.InlineHandler,source:!1,spacer:!1,span:r.InlineHandler,strike:r.InlineHandler,strong:r.InlineHandler,style:!1,sub:r.InlineHandler,summary:r.ParagraphHandler,sup:r.InlineHandler,table:r.TableHandler,template:!1,textarea:r.ParagraphHandler,time:r.InlineHandler,title:!1,track:!1,tt:r.InlineHandler,u:r.InlineHandler,ul:r.ListHandler,var:r.InlineHandler,video:!1,wbr:!1,xmp:!1},s=function(e,n){e&&e.length&&t.each(e,function(e){null==n[e]&&(n[e]=!1)})};return s(o,a),s(i,a),a}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(21),n(15),n(2)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createBlank=function(e){return new t({content:"",isFooter:!0===e})},t.format=function(e,t){return e?(null!=(t=t||{}).pageIndex&&(e=e.replace(/:p/,t.pageIndex+1)),t.pageCount&&(e=e.replace(/:n/,t.pageCount)),e):e},t.fromXml=function(e){var o=$(e),i=o.find(">text").text(),r=new t({align:o.find("styles>align").text(),content:i,isFooter:"footer"===e.nodeName});return o.children().each(function(e,t){switch(t.nodeName){case"text":break;case"styles":$(t).children().each(function(e,o){"align"!==o.nodeName&&n.appendToTree(r.unknownStyles,t)});break;default:n.appendToTree(r.unknownTree,t)}}),r},t.parse=function(e,t){return e.replace(/\d+/,function(e){return parseInt(e,10)===t.pageIndex+1?":p":e}).replace(/\d+/,function(e){return parseInt(e,10)===t.pageCount?":n":e})},t.prototype.getAlign=function(){return this.align},t.prototype.getBlockStyle=function(e){if("align"===e)return this.getAlign()||"center"},t.prototype.getContent=function(e,n){return t.format(this.content,n)},t.prototype.getInfo=function(){return{align:this.getAlign(),content:this.getContent(),isFooter:this.isFooter}},t.prototype.setAlign=function(e){this.align=e},t.prototype.setContent=function(e){this.content=e},t.prototype.setContentAndStyle=function(e,t){null!=e&&(this.content=e),null!=t&&(this.align=t),this.trigger("change",e,t)},t.prototype.toCollabJSON=function(){return{headerFooterInfo:this.getInfo()}},t.prototype.toXml=function(e){var t,o=this.isFooter?"footer":"header",i=e.createElement(o),r=e.createElement("styles"),a=e.createElement("text"),s=e.createTextNode(this.getContent());return a.appendChild(s),i.appendChild(a),(t=e.createElement("align")).appendChild(e.createTextNode(this.getAlign())),r.appendChild(t),n.appendToXml(this.unknownStyles,r),i.appendChild(r),n.appendToXml(this.unknownTree,i),i.setAttribute("compat","true"),i},t.prototype.initialize=function(t){t=t||{isFooter:!1,content:"",align:"center"},e.prototype.initialize.call(this,t),this.type=i.HEADER_FOOTER,this.blockId=t.isFooter?"footer-fixed-id":"header-fixed-id",this.content=t.content||"",this.align=t.align||"center",this.isFooter=!0===t.isFooter,this.unknownTree={},this.unknownStyles={}},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(5),o=n(0),i=n(117);return{processHtmlContent:function(e){var n=e.attr("title")||e.attr("filename");if(n){var r=e.attr("filelength"),a=t('<div class="attachment-container"></div>'),s=i.getFileType(n),l=i.getSizeString(r),c=i.splitFileFullName(n),d=t('<div class="attachment-icon svg-common '+(s?"src--svg--type_"+s+"_large":"src--svg--type_other_large")+'"></div>'),u=t('<div class="attachment-title"><p class="attachment-title-name">'+o.escape(c.fileName)+'</p><p class="attachment-title-type">'+o.escape(c.fileType)+"</p></div>"),h=t('<div class="attachment-size">'+l+"</div>");return a.append(d).append(u).append(h),e.replaceWith(a),a}},getAttachStyle:function(e,t){this._loadAttachCssFile(t,function(t){e.innerTag="<style>"+t.css+"</style>"})}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o=n(105);(e.exports=n(44)(!1)).push([e.i,"#presenter .demo-page {\n  position: absolute;\n  display: block;\n  z-index: 10099;\n  visibility: visible;\n  background-color: #f9f9f9;\n  cursor: url("+o(n(144))+'), auto;\n  top: 0;\n  left: 0;\n  height: 100%;\n  width: 100%;\n}\n#presenter .demo-page .note-content {\n  display: block;\n  width: 100%;\n  font-family: "Microsoft YaHei", "\\5FAE\\8F6F\\96C5\\9ED1", "Microsoft JhengHei", "\\534E\\6587\\9ED1\\4F53", arial, sans-serif, STHeiti, sans-serif;\n  font-size: 17px;\n  line-height: 3rem;\n  height: 100%;\n  overflow-y: scroll;\n  -webkit-user-select: text;\n  overflow-x: hidden;\n  word-break: break-all;\n}\n#presenter .demo-page .note-content.lsize {\n  font-size: 19px;\n}\n#presenter .demo-page .note-content.ssize {\n  font-size: 15px;\n}\n#presenter .demo-page .tool-bar {\n  position: fixed;\n  top: 30px;\n  right: 30px;\n}\n#presenter .demo-page .tool-bar .demo-mode-icon {\n  display: block;\n  width: 48px;\n  height: 48px;\n}\n#presenter .demo-page .tool-bar i {\n  display: block;\n}\n#presenter .demo-page .tool-bar .zoom-in-icon {\n  height: 48px;\n  width: 48px;\n  background-image: url('+o(n(145))+");\n}\n#presenter .demo-page .tool-bar .zoom-in-icon:hover {\n  background-image: url("+o(n(146))+");\n}\n#presenter .demo-page .tool-bar .zoom-out-icon {\n  height: 48px;\n  width: 48px;\n  background-image: url("+o(n(147))+");\n}\n#presenter .demo-page .tool-bar .zoom-out-icon:hover {\n  background-image: url("+o(n(148))+");\n}\n#presenter .demo-page .tool-bar .esc-icon {\n  height: 48px;\n  width: 48px;\n  background-image: url("+o(n(149))+");\n}\n#presenter .demo-page .tool-bar .esc-icon:hover {\n  background-image: url("+o(n(150))+");\n}\n#presenter .demo-page .tool-bar.show {\n  opacity: 0.2;\n}\nbody.presentation {\n  overflow: hidden !important;\n}\n.mixin-common-font {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.mixin-token-font {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-default pre:first-child {\n  border-top: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre:last-child {\n  border-bottom: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre {\n  border-left: 1px solid rgba(208, 212, 217, 0.5);\n  border-right: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre {\n  background-color: #f7f7f7;\n  line-height: 1.3;\n}\n.code-view.yne-code-theme-default .yne-plain {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default .yne-token {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default .yne-token.yne-comment,\n.code-view.yne-code-theme-default .yne-token.yne-prolog,\n.code-view.yne-code-theme-default .yne-token.yne-doctype,\n.code-view.yne-code-theme-default .yne-token.yne-cdata {\n  color: slategray;\n}\n.code-view.yne-code-theme-default .yne-token.yne-punctuation {\n  color: #999;\n}\n.code-view.yne-code-theme-default .yne-token .namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-default .yne-token.yne-property,\n.code-view.yne-code-theme-default .yne-token.yne-tag,\n.code-view.yne-code-theme-default .yne-token.yne-boolean,\n.code-view.yne-code-theme-default .yne-token.yne-number,\n.code-view.yne-code-theme-default .yne-token.yne-constant,\n.code-view.yne-code-theme-default .yne-token.yne-symbol,\n.code-view.yne-code-theme-default .yne-token.yne-deleted {\n  color: #905;\n}\n.code-view.yne-code-theme-default .yne-token.yne-selector,\n.code-view.yne-code-theme-default .yne-token.yne-attr-name,\n.code-view.yne-code-theme-default .yne-token.yne-string,\n.code-view.yne-code-theme-default .yne-token.yne-char,\n.code-view.yne-code-theme-default .yne-token.yne-builtin,\n.code-view.yne-code-theme-default .yne-token.yne-inserted {\n  color: #690;\n}\n.code-view.yne-code-theme-default .yne-token.yne-operator,\n.code-view.yne-code-theme-default .yne-token.yne-entity,\n.code-view.yne-code-theme-default .yne-token.yne-url {\n  color: #9a6e3a;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-default .yne-token.yne-atrule,\n.code-view.yne-code-theme-default .yne-token.yne-attr-value,\n.code-view.yne-code-theme-default .yne-token.yne-keyword {\n  color: #07a;\n}\n.code-view.yne-code-theme-default .yne-token.yne-function,\n.code-view.yne-code-theme-default .yne-token.yne-class-name {\n  color: #DD4A68;\n}\n.code-view.yne-code-theme-default .yne-token.yne-regex,\n.code-view.yne-code-theme-default .yne-token.yne-important,\n.code-view.yne-code-theme-default .yne-token.yne-variable {\n  color: #e90;\n}\n.code-view.yne-code-theme-default .yne-token.yne-important,\n.code-view.yne-code-theme-default .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-default .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-default .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-coy {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-coy pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre {\n  color: black;\n  background: none;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.6;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-coy pre {\n  border-left: 10px solid #358ccb;\n  box-shadow: -1px 0px 0px 0px #358ccb, 0px 0px 0px 0px #dfdfdf;\n  background-color: #fdfdfd;\n  background-image: linear-gradient(transparent 50%, rgba(69, 142, 209, 0.04) 50%);\n  background-size: 3em 3em;\n  background-origin: content-box;\n  background-attachment: local;\n}\n.code-view.yne-code-theme-coy pre {\n  background-color: #fdfdfd;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding-bottom: 0;\n  padding-top: 0;\n  padding-left: 1em;\n  position: relative;\n}\n.code-view.yne-code-theme-coy pre:nth-child(2n+1) {\n  background-color: #f6fafe;\n}\n.code-view.yne-code-theme-coy pre:before,\n.code-view.yne-code-theme-coy pre:after {\n  content: '';\n  z-index: -2;\n  display: block;\n  position: absolute;\n  bottom: 0.75em;\n  left: 0.18em;\n  width: 40%;\n  height: 20%;\n  max-height: 13em;\n  box-shadow: 0px 13px 8px #979797;\n  -webkit-transform: rotate(-2deg);\n  -moz-transform: rotate(-2deg);\n  -ms-transform: rotate(-2deg);\n  -o-transform: rotate(-2deg);\n  transform: rotate(-2deg);\n}\n.code-view.yne-code-theme-coy .yne-plain {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.code-view.yne-code-theme-coy .yne-token {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-comment,\n.code-view.yne-code-theme-coy .yne-token.yne-block-comment,\n.code-view.yne-code-theme-coy .yne-token.yne-prolog,\n.code-view.yne-code-theme-coy .yne-token.yne-doctype,\n.code-view.yne-code-theme-coy .yne-token.yne-cdata {\n  color: #7D8B99;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-punctuation {\n  color: #5F6364;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-property,\n.code-view.yne-code-theme-coy .yne-token.yne-tag,\n.code-view.yne-code-theme-coy .yne-token.yne-boolean,\n.code-view.yne-code-theme-coy .yne-token.yne-number,\n.code-view.yne-code-theme-coy .yne-token.yne-function-name,\n.code-view.yne-code-theme-coy .yne-token.yne-constant,\n.code-view.yne-code-theme-coy .yne-token.yne-symbol,\n.code-view.yne-code-theme-coy .yne-token.yne-deleted {\n  color: #c92c2c;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-selector,\n.code-view.yne-code-theme-coy .yne-token.yne-attr-name,\n.code-view.yne-code-theme-coy .yne-token.yne-string,\n.code-view.yne-code-theme-coy .yne-token.yne-char,\n.code-view.yne-code-theme-coy .yne-token.yne-function,\n.code-view.yne-code-theme-coy .yne-token.yne-builtin,\n.code-view.yne-code-theme-coy .yne-token.yne-inserted {\n  color: #2f9c0a;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-operator,\n.code-view.yne-code-theme-coy .yne-token.yne-entity,\n.code-view.yne-code-theme-coy .yne-token.yne-url,\n.code-view.yne-code-theme-coy .yne-token.yne-variable {\n  color: #a67f59;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-coy .yne-token.yne-atrule,\n.code-view.yne-code-theme-coy .yne-token.yne-attr-value,\n.code-view.yne-code-theme-coy .yne-token.yne-keyword,\n.code-view.yne-code-theme-coy .yne-token.yne-class-name {\n  color: #1990b8;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-regex,\n.code-view.yne-code-theme-coy .yne-token.yne-important {\n  color: #e90;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-style,\n.code-view.yne-code-theme-coy .yne-token.yne-string {\n  color: #a67f59;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-coy .yne-token.yne-important {\n  font-weight: normal;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-tomorrow {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-tomorrow pre {\n  color: #ccc;\n  background: none;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.3;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-tomorrow pre {\n  background: #2d2d2d;\n  caret-color: white;\n}\n.code-view.yne-code-theme-tomorrow pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-comment,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-block-comment,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-prolog,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-doctype,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-cdata {\n  color: #999;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-punctuation {\n  color: #ccc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-tag,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-attr-name,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-namespace,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-deleted {\n  color: #e2777a;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-function-name {\n  color: #6196cc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-boolean,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-number,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-function {\n  color: #f08d49;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-property,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-class-name,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-constant,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-symbol {\n  color: #f8c555;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-selector,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-important,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-atrule,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-keyword,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-builtin {\n  color: #cc99cd;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-string,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-char,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-attr-value,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-regex,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-variable {\n  color: #7ec699;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-operator,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-entity,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-url {\n  color: #67cdcc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-important,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-inserted {\n  color: green;\n}\n.code-view.yne-code-theme-okaidia {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-okaidia pre {\n  color: #f8f8f2;\n  background: none;\n  text-shadow: 0 1px rgba(0, 0, 0, 0.3);\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.3;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-okaidia pre {\n  background: #272822;\n  caret-color: white;\n}\n.code-view.yne-code-theme-okaidia pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-comment,\n.code-view.yne-code-theme-okaidia .yne-token.yne-prolog,\n.code-view.yne-code-theme-okaidia .yne-token.yne-doctype,\n.code-view.yne-code-theme-okaidia .yne-token.yne-cdata {\n  color: slategray;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-punctuation {\n  color: #f8f8f2;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-property,\n.code-view.yne-code-theme-okaidia .yne-token.yne-tag,\n.code-view.yne-code-theme-okaidia .yne-token.yne-constant,\n.code-view.yne-code-theme-okaidia .yne-token.yne-symbol,\n.code-view.yne-code-theme-okaidia .yne-token.yne-deleted {\n  color: #f92672;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-boolean,\n.code-view.yne-code-theme-okaidia .yne-token.yne-number {\n  color: #ae81ff;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-selector,\n.code-view.yne-code-theme-okaidia .yne-token.yne-attr-name,\n.code-view.yne-code-theme-okaidia .yne-token.yne-string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-char,\n.code-view.yne-code-theme-okaidia .yne-token.yne-builtin,\n.code-view.yne-code-theme-okaidia .yne-token.yne-inserted {\n  color: #a6e22e;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-operator,\n.code-view.yne-code-theme-okaidia .yne-token.yne-entity,\n.code-view.yne-code-theme-okaidia .yne-token.yne-url,\n.code-view.yne-code-theme-okaidia .yne-token.yne-language-css .string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-style .string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-variable {\n  color: #f8f8f2;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-atrule,\n.code-view.yne-code-theme-okaidia .yne-token.yne-attr-value,\n.code-view.yne-code-theme-okaidia .yne-token.yne-function,\n.code-view.yne-code-theme-okaidia .yne-token.yne-class-name {\n  color: #e6db74;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-keyword {\n  color: #66d9ef;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-regex,\n.code-view.yne-code-theme-okaidia .yne-token.yne-important {\n  color: #fd971f;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-important,\n.code-view.yne-code-theme-okaidia .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-Ateliersulphurpool {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  font-family: Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace;\n  font-size: 14px;\n  line-height: 1.375;\n  direction: ltr;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n  background: #f5f7ff;\n  color: #5e6687;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre::-moz-selection,\n.code-view.yne-code-theme-Ateliersulphurpool pre::-moz-selection {\n  text-shadow: none;\n  background: #dfe2f1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre::selection,\n.code-view.yne-code-theme-Ateliersulphurpool pre::selection {\n  text-shadow: none;\n  background: #dfe2f1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  margin: 0;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre:first-child {\n  border-top: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre:last-child {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  border-left: 1px solid rgba(0, 0, 0, 0.05);\n  border-right: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-comment,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-prolog,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-doctype,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-cdata {\n  color: #898ea4;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-punctuation {\n  color: #5e6687;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-operator,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-boolean,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-number {\n  color: #c76b29;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-property {\n  color: #c08b30;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-tag {\n  color: #3d8fd1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-selector {\n  color: #6679cc;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-attr-name {\n  color: #c76b29;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-entity,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-url,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-attr-value,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-keyword,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-control,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-directive,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-unit {\n  color: #ac9739;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-statement,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-regex,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-atrule {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-placeholder,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-variable {\n  color: #3d8fd1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-deleted {\n  text-decoration: line-through;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-inserted {\n  border-bottom: 1px dotted #202746;\n  text-decoration: none;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-important,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-important {\n  color: #c94922;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-vs {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-vs pre {\n  color: #393A34;\n  font-family: \"Consolas\", \"Bitstream Vera Sans Mono\", \"Courier New\", Courier, monospace;\n  direction: ltr;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  font-size: 0.95em;\n  line-height: 1.6em;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-vs pre::-moz-selection,\n.code-view.yne-code-theme-vs pre::-moz-selection {\n  background: #C1DEF1;\n}\n.code-view.yne-code-theme-vs pre::selection,\n.code-view.yne-code-theme-vs pre::selection {\n  background: #C1DEF1;\n}\n.code-view.yne-code-theme-vs pre {\n  padding: 0;\n  margin: 0;\n  background-color: white;\n}\n.code-view.yne-code-theme-vs pre:first-child {\n  border-top: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs pre:last-child {\n  border-bottom: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs pre {\n  border-left: 1px solid #dddddd;\n  border-right: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-comment,\n.code-view.yne-code-theme-vs .yne-token.yne-prolog,\n.code-view.yne-code-theme-vs .yne-token.yne-doctype,\n.code-view.yne-code-theme-vs .yne-token.yne-cdata {\n  color: #008000;\n  font-style: italic;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-string {\n  color: #A31515;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-punctuation,\n.code-view.yne-code-theme-vs .yne-token.yne-operator {\n  color: #393A34;\n  /* no highlight */\n}\n.code-view.yne-code-theme-vs .yne-token.yne-url,\n.code-view.yne-code-theme-vs .yne-token.yne-symbol,\n.code-view.yne-code-theme-vs .yne-token.yne-number,\n.code-view.yne-code-theme-vs .yne-token.yne-boolean,\n.code-view.yne-code-theme-vs .yne-token.yne-variable,\n.code-view.yne-code-theme-vs .yne-token.yne-constant,\n.code-view.yne-code-theme-vs .yne-token.yne-inserted {\n  color: #36acaa;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-function {\n  color: #00009f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-deleted,\n.code-view.yne-code-theme-vs .yne-token.yne-tag {\n  color: #9a050f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-selector,\n.code-view.yne-code-theme-vs .yne-token.yne-keyword {\n  color: #00009f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-important,\n.code-view.yne-code-theme-vs .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-class-name,\n.code-view.yne-code-theme-vs .yne-token.yne-property {\n  color: #2B91AF;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-tag,\n.code-view.yne-code-theme-vs .yne-token.yne-selector {\n  color: #800000;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-attr-name,\n.code-view.yne-code-theme-vs .yne-token.yne-property,\n.code-view.yne-code-theme-vs .yne-token.yne-regex,\n.code-view.yne-code-theme-vs .yne-token.yne-entity {\n  color: #ff0000;\n}\n.platform-pc .code-view {\n  width: calc(100vw - 60px);\n}\n.page-A4 .code-view,\n.read-mode .code-view {\n  width: 622px;\n}\n.page-A4 .code-view pre,\n.read-mode .code-view pre {\n  min-width: 605px;\n}\n.share .code-view {\n  width: 600px;\n}\n.share .code-view .para-text pre {\n  min-width: 590px;\n}\n.code-view .para-text.selectAll pre {\n  border-color: #4C98EF;\n}\n.combo-box-code-language .combo-menu-wrapper .combo-menu.combo-menu-code-language {\n  max-height: 300px;\n  overflow-y: scroll;\n}\n.code-view {\n  width: calc(100vw - 68px);\n  white-space: pre;\n  overflow-x: auto;\n  overflow-y: hidden;\n  counter-reset: lineNumber;\n  margin: 0 20px;\n}\n.code-view .para-text {\n  cursor: pointer;\n  margin: 0 auto;\n  padding: .5em .2em 0 .2em;\n  width: max-content;\n}\n.code-view .page-break-placeholder {\n  user-select: none;\n}\n.code-view pre {\n  counter-increment: lineNumber;\n  padding: .25em 0;\n  margin: 0;\n  min-width: calc(100vw - 77px);\n  cursor: auto;\n}\n.code-view pre:before {\n  content: counter(lineNumber);\n  width: 36px;\n  padding: 0 1em;\n  font-size: 12px;\n  color: grey;\n  user-select: none;\n}\n.note-view-wrapper .block-view.collab-editing-view.code-view {\n  margin: 0 20px;\n  padding-left: 0;\n}\n.note-view-wrapper .block-view.collab-editing-view.code-view {\n  pointer-events: initial;\n}\n",""])},function(e,t,n){var o;void 0===(o=function(e){var t=n(27),o=n(0);return t.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onEditingStateChange:function(e){o.has(e,this.name)&&this.setState(e[this.name])},onClick:function(){var e={};e[this.name]=!this.state,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:e}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(16),o=n(5),i=n(0),r=n(6),a=n(77),s=["shift","alt","ctrl","meta"],l={return:"enter",escape:"esc",plus:"+"},c={mod:r.IS_MAC?"meta":"ctrl",option:"alt",command:"meta"};return t.extend({initialize:function(e){(e=e||{}).el&&(i.bindAll(this,"_onKeyDown"),this.el=e.el,this._beforeMatch=e.beforeMatch,this._afterMatch=e.afterMatch,this._hasBindEvents=!1)},_bindEvents:function(){this._hasBindEvents||(o(this.el).on("keydown",this._onKeyDown),this._hasBindEvents=!0)},_unbindEvents:function(){this._hasBindEvents&&(o(this.el).off("keydown",this._onKeyDown),this._hasBindEvents=!1)},_prepareForBindKey:function(){this._hasBindEvents||this._bindEvents(),this._keyMap||(this._keyMap={}),this._matchCache||(this._matchCache={})},_formatKey:function(e){e=(e=(e=o.trim(e)).toLowerCase()).replace(/\s+/g,""),i.each(c,function(t,n){e=e.replace(n+"+",t+"+")});var t={},n=e.split(/\+/),r=i.last(n),a=[];return r=l[r]||r,t.key=r,i.each(s,function(n){e.indexOf(n)>-1&&(t[n]=!0,a.push(n))}),a.push(r),t.mark=a.join("-"),t},isEventMatchKey:function(e,t){var n=this._extractEventInfo(e),o=this._formatKey(t);return this._isMatch(n,o)},_extractEventInfo:function(e){var t={},n=[];return i.each(s,function(o){e[o+"Key"]&&(t[o]=!0,n.push(o))}),n.push(e.keyCode),t.keyCode=e.keyCode,t.mark=n.join("-"),t},_isMatch:function(e,t){return!(!t||!event)&&(i.every(s,function(n){return t[n]===e[n]})&&a.isMatch(t.key,e.keyCode))},_onKeyDown:function(e){var t,n,o=this,r=o._keyMap,a=o._extractEventInfo(e),s=a.mark,l=o._matchCache,c=l[s];o._beforeMatch&&o._beforeMatch(e),c||(c=l[s]={eventInfo:a},t={},n=!1,i.each(r,function(e,i){o._isMatch(a,e.keyInfo)&&(t[i]=e,n=!0)}),n&&(c.handlers=t)),i.each(c.handlers,function(t){t.callback.apply(null,[e])}),o._afterMatch&&o._afterMatch(e,n)},bind:function(e,t){var n,o,r=this,a=r._formatKey(e);a&&(r._prepareForBindKey(),o=r._keyMap["key-"+e]={keyInfo:a,callback:t},n=r._matchCache,i.each(n,function(e){if(e&&e.eventInfo){var t,n=e.handlers;n?t=!0:(n={},t=!1),r._isMatch(e.eventInfo,a)&&(n[a.mark]=o,t=!0),t&&(e.handlers=n)}}))},unbind:function(e){var t=this._keyMap,n=this._matchCache,o="key-"+e;t&&t[o]&&delete t[o],i.each(n,function(e){var t=e.handlers;t&&t[o]&&delete t[o]})},unbindAll:function(){this._unbindEvents(),this._keyMap={},this._matchCache={}},clearCache:function(){this._matchCache={}}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(8),a=n(3);return t=o.extend({name:"atom.DeleteCodeText",_textBlock:null,_startLineIndex:null,_startLineCharIndex:null,_endLineIndex:null,_endLineCharIndex:null,_deletedText:null,_inlineStyles:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._textBlock=this.options.block,this.options.startBlockRange.hasOwnProperty("startLineCharIndex")?(this._startLineIndex=this.options.startBlockRange.startLineIndex,this._startLineCharIndex=this.options.startBlockRange.startLineCharIndex):(this._startLineIndex=this.options.endBlockRange.startLineIndex,this._startLineCharIndex=this.options.endBlockRange.startLineCharIndex),this.options.endBlockRange.hasOwnProperty("endLineCharIndex")?(this._endLineIndex=this.options.endBlockRange.endLineIndex,this._endLineCharIndex=this.options.endBlockRange.endLineCharIndex):(this._endLineIndex=this.options.startBlockRange.endLineIndex,this._endLineCharIndex=this.options.startBlockRange.endLineCharIndex),this._inlineStyles=this.options.inlineStyles),t.__super__.initialize.apply(this)},apply:function(){var e=this._textBlock,t=e.sliceText(this._startLineIndex,this._startLineCharIndex,this._endLineIndex,this._endLineCharIndex);return!!t&&(this._deletedText=t,e.deleteText(this._startLineIndex,this._startLineCharIndex,this._endLineIndex,this._endLineCharIndex),!0)},doUnapply:function(){var e=this._deletedText;this._textBlock&&this._deletedText&&this._textBlock.insertText(this._startLineIndex,this._startLineCharIndex,e)},fromCollabJSON:function(){var e=this.options.args,n=e.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),n&&(this._deletedText=r.fromCollabJSON(n.richText),this._textBlock=e.collabProperties.coreEditor.getBlockById(n.blockId),this._start=n.startPosition,this._end=n.endPosition)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._textBlock.getId(),e.richText=this._deletedText.toCollabJSON(),e.startPosition=this._start,e.endPosition=this._end,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(72),n(2),n(49),n(69),n(71),n(39),n(26),n(12),n(55),n(31),n(87)],void 0===(i=function(e,t,n,o,i,r,a,s,l,c,d,u,h){"use strict";return function(){function e(){}return e.buildBlockFromJSON=function(e,t){var p=null,g=e.type;switch(g){case o.PARAGRAPH:p=c.fromCollabJSON(e);break;case o.IMAGE:p=s.fromJSON(e);break;case o.ATTACHMENT:p=n.fromJSON(e);break;case o.LIST_ITEM:p=l.fromCollabJSON(e);break;case o.TABLE:p=d.fromJSON(e);break;case o.HR:p=a.fromCollabJSON(e);break;case o.HEADING:p=r.fromCollabJSON(e);break;case o.CATALOGUE:p=i.fromCollabJSON(e);break;case o.TODO:p=u.fromCollabJSON(e);break;case o.QUOTE:p=h.fromCollabJSON(e);break;default:throw new Error("unsupported type [ "+g+"] in buildBlockFromJSON")}return p},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(22),r=n(4),a=n(64),s=n(3);return t=i.extend({name:"atom.SetTableCellBlockStyle",_table:null,_rect:null,_type:null,effected:!1,_oldStyles:{},_styles:null,initialize:function(){var e=this.options.args;this._oldStyles={},s.isCollabCommand(e)||(this._table=this.options.table,this._styles=this.options.styles,this._toggle=this.options.toggle,this._rect=this.options.rect,this._type=this.options.type,this._default=this.options.default),this.type===a.TYPES.ALL&&(this._rect=this._rect||{top:0,left:0,width:this._table.getColumnCount(),height:this._table.getRowCount()}),t.__super__.initialize.apply(this)},apply:function(){var e,t,n,i,r,s,l,c,d=this._table,u=this._rect,h=this._styles||{},p=this._toggle,g=!1;if(!u)return this.effected;if(e=u.top+u.height,t=u.left+u.width,p){if(!(r=a.create({block:d,type:a.TYPES.NORMAL,rect:u})))return this.effected;if(!(s=r.getAsRectRange()))return this.effected;n=d.getCommonBlockStyle(p,s),h[p]=null!=n?!n:null==this._default||!this._default}for(i=o.keys(h),l=u.top;l<e;l++)for(c=u.left;c<t;c++)this._oldStyles[l+"-"+c]=d.getCellBlockStyles({row:l,col:c,names:i}),d.setCellBlockStyles({row:l,col:c,styles:h})&&(g=!0);return this.effected=g,this.effected},doUnapply:function(){var e,t,n=this._table,o=this._rect,i=o.top+o.height,r=o.left+o.width;for(e=o.top;e<i;e++)for(t=o.left;t<r;t++)n.setCellBlockStyles({row:e,col:t,styles:this._oldStyles[e+"-"+t]})},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._styles=o.styleNameValues,this._oldStyles=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2,this._toggle=o.newBlkId)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.styleNameValues=this._styles||null,e.oldStyleNameValues=this._oldStyles,e.simpleValue1=this._rect,e.simpleValue2=this._type,e.newBlkId=this._toggle||null,e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(3);return t=o.extend({name:"atom.SetListItemLevel",_listItems:null,_newLevels:null,_oldLevels:null,initialize:function(){var e=this,n=e.options,o=n.args;a.isCollabCommand(o)||(e._listItems=n.listItems,e._newLevels={},n.newLevel?r.each(e._listItems,function(t,o){e._newLevels[o]=n.newLevel}):n.deltaLevel&&r.each(e._listItems,function(t,o){e._newLevels[o]=t.getLevel()+n.deltaLevel})),t.__super__.initialize.apply(e)},apply:function(){var e=this;return e._oldLevels={},r.each(e._newLevels,function(t,n){e._oldLevels[n]=e._listItems[n].getLevel(),e._listItems[n].setLevel(t)}),!0},doUnapply:function(){var e=this;return r.each(e._oldLevels,function(t,n){e._listItems[n].setLevel(t)}),!0},fromCollabJSON:function(){var e,n=this,o=n.options.args,i=o.collabProperties.cmdJSON;i&&(e=o.collabProperties.coreEditor.getNote(),i.oldLevels&&(n._oldLevels=i.oldLevels),n._newLevels=i.newLevels,n._listItems=[],r.each(i.listItemIds,function(t){n._listItems.push(e.getBlockById(t))})),t.__super__.fromCollabJSON.apply(n)},toCollabJSON:function(){var e=[],n=t.__super__.toCollabJSON.apply(this);return this._oldLevels&&(n.oldLevels=this._oldLevels),n.newLevels=this._newLevels,r.each(this._listItems,function(t){e.push(t.getId())}),n.listItemIds=e,n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(25);return function(e,n){if(!e||!n)return e;var i=o(e),r=i.querySelectorAll("img[data-media-type=attachment]"),a=i.querySelectorAll("img[data-media-type=image]"),s=function(e,n){t.each(e,function(e,t){e&&n.setAttribute(t,e)})};return t.each(r,function(e){var t=e.getAttribute("src"),o=e.getAttribute("path"),i=e.getAttribute("filelength"),r=e.getAttribute("filename"),a={"data-res-id":o,src:n[t],"data-attr-org-src-id":t,"data-attr-org-img-file":n[t],"data-file-name":r,"data-file-length":i,class:"editor-attachment"};s(a,e)}),t.each(a,function(e){var t=e.getAttribute("src"),o={src:n[t],"data-attr-org-src-id":t};s(o,e)}),i.innerHTML}}.call(t,n,t,e))||(e.exports=o)},function(e,t){e.exports="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PCFET0NUWVBFIHN2ZyBQVUJMSUMgIi0vL1czQy8vRFREIFNWRyAxLjEvL0VOIiAiaHR0cDovL3d3dy53My5vcmcvR3JhcGhpY3MvU1ZHLzEuMS9EVEQvc3ZnMTEuZHRkIj48c3ZnIHdpZHRoPSIyNTYiIGhlaWdodD0iMjQ0IiB2aWV3Qm94PSIwIDAgMjU2IDI0NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWFsaWduX2NlbnRlciIgeD0iMTM2IiB5PSIxNDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNNS41ODMgN0gxMlY2SDV2MWguNTgzek01LjU4MyAxMUgxMnYtMUg1djFoLjU4M3pNNS4zMTggMTVIMTJ2LTFINXYxaC4zMTh6TTIuNTkgMTNIMTV2LTFIMnYxaC41OXpNMi41OSA5SDE1VjhIMnYxaC41OXpNNS41ODMgM0gxMlYySDV2MWguNTgzek0yLjU5IDVIMTVWNEgydjFoLjU5eiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWFsaWduX2p1c3RpZnkiIHg9IjE1OCIgeT0iMTQwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgZmlsbD0iIzUyNUM2RiI+PHBhdGggZD0iTTMuMDgzIDlIMTVWOEgydjFoMS4wODN6TTMuMDgzIDEzSDE1di0xSDJ2MWgxLjA4M3pNMi41OSAxNUgxNXYtMUgydjFoLjU5ek0yLjU5IDExSDE1di0xSDJ2MWguNTl6TTIuNTkgN0gxNVY2SDJ2MWguNTl6TTMuMDgzIDVIMTVWNEgydjFoMS4wODN6TTIuNTkgM0gxNVYySDJ2MWguNTl6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tYWxpZ25fbGVmdCIgeD0iMTkwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgZmlsbD0iIzUyNUM2RiI+PHBhdGggZD0iTTIuNTgzIDlIOVY4SDJ2MWguNTgzek0yLjU4MyAxM0g5di0xSDJ2MWguNTgzek0yLjU5IDE1SDE1di0xSDJ2MWguNTl6TTIuNTkgMTFIMTV2LTFIMnYxaC41OXpNMi41OSA3SDE1VjZIMnYxaC41OXpNMi41ODMgNUg5VjRIMnYxaC41ODN6TTIuNTkgM0gxNVYySDJ2MWguNTl6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tYWxpZ25fcmlnaHQiIHg9IjE5MCIgeT0iMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNOC41ODMgOUgxNVY4SDh2MWguNTgzek04LjU4MyAxM0gxNXYtMUg4djFoLjU4M3pNMi41OSAxNUgxNXYtMUgydjFoLjU5ek0yLjU5IDExSDE1di0xSDJ2MWguNTl6TTIuNTkgN0gxNVY2SDJ2MWguNTl6TTguNTgzIDVIMTVWNEg4djFoLjU4M3pNMi41OSAzSDE1VjJIMnYxaC41OXoiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1hdHRhY2htZW50IiB4PSIxOTAiIHk9IjQ0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTMuMzYzIDE1LjM2NGwtLjAwNi0uMDA1YTMuMDkgMy4wOSAwIDAgMS0uMzc0LTQuMzRsNS4yNDQtNi4yNWMxLjUxMi0xLjgwMiA0LjE2MS0yLjA3OSA1LjkwNS0uNjE1IDEuNzI0IDEuNDQ2IDEuODk2IDQuMDkuMzg0IDUuODkxbC0zLjgyIDQuNTUyYS40OC40OCAwIDEgMS0uNzM3LS42MTlsMy44Mi00LjU1MWMxLjE5LTEuNDIgMS4wNzQtMy40MTItLjI2Ni00LjUzNi0xLjMzNi0xLjEyMi0zLjM3OC0uOS00LjU0OS40OTZsLTUuMjQ0IDYuMjVhMi4xMjYgMi4xMjYgMCAwIDAgLjI1NyAyLjk4NmwuMDA1LjAwNGMuNDM2LjM2Ni45OTIuNTQxIDEuNTY0LjQ5MmEyLjEzIDIuMTMgMCAwIDAgMS40Ni0uNzU3bDUuMjIzLTYuMjI1Yy4xOTktLjIzNy4yOTMtLjUzNi4yNjYtLjg0M2ExLjE0IDEuMTQgMCAwIDAtLjQwNy0uNzgybC0uMDAyLS4wMDJhMS4xNDcgMS4xNDcgMCAwIDAtLjg0My0uMjYyIDEuMTQ1IDEuMTQ1IDAgMCAwLS43ODMuNDFMNi4yNjQgMTEuNjlhLjQ4Mi40ODIgMCAwIDEtLjc0LS42MTZMOS43MjMgNi4wNGEyLjEgMi4xIDAgMCAxIDEuNDM1LS43NTJjLjU2My0uMDUgMS4xMTEuMTIxIDEuNTQ2LjQ4M2wuMDA0LjAwM2MuNDMyLjM2My42OTcuODcyLjc0NiAxLjQzNWEyLjA5OSAyLjA5OSAwIDAgMS0uNDg2IDEuNTQ3TDcuNzQzIDE0Ljk4YTMuMDg2IDMuMDg2IDAgMCAxLTIuMTE1IDEuMDk2IDMuMDg1IDMuMDg1IDAgMCAxLTIuMjY1LS43MTMiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMTgiIGhlaWdodD0iMjQiIHZpZXdCb3g9Ii0yIC0yIDE4IDI0IiBpZD0ic3JjLS1zdmctLWF0dGFjdGhtZW50X2Rvd25sb2FkIiB4PSIxNTYiIHk9IjExNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNOCA5VjBINnY5SDJsNSA1Ljg3TDEyIDlIOHptLTggOWgxNHYySDB2LTJ6IiBmaWxsPSIjNTU1IiBmaWxsLXJ1bGU9ImV2ZW5vZGQiLz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tYXV0b193cmFwIiB4PSIxOTAiIHk9IjY2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZmlsbD0iIzUyNUM2RiIgZD0iTTIgMmgxNHYxSDJ6TTggMTUuMDAxdjFoMXYxaDFWMTJIOXYxLjAwMUg4djFIN3YxaDF6TTIgNmgxNHYxSDJ6TTIgMTBoMTJ2MUgyek0yIDE0aDN2MUgyek0xMCAxNGg0djFoLTR6Ii8+PHBhdGggZmlsbD0iI0JEQzFDOCIgZD0iTTE1IDEwaDF2MWgtMXpNMTUgMTRoMXYxaC0xeiIvPjxwYXRoIGZpbGw9IiM2ODZGN0UiIGQ9Ik0xNCAxMGgxdjFoLTF6Ii8+PHBhdGggZmlsbD0iIzZFNzc4OSIgZD0iTTE0IDE0aDF2MWgtMXoiLz48cGF0aCBmaWxsPSIjNTI1QzZGIiBkPSJNMTUgMTFoMXYxaC0xek0xNSAxMmgxdjFoLTF6TTE1IDEzaDF2MWgtMXoiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWJvbGQiIHg9IjE5MCIgeT0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNSAxNFYzaDUuMDRjMS4xIDAgMS45MzkuMjU4IDIuNTY0Ljc5LjYwNi41MTIuODcyIDEuMjMuODcyIDIuMTkyIDAgMS40MjctMS4xIDIuMDczLTEuNDE5IDIuMjU3LjQ4OC4xNyAxLjA2NS42ODkgMS4zNSAxLjAzMy4zODUuNDY2LjU1IDEuMDM5LjU1IDEuOCAwIDEuMTItLjMxNCAxLjgyMi0xLjEgMi4zNjgtLjY1Ny40MzctMS42NTQuNTYtMi44MTcuNTZINXoiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBkPSJNNi41MTcgMTNoMy40MTVjLjc0Mi4wMSAyLjcyNS0uMjI0IDIuNzI1LTIuMDYyQzEyLjY1NyA5LjEwMSAxMC42NyA5IDkuOTMyIDlINi41MTd2NHpNNi41MTcgNy43MDFoMy4xNmMuNjg3LjAwOSAyLjUyMi0uMjA3IDIuNTIyLTEuOTA3UzEwLjM1OSA0IDkuNjc3IDRoLTMuMTZ2My43MDF6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1ib3JkZXJfY29sb3IiIHg9IjE5MCIgeT0iMTEwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTE0IDEzSDNWM2g3VjJIMnYxM2gxM3YtMmgtMXYxaDFWN2gtMXY2eiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGQ9Ik0yIDEzaDEzdjJIMnoiLz48cGF0aCBmaWxsPSIjQUNCNEM0IiBkPSJNMTQgMmgxdjFoLTF6Ii8+PHBhdGggZmlsbD0iIzUyNUM2RiIgZD0iTTExIDRoM3YxaC0zek0xMCA1aDN2MWgtM3pNOSA2aDN2MUg5ek04IDdoM3YxSDh6TTcgOGgzdjFIN3pNNyA5aDJ2MUg3eiIvPjxwYXRoIGQ9Ik0xNCAzVjJoLTF2MWgtMXYxaDF2MWgxVjRoMVYzaC0xeiIgZmlsbD0iIzUyNUM2RiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIxNyIgaGVpZ2h0PSIxNSIgdmlld0JveD0iLTIgLTIgMTcgMTUiIGlkPSJzcmMtLXN2Zy0tY2F0YWxvZ3VlIiB4PSIxMzYiIHk9IjEwMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjNTI1QzZGIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xIDF2MmgyVjFIMXpNMCAwaDR2NEgwVjB6bTAgN2g0djRIMFY3em0xIDF2MmgyVjhIMXoiIGZpbGwtcnVsZT0ibm9uemVybyIvPjxwYXRoIGQ9Ik01IDBoOHYxSDV6TTUgM2g1djFINXpNNSA3aDh2MUg1ek01IDEwaDV2MUg1eiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iLTIgLTIgMjQgMjQiIGlkPSJzcmMtLXN2Zy0tY2F0YWxvZ3VlLXJlZnJlc2giIHg9IjEyMiIgeT0iNzYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PHBhdGggZD0iTTE1LjkzIDlBNy4wMDIgNy4wMDIgMCAwIDAgMiAxMGE3IDcgMCAwIDAgMTAuNjI0IDUuOTlsMS4wMzggMS43MUE5IDkgMCAxIDEgMTcuOTQ1IDlIMjBsLTMgMy45NjFMMTQgOWgxLjkzeiIgZmlsbD0iIzU5NTk1OSIgZmlsbC1ydWxlPSJub256ZXJvIi8+PC9zdmc+PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9Ii0yIC0yIDI0IDI0IiBpZD0ic3JjLS1zdmctLWNhdGFsb2d1ZV9yZW1vdmUiIHg9Ijg4IiB5PSIzOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTAuMzY0IDguOTVMNS40MTQgNCA0IDUuNDE0bDQuOTUgNC45NUw0IDE1LjMxNGwxLjQxNCAxLjQxNCA0Ljk1LTQuOTUgNC45NSA0Ljk1IDEuNDE0LTEuNDE0LTQuOTUtNC45NSA0Ljk1LTQuOTVMMTUuMzE0IDRsLTQuOTUgNC45NXoiIGZpbGw9IiM1OTU5NTkiIGZpbGwtcnVsZT0iZXZlbm9kZCIvPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1jaGVja2VkIiB4PSIxOTAiIHk9IjEzMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xNiA0bC04Ljg0NyA5LjcxOEwzIDguOTQ4aC42NzJsMy40ODEgMi4wMzFMMTUuMTQ3IDRIMTZ6IiBmaWxsPSIjNTI1QzZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1jbGVhbl9mb3JtYXQiIHg9IjE5MCIgeT0iMTU0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTE2LjYwOCAzaC02LjQ5Yy0uMjcyIDAtLjYxNi4xOTEtLjc1NC40MjdMMi4xMiAxNC4xMzdjLS4yNzkuNDc3LS4wNTUuODYzLjUuODYzaDYuNDljLjI3MSAwIC42MTUtLjE5MS43NTItLjQyN2w3LjI0NS0xMC43MWMuMjgtLjQ3Ny4wNTUtLjg2My0uNDk5LS44NjN6IiBmaWxsPSIjQ0JDQkNCIi8+PHBhdGggZD0iTTkuMDMgMTRIMy40NWwzLjM4Mi01aDUuNjAzTDkuMDMgMTR6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1jbGVhbl9mb3JtYXRfYWN0aXZlIiB5PSIxNzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTYuNjA4IDNoLTYuNDljLS4yNzIgMC0uNjE2LjE5MS0uNzU0LjQyN0wyLjEyIDE0LjEzN2MtLjI3OS40NzctLjA1NS44NjMuNS44NjNoNi40OWMuMjcxIDAgLjYxNS0uMTkxLjc1Mi0uNDI3bDcuMjQ1LTEwLjcxYy4yOC0uNDc3LjA1NS0uODYzLS40OTktLjg2M3oiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBkPSJNOS4wMyAxNEgzLjQ1bDMuMzgyLTVoNS42MDNMOS4wMyAxNHoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+PHN2ZyBjbGFzcz0iYXBpY29uIiB2aWV3Qm94PSItMiAtMiAxMTAyIDEwMjgiIHdpZHRoPSIxNyIgaGVpZ2h0PSIxNyIgaWQ9InNyYy0tc3ZnLS1jb2RlIiB4PSIxMzYiIHk9IjExNyIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48c3R5bGUvPjwvZGVmcz48cGF0aCBkPSJNMzUyLjU0OSA3OTkuNDUxbC0yOC42IDI4LjZxLTUuNzA0IDUuNzA0LTEzLjE2NSA1LjcwNHQtMTMuMTY2LTUuNzA1TDMxLjMwNSA1NjEuNzM3cS01LjcwNS01LjcwNS01LjcwNS0xMy4xNjZ0NS43MDUtMTMuMTY1bDI2Ni4zMTMtMjY2LjMxM3E1LjcwNS01LjcwNiAxMy4xNjYtNS43MDZ0MTMuMTY2IDUuNzA2bDI4LjU5OSAyOC41OThxNS43MDUgNS43MDYgNS43MDUgMTMuMTY2dC01LjcwNSAxMy4xNjZMMTI4IDU0OC41NyAzNTIuNTQ5IDc3My4xMnE1LjcwNSA1LjcwNSA1LjcwNSAxMy4xNjZ0LTUuNzA1IDEzLjE2NXptMzM3Ljc3My02MDkuNzE4TDQ3Ny4xODQgOTI3LjQ1cS0yLjI2NyA3LjQ2MS04Ljg1IDExLjExOHQtMTMuNDU5IDEuNDYzbC0zNS40LTkuNzI4cS03LjQ2MS0yLjI2Ny0xMS4xMTgtOC44NXQtMS40NjMtMTMuOTdsMjEzLjEzOC03MzcuNzJxMi4yNjctNy40NiA4Ljg1LTExLjExN3QxMy40NTktMS40NjNsMzUuNCA5LjcyOHE3LjQ2MSAyLjI2NyAxMS4xMTggOC44NXQxLjQ2MyAxMy45N3ptMzc1LjM3IDM3Mi4wMDRMNzk5LjM3NyA4MjguMDVxLTUuNzA1IDUuNzA1LTEzLjE2NSA1LjcwNXQtMTMuMTY2LTUuNzA1bC0yOC41OTktMjguNTk5cS01LjcwNS01LjcwNS01LjcwNS0xMy4xNjV0NS43MDUtMTMuMTY2bDIyNC41NDktMjI0LjU0OS0yMjQuNTQ5LTIyNC41NDhxLTUuNzA1LTUuNzA1LTUuNzA1LTEzLjE2NnQ1LjcwNS0xMy4xNjZsMjguNTk5LTI4LjU5OHE1LjcwNS01LjcwNiAxMy4xNjYtNS43MDZ0MTMuMTY1IDUuNzA2bDI2Ni4zMTMgMjY2LjMxM3E1LjcwNiA1LjcwNSA1LjcwNiAxMy4xNjV0LTUuNzA2IDEzLjE2NnoiIGZpbGw9IiMyYzJjMmMiLz48L3N2Zz48c3ZnIHdpZHRoPSI5IiBoZWlnaHQ9IjciIHZpZXdCb3g9Ii0yIC0yIDkgNyIgaWQ9InNyYy0tc3ZnLS1jb21ib19leHBhbmQiIHg9IjE3NCIgeT0iMTMxIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTMgMWgyVjBIMHYxaDItMXYxaDF2MWgxVjJoMVYxSDN6IiBmaWxsPSIjOTA5OEE4Ii8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1leHBvcnQiIHg9IjIyIiB5PSIxNzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1YzZmIj48cGF0aCBkPSJNMTQgOS42NDdsLS4wMDItMi4yOEwxMC42MTYgNEg0Yy4wMDMgMCAwIDExLjAwMSAwIDExLjAwMUM0IDE0Ljk5OCA5IDE1IDkgMTV2MUg0LjAxQzMuNDUxIDE2IDMgMTUuNTUzIDMgMTUuMDAxVjRDMyAzLjQ0NyAzLjQ1NSAzIDQgM2g3LjAyN0wxNSA2Ljk1NHYyLjY5M2gtMXoiLz48cGF0aCBkPSJNNyAxMmg1djJIN3pNMTEgM2w0IDRoLTRWM3pNMTIgMTBWMTZoMXYtLjg1N2gxdi0uODU3aDF2LS44NTdoMXYtLjg1N2gtMXYtLjg1OGgtMXYtLjg1N2gtMVYxMGgtMXoiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1maXhlZF90b3AiIHg9IjQ0IiB5PSIxNzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxsPSIjNTI1QzZGIiBkPSJNMyAyaDExdjFIM3pNMTEgOXY2SDZWOWgxbC4wMDQgNSAyLjk5Ni4wMTJWOWgxek05IDZoMVY1SDl2MXpNNyA2aDFWNUg3djF6Ii8+PHBhdGggZD0iTTYgN2gxLjAwMVY1Ljk5OUg2Vjd6TTggNWgxVjRIOHYxeiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik04IDZoMVY1SDh2MXpNOSA3aDFWNkg5djF6TTEwIDhoMVY3aC0xdjF6TTExIDloMVY4aC0xdjF6TTcgN2gxVjZIN3Yxek02IDhoMVY3SDZ2MXpNNSA5aDFWOEg1djF6IiBmaWxsPSIjOTU5REFCIi8+PHBhdGggZD0iTTUgOGgxVjdINXYxek00IDloMVY4SDR2MXpNMyAxMGg0VjlIM3Yxek0xMCA3aDFWNS45OTloLTFWN3pNMTEgOGgxVjdoLTF2MXpNMTIgOWgxVjhoLTF2MXpNMTAgMTBoNFY5aC00djF6IiBmaWxsPSIjNTI1QzZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1mb3JtYXRfcGFpbnRlciIgeD0iNjYiIHk9IjE3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zIDJ2NWgxMFYySDN6IiBmaWxsPSIjNTI1QzZGIi8+PHBhdGggZD0iTTQgM2g4djNINFYzeiIgZmlsbD0iI0ZGRiIvPjxwYXRoIGQ9Ik00IDZoOFY1SDR2MXoiIGZpbGw9IiNCQUJGQ0EiLz48cGF0aCBkPSJNMTQgNXYzSDh2Mkg3djZoM3YtNkg5VjloNlY1aC0xeiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik04IDExaDF2NEg4di00eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0taHIiIHg9Ijg4IiB5PSIxNzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxsPSIjNTI1QzZGIiBkPSJNMiA5aDE0djFIMnoiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWltYWdlIiB4PSIxMTAiIHk9IjE3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zLjAwNyAzQzIuNDUgMyAyIDMuNDQ5IDIgNHYxMS4wMDNjMCAuNTUuNDUxLjk5OCAxLjAwNy45OThoMTEuOTg2Yy41NTcgMCAxLjAwNy0uNDQ3IDEuMDA3LS45OThWMy45OTlDMTYgMy40NDggMTUuNTQ5IDMgMTQuOTkzIDNIMy4wMDd6IiBmaWxsPSIjNTI1QzZGIi8+PHBhdGggZD0iTTE1IDE1LjAwMkMxNSAxNC45OTggMy4wMDcgMTUgMy4wMDcgMTUgMy4wMDEgMTUgMyAzLjk5OCAzIDMuOTk4IDMgNCAxNC45OTMgNCAxNC45OTMgNCAxNC45OTkgNCAxNSAxNS4wMDMgMTUgMTUuMDAzeiIgZmlsbD0iI0ZGRiIvPjxwYXRoIGQ9Ik0xMy45NzcgMTFhMi44MDcgMi44MDcgMCAwIDEtMS44MzEuNjg3QTIuODMgMi44MyAwIDAgMSA5LjUxIDkuODc2Yy0uMDA2LjAwMi0uMDExLjAwNy0uMDE4LjAwOUEyLjgyNSAyLjgyNSAwIDAgMCA2LjgzMiA4IDIuODMzIDIuODMzIDAgMCAwIDQgMTAuODMzYzAgLjA1Ny4wMTQuMTExLjAxNy4xNjdINHYzaDEwdi0zaC0uMDIzek0xMiA5YTEuNSAxLjUgMCAxIDAtLjAwMS0zLjAwMUExLjUgMS41IDAgMCAwIDEyIDkiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iNTQiIGhlaWdodD0iNjQiIHZpZXdCb3g9Ii0yIC0yIDU0IDY0IiBpZD0ic3JjLS1zdmctLWltYWdlX2Vycm9yIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9IiNERURFREUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTQyLjA5MSA0MS4xNjFsLTUuMDU1IDUuMDUyLTUuMDU2LTUuMDUyLTUuMDU1IDUuMDUyLTUuMDU2LTUuMDUyLTUuMDU2IDUuMDUyLTUuMDU1LTUuMDUyLTUuMDU1IDUuMDUyLTUuMDU2LTUuMDUydjE1LjM0YTEuNSAxLjUgMCAwIDAgMS41IDEuNWg0Mi41YTEuNSAxLjUgMCAwIDAgMS41LTEuNVY0Ni4yMTJsLTUuMDU2LTUuMDUyek0yMS44NyA0Mi41NzVsNC4zNSA0LjM0Ni43MDYuNzA2LjcwNy0uNzA2IDQuMzQ4LTQuMzQ2IDQuMzUgNC4zNDYuNzA2LjcwNi43MDctLjcwNiA0LjM0OC00LjM0NiA0LjA1NiA0LjA1M1Y1Ni41YS41LjUgMCAwIDEtLjUuNWgtNDIuNWEuNS41IDAgMCAxLS41LS41VjQzLjU3NGwzLjM0OSAzLjM0Ny43MDcuNzA2LjcwNy0uNzA2IDQuMzQ4LTQuMzQ2IDQuMzQ5IDQuMzQ2LjcwNi43MDYuNzA3LS43MDYgNC4zNDktNC4zNDZ6Ii8+PHBhdGggZD0iTTQ1LjY0NyAxLjVoLTQyLjVhMS41IDEuNSAwIDAgMC0xLjUgMS41djMzLjM5bDUuMDU1IDUuMDUyIDUuMDU2LTUuMDUyIDUuMDU1IDUuMDUyIDUuMDU2LTUuMDUyIDUuMDU2IDUuMDUyIDUuMDU1LTUuMDUyIDUuMDU1IDUuMDUyIDUuMDU2LTUuMDUyIDUuMDU2IDUuMDUyVjNhMS41IDEuNSAwIDAgMC0xLjUtMS41bTAgMWEuNS41IDAgMCAxIC41LjV2MzYuMDNsLTMuMzQ5LTMuMzQ4LS43MDctLjcwNi0uNzA3LjcwNi00LjM0OSA0LjM0Ni00LjM0OC00LjM0Ni0uNzA3LS43MDYtLjcwNy43MDYtNC4zNDggNC4zNDYtNC4zNS00LjM0Ni0uNzA2LS43MDYtLjcwNy43MDYtNC4zNDkgNC4zNDYtNC4zNDgtNC4zNDYtLjcwNy0uNzA2LS43MDcuNzA2LTQuMzQ5IDQuMzQ2LTQuMDU1LTQuMDUzVjNhLjUuNSAwIDAgMSAuNS0uNWg0Mi41Ii8+PHBhdGggZD0iTTE4LjIxOCAxNS44ODdhMy4xMTIgMy4xMTIgMCAxIDEgMC02LjIyMyAzLjExMiAzLjExMiAwIDAgMSAwIDYuMjIzTTQwLjAyOCAyNy44NzdMMjkuOTMxIDE1Ljc0YTEuMTIgMS4xMiAwIDAgMC0xLjcyMyAwbC02LjY3NSA4LjAyNGExLjEyIDEuMTIgMCAwIDEtMS43MjMgMGwtMi4zNjItMi44NGExLjEyIDEuMTIgMCAwIDAtMS43MjMgMEw5Ljk0IDI3Ljg3N2EuOTEyLjkxMiAwIDAgMCAuNzAxIDEuNDk1aDI4LjY4NmEuOTEyLjkxMiAwIDAgMCAuNzAxLTEuNDk1Ii8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1pbmRlbnQiIHg9IjEzMiIgeT0iMTc4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgZmlsbD0iIzUyNUM2RiI+PHBhdGggZD0iTTkuNDE3IDEySDE0di0xSDl2MWguNDE3ek0yLjU5IDE1SDE1di0xSDJ2MWguNTl6TTkuMjI3IDEwSDE0VjlIOXYxaC4yMjd6TTkuNDE3IDZIMTRWNUg5djFoLjQxN3pNOS40MTcgOEgxNFY3SDl2MWguNDE3ek0yLjU5IDNIMTVWMkgydjFoLjU5ek0zIDZWMTFoMXYtLjk5OWgxdi0xaDF2LTFINXYtMUg0VjZIM3oiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1pbmxpbmVfaGVpZ2h0IiB4PSIxNTQiIHk9IjE3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiM1MjVDNkYiPjxwYXRoIGQ9Ik04LjY2NyAxM0gxNnYtMUg4djFoLjY2N3pNMyAydjFIMnYxSDF2MWgydjdIMXYxaDF2MWgxdjFoMXYtMWgxdi0xaDEuMDAxdi0xSDRWNWgyLjAwMVY0SDVWM0g0VjJIM3pNOC42NjcgMTFIMTZ2LTFIOHYxaC42Njd6TTguNjY3IDlIMTZWOEg4djFoLjY2N3pNOC4xODIgMTVIMTJ2LTFIOHYxaC4xODJ6TTguMzY0IDdIMTZWNkg4djFoLjM2NHpNOC42NjcgNUgxNlY0SDh2MWguNjY3ek04LjM2NCAzSDE2VjJIOHYxaC4zNjR6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0taXRhbGljIiB4PSIxNzYiIHk9IjE3OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik04LjIzOSAzbC0uMTg2Ljk5NWgxLjM4NUw3LjY3NSAxMy4wMWgtMS4yMWwtLjE5Mi45OUgxMC4wNDNsLjIxNy0uOTlIOC44NGwxLjc3My05LjAxNWgxLjI1OEwxMi4wODIgM0g4LjIzOXoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWxpbmVfdGhyb3VnaCIgeD0iMjEyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTEwLjk2NyAzLjgxNmMuNzEyLjU2MyAxLjExMyAxLjQwOCAxLjIxNiAyLjUyaC0xLjJjLS4xMzQtLjc3LS40My0xLjMzNC0uODktMS43MDUtLjQ3NS0uMzg1LTEuMTQxLS41NjMtMi4wMDItLjU2My0uNzg1IDAtMS4zOTMuMTE4LTEuODM3LjM4NS0uNTA0LjI5Ny0uNzU2Ljc0MS0uNzU2IDEuMzUgMCAuNTMzLjI5Ni45NjMuOTAzIDEuMjg5LjI2Ny4xNDguOTIuMzcgMS45NDIuNjY2IDEuMzk0LjQxNiAyLjMxMy43NTcgMi43NTggMS4wMjQuODc0LjUzNCAxLjMyIDEuMjc1IDEuMzIgMi4yMzggMCAuOTItLjM3MiAxLjY2LTEuMTEyIDIuMTk0LS43NDIuNTItMS43MzUuNzg1LTIuOTk1Ljc4NS0xLjI0NiAwLTIuMjIzLS4yNjYtMi45MzUtLjgtLjgzLS42MzctMS4yOS0xLjYwMS0xLjM4LTIuOTA1aDEuMjAyYy4xMDMuOTIuNDMgMS42Ljk2MyAyLjAzLjQ5LjM4NiAxLjIuNTk0IDIuMTUuNTk0Ljg2IDAgMS41NzItLjE2MyAyLjEwNS0uNDkuNTMzLS4zMjYuOC0uNzcuOC0xLjMzNCAwLS42NjctLjM1Ni0xLjE4NS0xLjA1Mi0xLjU1Ni0uMjk3LS4xNzgtMS4wNTMtLjQzLTIuMjM5LS43Ny0xLjI3NS0uMzg2LTIuMDktLjY4My0yLjQzLS44Ni0uODE2LS40NzUtMS4yMTYtMS4xNTgtMS4yMTYtMi4wNDcgMC0uOTE5LjM4NS0xLjY0NSAxLjE3MS0yLjE1QzYuMTQ5IDMuMjM4IDcuMDU0IDMgOC4xNTEgM2MxLjE4NiAwIDIuMTM0LjI2NyAyLjgxNi44MTYiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBmaWxsPSIjNTI1QzZGIiBkPSJNMiA4aDEzdjFIMnoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMyA5aDkuOTgzdi41SDN6Ii8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1saW5rIiB4PSIyMTIiIHk9IjIyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgZmlsbD0iIzUyNUM2RiI+PHBhdGggZD0iTTcuMTI1IDEzLjJINS42QTMuNjA0IDMuNjA0IDAgMCAxIDIgOS42QzIgNy42MTUgMy42MTUgNiA1LjYgNmgyYzEuOTg1IDAgMy42IDEuNjE1IDMuNiAzLjZhLjYuNiAwIDEgMS0xLjIgMGMwLTEuMzIzLTEuMDc3LTIuNC0yLjQtMi40aC0yYTIuNDAzIDIuNDAzIDAgMCAwLTIuNCAyLjRjMCAxLjMyMyAxLjA3NyAyLjQgMi40IDIuNGgxLjUyNWEuNi42IDAgMSAxIDAgMS4yIi8+PHBhdGggZD0iTTEyLjYgMTMuMmgtMkEzLjYwNCAzLjYwNCAwIDAgMSA3IDkuNmEuNi42IDAgMSAxIDEuMiAwYzAgMS4zMjMgMS4wNzcgMi40IDIuNCAyLjRoMmMxLjMyMyAwIDIuNC0xLjA3NyAyLjQtMi40cy0xLjA3Ny0yLjQtMi40LTIuNGgtMS41MjVhLjYuNiAwIDAgMSAwLTEuMkgxMi42YzEuOTg1IDAgMy42IDEuNjE1IDMuNiAzLjZzLTEuNjE1IDMuNi0zLjYgMy42Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tbGlzdF9vbCIgeD0iMjEyIiB5PSI0NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yIDd2MWgxdjFIMnYxaDNWOUg0VjhoMVY3SDJ6TTIgMnYxaDF2MmgxVjJIMnpNMiAxMnYxaDJ2MUgydjFoM3YtM0gyeiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGZpbGw9IiNBOUFFQjciIGQ9Ik0zIDEzaDF2MUgzeiIvPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGQ9Ik03IDhoOHYxSDd6TTcgMTNoOHYxSDd6TTcgM2g4djFIN3oiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLWxpc3RfdWwiIHg9IjIxMiIgeT0iNjYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNMiAxMmgydjJIMnpNMiA3aDJ2Mkgyek0yIDJoMnYySDJ6TTYgM2g5djFINnpNNiA4aDl2MUg2ek02IDEzaDl2MUg2eiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTciIHZpZXdCb3g9Ii0yIC0yIDE2IDE3IiBpZD0ic3JjLS1zdmctLW5vcm1hbF9tb2RlIiB4PSIxNzQiIHk9IjExNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMSAxMi4wMDFMMTAuOTk4IDEyQzEwLjk5NiAxMiAxMSAuOTk5IDExIC45OTlMMS4wMDIgMUMxLjAwNCAxIDEgMTIuMDAxIDEgMTIuMDAxek0xLjAwMiAwaDkuOTk2QTEgMSAwIDAgMSAxMiAuOTk5VjEyYzAgLjU1Mi0uNDU2Ljk5OS0xLjAwMi45OTlIMS4wMDJBMSAxIDAgMCAxIDAgMTIuMDAxVjFDMCAuNDQ3LjQ1NiAwIDEuMDAyIDB6TTMuNSAzSDlWMkgzdjFoLjV6bTAgMkg5VjRIM3YxaC41em0wIDJIOVY2SDN2MWguNXptMCAySDlWOEgzdjFoLjV6bTAgMkg5di0xSDN2MWguNXoiIGZpbGwtcnVsZT0ibm9uemVybyIgZmlsbD0iIzUyNUM2RiIvPjwvc3ZnPjxzdmcgd2lkdGg9IjE3IiBoZWlnaHQ9IjE3IiB2aWV3Qm94PSItMiAtMiAxNyAxNyIgaWQ9InNyYy0tc3ZnLS1ub3RlX2JhY2tncm91bmQiIHg9IjY2IiB5PSIyMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNiAxaDF2MUg2VjF6TTUgMmgxdjFINVYyek00IDNoMXYxSDRWM3pNMyA0aDF2MUgzVjR6TTIgNWgxdjFIMlY1ek0xIDZoMXYxSDFWNnpNMCA3aDF2MUgwVjd6bTQtN2gxdjFINFYwek0zIDFoMXYxSDNWMXpNMiAyaDF2MUgyVjJ6TTEgM2gxdjFIMVYzek0wIDRoMXYxSDBWNHptNC01SDNoMXpNMSAwaDF2MUgxVjB6TTAgMWgxdjFIMFYxem04IDFoMXYxSDhWMnptMS0xaDF2MUg5VjF6bTEtMWgxdjFoLTFWMHpNNyAzaDF2MUg3VjN6TTYgNGgxdjFINlY0ek01IDVoMXYxSDVWNXpNNCA2aDF2MUg0VjZ6TTMgN2gxdjFIM1Y3ek0xIDloMXYxSDFWOXptLTEgMWgxdjFIMHYtMXptNC0xaDF2MUg0Vjl6bTItMmgxdjFINlY3em0xLTFoMXYxSDdWNnptLTQgNGgxdjFIM3YtMXptLTEgMWgxdjFIMnYtMXptNS0yaDF2MUg3Vjl6bS0xIDFoMXYxSDZ2LTF6bS0xIDFoMXYxSDV2LTF6bTQtNGgxdjFIOVY3em0xLTFoMXYxaC0xVjZ6bTEtMWgxdjFoLTFWNXpNOSA0aDF2MUg5VjR6bTEtMWgxdjFoLTFWM3ptMS0xaDF2MWgtMVYyem0wIDdoMXYxaC0xVjl6bS0xIDFoMXYxaC0xdi0xem0tMSAxaDF2MUg5di0xek0yIDhoMXYxSDJWOHoiIGZpbGw9IiNCOUJFQzkiLz48cGF0aCBkPSJNMSAxdjExaDExVjFIMXpNMCAwaDEzdjEzSDBWMHoiIGZpbGw9IiM1MjVDNkYiIGZpbGwtcnVsZT0ibm9uemVybyIvPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTggMHYxMmgxVjB6Ii8+PHBhdGggZmlsbD0iIzUyNUM2RiIgZmlsbC1ydWxlPSJub256ZXJvIiBkPSJNMCA5aDEzVjhIMHoiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLW91dGRlbnQiIHg9IjIxMiIgeT0iODgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNMy40MTcgMTJIOHYtMUgzdjFoLjQxN3pNMi41OSAxNUgxNXYtMUgydjFoLjU5ek0zLjIyNyAxMEg4VjlIM3YxaC4yMjd6TTMuNDE3IDZIOFY1SDN2MWguNDE3ek0zLjQxNyA4SDhWN0gzdjFoLjQxN3pNMi41OSAzSDE1VjJIMnYxaC41OXpNMTQgNlYxMWgtMXYtLjk5OWgtMXYtMWgtMXYtMWgxdi0xaDFWNmgxeiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTciIHZpZXdCb3g9Ii0yIC0yIDE2IDE3IiBpZD0ic3JjLS1zdmctLXBhZ2VfbW9kZSIgeD0iODMiIHk9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMSAuOTk5VjEyTDEuMDAyIDEyaDkuOTk2Yy0uMDAyIDAgLjAwMi0uMDA0LjAwMi4wMDFWMUwxMC45OTggMUgxLjAwMkMxLjAwNCAxIDEgMS4wMDQgMSAuOTk5bS0xIDBDMCAuNDQ3LjQ1NiAwIDEuMDAyIDBoOS45OTZBMSAxIDAgMCAxIDEyIC45OTlWMTJjMCAuNTUyLS40NTYuOTk5LTEuMDAyLjk5OUgxLjAwMkExIDEgMCAwIDEgMCAxMi4wMDFWMU0zIDN2N2g2VjNNMiAyaDh2OUgyVjJtMi41IDNINFY0aDR2MUg0LjV6bTAgMkg0VjZoNHYxSDQuNXptMCAySDRWOGg0djFINC41eiIgZmlsbC1ydWxlPSJub256ZXJvIiBmaWxsPSIjNTI1QzZGIi8+PC9zdmc+PHN2ZyB3aWR0aD0iMjAiIGhlaWdodD0iMjAiIHZpZXdCb3g9Ii0yIC0yIDIwIDIwIiBpZD0ic3JjLS1zdmctLXF1b3RlIiB4PSIxMDIiIHk9IjY0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9IiM1MjVDNkYiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTMgOGg0djRIM3pNOSA4aDR2NEg5ek0zIDVoMXYzSDN6TTQgNGgydjFINHoiLz48Zz48cGF0aCBkPSJNOSA1aDF2M0g5ek0xMCA0aDJ2MWgtMnoiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1yZWFkX21vZGUiIHg9IjIxMiIgeT0iMTEwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxwYXRoIGQ9Ik00IDMuOTk5VjE1TDQuMDAyIDE1aDkuOTk2Yy0uMDAyIDAgLjAwMi0uMDA0LjAwMi4wMDFWNEwxMy45OTggNEg0LjAwMkM0LjAwNCA0IDQgNC4wMDQgNCAzLjk5OW0tMSAwQzMgMy40NDcgMy40NTYgMyA0LjAwMiAzaDkuOTk2QTEgMSAwIDAgMSAxNSAzLjk5OVYxNWMwIC41NTItLjQ1Ni45OTktMS4wMDIuOTk5SDQuMDAyQTEgMSAwIDAgMSAzIDE1LjAwMVY0TTYgNnY3aDZWNk01IDVoOHY5SDVWNW0yLjUgM0gxMVY3SDd2MWguNXptMCAySDExVjlIN3YxaC41em0wIDJIMTF2LTFIN3YxaC41eiIgZmlsbD0iIzUyNWM2ZiIgZmlsbC1ydWxlPSJldmVub2RkIi8+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXJlZG8iIHg9IjIxMiIgeT0iMTMyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTguNzQxIDUuNzE0YzIuMjgxIDAgNC4zNDYuOTI1IDUuODQgMi40MkwxNyA1LjcxM3Y3LjI5M0g5Ljc3MWwyLjU0NS0yLjYwN0MxMC44OTUgOS4xODYgOS4wNzUgOC40MjUgNy4wNiA4LjQyNWMtMi40MjEgMC00LjU3IDEuMzY2LTYuMDYgMy4wNDQgMS4xNDgtMy4xODIgNC4xNjUtNS43NTUgNy43NDEtNS43NTV6IiBmaWxsPSIjQ0JDQkNCIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1yZWRvX2FjdGl2ZSIgeD0iMjEyIiB5PSIxNTQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNOC43NDEgNS43MTRjMi4yODEgMCA0LjM0Ni45MjUgNS44NCAyLjQyTDE3IDUuNzEzdjcuMjkzSDkuNzcxbDIuNTQ1LTIuNjA3QzEwLjg5NSA5LjE4NiA5LjA3NSA4LjQyNSA3LjA2IDguNDI1Yy0yLjQyMSAwLTQuNTcgMS4zNjYtNi4wNiAzLjA0NCAxLjE0OC0zLjE4MiA0LjE2NS01Ljc1NSA3Ljc0MS01Ljc1NXoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXJlZmVyZW5jZSIgeD0iMjEyIiB5PSIxNzYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0iIzUyNUM2RiIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNSAzaDEwdjFINXpNNSA4aDEwdjFINXpNNSAxM2gxMHYxSDV6TTIgMmgxdjEzSDJ6Ii8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS1yZXNpemVfdmlldyIgeT0iMjAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMiAyKSI+PHBhdGggZD0iTTguMDAxIDEzaDF2LTFoLTF2MXoiIGZpbGw9IiM1MjVDNkYiLz48cmVjdCBmaWxsPSIjNTI1QzZGIiB5PSI3IiB3aWR0aD0iNiIgaGVpZ2h0PSI2IiByeD0iMSIvPjxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0xIDhoNHY0SDF6Ii8+PHBhdGggZmlsbD0iIzUyNUM2RiIgZD0iTTUgN2gxdjFINXpNNiA2aDF2MUg2ek03IDVoMXYxSDd6Ii8+PHBhdGggZD0iTTcgM3YxaDF2MWgxdjFoMVYzSDd6TTEwIDEzaDF2LTFoLTF2MXpNMTIuNSAxMi4wMDFIMTJWMTNoMS4wMDF2LS45OTloLS41ek0xMiAxMS4wMDFoMS4wMDF2LTFIMTJ2MXpNMTIgOS4wMDFoMS4wMDFWOEgxMnYxLjAwMXpNMTIgN2gxLjAwMVY2SDEydjF6TTEyIDVoMS4wMDFWNEgxMnYxek0wIDVoMVY0SDB2MXpNMTIgMy4wMDFoMS4wMDF2LTFIMTJ2MXpNMCAzLjAwMWgxdi0xSDB2MXpNMTIgMHYxaDFWMGgtMXpNMTAgMHYxaDFWMGgtMXpNOCAwdjFoMVYwSDh6TTYgMHYxaDFWMEg2ek00IDB2MWgxVjBINHpNMiAwdjFoMVYwSDJ6TTAgMHYxaDFWMEgweiIgZmlsbD0iIzUyNUM2RiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXNjcmVlbnNob3QiIHg9IjIyIiB5PSIyMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1YzZmIj48cGF0aCBkPSJNNCAzdjJIMnYxaDEwdjZoMVY1SDVWM0g0eiIvPjxwYXRoIGQ9Ik00IDd2N2g4djJoMXYtMmgzdi0xSDVWN0g0eiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXNjcmVlbnNob3RfeCIgeD0iNDQiIHk9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik00IDd2N2g4djJoMXYtMmgzdi0xSDVWN0g0ek00IDN2MkgydjFoM1YzSDR6IiBmaWxsPSIjNTI1YzZmIi8+PHBhdGggZD0iTTYgNmgxVjVINnYxek04IDZoMVY1SDh2MXpNMTAgNmgxLjAwMVY1SDEwdjF6TTEyIDZoMVY1aC0xdjF6TTEyIDhoMVY2Ljk5OWgtMVY4ek0xMiAxMGgxVjloLTF2MXpNMTIgMTJoMXYtMWgtMXYxeiIgZmlsbD0iIzhjOGY5NCIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tc3luYyIgeD0iNjYiIHk9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSIjMzk4REVFIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0yLjAwNCA4Ljc2MmE3IDcgMCAwIDAgMTMuMzEzIDMuMjU4bC0xLjAwNy0uMzA4QTYgNiAwIDAgMSAyLjk1NyA5LjA1M2wtLjk1My0uMjkxem0xLjA0My0zLjQ0NkE3IDcgMCAwIDEgMTUuOTggOC40NThsLTEuMDg2LS4zMzJBNi4wMDEgNi4wMDEgMCAwIDAgNC4wMDYgNS42MWwtLjk2LS4yOTR6Ii8+PHBhdGggZD0iTTEgOS4wODRoM0wyLjUgN3pNMTQgOGgzbC0xLjUgMi4wODR6Ii8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS10YWJsZSIgeD0iODgiIHk9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0zLjAwNyAzQzIuNDUgMyAyIDMuNDQ5IDIgNHYxMS4wMDNjMCAuNTUuNDUxLjk5OCAxLjAwNy45OThoMTEuOTg2Yy41NTcgMCAxLjAwNy0uNDQ3IDEuMDA3LS45OThWMy45OTlDMTYgMy40NDggMTUuNTQ5IDMgMTQuOTkzIDNIMy4wMDd6IiBmaWxsPSIjNTI1QzZGIi8+PHBhdGggZD0iTTE1IDE1LjAwMkMxNSAxNC45OTggMy4wMDcgMTUgMy4wMDcgMTUgMy4wMDEgMTUgMyAzLjk5OCAzIDMuOTk4IDMgNCAxNC45OTMgNCAxNC45OTMgNCAxNC45OTkgNCAxNSAxNS4wMDMgMTUgMTUuMDAzeiIgZmlsbD0iI0ZGRiIvPjxwYXRoIGQ9Ik0yLjUzOCA4SDE2VjdIMnYxaC41Mzh6TTIuNTM4IDEySDE2di0xSDJ2MWguNTM4eiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik02IDMuNTlWMTZoMVYzSDZ2LjU5ek0xMSAzLjU5VjE2aDFWM2gtMXYuNTl6IiBmaWxsPSIjNTI1QzZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS10YWJsZV9jZWxsX2FsaWduX2JvdHRvbSIgeD0iMTEwIiB5PSIyMDAiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNMiAxNWgxM3YtMUgyek04IDEydi0xSDd2LTFINlY5aDJWMmgxdjdoMi4wMDF2MUgxMHYxSDl2MUg4eiIvPjwvZz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXRhYmxlX2NlbGxfYWxpZ25fbWlkIiB4PSIxMzIiIHk9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiM1MjVDNkYiPjxwYXRoIGQ9Ik0yIDhoMTN2MUgyek04IDEwdjFIN3YxSDZ2MWgydjNoMXYtM2gyLjAwMXYtMUgxMHYtMUg5di0xSDh6TTggN1Y2SDdWNUg2VjRoMlYxaDF2M2gyLjAwMXYxSDEwdjFIOXYxSDh6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfY2VsbF9hbGlnbl90b3AiIHg9IjE1NCIgeT0iMjAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PGcgZmlsbD0iIzUyNUM2RiI+PHBhdGggZD0iTTIgMmgxM3YxSDJ6TTggNXYxSDd2MUg2djFoMnY3aDFWOGgyLjAwMVY3SDEwVjZIOVY1SDh6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfY2VsbF9ib3JkZXJfYWxsIiB4PSIxNzYiIHk9IjIwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGQ9Ik0yIDJoMTN2MTNIMnoiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMyAzaDExdjExSDN6Ii8+PHBhdGggZD0iTTggMi41VjE1aDFWMkg4di41eiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik0yLjUgOUgxNVY4SDJ2MWguNXoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXRhYmxlX2NlbGxfYm9yZGVyX2xlZnQiIHg9IjE5OCIgeT0iMjAwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTQgMTR2MWgxdi0xSDR6TTYgMTR2MWgxdi0xSDZ6TTQgMnYxaDFWMkg0ek02IDJ2MWgxVjJINnpNMTIgMnYxaDFWMmgtMXpNMTAgMnYxaDFWMmgtMXpNOCAydjFoMVYySDh6TTEwIDE0djFoMXYtMWgtMXpNMTIgMTR2MWgxdi0xaC0xek0xNCAxNHYxaDF2LTFoLTF6TTggMTR2MWgxdi0xSDh6TTggMTJ2MWgxdi0xSDh6TTggMTB2MWgxdi0xSDh6TTEyIDh2MWgxVjhoLTF6TTEwIDh2MWgxVjhoLTF6TTggNHYxaDFWNEg4ek04IDZ2MWgxVjZIOHpNNCA4djFoMVY4SDR6TTYgOHYxaDFWOEg2ek0xNCAydjFoMVYyaC0xek0xNCAxMnYxaDF2LTFoLTF6TTE0IDEwdjFoMXYtMWgtMXpNMTQgNHYxaDFWNGgtMXpNMTQgNnYxaDFWNmgtMXpNMTQgOHYxaDFWOGgtMXpNOCA4djFoMVY4SDh6IiBmaWxsPSIjOEM4Rjk0Ii8+PHBhdGggZD0iTTIgMnYxM2gxVjJIMnoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXRhYmxlX2NlbGxfYm9yZGVyX25vbmUiIHg9IjIzNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxnIGZpbGw9IiM4QzhGOTQiPjxwYXRoIGQ9Ik0xMyAxNHYxaC0xdi0xaDF6TTExIDE0djFoLTF2LTFoMXpNMTUgMTB2MWgtMXYtMWgxeiIvPjxwYXRoIGQ9Ik0xNSAxMHYxaC0xdi0xaDF6TTE1IDE0djFoLTF2LTFoMXpNMTUgMTJ2MWgtMXYtMWgxeiIvPjxwYXRoIGQ9Ik0xNSAxMHYxaC0xdi0xaDF6TTE1IDh2MWgtMVY4aDF6TTE1IDZ2MWgtMVY2aDF6TTE1IDR2MWgtMVY0aDF6TTE1IDJ2MWgtMVYyaDF6TTEzIDJ2MWgtMVYyaDF6TTExIDJ2MWgtMVYyaDF6TTUgMnYxSDRWMmgxek03IDJ2MUg2VjJoMXpNOSAydjFIOFYyaDF6TTcgMTR2MUg2di0xaDF6TTUgMTR2MUg0di0xaDF6TTMgMTR2MUgydi0xaDF6TTkgMTR2MUg4di0xaDF6TTkgMTJ2MUg4di0xaDF6TTkgMTB2MUg4di0xaDF6TTUgOHYxSDRWOGgxek03IDh2MUg2VjhoMXpNOSA0djFIOFY0aDF6TTkgNnYxSDhWNmgxek0xMyA4djFoLTFWOGgxek0xMSA4djFoLTFWOGgxek0zIDJ2MUgyVjJoMXpNMyAxMnYxSDJ2LTFoMXpNMyAxMHYxSDJ2LTFoMXpNMyA0djFIMlY0aDF6TTMgNnYxSDJWNmgxek0zIDh2MUgyVjhoMXpNOSA4djFIOFY4aDF6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfY2VsbF9ib3JkZXJfb3V0IiB4PSIyMzQiIHk9IjIyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTMgMnYxM0gyVjJoMXoiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBmaWxsPSIjNTI1QzZGIiBkPSJNMTUgMTR2MUgydi0xek0xNSAydjFIMlYyeiIvPjxwYXRoIGQ9Ik0xNSAydjEzaC0xVjJoMXoiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBkPSJNOSAxMnYxSDh2LTFoMXpNOSAxMHYxSDh2LTFoMXpNNSA4djFINFY4aDF6TTcgOHYxSDZWOGgxek05IDR2MUg4VjRoMXpNOSA2djFIOFY2aDF6TTEzIDh2MWgtMVY4aDF6TTExIDh2MWgtMVY4aDF6TTkgOHYxSDhWOGgxeiIgZmlsbD0iIzhDOEY5NCIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfY2VsbF9ib3JkZXJfcmlnaHQiIHg9IjIzNCIgeT0iNDQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNMTUgMnYxM2gtMVYyaDF6IiBmaWxsPSIjNTI1QzZGIi8+PHBhdGggZD0iTTEzIDE0djFoLTF2LTFoMXpNMTEgMTR2MWgtMXYtMWgxek0xMyAydjFoLTFWMmgxek0xMSAydjFoLTFWMmgxek01IDJ2MUg0VjJoMXpNNyAydjFINlYyaDF6TTkgMnYxSDhWMmgxek03IDE0djFINnYtMWgxek01IDE0djFINHYtMWgxek0zIDE0djFIMnYtMWgxek05IDE0djFIOHYtMWgxek05IDEydjFIOHYtMWgxek05IDEwdjFIOHYtMWgxek01IDh2MUg0VjhoMXpNNyA4djFINlY4aDF6TTkgNHYxSDhWNGgxek05IDZ2MUg4VjZoMXpNMTMgOHYxaC0xVjhoMXpNMTEgOHYxaC0xVjhoMXpNMyAydjFIMlYyaDF6TTMgMTJ2MUgydi0xaDF6TTMgMTB2MUgydi0xaDF6TTMgNHYxSDJWNGgxek0zIDZ2MUgyVjZoMXpNMyA4djFIMlY4aDF6TTkgOHYxSDhWOGgxeiIgZmlsbD0iIzhDOEY5NCIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfY2VsbF9ib3JkZXJfdG9wIiB4PSIyMzQiIHk9IjY2IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTE0IDRoMXYxaC0xVjR6TTE0IDZoMXYxaC0xVjZ6TTIgNGgxdjFIMlY0ek0yIDZoMXYxSDJWNnpNMiAxMmgxdjFIMnYtMXpNMiAxMGgxdjFIMnYtMXpNMiA4aDF2MUgyVjh6TTE0IDEwaDF2MWgtMXYtMXpNMTQgMTJoMXYxaC0xdi0xek0xNCAxNGgxdjFoLTF2LTF6TTE0IDhoMXYxaC0xVjh6TTEyIDhoMXYxaC0xVjh6TTEwIDhoMXYxaC0xVjh6TTggMTJoMXYxSDh2LTF6TTggMTBoMXYxSDh2LTF6TTQgOGgxdjFINFY4ek02IDhoMXYxSDZWOHpNOCA0aDF2MUg4VjR6TTggNmgxdjFIOFY2ek0yIDE0aDF2MUgydi0xek0xMiAxNGgxdjFoLTF2LTF6TTEwIDE0aDF2MWgtMXYtMXpNNCAxNGgxdjFINHYtMXpNNiAxNGgxdjFINnYtMXpNOCAxNGgxdjFIOHYtMXpNOCA4aDF2MUg4Vjh6IiBmaWxsPSIjOEM4Rjk0Ii8+PHBhdGggZD0iTTIgMmgxM3YxSDJWMnoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMjIiIGhlaWdodD0iMjIiIHZpZXdCb3g9Ii0yIC0yIDIyIDIyIiBpZD0ic3JjLS1zdmctLXRhYmxlX2NlbGxfYnJvZGVyX2JvdHRvbSIgeD0iMjM0IiB5PSI4OCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0xNCAxM2gxdi0xaC0xdjF6TTE0IDExaDF2LTFoLTF2MXpNMiAxM2gxdi0xSDJ2MXpNMiAxMWgxdi0xSDJ2MXpNMiA1aDFWNEgydjF6TTIgN2gxVjZIMnYxek0yIDloMVY4SDJ2MXpNMTQgN2gxVjZoLTF2MXpNMTQgNWgxVjRoLTF2MXpNMTQgM2gxVjJoLTF2MXpNMTQgOWgxVjhoLTF2MXpNMTIgOWgxVjhoLTF2MXpNMTAgOWgxVjhoLTF2MXpNOCA1aDFWNEg4djF6TTggN2gxVjZIOHYxek00IDloMVY4SDR2MXpNNiA5aDFWOEg2djF6TTggMTNoMXYtMUg4djF6TTggMTFoMXYtMUg4djF6TTIgM2gxVjJIMnYxek0xMiAzaDFWMmgtMXYxek0xMCAzaDFWMmgtMXYxek00IDNoMVYySDR2MXpNNiAzaDFWMkg2djF6TTggM2gxVjJIOHYxek04IDloMVY4SDh2MXoiIGZpbGw9IiM4QzhGOTQiLz48cGF0aCBkPSJNMiAxNWgxM3YtMUgydjF6IiBmaWxsPSIjNTI1QzZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjI0IiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyNCAyMiIgaWQ9InNyYy0tc3ZnLS10YWJsZV9jZWxsX21lcmdlIiB4PSI1NCIgeT0iMzgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNOSA4SDhWN0g3VjZINnYySDN2MWgzdjIuMDAxaDFWMTBoMVY5aDFWOHpNMTEgOGgxVjdoMVY2aDF2MmgzdjFoLTN2Mi4wMDFoLTFWMTBoLTFWOWgtMVY4eiIvPjxwYXRoIGQ9Ik05IDQuODgyVjJIMXYxM2g4di0yLjQ5OEg4VjE0SDJWM2g2djEuODgyaDF6TTExIDQuODgyVjJoOHYxM2gtOHYtMi40OThoMVYxNGg2VjNoLTZ2MS44ODJoLTF6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfaGlkZV9ib3JkZXIiIHg9IjIzNCIgeT0iMTEwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTE1IDJ2MTNIMlYyaDEzeiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik0zIDE0aDEwLjk5OEwxNCAzSDMuMDE0TDMgMTR6IiBmaWxsPSIjRkZGIi8+PHBhdGggZmlsbD0iI0I5QkVDOSIgZD0iTTggM2gxdjFIOHpNNyAzaDF2Mkg3ek02IDNoMXYzSDZ6TTUgNGgxdjNINXpNNCA1aDF2M0g0ek0zIDZoMXYzSDN6TTEzIDloMXYzaC0xek0xMiAxMGgxdjNoLTF6TTExIDExaDF2M2gtMXoiLz48cGF0aCBmaWxsPSIjQjlCRUM5IiBkPSJNMTAgMTJoMnYyaC0yeiIvPjxwYXRoIGZpbGw9IiNCOUJFQzkiIGQ9Ik05IDEzaDN2MUg5ek0xMyAzaDF2MmgtMXpNMTIgM2gxdjNoLTF6TTExIDRoMXYzaC0xek0xMCA1aDF2M2gtMXpNOSA2aDF2M0g5ek04IDdoMXYzSDh6TTcgOGgxdjNIN3pNNiA5aDF2M0g2ek01IDEwaDF2M0g1ek00IDExaDF2M0g0ek0zIDEyaDF2MkgzeiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGFibGVfaW5zZXJ0X2RlbGV0ZSIgeD0iMjM0IiB5PSIxMzIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyB0cmFuc2Zvcm09InRyYW5zbGF0ZSgxIDIpIj48cGF0aCBkPSJNMy45OTkgM0gxNWMuNTUyIDAgLjk5OS40NTYuOTk5Ljk5NXY4LjAxYzAgLjU1LS40NDcuOTk1LS45OTkuOTk1SDRDMy40NDcgMTMgMyAxMi41NDQgMyAxMi4wMDV2LTguMDFjMC0uNTUuNDQ3LS45OTUuOTk5LS45OTV6IiBmaWxsPSIjNTI1QzZGIi8+PHBhdGggZD0iTTQgMTIuMDA1QzQgMTEuOTk2IDE1LjAwMSAxMiAxNS4wMDEgMTJMMTUgMy45OTVDMTUgNC4wMDQgMy45OTkgNCAzLjk5OSA0TDQgMTIuMDA1eiIgZmlsbD0iI0ZGRiIvPjxwYXRoIGQ9Ik00LjUgMTBIMTZWOUg0djFoLjV6TTQuNSA3SDE2VjZINHYxaC41eiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik0xMSAzLjVWMTNoMVYzaC0xdi41ek03IDMuNVYxM2gxVjNIN3YuNXoiIGZpbGw9IiM1MjVDNkYiLz48cmVjdCBmaWxsPSIjRDVEN0RDIiB3aWR0aD0iMTMiIGhlaWdodD0iNCIgcng9IjEiLz48cGF0aCBkPSJNLjk5OSAwSDEyYy41NTIgMCAuOTk5LjQ0My45OTkgMS4wMXYxLjk4YzAgLjU1OC0uNDQ3IDEuMDEtLjk5OSAxLjAxSDFBLjk5OS45OTkgMCAwIDEgMCAyLjk5VjEuMDFDMCAuNDUxLjQ0NyAwIC45OTkgMHoiIGZpbGw9IiM1MjVDNkYiLz48cGF0aCBkPSJNMSAyLjk5QzEgMy4wMDQuOTk4IDMgLjk5OSAzSDEyQzExLjk5OCAzIDEyIDIuOTk4IDEyIDIuOTlWMS4wMWMwLS4wMTMuMDAyLS4wMS4wMDEtLjAxSDFjLjAwMyAwIC4wMDEuMDAyLjAwMS4wMXYxLjk4eiIgZmlsbD0iI0Q1RDdEQyIvPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGQ9Ik00IDFoMXYySDR6TTggMWgxdjJIOHoiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjIyIiBoZWlnaHQ9IjIyIiB2aWV3Qm94PSItMiAtMiAyMiAyMiIgaWQ9InNyYy0tc3ZnLS10ZXh0X2JhY2tncm91bmQiIHg9IjIzNCIgeT0iMTU0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZmlsbD0iI0ZGRiIgZD0iTTIgMTNoMXYxSDJ6TTMgMTRoM3YxSDN6Ii8+PHBhdGggZD0iTTcuOTk4IDUuMDUzTDkuMDk0IDMuOTcgOS4yMzEgM0gxNHY1LjQxbC0xLjAyOS42MS0xLjQyOSAxLjMzLS45NjcuMTk0LTQuMDI0LTQuMDYyIDEuNDQ3LTEuNDN6IiBmaWxsPSIjRDVEN0RDIi8+PHBhdGggZD0iTTUgMTFoMXYzSDV2LTN6IiBmaWxsPSIjNDE0QzYyIi8+PHBhdGggZD0iTTUgOHY0LjAwMUg0VjEzSDN2MWgzdi0xaDR2LS45OTloLS45OTl2LTFoLTF2LTFIN3YxSDZ2LTFoMVY5SDZWOEg1eiIgZmlsbD0iIzUyNUM2RiIvPjxwYXRoIGQ9Ik05IDloMXYxSDlWOXpNNyA3aDF2MUg3Vjd6TTggOGgxdjFIOFY4ek0xMyA4aDF2MWgtMVY4ek0xMiA5aDF2MWgtMVY5ek0xMCAxMGgydjFoLTJ2LTF6TTYgNmgxdjFINlY2ek03IDVoMXYxSDdWNXpNOCA0aDF2MUg4VjR6TTkgM2gxdjFIOVYzeiIgZmlsbD0iIzQxNEM2MiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdGV4dF9jb2xvciIgeD0iMjM0IiB5PSIxNzYiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNNy42NjUgM0wzIDE0aDEuNDYxbDEuMjYyLTMuMDgxaDUuNDQ2bDEuMjYxIDMuMDhoMS40NzdMOS4yNDMgM0g3LjY2NXoiIGZpbGw9IiM0MTRDNjIiLz48cGF0aCBkPSJNOC40MjkgNC4zNTZoLjA2N2wyLjI0MSA1LjVINi4xNTVsMi4yNzQtNS41eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIxOCIgaGVpZ2h0PSIxNyIgdmlld0JveD0iLTIgLTIgMTggMTciIGlkPSJzcmMtLXN2Zy0tdG9kbyIgeD0iMTAyIiB5PSI4NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGZpbGw9IiM1MjVDNkYiIGQ9Ik0xMS45MzcgMy4yOGwtNS42NDMgNi44My0zLjEyNi00LjQ0NGguNTE2bDIuNjEgMiA0Ljk4Ny00LjM4NnoiLz48cmVjdCB3aWR0aD0iMTMiIGhlaWdodD0iMTIiIHg9Ii41IiB5PSIuNSIgc3Ryb2tlPSIjNTI1QzZGIiByeD0iMSIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdG9nZ2xlX3RhYiIgeD0iMjM0IiB5PSIxOTgiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBmaWxsLW9wYWNpdHk9IjAiIGZpbGw9IiNEOEQ4RDgiIGQ9Ik0wIDBoMTh2MThIMHoiLz48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNNSAxMS41MzZMOC41MzYgOGwuNzA3LjcwNy0zLjUzNiAzLjUzNnoiLz48cGF0aCBkPSJNMTEuMzY0IDEyLjI0M0w3LjgyOCA4LjcwNyA4LjUzNiA4bDMuNTM1IDMuNTM2eiIvPjwvZz48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNNSA3LjUzNkw4LjUzNiA0bC43MDcuNzA3LTMuNTM2IDMuNTM2eiIvPjxwYXRoIGQ9Ik0xMS4zNjQgOC4yNDNMNy44MjggNC43MDcgOC41MzYgNGwzLjUzNSAzLjUzNnoiLz48L2c+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX2F1ZGlvX2xhcmdlIiB4PSI1NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0wIDJDMCAuODk1Ljg5IDAgMS45OTEgMEgyMmw4IDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGw9IiNCQ0E1RkYiLz48cGF0aCBkPSJNMTYgMjZ2LTIuMDVhOS45OTYgOS45OTYgMCAwIDAgNy42MDItNC44NDdsLTEuNzItMS4wMjJBNy45OTQgNy45OTQgMCAwIDEgMTUgMjJhNy45OTQgNy45OTQgMCAwIDEtNi44NjgtMy44OTVsLTEuNzE2IDEuMDI3QTkuOTk1IDkuOTk1IDAgMCAwIDE0IDIzLjk1VjI2aC0yLjAwM2MtLjU0NCAwLS45OTcuNDQ4LS45OTcgMSAwIC41NTYuNDQ2IDEgLjk5NyAxaDYuMDA2Yy41NDQgMCAuOTk3LS40NDguOTk3LTEgMC0uNTU2LS40NDYtMS0uOTk3LTFIMTZ6bS02LTE1LjAwNWE1LjAwMSA1LjAwMSAwIDAgMSAxMCAwdjQuMDFhNS4wMDEgNS4wMDEgMCAwIDEtMTAgMHYtNC4wMXptMiAwdjQuMDFhMy4wMDEgMy4wMDEgMCAwIDAgNiAwdi00LjAxYTMuMDAxIDMuMDAxIDAgMCAwLTYgMHoiIGZpbGw9IiNGRkYiLz48cGF0aCBkPSJNMSAydjMwYzAgLjU1NS40NDMgMSAuOTkyIDFoMjYuMDE2YS45OTguOTk4IDAgMCAwIC45OTItLjk5N1Y4bC4yOTMuNzA3LTgtOEwyMiAxSDEuOTkxQS45OTQuOTk0IDAgMCAwIDEgMnpNMCAyQzAgLjg5NS44OSAwIDEuOTkxIDBIMjJsOCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6IiBmaWxsLW9wYWNpdHk9Ii4wNSIgZmlsbD0iIzAwMCIvPjxwYXRoIGZpbGwtb3BhY2l0eT0iLjEiIGZpbGw9IiMwMDAiIGQ9Ik0yMyA3aDYuMDI0TDMwIDguMDM2VjE0eiIvPjxwYXRoIGQ9Ik0yMiAwbDggOC02LjAwMi4wMDNBMS45OTIgMS45OTIgMCAwIDEgMjIgNi4wMDVWMHoiIGZpbGw9IiNEREQyRkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfY29tcHJlc3NfbGFyZ2UiIHg9Ijg4IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXRoIGlkPSJja2EiIGQ9Ik0wIDJDMCAuODk1Ljg5IDAgMS45OSAwaDIwLjAwMkwzMCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjRDQ5NjVBIiB4bGluazpocmVmPSIjY2thIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2NmwtNy03eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiNFNkMxOUUiLz48cGF0aCBkPSJNMTMgOWgydjJoLTJWOXptMiAyaDJ2MmgtMnYtMnptLTIgMmgydjJoLTJ2LTJ6bTIgMmgydjJoLTJ2LTJ6bS0yIDJoMnYyaC0ydi0yem0wIDRoMnY0aC0ydi00em0yLTJoMnYyaC0ydi0yem0wIDRoMnYyaC0ydi0yeiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIzNCIgaGVpZ2h0PSIzOCIgdmlld0JveD0iLTIgLTIgMzQgMzgiIGlkPSJzcmMtLXN2Zy0tdHlwZV9jc3ZfbGFyZ2UiIHk9IjY0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHBhdGggZD0iTTAgMkMwIC44OTUuODkgMCAxLjk5MSAwSDIybDggOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbD0iIzVCQ0I4QSIvPjxwYXRoIGQ9Ik0xIDJ2MzBjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3VjhsLjI5My43MDctOC04TDIyIDFIMS45OTFBLjk5NC45OTQgMCAwIDAgMSAyek0wIDJDMCAuODk1Ljg5IDAgMS45OTEgMEgyMmw4IDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGwtb3BhY2l0eT0iLjA1IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIgZD0iTTIzIDdoNi4wMjRMMzAgOC4wMzZWMTR6Ii8+PHBhdGggZD0iTTIyIDBsOCA4LTYuMDAyLjAwM0ExLjk5MiAxLjk5MiAwIDAgMSAyMiA2LjAwNVYweiIgZmlsbD0iIzlBRTJCOCIvPjx0ZXh0IGZvbnQtZmFtaWx5PSJBcmlhbC1Cb2xkTVQsIEFyaWFsIiBmb250LXNpemU9IjEzIiBmb250LXdlaWdodD0iYm9sZCIgZmlsbD0iI0ZGRiI+PHRzcGFuIHg9IjQiIHk9IjIxIj5jc3Y8L3RzcGFuPjwvdGV4dD48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfZXhjZWxfbGFyZ2UiIHg9IjM0IiB5PSI2NCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0wIDJDMCAuODk1Ljg5MiAwIDEuOTk2IDBIMjIuMDZMMzAgNy45NjJWMzJhMiAyIDAgMCAxLTEuOTkyIDJIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6IiBmaWxsPSIjNEVDNzgxIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2NmwtNy03eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiM5QUUyQjgiLz48cGF0aCBkPSJNMTcgMTBsLTIgMy0yLTNIOWw0IDYtNSA4aDd2LTJoLTJsMi0zIDIgNWg0bC00LTggNC02aC00eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIzNCIgaGVpZ2h0PSIzOCIgdmlld0JveD0iLTIgLTIgMzQgMzgiIGlkPSJzcmMtLXN2Zy0tdHlwZV9mbGFzaF9sYXJnZSIgeD0iNjgiIHk9IjY0IiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXRoIGlkPSJjbmEiIGQ9Ik0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMjFMMzAgNy45NjJWMzJhMiAyIDAgMCAxLTEuOTkyIDJIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjRkE1RDVEIiB4bGluazpocmVmPSIjY25hIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2NmwtNy03eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiNGRkE3QTciLz48cGF0aCBkPSJNOC4xOSAyMi40NVYyNWM0LjktLjMyNiA3LjAyLTIuMzc2IDcuOTItNi4wOTFoNC4wMjh2LTIuNTRIMTYuNTVjLjYzNi00LjE2IDQuNDUtNC43NSA0LjQ1LTQuODJWOWMtMS4xNjUuMDgyLTYuMzg3IDEuNjYzLTcuMDM1IDcuMzUzLS42MjMgNS40NTYtMy40NDYgNS45NTktNS43NzUgNi4wOTh6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX2h0bWxfbGFyZ2UiIHg9IjEyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY29hIiBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTk0IDBoMjAuMDM3TDMwIDcuOTYyVjMyYTIgMiAwIDAgMS0xLjk5MiAySDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIvPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjx1c2UgZmlsbD0iIzY1QTZGMyIgeGxpbms6aHJlZj0iI2NvYSIvPjxwYXRoIGQ9Ik0xIDMyYzAgLjU1NS40NDMgMSAuOTkyIDFoMjYuMDE2YS45OTguOTk4IDAgMCAwIC45OTItLjk5N3MuMDg5LTIzLjUtLjAxMy0yMy42MDJDMjYuNDI1IDUuODM2IDIxLjczMyAxIDIxLjU5NSAxSDEuOTkyQS45OTUuOTk1IDAgMCAwIDEgMnYzMHpNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBoMjAuMDE2TDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGwtb3BhY2l0eT0iLjA1IiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIzIDdsNyAxdjZsLTctN3oiIGZpbGwtb3BhY2l0eT0iLjEiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjIgMGw4IDhoLTYuMDAyQTEuOTkzIDEuOTkzIDAgMCAxIDIyIDYuMDAyVjB6IiBmaWxsPSIjQTNDQkZBIi8+PHBhdGggZD0iTTIxLjA4MSA5Ljc1NWMtLjY3MS0uNjIxLTEuNTI3LS42OC0yLjI5Ny0uNjg0LS44MjEuMDMyLTEuNjUxLjIyLTIuMzYuNTI2YTcuMDUgNy4wNSAwIDAgMC0xLjE4OC41NGMtLjA5NS4wNDktLjE4LjEyOS0uMjY4LjJhNy43MjggNy43MjggMCAwIDAtLjU4Ni0uMDI3Yy0uODQ5IDAtMS42NTMuMTU3LTIuNDEyLjQ2N2E2LjAyMiA2LjAyMiAwIDAgMC0yIDEuMzMgNi4yOTYgNi4yOTYgMCAwIDAtMS4zNSAyLjAyOCA2LjQ3MyA2LjQ3MyAwIDAgMC0uNDkxIDIuNTRjMCAuMTMuMDIzLjI0MS4wMjguMzY4LS40OTkuOC0uODcgMS41NzUtMS4xMTUgMi4zMy0uMzYyIDEuMTItLjUyIDIuMDItLjQ5NiAyLjgzLjAzNCAxLjE5Ny4zMTYgMi4wODYuODY3IDIuNzIuNTAxLjU2NyAxLjE2My44NTQgMS45NjQuODU0LjE0IDAgLjI3NS0uMDA4LjQtLjAyMy42MjgtLjA3IDEuMTEyLS4yNCAxLjUzMi0uNC43NjktLjMyIDEuMTYxLS42MDQgMS4yMDMtLjYzNmwtLjQ4OC0uOThjLS4wMDQuMDAyLS40MDIuMTQ3LTEuMDk1LjI4Mi0uNDU1LjA5Mi0uNzkzLjEyNi0xLjIuMDk3LS40LS4wMjUtLjc2My0uMTg0LS45MDUtLjM5OS0uMjAxLS4zLS4yODgtLjgwMy0uMjYtMS40OS4wMzMtLjU3LjE4Ni0xLjIyLjQ1Mi0xLjk2LjI0LjQwOS41MTUuNzkxLjg1NSAxLjEyNSAxLjE2IDEuMTQzIDIuNjk0IDEuNzEzIDQuNiAxLjcxMyAxLjM4NSAwIDIuNjEtLjMzNiAzLjY3NC0xLjAxMiAxLjA2NC0uNjc2IDEuNzYtMS43OTcgMi4wODgtMy4xMThoLTMuNTUxYy0uMTc5LjQyLS40NjUuODY4LS44NiAxLjEwMi0uMzk0LjIzMi0uODMuMzUtMS4zMDYuMzUtLjc5IDAtMS40MTEtLjI0OS0xLjg2NC0uNzQ4LS40NTUtLjQ5NS0uNjk3LTEuMTY0LS43MjctMi4wMDNoOC41MzJjMC0uOTc3LS4xMzItMi4zNzItLjM5Mi0zLjIwNGE2LjQ5NSA2LjQ5NSAwIDAgMC0xLjE2LTIuMTljLS4zMTgtLjM5LS43MDEtLjcwNS0xLjExNS0uOTg0bC4yNTgtLjA4NmMuMjA5LS4wOTEuNDY2LS4xNC43MTQtLjE4OGwuMTItLjAyNWMuMTc3LS4wMjIuMzUtLjAzNi41MTItLjAzNi4zNzEgMCAuNTM4LjA3NS41OTUuMTEyLjI0Ny4xNzQuNDI1LjQ5Ni40Ny43MDguMTIyLjY2OC4wOTQgMS4wODYuMDkzIDEuMDlsMS4wNDYuMTk2LjEwMy0uNDI5Yy4wNDMtLjIyNi4xMDYtLjU2OS4wOS0xLjAzNC0uMDI4LS40NC0uMDc4LTEuMTc4LS43MS0xLjg1MnptLTkuMTU2IDUuNjU2Yy4xMi0uNzQ2LjM5NS0xLjI5My44MjYtMS43NDQuNDMyLS40NDkuOTc2LS42NzUgMS42MzEtLjY3NS42MjUgMCAxLjE1LjIzNyAxLjU3NC43MS40MjQuNDc0LjY1MSAxLjAxLjY4IDEuNzA5aC00LjcxeiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIzNCIgaGVpZ2h0PSIzOCIgdmlld0JveD0iLTIgLTIgMzQgMzgiIGlkPSJzcmMtLXN2Zy0tdHlwZV9pbWFnZV9sYXJnZSIgeD0iMTIyIiB5PSIzOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY3BhIiBkPSJNMCAyQzAgLjg5NS44OTIgMCAxLjk5NyAwaDIwLjA2NUwzMCA3Ljk2MlYzMmEyIDIgMCAwIDEtMS45OTIgMkgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48dXNlIHN0cm9rZS1vcGFjaXR5PSIuMDUiIHN0cm9rZT0iIzAwMCIgZmlsbD0iIzY3Q0NCQSIgeGxpbms6aHJlZj0iI2NwYSIvPjxwYXRoIGQ9Ik0xIDMyYzAgLjU1NS40NDMgMSAuOTkyIDFoMjYuMDE2YS45OTguOTk4IDAgMCAwIC45OTItLjk5N3MuMDg5LTIzLjUtLjAxMy0yMy42MDJDMjYuNDI1IDUuODM2IDIxLjczMyAxIDIxLjU5NSAxSDEuOTkyQS45OTUuOTk1IDAgMCAwIDEgMnYzMHpNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBoMjAuMDE2TDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGwtb3BhY2l0eT0iLjA1IiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIzIDdsNyAxdjdsLTctOHoiIGZpbGwtb3BhY2l0eT0iLjEiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjIgMGw4IDguMDA4aC02LjAwMmExLjk5NCAxLjk5NCAwIDAgMS0xLjk5OC0yVjB6IiBmaWxsPSIjQThFMEQ2Ii8+PHBhdGggZD0iTTEwLjAzIDEzLjk3NWMxLjExNiAwIDIuMDItLjkgMi4wMi0yLjAxIDAtMS4xMS0uOTA0LTIuMDEtMi4wMi0yLjAxcy0yLjAyLjktMi4wMiAyLjAxYzAgMS4xMS45MDQgMi4wMSAyLjAyIDIuMDFtMi42NjQgNy41MmwtMS43NjctMi40NThjLS42NDUtLjg5Ni0xLjY4Ny0uODk1LTIuMzMgMEw2LjMwOCAyMi4yMmMtLjY0NS44OTYtLjI0OCAxLjc4MS44ODQgMS43ODFoNS4xMzdjLjEzOSAwIC4yNjctLjAxLjM4My0uMDMyLjExNi4wMjEuMjQzLjAzMi4zODIuMDMyaDkuNzA3YzEuMTI1IDAgMS41MzUtLjg5NS44OTYtMS44bC00LjU5NC02LjUyMWMtLjYzNy0uOTA0LTEuNjczLS45MDYtMi4zMTIgMGwtNC4wOTggNS44MTYiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfbWRfbGFyZ2UiIHk9IjEwMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBIMjIuMDFMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgaWQ9ImNxYSIvPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjx1c2UgZmlsbD0iI0Y3OEEwOSIgeGxpbms6aHJlZj0iI2NxYSIvPjxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0yMCAxMGwtNSA1LjQ4M0wxMCAxMEg3djE0aDNWMTMuNzZMMTMuNzQzIDE4aDIuNTQ2TDIwIDEzLjc2VjI0aDNWMTB6Ii8+PHBhdGggZD0iTTEgMnYzMGMwIC41NTUuNDQzIDEgLjk5MiAxaDI2LjAxNmEuOTk4Ljk5OCAwIDAgMCAuOTkyLS45OTdWOGwuMjkyLjcwNy03Ljk5LThMMjIuMDEgMUgxLjk5MkEuOTk1Ljk5NSAwIDAgMCAxIDJ6TTAgMkMwIC44OTUuODkgMCAxLjk5MiAwSDIyLjAxTDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGwtb3BhY2l0eT0iLjA1IiBmaWxsPSIjMDAwIi8+PHBhdGggZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIgZD0iTTMwIDE0bC04LTdoOHoiLz48cGF0aCBkPSJNMjIgMGw4IDhoLTYuMDAyQTEuOTkzIDEuOTkzIDAgMCAxIDIyIDYuMDAyVjB6IiBmaWxsPSIjRkZCRjgxIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX211c2ljX2xhcmdlIiB4PSIzNCIgeT0iMTAyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXRoIGlkPSJjcmEiIGQ9Ik0wIDJDMCAuODk1Ljg5MyAwIDEuOTk4IDBIMjIuMDhMMzAgNy45NjJWMzJhMiAyIDAgMCAxLTEuOTkyIDJIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjRjI4RjY2IiB4bGluazpocmVmPSIjY3JhIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2NmwtNy03eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiNGREIyOTMiLz48cGF0aCBkPSJNOS45ODIgMTAuODM2Yy0uNTQyLjA5LS45ODIuNjEtLjk4MiAxLjE2MlYyMGMtMS4wODIuMjU4LTIgMS4yMTItMiAyLjM4OWEyLjIzNyAyLjIzNyAwIDAgMCAyLjI0MiAyLjIzIDIuMjMxIDIuMjMxIDAgMCAwIDIuMjI4LTIuMDc3bC4wMTQtLjEzNmMuMDAxLS4wMjYtLjAxNS05LjA5NS0uMDE1LTkuMDk1bDcuMzAzLTEuMTc3djUuMDc1Yy0uMDE2IDAtLjAzLS4wMDQtLjA0Ny0uMDA0YTIuMjM3IDIuMjM3IDAgMCAwLTIuMjQzIDIuMjMxIDIuMjM3IDIuMjM3IDAgMCAwIDIuMjQzIDIuMjMxYzEuMiAwIDIuMTctLjkzOCAyLjI3NS0xLjY2N1Y5Ljk5NmMwLS41NS0uNDQxLS45MjItLjk4Mi0uODMyTDkuOTgyIDEwLjgzNnoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfbm90ZV9sYXJnZSIgeD0iNjgiIHk9IjEwMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY3NhIiBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBoMjAuMDE5TDMwIDcuOTYyVjMyYTIgMiAwIDAgMS0xLjk5MiAySDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIvPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjx1c2UgZmlsbD0iIzVDOURGNCIgeGxpbms6aHJlZj0iI2NzYSIvPjxwYXRoIGQ9Ik0xIDMyYzAgLjU1NS40NDMgMSAuOTkyIDFoMjYuMDE2YS45OTguOTk4IDAgMCAwIC45OTItLjk5N3MuMDg5LTIzLjUtLjAxMy0yMy42MDJDMjYuNDI1IDUuODM2IDIxLjczMyAxIDIxLjU5NSAxSDEuOTkyQS45OTUuOTk1IDAgMCAwIDEgMnYzMHpNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBoMjAuMDE2TDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGwtb3BhY2l0eT0iLjA1IiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIzIDdsNyAxdjZsLTctN3oiIGZpbGwtb3BhY2l0eT0iLjEiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjIgMGw4IDhoLTYuMDAyQTEuOTkzIDEuOTkzIDAgMCAxIDIyIDYuMDAyVjB6IiBmaWxsPSIjOURDREZGIi8+PHBhdGggZD0iTTIyLjEzMSAxNS40NmwtNS4wNjItNS4wN2MtLjM4My0uMzg0LS44NjgtLjM4NC0xLjI1MSAwbC02LjM5IDYuNDAyYy0uMjk4LjI2LS40ODcuNjQyLS40ODcgMS4wNjlsLS40MDEgNS4wNTVjMCAuNzgzLjIzMSAxLjAxNSAxLjAxMiAxLjAxNWw1LjE4OC0uNDAyYy4xNzQgMCAuMzQtLjAzMi40OTQtLjA5YS45NzQuOTc0IDAgMCAwIC40MzctLjI1Mmw2LjQ2LTYuNDczYy4zODMtLjM4NC4zODMtLjg3IDAtMS4yNTQiIGZpbGw9IiNGRkYiLz48cGF0aCBkPSJNMTkuNTkzIDEyLjkxN0w4Ljc3NyAyMy43MzNsLS4wNTctLjA2Yy4xNTEuMTg1LjQxMi4yNTIuODMyLjI1Mmw1LjE4OC0uNDAzYy4xNzQgMCAuMzQtLjAzMS40OTQtLjA4OWEuOTcyLjk3MiAwIDAgMCAuNDM3LS4yNTNsNi40Ni02LjQ3MmMuMTktLjE5MS4yODYtLjQwOC4yODctLjYyNCAwLS4yMTctLjA5Ni0uNDMzLS4yODctLjYyNGwtMi41MzgtMi41NDMiIGZpbGw9IiNEOUVDRkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfb3RoZXJfbGFyZ2UiIHg9IjEwMiIgeT0iMTAyIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXRoIGlkPSJjdGEiIGQ9Ik0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMEgyMi4wMUwzMCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBzdHJva2Utb3BhY2l0eT0iLjA1IiBzdHJva2U9IiMwMDAiIGZpbGw9IiNCNUJCQkUiIHhsaW5rOmhyZWY9IiNjdGEiLz48cGF0aCBkPSJNMSAzMmMwIC41NTUuNDQzIDEgLjk5MiAxaDI2LjAxNmEuOTk4Ljk5OCAwIDAgMCAuOTkyLS45OTdzLjA4OS0yMy41LS4wMTMtMjMuNjAyQzI2LjQyNSA1LjgzNiAyMS43MzMgMSAyMS41OTUgMUgxLjk5MkEuOTk1Ljk5NSAwIDAgMCAxIDJ2MzB6bS45OTItMzJoMjAuMDE2TDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMkMwIC44OTUuODkgMCAxLjk5MiAweiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2NmwtNy03eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiNFM0U1RTUiLz48cGF0aCBkPSJNMTUuNTI3IDI1aC0xLjA1NGMtLjI2IDAtLjQ3My0uMTk3LS40NzMtLjQ0MnYtMS4xMTZjMC0uMjQ0LjIxMi0uNDQyLjQ3My0uNDQyaDEuMDU0Yy4yNiAwIC40NzMuMTk4LjQ3My40NDJ2MS4xMTZjMCAuMjQ1LS4yMTIuNDQyLS40NzMuNDQyem0tNS41MjUtMTEuNTM1Yy4wNTgtLjcxNC4xNzctMS4zNjQuMzU2LTEuNzgyLjIzLS41MzguNTk5LTEuMDIgMS4xMDYtMS40NDRhNS4wNDEgNS4wNDEgMCAwIDEgMS42OTMtLjkzOEE2LjM0OCA2LjM0OCAwIDAgMSAxNS4xMjcgOWMxLjM5OCAwIDIuNTYzLjM4NCAzLjQ5MSAxLjE1NC45My43NjggMS4zOTYgMS43OTIgMS4zOTYgMy4wNzIgMCAuNTc0LS4xMiAxLjA5NS0uMzU5IDEuNTYyLS4yMzguNDY4LS43NDUgMS4wNS0xLjUyIDEuNzQ2LS43NzYuNjk4LTEuMjkxIDEuMTk0LTEuNTQzIDEuNDlhMi45NTQgMi45NTQgMCAwIDAtLjU3OCAxLjA1NWMtLjA5Mi4yODkuMDIgMS44NzYgMCAyLjMwNi0uMDE0LjMxOC0uMzAyLjU3LS42NDMuNTdoLS43MjZjLS4zNzUgMC0uNjY1LS4zMDEtLjY0Ni0uNjUxLjAyOC0uNTA5LS4wNzctMi4xNjEuMDIzLTIuNTA2LjEzOC0uNDgxLjM0NC0uOS42MjMtMS4yNi4yNzYtLjM2Ljc3NC0uODg3IDEuNDk2LTEuNTg1LjcyMi0uNjk3IDEuMTg3LTEuMjA0IDEuMzk1LTEuNTIuMjA2LS4zMTYuMzEtLjc4OC4zMS0xLjQxM3MtLjIzOC0xLjE3OC0uNzE0LTEuNjZjLS40NzctLjQ4Mi0xLjE2Ny0uNzIyLTIuMDc0LS43MjItMS44NzIgMC0yLjg4OCAxLjA0LTMuMDQ0IDIuOTQ4LS4wMjUuMzEyLS4zMjIuNTQ0LS42NTYuNTQ0aC0uNzExYy0uMzgxIDAtLjY3NC0uMzEtLjY0NS0uNjY1eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIzNCIgaGVpZ2h0PSIzOCIgdmlld0JveD0iLTIgLTIgMzQgMzgiIGlkPSJzcmMtLXN2Zy0tdHlwZV9wZGZfbGFyZ2UiIHg9IjE1NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik0wIDJDMCAuODk1Ljg5MiAwIDEuOTk3IDBoMjAuMDY3TDMwIDh2MjQuMDAzQTEuOTk4IDEuOTk4IDAgMCAxIDI4LjAwOCAzNEgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiIGZpbGw9IiNGQTVDNDciLz48cGF0aCBkPSJNMSAzMmMwIC41NTUuNDQzIDEgLjk5MiAxaDI2LjAxNmEuOTk4Ljk5OCAwIDAgMCAuOTkyLS45OTdzLjA4OS0yMy41LS4wMTMtMjMuNjAyQzI2LjQyNSA1LjgzNiAyMS43MzMgMSAyMS41OTUgMUgxLjk5MkEuOTk1Ljk5NSAwIDAgMCAxIDJ2MzB6TTAgMkMwIC44OTUuODkgMCAxLjk5MiAwaDIwLjAxNkwzMCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6IiBmaWxsLW9wYWNpdHk9Ii4wNSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMyA3aDZsMSAxdjZsLTctN3oiIGZpbGwtb3BhY2l0eT0iLjEiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjIgMGw4IDhoLTZjLTEuMTA1IDAtMi0uODg2LTItMlYweiIgZmlsbD0iI0ZFOUQ4RiIvPjxwYXRoIGQ9Ik0yMi4zMzcgMTguNjc1YTIuMDgxIDIuMDgxIDAgMCAwLTEuNjQtMS4wNzVjLS43NzUtLjA3NC0xLjg1OS4wMDUtMy4zNzcuMjM3YTEyNS40NiAxMjUuNDYgMCAwIDAtLjYxOC0uNTY2Yy0xLjA0LS45NDItMS45NTgtMi4zMDMtMi4xODMtMi42NDQuMjg2LTIuNjg5LjE1NC0zLjUwOC0uMDE0LTMuOTVDMTQuMTA1IDkuNjI3IDEzLjMzIDkgMTIuNDMyIDljLS42OSAwLTEuMzM0LjM5LTEuNjgyIDEuMDE4LS40MDIuNzI0LS4zNiAxLjYzMy4xMTkgMi40OS4yNTIuNDU0LjU5LjgyMyAxLjAxOCAxLjI5LjMwNS4zMzQuNjc1LjczNyAxLjExMiAxLjI4LS4wNTkuNTA1LS4xMjIuOTktLjE3OCAxLjQxNy0uMTM4IDEuMDU2LS4zMjQgMS44NjctLjUyIDIuNzI2bC0uMDE5LjA4MWMtLjE1Ni4wNjktLjMxNi4xMzctLjQ3OS4yMDYtLjg3LjM2Ny0xLjg1NS43ODQtMi42MjUgMS41MS0xLjQzMyAxLjM0OC0xLjIyMyAyLjQ3OC0xLjA2NiAyLjkwMUM4LjM1OSAyNC41ODYgOC45NjggMjUgOS43IDI1Yy43MzQgMCAxLjQ4MS0uNDI0IDIuMDUtMS4xNjdhMTAuOTY5IDEwLjk2OSAwIDAgMCAxLjc1Mi0zLjQyYy45MDQtLjM2NSAyLjM0Mi0uNzg2IDMuMDItLjkwNWwuMzQyLS4wNTkuMjI3LjIxMmMuNzIuNjcyIDEuNDI3IDEuMzMgMS45NDcgMS43NzQuNDI0LjM2Ljk2LjU1OCAxLjUxLjU1OGguMDAyYy44NjYgMCAxLjYzLS40OSAxLjk0Ny0xLjI0NS4yNjItLjYyOC4xOTktMS40NC0uMTYtMi4wNzN6bS0xMS41NDYgNC4wMDRjLS4yODIuMzY2LS42MTguNTg2LS44OTYuNTg2LS4wNTUgMC0uMTg3LS4wMS0uMjIzLS4xMDgtLjA2NC0uMTcyLjA2My0uNjM3LjY3My0xLjIxMi4zOTQtLjM3Mi45MDItLjY0OSAxLjQzNS0uODk1YTkuMTUgOS4xNSAwIDAgMS0uOTg5IDEuNjI5em0yLjU0NC05LjcxNWE1OC4zODUgNTguMzg1IDAgMCAwLS4yNDUtLjI2OGMtLjM2OS0uNDA0LS42MzYtLjY5NS0uOC0uOTktLjIwNi0uMzctLjI0OC0uNzE4LS4xMTYtLjk1N2EuNDc4LjQ3OCAwIDAgMSAuNDEyLS4yNTVjLjI3NiAwIC41MzMuMjU5LjcwNC43MDguMDM4LjA5OC4xMjYuNDc1LjA0NSAxLjc2MnptLjc0MSA1LjUzOGwuMDMyLS4xMzMtLjAyNC4wMTJjLjExLS41MTguMjEyLTEuMDc1LjI5OC0xLjcwOS4zNDcuNDQxLjc2Ny45MzIgMS4yMjUgMS4zNzYtLjQ2Ny4xMjEtMS4wMTQuMjgyLTEuNTMuNDU0em03LjEwNCAxLjQ3NGMtLjA4My4xOTgtLjMxOC4zMjgtLjU5OS4zMjhhLjg5MS44OTEgMCAwIDEtLjU3Ny0uMjEzIDM5LjAwOCAzOS4wMDggMCAwIDEtMS4xODctMS4wNjhjLjc1My0uMDgyIDEuMzMzLS4xMSAxLjc3NC0uMDYzLjIzMi4wMjEuNC4xMy41MTIuMzMuMTM3LjIzOS4xNDIuNTMyLjA3Ny42ODZ6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX3BwdF9sYXJnZSIgeD0iMTU2IiB5PSIzOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY3ZhIiBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTkxIDBIMjJsOCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjRTdBNzREIiB4bGluazpocmVmPSIjY3ZhIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2g2bDEgMXY2bC03LTd6IiBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIyIDBsOCA4aC02Yy0xLjEwNSAwLTItLjg4Ni0yLTJWMHoiIGZpbGw9IiNGM0NBOTEiLz48cGF0aCBkPSJNMTEgMTB2MTVoM3YtNWwyLjAxNy4wMjZjMi4xNDEgMCA0LjIxLS44MjMgNC4yMS00Ljk4IDAtMy41MDgtMS4wNTYtNS4wNDgtNC43NTUtNS4wNDZIMTF6bTMgN3YtMy45OThoMS4yMjJjMS42NjYtLjA0NyAxLjc3NS42MTkgMS43NzUgMS45MTQuMDQ0IDEuNDQtLjQ0NiAyLjA4NC0xLjc3NSAyLjA4NEgxNHoiIGZpbGw9IiNGRkYiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfc2Nhbl9sYXJnZSIgeD0iMTU2IiB5PSI3NiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBIMjIuMDFMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgaWQ9ImN3YSIvPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjx1c2UgZmlsbD0iIzQzRDlBRCIgeGxpbms6aHJlZj0iI2N3YSIvPjxwYXRoIGQ9Ik05IDExLjk5OWMwLS41NTIuNDU2LS45OTkgMS4wMDItLjk5OWg5Ljk5NmExIDEgMCAwIDEgMS4wMDIuOTk5VjIzYzAgLjU1Mi0uNDU2Ljk5OS0xLjAwMi45OTloLTkuOTk2QTEgMSAwIDAgMSA5IDIzLjAwMVYxMnoiIGZpbGw9IiNGRkYiLz48cGF0aCBkPSJNMTIuNSAxNC41aDVNMTIuNSAxNy41aDVNMTIuNSAyMC41aDUiIHN0cm9rZT0iIzQzRDlBRCIgc3Ryb2tlLWxpbmVjYXA9InNxdWFyZSIvPjxwYXRoIGZpbGw9IiNGRkYiIGQ9Ik0xMCA5VjhINnY0aDFWOXpNMjAgOVY4aDR2NGgtMVY5ek0xMCAyNnYxSDZ2LTRoMXYzek0yMCAyNnYxaDR2LTRoLTF2M3oiLz48cGF0aCBkPSJNMSAydjMwYzAgLjU1NS40NDMgMSAuOTkyIDFoMjYuMDE2YS45OTguOTk4IDAgMCAwIC45OTItLjk5N1Y4bC4yOTIuNzA3LTcuOTktOEwyMi4wMSAxSDEuOTkyQS45OTUuOTk1IDAgMCAwIDEgMnpNMCAyQzAgLjg5NS44OSAwIDEuOTkyIDBIMjIuMDFMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIiBkPSJNMzAgOHY2bC03LjUwNi02LjY3IDYuNTItLjMzeiIvPjxwYXRoIGQ9Ik0yMiAwbDggOGgtNi4wMDJBMS45OTMgMS45OTMgMCAwIDEgMjIgNi4wMDJWMHoiIGZpbGw9IiM4MEVGQ0UiLz48L2c+PC9zdmc+PHN2ZyB3aWR0aD0iMzQiIGhlaWdodD0iMzgiIHZpZXdCb3g9Ii0yIC0yIDM0IDM4IiBpZD0ic3JjLS1zdmctLXR5cGVfdGFibGVfbGFyZ2UiIHk9IjE0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY3hhIiBkPSJNMCAyQzAgLjg5NS44OTIgMCAxLjk5NiAwaDIwLjA1NkwzMCA3Ljk2MlYzMmEyIDIgMCAwIDEtMS45OTIgMkgxLjk5MkMuODkyIDM0IDAgMzMuMTA4IDAgMzJWMnoiLz48L2RlZnM+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48dXNlIGZpbGw9IiNFMTkyQjUiIHhsaW5rOmhyZWY9IiNjeGEiLz48cGF0aCBkPSJNMSAzMmMwIC41NTUuNDQzIDEgLjk5MiAxaDI2LjAxNmEuOTk4Ljk5OCAwIDAgMCAuOTkyLS45OTdzLjA4OS0yMy41LS4wMTMtMjMuNjAyQzI2LjQyNSA1LjgzNiAyMS43MzMgMSAyMS41OTUgMUgxLjk5MkEuOTk1Ljk5NSAwIDAgMCAxIDJ2MzB6TTAgMkMwIC44OTUuODkgMCAxLjk5MiAwaDIwLjAxNkwzMCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6IiBmaWxsLW9wYWNpdHk9Ii4wNSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMyA3bDcgMXY2bC03LTd6IiBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIyIDBsOCA4aC02LjAwMkExLjk5MyAxLjk5MyAwIDAgMSAyMiA2LjAwMlYweiIgZmlsbD0iI0YzQkRENCIvPjxwYXRoIGQ9Ik0xMyAxNkg5di00aDEydjRoLTZ2LTRoLTJ2NHptMCAySDl2NGgxMnYtNGgtNnY0aC0ydi00em0tNi02Ljk5M0M3IDEwLjQ1IDcuNDQ1IDEwIDggMTBoMTRjLjU1MiAwIDEgLjQ1IDEgMS4wMDd2MTEuOTg2QzIzIDIzLjU1IDIyLjU1NSAyNCAyMiAyNEg4Yy0uNTUyIDAtMS0uNDUtMS0xLjAwN1YxMS4wMDd6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX3R4dF9sYXJnZSIgeD0iMzQiIHk9IjE0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iY3lhIiBkPSJNMCAyQzAgLjg5NS44OSAwIDEuOTkxIDBIMjJsOCA4djI0LjAwM0ExLjk5OCAxLjk5OCAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjOUJCMUM1IiB4bGluazpocmVmPSIjY3lhIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2g2bDEgMXY2bC03LTd6IiBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIyIDBsOCA4aC02Yy0xLjEwNSAwLTItLjg4Ni0yLTJWMHoiIGZpbGw9IiNEM0RBRTEiLz48cGF0aCBkPSJNOSAxMy42OTFoMS44NDZzLjAyMy0uNDk5LjkyMy0uODQ1IDEuODQ2LjEzNSAxLjg0Ni4xMzV2Ny45MTNoLTEuODk4VjIzaDYuNTg3di0yLjEwNmgtMS45MnYtNy45MTNzLjc3LS41OTYgMS43OS0uMTM1YzEuMDIuNDYyIDEuMDIuODQ1IDEuMDIuODQ1SDIxVjExSDl2Mi42OTF6IiBmaWxsPSIjRkZGIi8+PC9nPjwvc3ZnPjxzdmcgd2lkdGg9IjM0IiBoZWlnaHQ9IjM4IiB2aWV3Qm94PSItMiAtMiAzNCAzOCIgaWQ9InNyYy0tc3ZnLS10eXBlX3ZpZGVvX2xhcmdlIiB4PSI2OCIgeT0iMTQwIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciPjxkZWZzPjxwYXRoIGlkPSJjemEiIGQ9Ik0wIDJhMiAyIDAgMCAxIDIuMDAzLTJoMjAuMTI2TDMwIDcuOTYyVjMyYTIgMiAwIDAgMS0xLjk5MiAySDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIvPjwvZGVmcz48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjx1c2Ugc3Ryb2tlLW9wYWNpdHk9Ii4wNSIgc3Ryb2tlPSIjMDAwIiBmaWxsPSIjOTk5QUVGIiB4bGluazpocmVmPSIjY3phIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2w3IDF2N2wtNy04eiIgZmlsbC1vcGFjaXR5PSIuMSIgZmlsbD0iIzAwMCIvPjxwYXRoIGQ9Ik0yMiAwbDggOC4wMDhoLTYuMDAyYTEuOTk0IDEuOTk0IDAgMCAxLTEuOTk4LTJWMHoiIGZpbGw9IiNDMkMzRjgiLz48cGF0aCBmaWxsPSIjRkZGIiBkPSJNMTAuOTkgMTEuMTQybDkuODQ0IDYuMTI1LTkuODQ0IDYuMTM3eiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIzNCIgaGVpZ2h0PSIzOCIgdmlld0JveD0iLTIgLTIgMzQgMzgiIGlkPSJzcmMtLXN2Zy0tdHlwZV93b3JkX2xhcmdlIiB4PSIxMDIiIHk9IjE0MCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48cGF0aCBpZD0iZGFhIiBkPSJNMCAyQzAgLjg5NS44ODkgMCAyLjAwOCAwaDE5Ljk2NkwzMCA4LjAyNXYyMy45OEExLjk5NyAxLjk5NyAwIDAgMSAyOC4wMDggMzRIMS45OTJDLjg5MiAzNCAwIDMzLjEwOCAwIDMyVjJ6Ii8+PC9kZWZzPjxnIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCI+PHVzZSBmaWxsPSIjNUJCQUVGIiB4bGluazpocmVmPSIjZGFhIi8+PHBhdGggZD0iTTEgMzJjMCAuNTU1LjQ0MyAxIC45OTIgMWgyNi4wMTZhLjk5OC45OTggMCAwIDAgLjk5Mi0uOTk3cy4wODktMjMuNS0uMDEzLTIzLjYwMkMyNi40MjUgNS44MzYgMjEuNzMzIDEgMjEuNTk1IDFIMS45OTJBLjk5NS45OTUgMCAwIDAgMSAydjMwek0wIDJDMCAuODk1Ljg5IDAgMS45OTIgMGgyMC4wMTZMMzAgOHYyNC4wMDNBMS45OTggMS45OTggMCAwIDEgMjguMDA4IDM0SDEuOTkyQy44OTIgMzQgMCAzMy4xMDggMCAzMlYyeiIgZmlsbC1vcGFjaXR5PSIuMDUiIGZpbGw9IiMwMDAiLz48cGF0aCBkPSJNMjMgN2g2bDEgMXY2bC03LTd6IiBmaWxsLW9wYWNpdHk9Ii4xIiBmaWxsPSIjMDAwIi8+PHBhdGggZD0iTTIyIDBsOCA4aC02Yy0xLjEwNSAwLTItLjg4Ni0yLTJWMHoiIGZpbGw9IiM4QUQ1RkYiLz48cGF0aCBkPSJNMTguNjkgMTFjLS4wOSAwLS4xNjQuMDYzLS4xNjQuMTM5djEuNjY1YzAgLjA3Ni4wNzUuMTM4LjE2NC4xMzhoMS44NjJjLjEwMiAwIC4xOC4wOC4xNjEuMTY2bC0xLjQzIDYuNjA2aC0uNDk3bC0yLjA0OC04LjYwMmMtLjAxNC0uMDY0LS4wODItLjExMi0uMTYxLS4xMTJoLTIuOTU4Yy0uMDc2IDAtLjE0NC4wNDUtLjE2LjExbC0yLjMgOC42MDRoLS40NDdsLTEuNzg4LTguNTk4Yy0uMDEzLS4wNjctLjA4Mi0uMTE2LS4xNjEtLjExNkg2LjE2NWMtLjEwNCAwLS4xODMuMDgtLjE2Mi4xNjdMOS4xNiAyMy44OWMuMDE2LjA2NS4wODMuMTExLjE2Mi4xMTFoMi45NThjLjA3NyAwIC4xNDQtLjA0Ni4xNi0uMTFsMi4zODUtOS4xODljLjAzNy0uMTQ4LjI4OC0uMTQ3LjMyMS4wMDJsMi4xODUgOS4xODVjLjAxNi4wNjUuMDg0LjExMi4xNjIuMTEyaDIuODg1Yy4wNzcgMCAuMTQ1LS4wNDYuMTYtLjExbDMuMjk4LTEyLjcyMmMuMDIyLS4wODYtLjA1Ni0uMTY4LS4xNi0uMTY4SDE4LjY5eiIgZmlsbD0iI0ZGRiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdW5kZXJsaW5lIiB5PSIyMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48ZyBmaWxsPSIjNTI1QzZGIj48cGF0aCBkPSJNNCAxNmgxMXYtMUg0djF6TTYuMjY0IDN2NS41NzZjMCAxLjA4LjIzMSAxLjg5Ni43MjQgMi40NTEuNTEuNTcgMS4zMS44NjMgMi40MDQuODYzIDEuMDggMCAxLjg4LS4yOTMgMi40MDUtLjg2My40NzctLjU1NS43MjQtMS4zNzIuNzI0LTIuNDVWM2gxLjI2NHY1LjU2MWMwIDEuNDMzLS4zNyAyLjUyOC0xLjA5NSAzLjI4My0uNzU1Ljc3LTEuODQ5IDEuMTU2LTMuMjk4IDEuMTU2LTEuNDQ4IDAtMi41NDMtLjM4Ni0zLjI4Mi0xLjE0QzUuMzcgMTEuMDkgNSA5Ljk5MyA1IDguNTZ2LTUuNTZoMS4yNjR6Ii8+PC9nPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdW5kbyIgeD0iMjIiIHk9IjIyMiIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPjxwYXRoIGQ9Ik05LjI1OSA1LjcxNGE4LjIzMyA4LjIzMyAwIDAgMC01Ljg0IDIuNDJMMSA1LjcxM3Y3LjI5M2g3LjIyOUw1LjY4NCAxMC40YzEuNDIxLTEuMjE0IDMuMjQxLTEuOTc1IDUuMjU2LTEuOTc1IDIuNDIxIDAgNC41NyAxLjM2NiA2LjA2IDMuMDQ0LTEuMTQ4LTMuMTgyLTQuMTY1LTUuNzU1LTcuNzQxLTUuNzU1eiIgZmlsbD0iI0NCQ0JDQiIvPjwvZz48L3N2Zz48c3ZnIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iLTIgLTIgMjIgMjIiIGlkPSJzcmMtLXN2Zy0tdW5kb19hY3RpdmUiIHg9IjQ0IiB5PSIyMjIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGcgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj48cGF0aCBkPSJNOS4yNTkgNS43MTRhOC4yMzMgOC4yMzMgMCAwIDAtNS44NCAyLjQyTDEgNS43MTN2Ny4yOTNoNy4yMjlMNS42ODQgMTAuNGMxLjQyMS0xLjIxNCAzLjI0MS0xLjk3NSA1LjI1Ni0xLjk3NSAyLjQyMSAwIDQuNTcgMS4zNjYgNi4wNiAzLjA0NC0xLjE0OC0zLjE4Mi00LjE2NS01Ljc1NS03Ljc0MS01Ljc1NXoiIGZpbGw9IiM1MjVDNkYiLz48L2c+PC9zdmc+PC9zdmc+"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAABOUlEQVR42mL8//8/g/G8DwxIgA2IS4F4DxCfZCABnE0SYGDCIu4MxC1AvAOIVRhIBNgM1IDSAkC8AYj5KTVQE4mtDcSLgJiRWgaCgB8QN1HTQBCoBuIQcgwUA2JhLOpAXl4IxHqkGqiBRy0XEG8EYlFSDNQi4AAFIF4FxKzEGqhJRDA5AHEfNbyMDHKAOIVaLoSBqUBsjc9AXiCWJcFAUJ5fC8QyuAzUYCAdiAPxemgKwDBQk4E8YALEs0kx8C+09JkJxHdxqIkC4iwQg4WAgSDD4oB4GZKYIhC7QLETEItAxYOAeBo+A38BcTQQr0ETvw/14myoDw2ght9DdiE7ECujGRYKxJsIhN8/ID4HxQzIBqoBMTOU/R3q/B3kxBDMQB4o/Q1a/u0lM8bhsXwCmj/dKTEMBAACDAA6Oi9O6DlyWwAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAmVBMVEVVVVVVVVVVVVVTU1NSUlJTU1NRUVFQT1BPT09OTk5MS0xKSkpJSEhgYGBdXFxycHFycXKBgYF+fn6VlJWRkJCRkJGQj4+NjY2KiYmhoaGtra2qqqqpqKimpqanpqa0s7O0tLSzs7O9vb2+vb3Hx8fR0NDR0dHZ2dnk4+Pj4+Pi4uLr6+vq6enq6urx8fH4+Pj5+Pj5+fn///++amiSAAAAMnRSTlMlc4CBgoKDhIWGiImLj5KXl5+io6amp6mrq7O1t7i4vr6/xcXN1NTc4eLj6erq8fj4+MKLdMMAAADeSURBVEjH7dTJbsJADAbgxJ7FpqG0bF1IFwoFhiVD/vd/uB7ChUNJ5lap+U8zkj/J9kiTZTklJM/S6onyjBLTgx78JWAdJwE7O0gS8N+Y2wTAD8DWJwC3isCIuwM9PwNfrjMwi3C3RaWX/kS4BUhYSAmUprkBchvwY7zXImLf1Cmgt4HfxBBCMzaLFkCh111dAx7G9+ls+gasHQkukd+B+6zUstUT4pC7AK0+HBG5JVCa9pZYnjD2ROTHwHFgWoc2O6B+ZeKXGkA94ba1slcVQ0RGtDl1eLj+1+jBfwY/i3slL0LG/YYAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAolBMVEVVVVVVVVVVVVVUVFRVVVVTU1NUVFRRUVFSUlJQUFBPTk9MTExNTU1dXV1aWlpraWpramt3dnd1dXWGhoaEg4OEg4SBgYGDgoJ/f3+RkZGdnZ2amZmbmpqbm5uZmJinp6elpaWmpaWwsLC7urrFxMTFxcXPz8/Pz8/b29vZ2dna2trk5OTi4uLs7Ozt7Oz29vb39vb39/f29fX29fb29vb///8BtdBsAAAANXRSTlNYt7jAwMHBwsLDxMXFx8nLy8/R0dPT1NTW1trb29vc3t/f4ubq6u3u8PHx9PX4+Pv7+/z8/FS6DEgAAADfSURBVEjH7dRJU8JAEAXgYC+PNiKK4B4XXBMRjPD+/1/zEC4cJJmbVead5tBfTU931WTZQBMyyNLqVQ8yTUwPevCXgJsnAZ99IAngmReeAOSEfEUCGM7X5Fi6g/i6JOfWGVhRHb3xM7YDALwFoCpQkEVzBUjsB366Oo78m2VTF2TsB3jZlFW5JseujsjJPHa72gUyWt1MZ9M78mmo4Db4Hdj9Mtw9FtyMpAuI5aOpqj2Qt9bekuCcE6gqJuTi0Fofbe9kfS0qVzXJ+kzaxiqIgKmqIZpTh8X1v0YP/jP4AUh9Nkgxwp+OAAAAAElFTkSuQmCC"},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAh1BMVEVVVVVTU1NSUlJTU1NRUVFQT1BOTk5PT09OTk5MTExKSkpJSUlycnJycHFycXJwcHCGhoaCgYKRkJGQj4+NjY2Mi4udnZ2qqampqKinpqakpKSzsrK/v7+8u7vLy8vJyMjHx8fT09PR0NDPz8/a2trk4+Pj4+Pi4uLq6ury8vLx8fH4+Pj///8RUosEAAAALHRSTlOAgYKCg4SFhYaHiYqWl5eYm56mp6mqr7a3uLq/xMfKzM3S1NXb4eLj6vDx+I8LeUsAAACxSURBVEjH7ZPJEoMgEEQdRMCY1SRmMzGLcaP///sCVs4Kd955uug3U0RRIBCYgBgjrwAvS+4VUINWPvNxAZyZRyCpNVrpobzUV2BFHspVpvF011b9Trzhrh0X3SI9jtok1YicrCeboWlaWG2JP1MboDUOeb7/WG2nAK9qQcQ2MNpOlVJ9sjcTnZs2iRsyEyB1By5y/hbsC/Rbs6qHrf6K519IlErMGHFhunMKXz0QmOYHEpYPZARp1wIAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAAmVBMVEVVVVVVVVVVVVVUVFRVVVVTU1NUVFRRUVFSUlJPT09QUFBMTExNTU1raWpramtpaWl6enp4d3iEg4SBgYGDgoKBgICPj4+amZmbm5uXl5elpKSysrKxsLCvrq69vL27urq8u7u8vLzHx8fExMTFxMTPz8/Q0NDb29vZ2dna2dna2trj4+Pi4uLs7Ozt7e329vb19fX29vb///8rOHeJAAAAMnRSTlOevb7AwMHBwsLDw8XFy8vMzc/T1NTV19vb3eDh4uPl5ubm6erq7e3w8fHx9PX4+Pv8/PE+aukAAADGSURBVEjH7dTJEoIwEATQQJgMREXFXdxXXACd//84CXqxLCC5eUhfcnqV7kpVGHM8gziMuZ5RXOYZxgIL/glwAG4EII7BCMj0KU2AGBNNwQDg8UEJ6gMe5jOijtAGsNi2nrT2tYHM+vJA1bPZz+RbOxiVswXKMijqACbp5ZqQmo30CdYAEdIgioZ7NVsL+JuTFAK6VMzWqhTk5ZvJe+XsL8DlnFqgziXRBHkjgDNR1iuWrFT1nWi+Ad+Nua+6+9x+AhZYUJ8XXfYyh6P7eHAAAAAASUVORK5CYII="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAABAlBMVEVVVVVVVVVVVVVVVVVVVVVTU1NSUlJTU1NRUVFQT1BOTk5PT09OTk5MTExMSktMS0xKSkpJSUlKSUlJSEhtbW1HR0dsa2xra2tqamppZ2hpaGlpaWlmZmZmZmaCgoKAgICBgYGAgIBhYGB+fn59fX17eXmSkpKTk5OSkpKQkJCPj4+ioqKgoKCgn5+gn6Cfn5+enZ2dnZ2cm5uvr6+sq6upqam5uLm3t7e2trbLy8vKysrLysrKysrJycnU1NTU09PU1NTS0tLc3Nzb29va2dna2trj4+Pi4uLj4uLi4eHp6enp6eno6Ojp6Ojp6eno6Ojw8PDv7+/09PT19fX6+vr////xn5ujAAAAVXRSTlMlcnN0gIGCgoOEhYWGh4iIiYqKi4uMjI2Oj4+PkJGTlJSVlpeYm5ycnZ6fpKWmpqeoqaqrr7G1t7jExcXGx8vMzM7S1NXV2tvb3OHi4+Pj5Onq8fH4zYRYuQAAAWJJREFUSMft1FlTwjAQB/Aq2bQhqeCB4gkKIirQiidQUQHPHlJgv/9XMY0vMNMyw6Mj+5BpOvubyf6bqUYWLG0JluD/AoA5ACgQnXFZhmqTC70swiyaBke9PK26qhiJmrcIxxbVKxU9HmwPP4SFTdtuopBbjg0Q2DbYr48BemlybqHT6TgKCLQU4L7PE2ZgBTYDbJZFR5heAtCrVo1NHUngoO3gt+OMgvgj0S9E00IvCLzwQo4pXN/1cCSXp3gAbBMzFub6LyehSwm9uzf5Bj6a6XKnAPEfTkQgWw7x1QSiwomGhjrWE0H2Bm+fr8JwH4gKRwFLxhWf0hrm3jHsHu8Ne7oEnmlEKTE7AUC+j58Pp+sZIQ52DcKCkSMD9trtQQKgb8PD1nisrsbkGoxu9OD7rhsmzABnO9Tg+VpDVtUgYKh7yHm61CrCnOsNqmbe6LD8CSzBnwSri/WnNC21SP+K9gMWPFrvajbpcQAAAABJRU5ErkJggg=="},function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAMAAABg3Am1AAAA3lBMVEVVVVVVVVVVVVVVVVVVVVVVVVVUVFRVVVVTU1NUVFRRUVFSUlJPT09QUFBOTU5PTU5PTk9MTExNTExNTU1LS0tlZWVmZmZlZWVjYWJjYmNhYGBhYWF2dnZeXV10c3R1dHV1dXVzc3NycXGGhoaEhISFhYWDg4OTk5ORkZGSkZGSkZKQkJCRkJCRkZGPjo6fn5+dnJycnJyrqqqpqamoqKi/v7++vb2+vr69vb3Hx8fIyMjS0dLQ0NDa2trZ2dna2dni4uLh4eHi4eHi4uLp6enq6urp6enx8fH5+fn///8EyOYYAAAASXRSTlOSnrm6vb7AwMHBwsLDw8TExMXFxcbGxsfIyMnJysvLy8vMzc3Ozs/S09PT1NTU1dbY2drb3OHi4uPm5unq7O3t8PHx8fT09fj7OSuUwgAAAWBJREFUSMft1FtPwjAYBuBx6gmKQ0FEUeZhKozh2c0xcWWw8f3/P2Q7biBZSXanyd6LJU2+J2nfNjMqdVwg9YrRwIXSMHDBlKAEfxYgdABQgjBlKs1sTH7IwxDto10wnPeJHcdRFEcMq+FTzMAj1LZpPuitf7gLM8eZAZdLBhPKJWBxzDRbGm3upuB7np8BDu4WCKEBiFlsDzisDT43dYDajxO2syUOoaTi0081gEQALReETHIvj8mXYikglcsgHyDWAdOFbvh1mUQEk9e3FjsG3+TXnoXyL46DOYWTqxWELYqzctSh6RjGVAfaz/ASOMlqgHBWTgZcWVd+S0fQXcAqsAbrOVXAJKol5mgA7YeweL/pmJxfnDUlSH3VkueFGkC+1+demqqnEW+eEAmEiGVFS5FozkBve4Sw/kTFJhgRtg0ffQzRgedNVfYeNdpdlj+BEvwjUC02XzOMWpH5qvELML9rtx8tx8AAAAAASUVORK5CYII="},function(e,t,n){var o,i;o=[n,t,n(0),n(2),n(45),n(1)],void 0===(i=function(e,t,n,o,i,r){"use strict";var a={align:{type:"Enum",possible:{left:!0,right:!0,center:!0,justify:!0},default:"left"},"line-height":{type:"Number",default:1.75},indent:{type:"Number",default:0},"text-indent":{type:"Number",default:0},width:{type:"Number",default:null},float:{type:"Enum",possible:{none:!0,left:!0,right:!0},default:"none"},height:{type:"Number",default:1},color:{type:"String",default:"#999999"},"back-color":{type:"String",default:""},padding:{type:"String",default:""}},s={},l={},c={};return s[o.HR]={width:{type:"Number",default:100},margin:{type:"String",default:"none"}},l[o.PARAGRAPH]=["align","indent","text-indent","line-height","back-color","padding"],l[o.LIST_ITEM]=["align","indent","text-indent","line-height","back-color","padding"],l[o.HEADING]=["align","indent","text-indent","line-height","back-color","padding"],l[o.CATALOGUE]=["align","indent","text-indent","line-height","back-color","padding"],l[o.TODO]=["align","indent","text-indent","line-height","back-color","padding"],l[o.IMAGE]=["align","width","float","height","back-color","padding"],l[o.ATTACHMENT]=["align","float","back-color","padding"],l[o.HR]=["align","width","height","color","back-color","padding","margin"],l[o.TABLE]=["back-color","padding"],l[o.QUOTE]=["line-height","back-color","padding"],l[o.CODE]=["back-color"],n.each(o.getAllBlockTypes(),function(e){l[e]||r.warn("no block style config for block["+e+"]")}),n.each(o.getAllBlockTypes(),function(e){var t={},o=l[e]||[],i=s[e];n.each(o,function(e){i&&i[e]?t[e]=i[e]:a[e]?t[e]=a[e]:r.error("no config for style named ["+e+"]")}),c[e]=t}),r.log("xml block style config",c),i(c)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(40),n(1),n(81),n(19)],void 0===(i=function(e,t,n,o,i,r,a){"use strict";return function(){function e(e){o(r.checkValid(e)),this.char=e,this.length=e.length,this.styles={}}return e.fromJSON=function(t){if(t&&t.char){var o=new e(t.char);return n.each(t.styles,function(e,t){o.setStyle(t,e)}),o}},e.prototype.clone=function(){var t=new e(this.char);return t.styles=n.clone(this.styles),this.unknownStyles&&(t.unknownStyles=n.clone(this.unknownStyles)),t},e.prototype.getStyle=function(e,t,o){void 0===t&&(t=!0);var r,s=t&&o&&void 0!==o[e]?o[e]:null,l=a.getConfig(e);return o&&o[e]&&!this.styles[e]?r=o[e]:l?null==(r=this.styles[e])?t?null===s?l.default:s:null:(n["is"+l.type](r)||(i.warn("The value `"+r+"` of `"+e+"` is not valid type!"),r=null),t?null==r?null===s?l.default:s:r:r===l.default?l.default:r):null},e.prototype.getStyles=function(e){var t=this,o={},i=a.getAllConfig();return n.each(i,function(n,i){o[i]=t.getStyle(i,!0,e)}),o},e.prototype.getUnknownStyle=function(e){var t=this.unknownStyles;if(t)return t[e]},e.prototype.isLineBreak=function(){return"\r"===this.char||"\n"===this.char},e.prototype.removeStyles=function(){this.styles={}},e.prototype.setStyle=function(e,t,o){var r=this.styles,s=a.getConfig(e);if(s){if(t&&!n["is"+s.type](t))switch(s.type){case"Number":t=Number(t),t=isNaN(t)?s.default:t;break;case"Boolean":t=t+""=="true";break;default:i.warn("The value `"+t+"` of `"+e+"` is not valid type!"),t=null}!t||(s.equalDefault?s.equalDefault(t):t===s.default)?(delete r[e],o&&o[e]&&(r[e]=t)):r[e]=t}else i.warn("The RichText does not support `"+e+"` style!")},e.prototype.setUnknownStyle=function(e,t){a.isSupport(e)?i.warn("The RichText supports `"+e+"` style!"):(this.unknownStyles||(this.unknownStyles={}),this.unknownStyles[e]=t)},e.prototype.toJSON=function(){var e=this,t={char:e.char},o={},i=!1,r=a.getAllConfig();return n.each(r,function(t,n){var r=e.getStyle(n,!1);r&&(o[n]=r,i=!0)}),i&&(t.styles=o),t},e.prototype.toString=function(){return this.char},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(108),n(45),n(28)],void 0===(i=function(e,t,n,o,i){"use strict";var r="transparent",a="#000000";return o({bold:{key:"b",default:!1,type:"Boolean"},italic:{key:"i",default:!1,type:"Boolean"},underline:{key:"u",default:!1,type:"Boolean"},strike:{key:"s",default:!1,type:"Boolean"},"font-family":{key:"ff",default:n.DEFAULT_FONT,type:"String"},"font-size":{key:"fs",default:14,type:"Number"},color:{key:"cl",default:a,type:"String",equalDefault:function(e){return e===a||i.equals(e,a)}},"back-color":{key:"bc",default:r,type:"String",equalDefault:function(e){return e===r||i.equals(e,r)}},href:{key:"href",default:"",type:"String"}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(63),n(2),n(9)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.fromXml=function(e){throw new Error("HandWrite do NOT support fromXml till now")},t.prototype.canDrawedByNative=function(){return!1},t.prototype.clone=function(){return new t({block:this._rangeProps.block})},t.prototype.collapse=function(){},t.prototype.getDataAsJSON=function(){var e=this._rangeProps.block.toJSON();return(i.IS_WEB_NOTE||i.IS_WEB_GROUP)&&e.resource&&!/^http/i.test(e.resource)&&(e.resource=location.protocol+"//"+location.hostname+e.resource),e},t.prototype.getDataAsHtml=function(e){return this._rangeProps.block.toHtml(null,null,e)},t.prototype.getDataAsPlain=function(){return this._rangeProps.block.toPlain()},t.prototype.isCollapsed=function(){return!1},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=o.HANDWRITE,this._rangeProps={block:t.block}},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(63)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.clone=function(){return new t({block:this.block})},t.prototype.collapse=function(){},t.prototype.isCollapsed=function(){return!1},t.prototype.getDataAsHtml=function(){return this.block.toHtml()},t.prototype.getDataAsJSON=function(){return this.block.toJSON()},t.prototype.getDataAsPlain=function(){return this.block.toPlain()},t.prototype.canDrawedByNative=function(){return!0},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.HR},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(1),n(82)],void 0===(i=function(e,t,n,o,i){"use strict";return function(){function e(){}return e.renderTable=function(t,n,o){var i,r,a,s,l=t.getRowCount(),c=t.getColumnCount();for(i=(n=n||e._createTableEl()).querySelector("tbody"),e.table=t,a=0;a<l;a++){for(r=document.createElement("tr"),s=0;s<c;s++)t.getCell(a,s).isMergedCell()||r.appendChild(e._renderCell(a,s,null,{resourceMap:o}));r.style.height=t.getRowHeight(a)+"px",i.appendChild(r)}return e._renderColumns(n.querySelector("colgroup")),e.table=null,$(n).css({"border-collapse":"collapse","table-layout":"fixed","white-space":"nowrap",width:0}),n},e._createTableEl=function(){var e=document.createElement("table");return e.innerHTML="<colgroup></colgroup><tbody></tbody>",e},e._handleMergePointIfNeeded=function(e,t){if(t.isMergePoint()){var n=t.getMergePointAttr();n.width>0&&e.setAttribute("colspan",n.width),n.height>0&&e.setAttribute("rowspan",n.height)}},e._renderCell=function(t,o,r,a){r=r||document.createElement("td"),$(r).css({"font-size":14,color:"#393939",border:"1px solid #a7a7a7",overflow:"hidden","vertical-align":"middle","word-wrap":"break-word","background-color":"rgba(255, 255, 255, 0.3)"}),a=n.defaults(a||{},{withCellId:!0,resourceMap:null});var s,l=e.table.getCell(t,o),c=l.getContent();return a.withCellId&&r.setAttribute("data-cell-id",l.getCellId()),e._handleMergePointIfNeeded(r,l),e._setCellStyles(r,l.getBlockStyles(),!0),s=i.contentToHtml(c,a.resourceMap),r.innerHTML=s,r},e._renderColumns=function(t){var n=e.table;t?(t.innerHTML="",n.forEachColumn(function(e){var o=n.getColumnWidth(e),i=document.createElement("col");i.style.width=o+"px",t.appendChild(i)})):o.warn("parameter is not valid",t)},e._setCellStyles=function(e,t,n){var o;n=!1!==n,o=t.textAlign,e.style.textAlign="center"===o||"right"===o||"left"===o?o:"",o=t.verticalAlign,e.style.verticalAlign="top"===o||"middle"===o||"bottom"===o?o:"",n||"true"===t.wrap?e.style.whiteSpace="pre-wrap":e.style.whiteSpace="nowrap",o=t.backColor,e.style.backgroundColor=o&&"inherit"!==o&&"transparent"!==o?o:""},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(45)],void 0===(i=function(e,t,n){"use strict";return n({textAlign:{type:"Enum",possible:{left:!0,right:!0,center:!0,justify:!0},default:"left"},verticalAlign:{type:"Enum",possible:{top:!0,middle:!0,bottom:!0},default:"left"},wrap:{type:"Boolean",default:!1},backColor:{type:"String",default:"transparent"},"border|vertical":{type:"String",default:"1px solid #a7a7a7"},"border|horizontal":{type:"String",default:"1px solid #a7a7a7"}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return function(e,t,n,o){var i,r,a;for(i=0;i<n;i++)if(a=t?n-i-1:i,null==o){if(!1===e(a))return}else for(r=0;r<o;r++)if(!1===e(a,t?o-r-1:r))return}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(46),n(42)],void 0===(i=function(e,t,n,o){"use strict";return{attach:n,image:o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(161),n(162),n(163),n(164)],void 0===(i=function(e,t,n,o,i,r,a){"use strict";var s=[o,i,r,a];return function(e){e=e||{};var t,o,i,r=JSON.parse(JSON.stringify(e)),a=s.length,l=r,c=[],d=function(e){c.push(o.name+".js: "+e)};for(t=0;t<a;t++){if(i=(o=s[t]).checkAndFix(l),n.each(i.errors,d),!0===i.stopCheck)return{errors:c,fixedData:i.fixedData};l=i.fixedData}return{errors:c,fixedData:l}}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(84)],void 0===(i=function(e,t,n,o){"use strict";return function(){function e(){}return e.checkAndFix=function(e){var t,i,r,a=e.cells,s=a.length,l=!1,c=!1,d=[];for(t=0;t<s;t++)i=a[t],n.isObject(i)?null==(r=i.value)||n.isString(r)||(c=!0,i.value=r+""):(l=!0,a[t]=o());return l&&d.push("Some cell is NOT Object type"),c&&d.push("The value of some cell is not String type"),{errors:d,fixedData:e,stopCheck:!1}},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0===(i=function(e,t,n){"use strict";return function(){function e(){}return e.checkAndFix=function(t){var o=t.cells,i=t.heights,r=t.widths,a=e.IS_VALID(o,i.length,r.length),s=[];return!0!==a&&(s.push(a),n.each(o,function(e){delete e.mergeWidth,delete e.mergeHeight,delete e.mergePointDX,delete e.mergePointDY})),{errors:s,fixedData:t,stopCheck:!1}},e.IS_VALID=function(e,t,o){var i={},r="";return n.some(e,function(t,a){if(!i[a+""]){var s,l,c,d,u,h,p,g,f,m,y;if(t.mergeWidth||t.mergeHeight){if(t.mergeWidth&&!n.isNumber(t.mergeWidth))return r="The mergeWidth is not Number type",!0;if(t.mergeHeight&&!n.isNumber(t.mergeHeight))return r="The mergeHeight is not Number type",!0;if(null!=t.mergePointDX||null!=t.mergePointDY)return r="The cell data is not valid, index: "+a,!0;for(s=t.mergeWidth||1,l=t.mergeHeight||1,c=Math.floor(a/o),d=a%o,g=0;g<l;g++)for(u=c+g,p=0;p<s;p++)if(g>0||p>0){if((f=e[h=u*o+(d+p)]).mergeWidth||f.mergeHeight)return r="The merged cell should not have `mergeWidth` or `mergeHeight`, merge point cell index: "+a+", merged cell index: "+h,!0;if(f.value)return r="The `value` of merged cell should be empty string,merge point cell index: "+a+", index: "+h,!0;if(m=f.mergePointDX||0,y=f.mergePointDY||0,m!==p||y!==g)return r="The `mergePointDX` or `mergePointDY` of mergedCell is not valid, merge point cell index: "+a+",  merged cell index: "+h,!0;i[h+""]=!0}}i[a+""]=!0}}),r||!0},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0===(i=function(e,t,n){"use strict";return function(){function e(){}return e.checkAndFix=function(e){var t=e.cells,o=!1,i=[];return n.each(t,function(e){e.mergeWidth&&!e.mergeHeight?(e.mergeHeight=1,o=!0):e.mergeHeight&&!e.mergeWidth&&(e.mergeWidth=1,o=!0)}),o&&i.push("Some cell has no default value for mergeHeight or mergeWidth"),{errors:i,fixedData:e,stopCheck:!1}},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(67),n(84),n(165)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(){function e(){}return e.checkAndFix=function(e){if(!e.cells||!n.isArray(e.cells))return{errors:["The `cells` property is not Array type!"],fixedData:r(),stopCheck:!0};var t,a,s=e.cells,l=e.widths,c=e.heights,d=!0,u=!0,h=[];for(l&&n.isArray(l)||(d=!1,h.push("The `widths` property is not Array type!")),c&&n.isArray(c)||(u=!1,h.push("The `heights` property is not Array type!")),d||u?d?u||(c=[],0===l.length&&(l.length=5),c.length=Math.ceil(s.length/l.length)):(l=[],0===c.length&&(c.length=5),l.length=Math.ceil(s.length/c.length)):((l=[]).length=5,(c=[]).length=Math.ceil(s.length/l.length)),t=l.length*c.length,a=!1;t<s.length;)c.push(o.DEFAULT_ROW_HEIGHT),t=l.length*c.length,a=!0;for(a&&h.push("The widths.length * heights.length is less than cells.length"),t=l.length*c.length,a=!1;t>s.length;)s.push(i()),a=!0;return a&&h.push("The widths.length * heights.length is greater than cells.length"),a=!1,l=n.map(l,function(e){return e&&n.isNumber(e)?e:(a=!0,o.DEFAULT_COL_WIDTH)}),a&&h.push("The `widths` has unvalid value"),a=!1,c=n.map(c,function(e){return e&&n.isNumber(e)?e:(a=!0,o.DEFAULT_ROW_HEIGHT)}),a&&h.push("The `heights` has unvalid value"),{errors:h,fixedData:{cells:s,heights:c,widths:l},stopCheck:!1}},e}()}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(67),n(84)],void 0===(i=function(e,t,n,o){"use strict";return function(e,t){var i,r=[],a=[],s=[],l=(e=e||1)*(t=t||1);for(i=0;i<e;i++)a.push(n.DEFAULT_ROW_HEIGHT);for(i=0;i<t;i++)r.push(n.DEFAULT_COL_WIDTH);for(i=0;i<l;i++)s.push(o());return{cells:s,heights:a,widths:r}}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(){return{contains:function(e,t){if(!e||!t)return!1;var n=e.left+e.width,o=e.top+e.height,i=t.left+t.width,r=t.top+t.height;return e.left<=t.left&&e.top<=t.top&&n>=i&&o>=r},union:function(e,t){if(e&&t){var n=Math.min(e.left,t.left),o=Math.min(e.top,t.top);return e={left:n,top:o,width:Math.max(e.left+e.width,t.left+t.width)-n,height:Math.max(e.top+e.height,t.top+t.height)-o}}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(63)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.canDrawedByNative=function(){return!1},t.prototype.clone=function(){return new t({block:this.block})},t.prototype.collapse=function(){},t.prototype.getDataAsHtml=function(){return this.block.toHtml()},t.prototype.getDataAsJSON=function(){return this.block.toJSON()},t.prototype.getDataAsPlain=function(){return this.block.toPlain()},t.prototype.isCollapsed=function(){return!1},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.UNKNOWN},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.isCmdVersionMatchNoteVersion=function(e,t){return e-t==1},e.isMessageTooLarge=function(e){return e>5e3},e.newGUID=function(){var e="";return e+=Math.floor(10*Math.random()).toString().substr(0,1),e+=Math.floor(10*Math.random()).toString().substr(0,1),e+="-",e+=Date.now().toString()},e}();t.Utils=n}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(34),n(3),n(35),n(13),n(1),n(96),n(6),n(81),n(200),n(79),n(15),n(201),n(2),n(50),n(133),n(29),n(26),n(12),n(8),n(19),n(116),n(80)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k,C,w,A){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.entityCache={},t}return a(t,e),t.createBlank=function(e,n){var o=v.createBlank(e);return n||(n=new t({})),n.append(o),n},t.fromHtml=function(e,o,i,r){var a,s=c.parseHtml(e);return o||(o=new t({})),a=(r=n.defaults(r||{},{isAsync:!1,progressCallBack:function(){}})).progressCallBack,t._parseHTMLInBatch(s,0,o,i,a,r.isAsync)?o:null},t.fromOCR=function(e,o,i){var r=c.parseOCR(e,i),a=0;return o=o||new t({}),n.each(r,function(e){e&&(o.append(e),a++)}),a?o:null},t.fromXml=function(e,o,i,r){var a,s,c,h,g,f,m={},b={};return o||(o=new t({})),f=(r=n.defaults(r||{},{isAsync:!1,progressCallBack:function(){}})).progressCallBack,n.isString(e)?(e=u.clear(e),a=$.parseXML(e)):a=e,f({percent:.1}),o.setContentStatus(!0),l.log(a),(c=(s=$(a).find("note:first")).attr("schema-version"))&&o.setSchemaVersion(c),h=parseInt(s.attr("file-version"),10),isNaN(h)&&(h=0),o.setFileVersion(h),s&&s.get(0)?(s.find("head").children().each(function(e,t){var n;switch(t.nodeName){case"list":n=I.fromXml(t),m[$(t).attr("id")]=n;break;case"catalogue-wrap":n=y.fromXml(t),b[$(t).attr("id")]=n;break;case"header":n=_.fromXml(t),o.setHeaderFooter(n,!1,!0);break;case"footer":n=_.fromXml(t),o.setHeaderFooter(n,!0,!0);break;default:n=$(t).attr(d.COMPAT),p.isCompatible(n)&&(n=t.cloneNode(!0),o.headUnknownNodeList.push(n))}}),f({percent:.15}),g=s.find("body").children(),t._parseXMLBodyInBatch(g,0,o,m,b,i,f,r.isAsync),o):(o.isBlank()&&o.append(v.createBlank()),f({percent:1}),o.setContentStatus(!1),o.updateContentParseTimer(null),o)},t.unescape=function(e){var t=document.createElement("span");return t.innerHTML=e,t.textContent},t._parseHTMLInBatch=function(e,o,i,r,a,s){var l,c,d,u=Date.now(),h=!1,p=i.getExtraInfo("pcTodoMap");if(null==e&&0===e.length)return a({percent:1}),i.updateContentParseTimer(null),!1;for(;o<e.length;)if(l=e[o],m.isImage(l)&&r&&r.length>0&&n.each(r,function(e){e.resId!==l.getResId()||l.setImageInfo(e)}),m.isTodo(l)&&l.isFromOldTodo()&&((d=l.getLegacyResId())&&p&&p[d]?(l.setText(t.unescape(JSON.parse(p[d]).content)),l.setChecked(JSON.parse(JSON.parse(p[d]).checked))):l=null),l&&(i.append(l),h=!0),++o>=e.length?(a({percent:1}),i.updateContentParseTimer(null)):a({percent:.15+o/e.length*.85}),s&&Date.now()-u>100){c=setTimeout(t._parseHTMLInBatch.bind(null,e,o,i,r,a,s),10),i.updateContentParseTimer(c);break}return h},t._parseXMLBodyInBatch=function(e,o,r,a,s,l,c,u){var h,y,_,I,b,v,k,C,A=Date.now();if(null==e||0===e.length)return c({percent:1}),r.updateContentParseTimer(null),void r.setContentStatus(!1);for(;o<e.length;){if(y=(h=e[o]).nodeName,_=f[y],I=$(h).attr(d.COMPAT),(!_&&p.isCompatible(I)||_&&I&&!p.isCompatible(I))&&(_=w),_&&_.fromXml){if(!(b=_.fromXml(h)))throw r.updateContentParseTimer(null),new Error("Failed to parse block from xml node!");for(v=g.parseResourceList(h),b.setResourceIds(v),m.isListItem(b)&&b.setOwnerList(a[$(h).attr("list-id")]),m.isImage(b)&&l&&l.length>0&&n.each(l,function(e){e.resId!==b.getResId()||b.setImageInfo(e)}),m.isCatalogue(b)&&b.setOwnerList(s[$(h).attr("catalogue-id")]),r.append(b),b.isValidForCollab()||r.setValidForCollab(!1),C=b.getId();r.originalBlockIds.indexOf(C)>-1;)C=i.newGUID();C!==b.getId()&&(r.setValidForCollab(!1),b.setId(C)),r.originalBlockIds.push(C)}if(++o>=e.length)c({percent:1}),r.setContentStatus(!1),r.updateContentParseTimer(null);else if(c({percent:.15+o/e.length*.85}),u&&Date.now()-A>100){k=setTimeout(t._parseXMLBodyInBatch.bind(null,e,o,r,a,s,l,c,u),10),r.updateContentParseTimer(k);break}}},t.prototype.append=function(e){this.insert(this.blocks.length,e)},t.prototype.clearHighlight=function(){this.trigger("clear-high-light")},t.prototype.countWords=function(e,t){var n,o,i=function(e){return!m.isHr(e)};return e&&(n=!0,o=this._parseWordCountInfo(e.getDataAsPlain(this,i))),(!e||!o.all&&t)&&(n=!1,o=this._parseWordCountInfo(this.toPlain(i))),{count:o.all,detail:o,isSelected:n}},t.prototype.findAttachmentByResource=function(e,t){return n.filter(this.blocks,function(n){return m.isAttachment(n)&&n.getResource(t)===e})},t.prototype.getAllBlocks=function(){return this.blocks},t.prototype.getAllResouceIds=function(){var e=[];return n.each(this.blocks,function(t){var n=t.getResourceIds();n&&n.length&&(e=e.concat(n))}),e=n.uniq(e)},t.prototype.getAllResourceInfo=function(e,t){var o,i,r,a,s=[];return e=e||this.blocks,t=t||[m.IMAGE,m.ATTACHMENT,m.HANDWRITE,m.TABLE],n.each(this.blocks,function(e){m.isAttachment(e)&&t.indexOf(m.ATTACHMENT)>-1||m.isHandWrite(e)&&t.indexOf(m.HANDWRITE)>-1?(o=e.getSource(!1),i=e.getSource(!0),r=e.getResource(!1),a=e.getResource(!0),o&&i&&r&&a&&s.push({extraResource:a,extraSource:i,resource:r,source:o})):m.isImage(e)&&t.indexOf(m.IMAGE)>-1?(o=e.getSource(!1),i=e.getSource(!0),o&&i&&s.push({blockId:e.getId(),extraSource:i,source:o})):m.isTable(e)&&(s=s.concat(e.getAllResourceInfo()))}),s},t.prototype.getAttachmentByResource=function(e,t){return n.filter(this.blocks,function(n){return m.isAttachment(n)&&n.getResource(t)===e})},t.prototype.getBlockAt=function(e){return this.blocks[e]},t.prototype.getBlockById=function(e){return this.header&&e===this.header.getId()?this.header:this.footer&&e===this.footer.getId()?this.footer:n.find(this.blocks,function(t){return e===t.getId()})},t.prototype.getBlockIndex=function(e){return n.indexOf(this.blocks,e)},t.prototype.getBlockIndexById=function(e){var t,n=-1;return(t=this.getBlockById(e))&&(n=this.getBlockIndex(t)),n},t.prototype.getCommonInlineStyle=function(e,t){var o=this;if(e&&t){var i,r=e.getStartBlockRange(),a=e.getEndBlockRange(),s=r.block,l=a.block,c=null,u=[],h=!0;return this.isNonEmptyParaTable(s)&&(u.push(s.getCommonInlineStyle(t,r)),h=!1),s!==l&&(i=this.getInterBlocks(s,l),n.each(i,function(e){o.isNonEmptyParaTable(e)&&(u.push(e.getCommonInlineStyle(t)),h=!1)}),this.isNonEmptyParaTable(l)&&(u.push(l.getCommonInlineStyle(t,a)),h=!1)),h?(m.isTextBlock(s)&&(c=s.getInlineStyleForEmpty(t,!0)),c||C.getDefault(t)):(n.some(u,function(e){if(null===c)c=e;else if(null!=e&&c!==e)return c=d.INTERM,!0}),c)}},t.prototype.getExtraInfo=function(e){return e?(this.extraInfo||{})[e]:this.extraInfo},t.prototype.getHeaderFooter=function(e){return e?this.footer:this.header},t.prototype.getFileVersion=function(){return this.fileVersion},t.prototype.getEntityCache=function(e){var t=this.entityCache;return n.pick(t,e)},t.prototype.entityExistInCache=function(e){var t=this.getEntityCache(e);return n.keys(t).length===e.length},t.prototype.getImageBySource=function(e,t){return n.filter(this.blocks,function(n){return m.isImage(n)&&n.getSource(t)===e})},t.prototype.getInterBlocks=function(e,t,n){var o=this.blocks,i=this.getBlockIndex(e),r=this.getBlockIndex(t);return n?o.slice(i,r+1):o.slice(i+1,r)},t.prototype.getLastBlock=function(){return n.last(this.blocks)},t.prototype.getNextBlock=function(e){var t=this.getBlockIndex(e);if(t>=0)return this.getBlockAt(t+1)},t.prototype.getNoteId=function(){return this.noteId},t.prototype.getPreBlock=function(e){var t=this.getBlockIndex(e);if(t>0)return this.getBlockAt(t-1)},t.prototype.getRangeBlockStyle=function(e,t){if(e&&t){var o=e.getStartBlockRange(),i=e.getEndBlockRange(),r=o.block,a=i.block,s=this.getInterBlocks(r,a,!0),c=null;return e.isSingleTableSelected()?s[0]?s[0].getCommonBlockStyle(t,o):void l.warn("No table block find, need update noteRange"):(n.each(s,function(e){var n=e.getBlockStyle(t);c=null===c?n:c===n?c:d.INTERM}),c)}},t.prototype.getSchemaVersion=function(){return this.schemaVersion||p.getDefaultAsString()},t.prototype.hasHandWriteBlock=function(){var e=!1;return n.some(this.blocks,function(t){return m.isHandWrite(t)&&(e=!0),e}),e},t.prototype.highlight=function(e,t){var o,i,r=[];t=n.defaults(t||{},{ignoreCase:!1}),e&&e.length&&(o=[],n.each(e,function(e){if(e&&!/\s/.test(e)){var t=new k({text:e});o.push(t)}}),o=o.length?o:null),i=this.blocks.slice(),this.header&&i.unshift(this.header),this.footer&&i.push(this.footer),n.each(i,function(e){(null!=o||null!=t.images&&t.images.length>0&&(m.isImage(e)||m.isTable(e)))&&e.highlight(o,t,function(e){r.push(e)})}),this.trigger("high-light",r),n.isFunction(t.callback)&&t.callback(r.length)},t.prototype.insert=function(e,t){if(!t)throw new Error("cannot insert null block");this.blocks.splice(e,0,t),this._bindEventsForBlock(t),t.trigger("attached",this),this.trigger("insert-block",e,t)},t.prototype.isBlank=function(){return!this.blocks||0===this.blocks.length},t.prototype.isEmptyContent=function(){var e,t=this.blocks;return!!(t&&1===t.length&&(e=t[0])&&e.isEmptyContent)&&e.isEmptyContent()},t.prototype.isParsingData=function(){return null!=this.contentParseTimer},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.isSameNote=function(e){return e===this.noteId},t.prototype.isDragProhibited=function(){return this.dragProhibited},t.prototype.isCopyProhibited=function(){return this.copyProhibited},t.prototype.isSameList=function(e,t){var n,o,i,r,a,s,c,d,u,h;if(!e)return l.error("isSameList:noteRange should not be null"),!1;for(n=e.getStartBlockRange(),o=e.getEndBlockRange(),i=n.block,r=o.block,h=(a=this.getInterBlocks(i,r,!0)).length,s=0;s<h;s++)if((c=a[s])instanceof v){if(!(c instanceof b))return!1;if((d=c.getOwnerList()).getType()!==t)return!1;if(u){if(u!==c.getOwnerList())return!1}else u=d}return!!u},t.prototype.isValidForCollab=function(){return this.validForCollab},t.prototype.lastBlockIsEasyInput=function(){var e=this.getLastBlock();return m.isTextBlock(e)},t.prototype.lockBlock=function(e,t){this._setBlockLocked(e,!0,t)},t.prototype.nextHighlight=function(){this.trigger("next-high-light")},t.prototype.preHighlight=function(){this.trigger("pre-high-light")},t.prototype.remove=function(e,t){var n=this.blocks.splice(e,1)[0];n&&(n.trigger("detached",this),this._unbindEventsForBlock(n),this.trigger("remove-block",e,t))},t.prototype.removeBlock=function(e){this.remove(this.getBlockIndex(e))},t.prototype.removeBlockById=function(e,t){this.remove(this.getBlockIndexById(e),t)},t.prototype.replace=function(e,t){var n=this.blocks.splice(e,1,t)[0];return n?(n.trigger("detached",this),this._unbindEventsForBlock(n)):l.warn("oldBlock should not be null"),t&&(this._bindEventsForBlock(t),t.trigger("attached",this)),this.trigger("replace-block",e,t,n),n},t.prototype.reset=function(){this.destroy(),this.noteId=i.newGUID(),this.headUnknownNodeList=[],this.blocks=[],this.originalBlockIds=[],null!=this.contentParseTimer&&(clearTimeout(this.contentParseTimer),this.contentParseTimer=null),this.header=null,this.footer=null},t.prototype.setExtraInfo=function(e){this.extraInfo=e,this._triggerExtraInfoChange()},t.prototype.setEntityCache=function(e){this.entityCache=Object.assign(this.entityCache,e)},t.prototype.removeEntityCache=function(){this.entityCache={}},t.prototype.setEntity=function(e,t){var n;t&&(n=this.getBlockById(t))&&n instanceof v&&n.setEntity(e)},t.prototype.setExtraInfoWithKey=function(e,t,n,o){var i=this.extraInfo,r=i[e];i||(i={},o=!0),r||(i[e]=r={}),r[t]=n,!0===o?this.setExtraInfo(i):this.extraInfo=i},t.prototype.setFileVersion=function(e){this.fileVersion=e},t.prototype.setDragProhibited=function(e){e!==this.dragProhibited&&(this.dragProhibited=e)},t.prototype.setCopyProhibited=function(e){e!==this.copyProhibited&&(this.copyProhibited=e,this.trigger("copy-prohibited",e))},t.prototype.setHeaderFooter=function(e,t,n){t?this.footer=e:this.header=e,n&&this.trigger("header-footer-changed",t)},t.prototype.setReadOnly=function(e){(e=!!e)!==this.readOnly&&(this.readOnly=e,this.trigger("read-only-change",e),n.each(this.blocks,function(t){t.setReadOnly(e)}))},t.prototype.setContentStatus=function(e){this.contentStart=e},t.prototype.getContentStatus=function(){return this.contentStart},t.prototype.setSchemaVersion=function(e){p.isLessThanDefault(e)?l.warn("schema version is older than current, need upgrade!"):this.schemaVersion=e||p.getDefaultAsString()},t.prototype.setValidForCollab=function(e){this.validForCollab=e},t.prototype.toHtml=function(e,t){var n,o,i,r,a,s,l,c,d,u,h,p,g,f,y,_=this.blocks,I=_.length,b=[],v=[];for(t=!0===t,e?(s=e.getStartBlockRange(),l=e.getEndBlockRange(),c=s.block,d=l.block,u=this.getBlockIndex(c),h=this.getBlockIndex(d),y=e.isInSingleBlock()):(u=0,h=I-1),o=u;o<=h;o++)f=null,p=o===u,g=o===h,n=_[o],p&&s?(f=s,y||(f=f.clone()).expandToEnd()):g&&l&&(f=l,y||(f=f.clone()).expandToStart()),m.isListItem(n)||m.isCatalogue(n)?(a=n.getOwnerList(),r&&r!==a&&v.length&&(i=this._toHtmlWithSameOwnerList(v,t),b.push(i),v=[]),v.push({block:n,range:f||null}),r=a):(r=null,v.length&&(i=this._toHtmlWithSameOwnerList(v,t),b.push(i),v=[]),i=f?f.getDataAsHtml(t):n.toHtml(null,null,t),b.push(i));return v.length&&(i=this._toHtmlWithSameOwnerList(v,t),b.push(i)),b.join("")},t.prototype.toPlain=function(e){var t=e?n.filter(this.blocks,e):this.blocks;return n.map(t,function(e){return e.toPlain()}).join("\n")},t.prototype.toXml=function(){var e,t,i,r,a,s,c="http://"+A.getNamespace(),d=this._createXMLDocument(c,"note"),u=d.createElement("head"),h=d.createElement("body"),p={},g=this.getSchemaVersion(),f=this.getFileVersion(),m=d.documentElement,y=[];return m.appendChild(u),m.appendChild(h),g&&m.setAttribute("schema-version",g),m.setAttribute("file-version",f.toString()),n.each(this.blocks,function(e){var t,o,i,r,a,s;e&&e.toXml&&(t=e.toXml(d)),t?t.listItem?(o=t,h.appendChild(o.listItem),r=o.listId,p[r]||(p[r]=!0,i=d.createElement("list"),a=o.ownerList.unknownAttrs,n.each(a,function(e){var t=e.cloneNode(!0);i.setAttributeNode(t)}),i.setAttribute("id",r),i.setAttribute("type",o.listType),u.appendChild(i))):("catalogue"===t.tagName&&(s=t.getAttribute("catalogue-id"),-1===y.indexOf(s)&&y.push(s)),h.appendChild(t)):l.warn("block.toXml() failed!")}),n.each(this.headUnknownNodeList,function(e){if(e&&e.cloneNode){var t=e.cloneNode(!0);u.appendChild(t)}}),s=u.querySelectorAll("catalogue-wrap"),n.each(s,function(e){u.removeChild(e)}),n.each(y,function(e){e&&((a=d.createElement("catalogue-wrap")).setAttribute("id",e),a.setAttribute("compat","true"),u.appendChild(a))}),t=this.getHeaderFooter(!1),i=this.getHeaderFooter(!0),t&&(e=t.toXml(d))&&u.appendChild(e),i&&(e=i.toXml(d))&&u.appendChild(e),r=(new XMLSerializer).serializeToString(d),o.startsWith(r,"<?xml")||(r='<?xml version="1.0"?>\n'+r),r},t.prototype.unlockBlock=function(e){this._setBlockLocked(e,!1)},t.prototype.updateContentParseTimer=function(e){this.contentParseTimer!==e&&(clearTimeout(this.contentParseTimer),this.contentParseTimer=e),null==e&&this.trigger("content-parse-done")},t.prototype.initialize=function(){this.extraInfo={},this.noteId=i.newGUID(),this.blocks=[],this.originalBlockIds=[],this.headUnknownNodeList=[],this.schemaVersion=p.getDefaultAsString(),this.fileVersion=0},t.prototype.destroy=function(){var e=this;n.each(e.blocks,function(t){e._unbindEventsForBlock(t)}),e.blocks=null,e.readOnly=!1,e.validForCollab=!0},t.prototype.isNonEmptyParaTable=function(e){return e instanceof v&&!e.isEmpty()||m.isTable(e)&&!e.isEmptyContent()},t.prototype._bindEventsForBlock=function(e){var t;e&&(this._unbindEventsForBlock(e),t=this._listenerEventsForBlock(),r.addListeners(t,e,this),t=this._bubbleEventsForBlock(e),r.bubble(t,e,this))},t.prototype._bubbleEventsForBlock=function(e){var t={};return m.isTable(e)&&(t=n.extend(t,{"color-picker-show":!0,"get-block-view":!0,"yne-user-action-collection":!0})),t},t.prototype._listenerEventsForBlock=function(){return{"get-default-set-font":"_onGetDefaultSetFont","get-extra-info":"_onGetExtraInfo"}},t.prototype._onGetDefaultSetFont=function(e){this.trigger("get-default-set-font",function(t){e(t)})},t.prototype._onGetExtraInfo=function(e,t){t(this.getExtraInfo(e))},t.prototype._parseCataloguesToHtml=function(e){var t,n,o=document.createElement("div"),i=document.createElement("div"),r="";for(n=0;n<e.length;n++)r+=(t=e[n].block).toHtml();return o.innerHTML=r,i.setAttribute("yne-bulb-type","catalogue-wrap-container"),i.style.backgroundColor=t.getBlockStyle("back-color"),i.appendChild(o),i.outerHTML},t.prototype._parseWordCountInfo=function(e){var t=/[A-z0-9~!@#$%^&*()_+{}|:"<>?`\-=[\]\\;',./]+/g,n=e.match(t),o=e.match(/[\u4e00-\u9fa5\u3002\uff1b\uff0c\uff1a\u201c\u201d\uff08\uff09\u3001\uff1f\u300a\u300b]/g),i=e.replace(t,"").replace(/\s+/g,"").length,r=o?o.length:0,a=n?n.length:0,s=i-r;return{all:r+a+s,chinese:r,nonChinese:a+s}},t.prototype._parseListItemsToTree=function(e){var t,n,o,i,r,a,s,l,c,d=new h(0),u=e.length;for(r=d,t=0;t<u;t++){if(o=(n=e[t]).block,i=n.range||{},l=o.getLevel(),s=new h(l,o,i.start,i.end),(c=l-r.getLevel())>1)for(;l-r.getLevel()>1;)a=new h(r.getLevel()+1),r.addChildNodes([a]),r=a;else if(c<1)for(;l-r.getLevel()<1;)r=r.getParentNode();r.addChildNodes([s]),r=s}return d},t.prototype._setBlockLocked=function(e,t,o){var i,r=this;i=n.isArray(e)?e:[e],n.each(i,function(i){var a;(a=n.isString(i)?r.getBlockById(i):i)?a.setLocked(t,o):l.log("BlockLock: skip non-existing block",e)})},t.prototype._toHtmlWithSameOwnerList=function(e,t){var o,i,r=n.first(e).block;if(m.isListItem(r)){if(o=this._parseListItemsToTree(e)){i=o.toHtml(!0===t);var a=document.createElement("div");r&&r.getBlockStyle("back-color")&&(a.style.backgroundColor=r.getBlockStyle("back-color")),a.innerHTML=i,i=a.outerHTML}}else m.isCatalogue(r)&&(i=this._parseCataloguesToHtml(e));return i||""},t.prototype._triggerExtraInfoChange=function(){n.each(this.blocks,function(e){e.trigger("extra-info-change")})},t.prototype._unbindEventsForBlock=function(e){if(e){var t=function(t){t&&n.each(t,function(t,n){e.off(n)})};t(this._listenerEventsForBlock()),t(this._bubbleEventsForBlock(e))}},t.prototype._createXMLDocument=function(e,t){var n=document.implementation.createDocument(e,t,null);return n.createElement=function(e){return this.createElementNS(this.documentElement.namespaceURI,e)},n},t}(s)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(16),r=n(171),a=n(175),s=n(25),l=n(176);return t=i.extend({_mapper:{},_blackTagList:{},constructor:function(e){var t=this;t._mapper={},t._blackTagList={},o.each(e,function(e,n){!1===e?t._blackTagList[n]=!0:e&&o.isObject(e)&&t.define(n,e)})},parse:function(e,t){var n,i,a,c=new l,d=/<html[\S\s]*<\/html>/i;return e=e.replace(/<!--[\w\W]*?-->/i,""),d.test(e)&&(e=e.match(d)[0]),(n=s(e,document,!0))?i=new r(n):((n=document.createElement("div")).innerHTML=e,i=new r(n)),(a=n.getElementsByTagName("style"))&&o.each(a,function(e){c.parse(e.innerText)}),i.internalStylesParser=c,this._parseRecursively(i,this,t),i.blocks},_shouldBreak:function(e){return!e||!e.style||("none"===e.style.display||"hidden"===e.style.visibility)},_parseRecursively:function(e,t,n){var i,r,s,l,c,d=e.el;if(!0!==this._shouldBreak(d)){if(e.setup(),!0!==e.handleChildrenBySelf())for(i=d.firstChild;i;)1===i.nodeType?(c=i.tagName.toLowerCase(),this._blackTagList[c]||(s=this._findHandlers(i),l=new(s=o.isFunction(s)?s:a)(i,e,e.internalStylesParser,t,n),this._parseRecursively(l,t,n))):3===i.nodeType&&(r=i.textContent)&&e.capture({text:r,styles:e.styles,isText:!0}),i=i.nextSibling;e.finish()}},define:function(e,n,o){this._mapper[e]={Class:n,priority:o||t.PRIORITY.DEFAULT}},_findHandlers:function(e){var t=[];if(o.each(this._mapper,function(n,o){(function(e,t){if(e)return e.matches?e.matches(t):e.webkitMatchesSelector?e.webkitMatchesSelector(t):void 0})(e,o)&&t.push(n)}),0!==t.length)return t.sort(function(e,t){return t.priority-e.priority}),t[0].Class}},{PRIORITY:{HIGH:1,DEFAULT:0,LOW:-1}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(68),o=n(15);return t.extend({constructor:function(e){t.call(this,e,null),this.blocks=[]},setup:function(){t.prototype.setup.apply(this),this.blocks=[]},emit:function(e){e&&e instanceof o&&this.blocks.push(e)},finish:function(){this.emitBlock()},getRoot:function(){return this}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(1),i={1:12,2:13,3:16,4:18,5:24,6:32,7:48},r={b:function(e){e.bold=!0},i:function(e){e.italic=!0},u:function(e){e.underline=!0},strike:function(e){e.strike=!0},code:function(e){e["font-family"]="monospace"},mark:function(e){e["back-color"]="#ffff00",e.color="#000000"},font:function(e,t){var n,o=t.getAttribute("color"),r=t.getAttribute("face"),a=t.getAttribute("size");o&&(e.color=o),r&&(e["font-family"]=r),a&&(n=i[a])&&(e["font-size"]=n)},pre:function(e){e["white-space"]="pre"},a:function(e,t){t&&t.href&&(e.color="#003884",e.underline=!0)}},a=function(e,n){var i=r[e];i?t.each(n,function(e){r[e]||(r[e]=i)}):o.error("The tag handler for `"+e+"` does not exist!")};return t.each({h1:32,h2:24,h3:18,h4:16,h5:13,h6:12},function(e,t){r[t]=function(t){t.bold=!0,t["font-size"]=e}}),a("b",["strong"]),a("i",["em","cite","var","address","dfn"]),a("strike",["s","del"]),a("u",["ins"]),a("code",["tt","kbd","samp","pre","xmp","plaintext","listing"]),r}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(28),o=n(34),i={};return function(e,n){var r,a;if((e=o(e).trim().toLowerCase().value())&&"inherit"!==e){if(n&&"transparent"===e)return e;if(r=i[e])return"null"===r?void 0:r;if((a=t(e)).isValid())return 0===a.getAlpha()?void(i[e]="null"):(r=a.toHexString(),i[e]=r,r);i[e]="null"}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(34),i=["normal","nowrap","pre-line"],r=function(e,t){return t&&"normal"!==t&&"nowrap"!==t?"pre-line"===t?e.replace(/[ \t]+$/g,""):e:e.replace(/[ \t\r\n]+$/g,"")},a=function(e){var n=e.styles["white-space"];return!n||t.contains(i,n)};return function(e){var n,i,s,l,c,d,u,h;for(t.each(e,function(e){var t,n;e.text=(t=e.text,(n=e.styles["white-space"])&&"normal"!==n&&"nowrap"!==n?"pre-line"===n?t.replace(/[ \t]+/g," "):t:t.replace(/[ \t\r\n]+/g," "))}),s=e.length,n=0;n<s&&((l=e[n]).text=(u=l.text,(h=l.styles["white-space"])&&"normal"!==h&&"nowrap"!==h?"pre-line"===h?u.replace(/^[ \t]+/g,""):u:u.replace(/^[ \t\r\n]+/g,"")),!l.text);n++);for(n=0,i=1;i<s;i++)c=e[n],d=e[i],a(c)&&a(d)&&(o.endsWith(c.text," ")&&o.startsWith(d.text," ")&&(d.text=d.text.slice(1)),""===d.text)||(n=i);for(n=s-1;n>=0&&((l=e[n]).text=r(l.text,l.styles["white-space"]),!l.text);n--);return e}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(32).extend({_computeStyles:function(){var e=this.parent;e&&(this.styles=e.styles)},capture:function(e){this.emit(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(16),i=n(217),r=n(226),a=n(5),s=n(1);return o.extend({_internalStyles:{},constructor:function(){this._internalStyles={}},parse:function(e){var n,o,r,a={},l={};if(!0===s.DEBUG)n=i.parse(e);else try{n=i.parse(e)}catch(e){return{}}return n.cssRules?(t.each(n.cssRules,function(e){e.selectorText&&e.style&&(l={},o=e.style,t.each(o,function(e){l[e]=o[e]}),-1!==e.selectorText.indexOf(",")?(r=e.selectorText.split(","),t.each(r,function(e){e=e.trim(),a[e]={selectorText:e,style:l}})):(e.selectorText=e.selectorText.trim(),a[e.selectorText]={selectorText:e.selectorText,style:l}))}),this._internalStyles=t.extend(this._internalStyles,a),a):{}},getInternalStyles:function(){return this._internalStyles},getStylesBySpecificity:function(e,n){var o=this,i={},r=o._internalStyles,s=[],l=0;return r?(t.each(r,function(t){try{a(e).is(t.selectorText)&&s.push(t)}catch(e){}}),s.sort(function(e,t){return-1*o._specificityCompare(e.selectorText,t.selectorText)}),t.some(s,function(e){if(e.style&&t.some(e.style,function(e,o){if(l===n.length)return!0;o in i||-1===t.indexOf(n,o)||(i[o]=e,l++)}),l===n.length)return!0}),i):{}},_specificityCompare:function(e,t){return r.compare(e,t)}})}.call(t,n,t,e))||(e.exports=o)},,,,,,,function(e,t,n){var o;void 0===(o=function(){return["maction","math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msubsup","msup","mtable","mtd","mtext","mtr","munder","munderover","semantics"]}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return["a","altGlyph","altGlyphDef","altGlyphItem","animate","animateColor","animateMotion","animateTransform","circle","clipPath","color-profile","cursor","defs","desc","ellipse","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","filter","font","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignObject","g","glyph","glyphRef","hkern","image","line","linearGradient","marker","mask","metadata","missing-glyph","mpath","path","pattern","polygon","polyline","radialGradient","rect","script","set","stop","style","svg","switch","symbol","text","textPath","title","tref","tspan","use","view","vkern"]}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return{AnchorHandler:n(186),BreakHandler:n(187),HrHandler:n(188),ImageHandler:n(112),InlineHandler:n(70),ListHandler:n(114),ListItemHandler:n(189),ParagraphHandler:n(68),TableHandler:n(190),TodoHandler:n(192)}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(32);return t.extend({inheritStyleHandlers:{bold:!0,italic:!0,underline:!0,strike:!0,"font-family":!0,"font-size":!0,color:!0,"back-color":!0,"white-space":!0},constructor:function(e,n,o){t.call(this,e,n,o)},capture:function(e){var t=this.el.getAttribute("href");t&&"#"!==t&&0!==t.indexOf("javascript")&&e&&!0===e.isText?(e.styles.href=e.styles.href||t,this.emit(e)):this.emit(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(70).extend({inheritStyleHandlers:!1,inheritBlockStyles:{"line-height":!0,indent:!0,"text-indent":!0},finish:function(){this.emit({isBr:!0,styles:this.styles})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(32),o=n(71),i=n(0),r=n(53),a=n(2);return t.extend({computeBulbStyles:function(){var e,t=this,n=t.el;"hr"===n.getAttribute("yne-bulb-block")&&(e=r.getStyleNamesOfBlock(a.HR),i.each(e,function(e){var o=n.getAttribute("yne-style-"+e);o&&(t.styles[e]=o)}))},finish:function(){var e=new o;this.styles&&e.setBlockStyles(this.styles),this.emit(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(68),o=n(26),i=n(114);return t.extend({setup:function(){this.ownerListHandler=this._findOwnerListHandler()},captureBlock:function(e){var t=null;this.emitBlock(),!this._listed&&e.getType&&"paragraph"===e.getType()?((t=this.createBlock()).append(e.getText()),this.emit(t)):this.emit(e)},emit:function(e){e instanceof o&&(this._listed=!0),t.prototype.emit.call(this,e)},createBlock:function(){var e,n,i=this.ownerListHandler;return!this._listed&&i&&i.list?(i.increaseItemCounter(),n=i.list,e=new o({list:n}),n&&n.addItem&&n.addItem(e),e):t.prototype.createBlock.call(this)},_findOwnerListHandler:function(){for(var e=this.parent;e;){if(e instanceof i)return e;e=e.parent}}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(32),o=n(55),i=n(66),r=n(56),a=n(42),s=n(46),l=n(76),c=n(112),d=n(1),u=n(5),h=n(0),p=n(191),g=n(97),f=n(2),m=function(e,t,n){if(!e)return n;var o=e.getAttribute(t);return o=parseInt(o||n,10),isNaN(o)&&(o=n),o},y=function(e,t,n){if(!e)return n;var o=e.style[t];return o=parseInt(o||n,10),isNaN(o)&&(o=n),o};return t.extend({DEFAULT_HEIGHT:40,DEFAULT_WIDTH:70,_styleHandlers:{bold:{tagList:["b","strong"],styleHandler:function(e){return g.bold.action(e,{},null)}},lineThrough:{tagList:["strike","s","del"],styleHandler:function(e){return g.strike.action(e,{},null)}},underline:{tagList:["u","ins"],styleHandler:function(e){return g.underline.action(e,{},null)}},italic:{tagList:["i","em","cite","var","address","dfn"],styleHandler:function(e){return g.italic.action(e,{},null)}},fontName:function(e){var t=g["font-family"].action(e,{},null);return t||("FONT"===e.tagName?(t=e.getAttribute("face"))||null:void 0)},fontSize:function(e){var t=g["font-size"].action(e,{},null);if(t)return t+"px"},textColor:function(e){var t=g.color.action(e,{},null);return t||("FONT"===e.tagName?(t=e.getAttribute("color"))||null:void 0)},backColor:function(e){return g["back-color"].action(e,{},null)},textAlign:function(e){return g.align.action(e,{},null)}},_tableStyleHandlers:{verticalAlign:function(e){if(e)return e.style.verticalAlign||e.getAttribute("valign")||(e.tagName&&h.contains(["THEAD","TBODY","TFOOT"],e.tagName)?"middle":void 0)},textAlign:function(e){if(e)return e.style&&e.style.textAlign?e.style.textAlign:e.getAttribute("align")},textColor:function(e){return g.color.action(e,{},null)},backColor:function(e){return e.style.backgroundColor||null},bold:function(e){return e&&e.tagName&&"TH"===e.tagName?"true":g.bold.action(e,{},null)?"true":void 0},italic:function(e){if(g.italic.action(e,{},null))return"true"},underline:function(e){if(g.underline.action(e,{},null))return"true"},lineThrough:function(e){if(g.strike.action(e,{},null))return"true"},fontName:function(e){return g["font-family"].action(e,{},null)},fontSize:function(e){var t=g["font-size"].action(e,{},null);if(t)return t+"px"}},constructor:function(e,t,n,o){this.el=e,this.parent=t,this.internalStylesParser=n,this._parser=o},handleChildrenBySelf:function(){return!0},_inheritStyles:function(e,t,n){var o={};return n=n||{},h.each(this._styleHandlers,function(i,r){var a;!1!==e[r]&&(h.isFunction(i)?a=i(t):(i.styleHandler&&(a=i.styleHandler(t)),!a&&i.tagList&&(a=function(e,t){var n;if(e&&e.tagName){if((n=(e.tagName+"").toLowerCase())===t+"")return!0;if(h.contains(t,n))return!0}}(t,i.tagList))),a&&"inherit"!==a||(a=n[r]),o[r]=a)}),o},_mergeStyles:function(e,t){var n=u.trim(e.value).length;h.each(this._styleHandlers,function(o,i){0===n?t[i]?e[i]=t[i]:e[i]=!1:e[i]&&t[i]!==e[i]&&(e[i]=!1)})},_inheritTableStyles:function(e,t){var n={};return h.contains(["TABLE","THEAD","TBODY","TFOOT","TR","TD","TH"],e.tagName+"")?(t=t||{},h.each(this._tableStyleHandlers,function(o,i){var r=o(e);null!=r&&"inherit"!==r||(r=t[i]),null!=r&&(n[i]=r)}),n):{}},_parseImage:function(e,t){var n,o,i=e.getAttribute("src");if(c.isNoteLink(e))return o=e.getAttribute("alt")||"",void(t.value+=o);i&&(c.isAttachment(e)?(n=e.getAttribute("path"),t.value=s.create({source:i,resource:n,fileLength:c.getAttachmentFileLength(e),fileName:c.getAttachmentFileName(e)})):c.isImage(e)&&(t.value=a.create({source:i})))},_shouldAddLineBreak:function(e){e=(e+"").toLowerCase();return h.contains(["article","aside","blockquote","br","button","caption","col","colgroup","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","map","ol","output","p","pre","progress","section","textarea","tfoot","ul","video"],e)},_isLinkCell:function(e){if(!e)return!1;var t,n,o,i,r,a,s=e.querySelectorAll("a"),l=function(e){return!e||(1===e.nodeType?""===u.trim(e.textContent||""):3!==e.nodeType||""===u.trim(e.nodeValue||""))};if(!s||!s.length||1!==s.length)return!1;for(t=(n=s[0]).parentNode;t&&t!==e;){for(i=(o=t.childNodes).length,r=0;r<i;r++)if((a=o[r])!==n&&!l(a))return!1;t=(n=t).parentNode}return!0},_parseCell:function(e,t,n){var o,i,l,c,d,u=this,g={value:""},y=u.internalStylesParser,_=r.createBlank(),I=!1;return d=u._parser.parse(e.innerHTML),h.any(d,f.isTextBlock.bind(f))?h.each(d,function(e){f.isTextBlock(e)?_.appendRichText(e.getText()):(f.isImage(e)||f.isAttachment(e)||f.isTable(e)||f.isHr(e))&&u._blockList.push(e)}):h.each(d,function(e){(f.isTable(e)||f.isHr(e))&&u._blockList.push(e),I?(f.isImage(e)||f.isAttachment(e))&&u._blockList.push(e):f.isImage(e)?(_=a.create({source:e.getSource(),width:e.getStyles("width"),height:e.getStyles("height")}),I=!0):f.isAttachment(e)&&(_=s.create({source:e.getSource(),resource:e.getResource(),fileLength:e.getFileLength(),fileName:e.getFileName()}),I=!0)}),(o={value:_}).value&&g.link&&(o.link=g.link),n===u.DEFAULT_HEIGHT&&(o.wrap="true"),h.each(u._styleHandlers,function(e,t){!0===g[t]?o[t]="true":g[t]&&(o[t]=g[t])}),(i=m(e,"colspan",1))>1&&(o.mergeWidth=i,o.mergeHeight=o.mergeHeight||1),(i=m(e,"rowspan",1))>1&&(o.mergeHeight=i,o.mergeWidth=o.mergeWidth||1),l=u._inheritTableStyles(e,t),h.each(l,function(e,t){null==o[t]&&e&&(o[t]=e)}),c=y.getStylesBySpecificity(e,["font-size","font-family","font-style","font-weight","color","background-color","background","text-decoration","text-align","vertical-align","white-space","word-wrap","word-space"]),h.each(c,function(t,n){var o=e.style.getPropertyValue(n);null!=o&&""!==o||e.style.setProperty(n,t)}),h.each(u._tableStyleHandlers,function(t,n){var i=t(e);null==o[n]&&null!=i&&(o[n]=i)}),p(o.backColor)&&delete o.backColor,o},_isArrayFull:function(e,t){var n;if(0===t)return!1;for(n=0;n<t;n++)if(null==e[n])return!1;return!0},_parseTbodyCells:function(e,t,n){var o,i=this,a=h.filter(t.children,i._isTableRow),s=[],l=e.widths.length,c=e.heights.length,d=0;return o=i._inheritTableStyles(t,n),h.each(a,function(t){var n=h.filter(t.children,i._isTableCell),a=i._inheritTableStyles(t,o),u=d,p=s[u];if(0!==n.length){for(;p&&i._isArrayFull(p,l);)d++,p=s[++u];for(p||(p=s[u]=[]),h.each(n,function(t){for(var n,o,l,d,h,g,f,y,_,I=0,b=p[I];b;)b=p[++I];for(n=I,d=i._parseCell(t,a,e.heights[u]),p[n]=d,o=m(t,"rowspan",1),l=m(t,"colspan",1),o>c-u&&(o=c-u,d.mergeHeight=o),h=0;h<o;h++)for((_=s[f=u+h])||(_=s[f]=[]),g=0;g<l;g++)_[y=n+g]||(_[y]={mergePointDX:g,mergePointDY:h,value:r.createBlank(!0)})});p.length<l;)p.push({value:""});d++}}),s},_isTableCell:function(e){if(!e||!e.tagName)return!1;var t=e.tagName||"";return h.contains(["TD","TH"],t)},_isTableRow:function(e){return!(!e||!e.tagName)&&"TR"===e.tagName},_getTbodySize:function(e){var t,n,o,i,r,a,s=this,l=[],c=0,d=0,u=[];for(h.each(e,function(t){var n,o,i=d,r=l[i];if(0!==(n=h.filter(t.children,s._isTableCell)).length){for(;r&&s._isArrayFull(r,c);)r=l[++i];d=i,r||(r=l[i]=[],u[i]=e[i]),h.each(n,function(t,n){var a,c,d,h,p,g=m(t,"colspan",1),f=m(t,"rowspan",1),_=y(t,"width",0)||m(t,"width",0);for(o+=g,_=Math.max(Math.round(_/g),s.DEFAULT_WIDTH),h=n;null!=r[h];)h++;for(d=0;d<g;d++)r[h+d]=_;for(a=1;a<f;a++)for((p=l[c=i+a])||(p=l[c]=[],u[c]=e[c]),d=0;d<g;d++)p[h+d]=_}),o=r.length,c<o&&(c=o)}}),t=l.length,a=[],n=0;n<c;n++){for(i=(l[0]||[])[n]||s.DEFAULT_WIDTH,o=1;o<t;o++)(r=(l[o]||[])[n])&&r>i&&(i=r);a.push(i)}return{rows:t,columns:c,columnWidthList:a,compactTrList:h.compact(u)}},_createBlankRow:function(e){for(var t=[];e>0;)t.push({value:""}),e--;return t},_parseColgroup:function(e){var t=h.filter(e.children,this._isCol);return h.map(t,function(e){return parseFloat(e.style.width)})},_isCol:function(e){return!(!e||!e.tagName)&&"COL"===e.tagName},_parseTbody:function(e,t,n){var o,i,r,a,s=this,l=h.filter(e.children,s._isTableRow),c=0,d={},u=[],p=0;for(l=(a=s._getTbodySize(l)).compactTrList,d.heights=h.map(l,function(e){if(e.style.height)return parseFloat(e.style.height);var t=h.filter(e.children,s._isTableCell),n=0;return h.some(t,function(e){if(!e.getAttribute("rowspan")){var t=y(e,"height",0)||m(e,"height",0);if(t)return n=t,!0}}),n=Math.max(n,s.DEFAULT_HEIGHT)});d.heights.length<a.rows;)d.heights.push(s.DEFAULT_HEIGHT);if(p=0,h.each(a.columnWidthList,function(e){p+=e}),p<n?(i=Math.ceil((n-p)/a.columns),u=h.map(a.columnWidthList,function(e){return e+i})):u=a.columnWidthList,d.widths=u,r=(o=s._parseTbodyCells(d,e,t)).length,(c=d.heights.length)>r)for(;r<c;)o.push(s._createBlankRow(a.columns)),r++;else if(c<r)for(;c<r;)d.heights.push(s.DEFAULT_HEIGHT),c++;return d.cells=o,d},_extendBodyInfo:function(e,t){var n,o,i,r=e.cells,a=e.heights.length;if(!(e.widths.length>=t))for(n=0;n<a;n++)for(i=(o=r[n]).length;i<t;i++)o.push({value:""})},_convertToTableCells:function(e,t){var n,o,a,s,c=e.length,u=[];for(n=0;n<c;n++)for(o=e[n],u[n]=[],a=0;a<t;a++)(s=o[a])?u[n].push(i.create({content:s.value||r.createBlank(),mergeWidth:s.mergeWidth,mergeHeight:s.mergeHeight,mergePointDX:s.mergePointDX,mergePointDY:s.mergePointDY,styles:h.pick(s,l.getAllStyleNames())})):d.error("No tdInfo  at row, col: "+n+", "+a);return u},_mergeTbody:function(e){if(e&&e.length){var t,n=this,o=0,i=[],r=[],a={};return h.each(e,function(e){var n=e.widths.length;n>o&&(o=n,t=e.widths)}),h.each(e,function(e){n._extendBodyInfo(e,o)}),h.each(e,function(e){i=i.concat(e.heights),r=r.concat(e.cells)}),r=n._convertToTableCells(r,o),a.widths=t,a.heights=i,a.cells=r,a}},_parseTable:function(e){var t,n,o=this,i=h.toArray(e.children),r=["thead","tbody","tfoot"],a={thead:[],tbody:[],tfoot:[]},s=[],l=o._blockList.length,c=o._inheritTableStyles(e,{}),d=y(e,"width",0)||m(e,"width",0);o._blockList.push(0),h.each(i,function(e){var t,i=(e.tagName||"").toLowerCase();"colgroup"===i&&(n=o._parseColgroup(e)),h.contains(r,i)&&(t=o._parseTbody(e,c,d),h.extend(t.widths,n),a[i].push(t))}),h.each(r,function(e){var t=a[e];t&&t.length&&(s=s.concat(t))}),(t=o._mergeTbody(s))&&(o._blockList[l]=t)},setup:function(){this._blockList=[]},finish:function(){var e=this;e._parseTable(e.el),h.each(e._blockList,function(t){var n;t&&t.heights&&t.cells&&t.cells.length>0?n=new o({tableCells:t.cells,rowHeights:t.heights,colWidths:t.widths}):t&&(n=t),n&&e.emit(n)})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(28);return function(e){return!!e&&t.equals(e,"white")}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(31);return n(70).extend({finish:function(){var e,n,i=this.el;"todo"===i.getAttribute("data-media-type")&&(e=i.getAttribute("data-attr-content"),n=i.getAttribute("data-attr-checked"),t.isUndefined(e)&&t.isUndefined(n)||this.emit(new o({text:e||"",checked:"true"===n})))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(68),o=n(29),i=n(26),r=n(1),a=n(0),s=n(3);return t.extend({setup:function(){var e,n,i,r,a,l,c=this.getRoot();t.prototype.setup.call(this),(e=this.el.getAttribute("style"))&&(n=/mso-list:(l\d+) (level\d+)/.exec(e))&&(r=n[1],a=n[2],(i=this._getStyles()["list "+r+":"+a])&&((l=c["mso-"+r])||(l=c["mso-"+r]=new o({type:"bullet"===i["mso-level-number-format"]?o.UNORDERED:o.ORDERED,listId:s.newGUID()})),this.list=l,this.level=Number(a.replace("level","")),this.el.querySelector('[style="mso-list:Ignore"]').remove()))},createBlock:function(){if(!this.list)return t.prototype.createBlock.call(this);var e=this.list,n=new i({list:e,level:this.level});return e&&e.addItem&&e.addItem(n),n},_getStyles:function(){var e,t=this.getRoot(),n=this.el.ownerDocument,o={};return t.msoStyles?t.msoStyles:(e=n.querySelectorAll("style"),a.each(e,function(e){var t,n,i;1===e.childNodes.length&&3===e.firstChild.nodeType&&(t=e.firstChild.textContent,n=o,null!==(i=t.match(/(@[\w_\-:\s]+)\n\s*\{(.|\n)*?\}/gm))&&i.forEach(function(e){var t=/@([\w_\-:\s]+)/.exec(e)[1].trim(),o=e.substring(e.indexOf("{")+1,e.indexOf("}")).trim(),i={};o.split(";").forEach(function(e){var t;-1!==e.indexOf(":")&&(t=e.split(":"),i[t[0].trim()]=t[1].trim())}),n[t]||(n[t]={}),a.extend(n[t],i)}))}),r.log(o),t.msoStyles=o,o)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0),i=n(195);return function(e,n,r,a){var s,l=[];if(e){if((s=e.split(/\r\n?|\n/))&&s.length)return o.each(s,function(e){var t=i(e,o.clone(n),o.clone(r),a);t&&l.push(t)}),t.log("to paste text",l),l;t.warn("lines do not exist or lines.length is 0!")}else t.warn("no text when paste plain text!")}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(196),o=n(12),i=n(99),r=n(0);return function(e,n,a,s){if(null!=e){var l,c,d=new o;return s||(l=i.matchEnd(e))&&0===l.result.index&&r.extend(n||(n={}),{href:l.fullURI,underline:!0,color:"#003884"}),c=t(e,n),d.setText(c),a&&r.each(a,function(e,t){d.setBlockStyle(t,e)}),d}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(8);return function(e,n){var o;return e=(e+="").replace(/[\r\n]/g,""),o=new t({text:e}),n&&o.setStyles(0,o.getLength(),n),o}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0),i=n(29),r=n(50),a=n(2),s=n(198),l=n(3);return function(e,n){var c,d,u,h=[],p={},g={},f={};if(o.isString(e))try{c=window.JSON.parse(e)}catch(n){t.error("parse json string error: ",e)}else o.isArray(e)&&(c=e);if(c&&c.length)return t.log("createBlocksFromJSON array: ",c),o.each(c,function(e){var t;(t=s(e,n))&&(e.listId&&e.listType&&a.isListItem(t)&&(d=e.listId,(u=p[d])||(u=new i({type:e.listType,listId:e.listId}),p[d]=u),t.setOwnerList(u)),e.ownerId&&a.isCatalogue(t)&&(d=e.ownerId,f[d]||(f[d]=l.newGUID(),g[f[d]]=new r({id:f[d]})),u=g[f[d]],t.setOwnerList(u)),h.push(t))}),h}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(72),o=n(2),i=n(49),r=n(69),a=n(71),s=n(39),l=n(26),c=n(12),d=n(55),u=n(31),h=n(87),p=n(51),g=n(113),f=n(1);return function(e,n){if(e&&(e.blockType||e.type)){var m,y=e.blockType||e.type;switch(y){case o.PARAGRAPH:m=c.fromJSON(e,n);break;case o.LIST_ITEM:m=l.fromJSON(e);break;case o.IMAGE:m=s.fromJSON(e);break;case o.ATTACHMENT:m=t.fromJSON(e);break;case o.TABLE:m=d.fromJSON(e,!0);break;case o.HR:m=a.fromJSON(e);break;case o.HEADING:m=r.fromJSON(e);break;case o.CATALOGUE:m=i.fromJSON(e);break;case o.TODO:m=u.fromJSON(e);break;case o.QUOTE:m=h.fromJSON(e);break;case o.CODE:m=p.fromJSON(e);break;case o.HANDWRITE:m=g.fromJSON(e);break;default:f.warn("jsonObj.blockType = "+y)}return m}f.warn("jsonObj is null or jsonObj has no `blockType` property!")}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0),i=n(8),r=n(12),a={create:function(){var e={data:{},push:function(t,n){n||(n=1),e.data[t]?e.data[t]+=n:e.data[t]=n},count:function(){return Object.keys(e.data).length},mergeKeys:function(t){var n,i,r,s,l,c=a.create(),d=e.data;return o.each(e.orderedKeys(),function(e){r&&e-r<t?(s=d[r],l=d[e],n=(r*s+e*l)/(i=s+l),c.push(n,i),r=null):(r&&c.push(r,d[r]),r=e)}),r&&c.push(r,d[r]),c.count()!==e.count()?c.mergeKeys(t):c},mostFrequencyKey:function(){var t,n=0;return o.each(e.data,function(e,o){e>=n&&(n=e,t=parseInt(o))}),t},orderedKeys:function(){return Object.keys(e.data).sort(function(e,t){return e-t})}};return e}},s=function(e,t){return"yd"===t?function(e){var t={},n=e.split(",");return t.left=parseInt(n[0]),t.top=parseInt(n[1]),t.right=parseInt(n[2]),t.bottom=parseInt(n[5]),t.width=t.right-t.left,t.height=t.bottom-t.top,t}(e):function(e){var t={},n=e.split(",");return t.left=parseInt(n[0]),t.top=parseInt(n[1]),t.width=parseInt(n[2]),t.height=parseInt(n[3]),t.right=t.left+t.width,t.bottom=t.top+t.height,t}(e)},l=function(e,t){var n,i,r=e.json,a=t.type,l=[];for(r.box=s(r.boundingBox,a),o.each(r.lines,function(e){var t,i="";e.box=s(e.boundingBox,a),"ms"===a&&(o.each(e.words,function(e){e.box=s(e.boundingBox,a),function(e){return/^[a-z][a-z\d\s.,\/#!$%\^&\*;:{}=\-_`~()]*$/i.test(e)}(e.text)&&(i+=" "),i+=e.text}),e.text=i),!function(e){var t=!1;return[/Epdf/,/For Evaluation Purposes Only/].forEach(function(n){n.test(e)&&(t=!0)}),t}(e.text)?(n&&function(e,t){var n=(t.box.bottom-e.box.top)/e.box.height,o=(t.box.bottom-e.box.top)/t.box.height;return Math.max(n,o)>.8}(e,n)&&(!function(e,t){e.box.top=e.box.top<t.box.top?e.box.top:t.box.top,e.box.bottom=e.box.bottom>t.box.bottom?e.box.bottom:t.box.bottom,e.box.left=e.box.left<t.box.left?e.box.left:t.box.left,e.box.right=e.box.right>t.box.right?e.box.right:t.box.right,e.box.height=e.box.bottom-e.box.top,e.box.width=e.box.right-e.box.left,e.words=t.words.concat(e.words),e.text=t.text+"  "+e.text}(e,n),t=r.lines.indexOf(n),l.push(t)),n=e):(t=r.lines.indexOf(e),l.push(t))}),i=l.length-1;i>=0;i-=1)r.lines.splice(l[i],1)},c=function(e,t){var n={};return n.json=e,l(n,t),t.parseParagraph?(function(e){var t,n=e.json,i=a.create(),r=a.create(),s=a.create(),l=a.create(),c={};o.each(n.lines,function(e){i.push(e.box.left),r.push(e.box.right),t&&s.push(e.box.bottom-t.box.bottom),t=e,l.push(e.box.height)}),c.baseLineHeight=s.mostFrequencyKey(),c.baseFontHeight=l.mergeKeys().mostFrequencyKey(),c.regionLeft=i.mergeKeys(c.baseFontHeight).mostFrequencyKey(),c.regionRight=r.mergeKeys(c.baseFontHeight).mostFrequencyKey(),e.stat=c}(n),function(e){var t,n,o,i,r,a,s=e.json,l=[],c=e.stat.regionLeft,d=e.stat.regionRight,u=e.stat.baseFontHeight,h=e.stat.baseLineHeight,p=!1,g=!1,f="";for(t={startLineIndex:0},r=0;r<s.lines.length;r+=1){if(p=g,c+1.5*u<(i=s.lines[r]).box.left&&r!==t.startLineIndex&&(p=!0),o&&i.box.bottom-o.box.bottom>1.5*h&&(p=!0),p){for(t.endLineIndex=r-1,t.text=f.trim(),l.push(t),n=Math.floor((i.box.bottom-o.box.bottom)/h-1),a=0;a<n;a+=1)l.push({text:""});t={startLineIndex:r},f=i.text}else f+=i.text;o=i,g=d-1.5*u>i.box.right}t.endLineIndex=r,t.text=f,l.push(t),e.paragraphs=l}(n),t.parseIndent&&function(e){var t=e.json,n=e.stat,i=e.paragraphs;o.each(i,function(e){var o,i=t.lines[e.startLineIndex];i&&(Math.ceil((i.box.left-n.regionLeft)/n.baseFontHeight)/2>=1?e.text="\t"+e.text:(e.startLineIndex+1<=e.endLineIndex&&(o=t.lines[e.startLineIndex+1]),o&&Math.ceil((i.box.left-o.box.left)/n.baseFontHeight)/2>=1&&(e.text="\t"+e.text)))})}(n)):function(e){var t,n=e.json;t={startLineIndex:0,endLineIndex:n.lines.length-1,text:""},o.each(n.lines,function(e){t.text+=e.text}),e.paragraphs=[t]}(n),n};return function(e,n){var a,s,l=[];if(o.isString(e))try{a=window.JSON.parse(e)}catch(n){t.error("parse json string error: ",e)}return a&&o.each(a,function(e){o.each(e.regions,function(e){var t=c(e,n);o.each(t.paragraphs,function(e){s=function(e){var t,n,o,a=new r;return o=e.fontSize,t=(t=e.text).replace(/[\r\n]/g,""),(n=new i({text:t})).setStyle(0,n.getLength(),"font-size",o),a.setText(n),a}(e),l.push(s)})}),l.push(new r)}),l}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(13),n(1)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(t,o,r,a,s){var l=e.call(this,{})||this;return l.listItemNodeProps={},i.DEBUG&&(l.listItemNodeProps.debugId=n.uniqueId()),l.listItemNodeProps.level=t||0,l.listItemNodeProps.block=o,l.listItemNodeProps.start=r,l.listItemNodeProps.end=a,l.addChildNodes(s),l}return a(t,e),t.prototype.addChildNodes=function(e){var t=this;e&&(n.isArray(e)||(e=[e]),n.each(e,function(e){e.parentNode=t,t.childNodes||(t.childNodes=[]),t.childNodes.push(e)}))},t.prototype.childrenCount=function(){return this.childNodes?this.childNodes.length:0},t.prototype.getChildStartIndex=function(){var e=(this.childNodes||[])[0];return e?e.getStartIndex():1},t.prototype.getLevel=function(){return this.listItemNodeProps.level},t.prototype.getParentNode=function(){return this.parentNode},t.prototype.getStartIndex=function(){return this.listItemNodeProps.block?this.listItemNodeProps.block.getIndex():1},t.prototype.hasChildren=function(){return this.childrenCount()>0},t.prototype.isChildOrdered=function(){var e=(this.childNodes||[])[0];return!!e&&e.isOrdered()},t.prototype.isOrdered=function(){return this.listItemNodeProps.block?this.listItemNodeProps.block.isOrdered():!!this.parentNode&&this.parentNode.isOrdered()},t.prototype.toHtml=function(e){var t,o,i,r,a,s,l=this.listItemNodeProps.block,c=[];return e=!0===e,this.hasChildren()?(a=l?l.toHtml(this.listItemNodeProps.start,this.listItemNodeProps.end,e):"",c.push(a),i="<"+(t=this.isChildOrdered()?"ol":"ul")+' yne-block-type="list" style="margin:0px " ',(o=this.getChildStartIndex())>1&&(i+=' start="'+o+'"'),i+=">",c.push(i),s=this.childNodes,n.each(s,function(t){var n=t.toHtml(e);c.push(n)}),r="</"+t+">",c.push(r)):(a=l?l.toHtml(this.listItemNodeProps.start,this.listItemNodeProps.end,e):"<li></li>",c.push(a)),c.join("")},t.prototype.initialize=function(){},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(0),n(72),n(49),n(69),n(71),n(39),n(26),n(12),n(87),n(55),n(31),n(51),n(116)],void 0===(i=function(e,t,n,o,i,r,a,s,l,c,d,u,h,p,g){"use strict";var f={attach:o,catalogue:i,heading:r,"horizontal-line":a,image:s,"list-item":l,para:c,code:p,quote:d,table:u,todo:h,unknown:g};return n.each(f,function(e,t){e.prototype.xmlNodeName=t}),f}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(1);return t.View.extend({class:"bulb-panel",events:{mousedown:"_onMouseDown"},initialize:function(e){this._editor=e.editor,this._items=[],this.isRendered=!1},addItems:function(e){var t=this;e=o.isArray(e)?e:[e],o.each(e,function(e){t._items.push(e),t.isRendered&&t.$el.append(e.$el)})},getItemByName:function(e){return o.find(this._items,function(t){return t.name===e})},render:function(){var e=this;e.isRendered||(e.isRendered=!0,o.each(e._items,function(t){e.$el.append(t.$el)}))},_onMouseDown:function(e){e.preventDefault()},show:function(){this.$el.show()},hide:function(){this.$el.hide()},_invoke:function(e){o.each(this._items,function(t){t[e]?t[e]():i.error("item."+e+" is not method",t)})},enable:function(){this.$el.removeClass("disabled"),this._invoke("enable")},disable:function(){this.$el.addClass("disabled"),this._invoke("disable")},reset:function(){this._invoke("reset")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(1),o=n(0),i=n(34),r={_map:{},add:function(e){var n=e.prototype.name,o=this._map;n?o[n]?t.error("Button class ["+n+"] exists!"):o[n]=e:t.error("The Button class has no name!",e)},get:function(e){i.startsWith(e,"---")&&(e="base-split");var n=this._map[e];return n||t.error("Button class ["+e+"] does not exist!"),n},getAllNames:function(){return o.keys(this._map)}};return o.each([n(204),n(362),n(363),n(364),n(365),n(366),n(367),n(368),n(369),n(370),n(371),n(374),n(375),n(376),n(377),n(378),n(379),n(380),n(381),n(382),n(383),n(384),n(385),n(386),n(387),n(388),n(389),n(390),n(391),n(392),n(393),n(394),n(396),n(397),n(398),n(399),n(400),n(401),n(402),n(403),n(404),n(405),n(406),n(407),n(408),n(409),n(410),n(412),n(413),n(414),n(415),n(416),n(417),n(418)],function(e){r.add(e)}),r}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(205),o=n(361);return t.extend({name:"base-split",className:"toolbar-item toolbar-split",initialize:o,render:o,enable:o,disable:o,reset:o})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(20).View.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},isVisible:!0,show:function(){this.$el.css("display","inline-block"),this.isVisible=!0},hide:function(){this.$el.hide(),this.$el.css("display","none"),this.isVisible=!1},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},onEditingStateChange:function(){},onSelectionChange:function(){}})}.call(t,n,t,e))||(e.exports=o)},,function(e,t,n){var o;void 0===(o=function(e){var t=n(5),o=n(99),i=n(52),r=n(43);return{_container:null,getUrlInfoBeforeRange:function(e,t){var n,o,a=e.commonAncestorContainer,s={textNodeArray:[],endIndex:-1};if(i.isRangeInNode(t,e))return this._container=t,this._isInLinkElement(a)?o={alreadyUrl:!0}:(r.isElement(a)?(n=this._findLastTextNode(a))&&(s.endIndex=n.length):s.endIndex=e.endOffset,o=this._iteratorOfTextNodeBefore(s,a),this._container=null,o)},_iteratorOfTextNodeBefore:function(e,t){var n;if(r.isText(t))n=t;else{if(!r.isElement(t))return;n=this._findLastTextNode(t)}if(n)return e.textNodeArray.unshift(n),this._parseTextNodeObject(e)||this._iteratorOfTextNodeBefore(e,this._findPreviousNode(n))},_findPreviousNode:function(e){var t=e.previousSibling;return t?this._isUnvalidElement(t)?null:t:(e=e.parentNode)?this._findPreviousNode(e):null},_findLastTextNode:function(e){var t,n,o;if(e){if(r.isText(e))return e;if(0===(o=e.childNodes.length))return e=this._findPreviousNode(e),this._findLastTextNode(e);for(n=o-1;n>=0;n--)return t=e.childNodes[n],this._findLastTextNode(t)}return null},_parseTextNodeObject:function(e){var t,n,i,r,a,s="",l=e.textNodeArray[0].nodeValue,c=0,d="",u=e.endIndex,h=e.textNodeArray,p=e.textNodeArray.length;for(r=0;r<p-1;r++)d+=h[r].nodeValue;if(d+=h[p-1].nodeValue.slice(0,u),(t=o.matchEnd(d))&&t.result){for(i=t.result.index,a=0;a<p-1;a++){if(i-=s.length,s.length<=i&&l.length>i){c=a;break}s+=h[a].nodeValue,l+=h[a+1].nodeValue}n={uri:t.fullURI,startNode:h[c],startOffset:i,endNode:h[p-1],endOffset:u}}return n},_isUnvalidElement:function(e){var n,o;return!r.isText(e)&&(!r.isElement(e)||!t.contains(this._container,e)||(n=e.currentStyle||window.getComputedStyle(e,""),o="A"===e.nodeName,"block"===n.display||o))},_isInLinkElement:function(e){if(t.contains(this._container,e)){for(;e&&e!==this._container;){if("A"===e.nodeName)return!0;e=e.parentNode}return!1}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(3);return t=o.extend({name:"atom.SetInlineStyle",_selectedBlocks:null,_start:null,_end:null,_isFullText:!1,_oldStyleNameValues:{},_styleNameValues:null,initialize:function(){var e=this.options.args;this._oldStyleNameValues={},a.isCollabCommand(e)||(this._selectedBlocks=this.options.blocks,this._styleNameValues=this.options.styleNameValues,this._start=this.options.start,this._end=this.options.end,this._isFullText=this.options.fullText),t.__super__.initialize.apply(this)},apply:function(){var e=this;r.each(e._styleNameValues,function(t,n){e._setStyleToSelectedBlocks(n,t)})},doUnapply:function(){var e,t=this;r.each(t._selectedBlocks,function(n){e=t._oldStyleNameValues[n.getId()],t._isFullText&&(t._start=n.getStartOffset(),t._end=n.getEndOffset()),r.each(e,function(e,o){n.setTextStyle(o,e,t._start,t._end)})})},fromCollabJSON:function(){var e,n=this,o=n.options.args.collabProperties,i=o.cmdJSON;t.__super__.fromCollabJSON.apply(n),e=o.coreEditor.getNote(),i&&(n._selectedBlocks=[],r.each(i.blockIds,function(t){n._selectedBlocks.push(e.getBlockById(t))}),n._styleNameValues=i.styleNameValues,n._oldStyleNameValues=i.oldStyleNameValues,n._start=i.startPosition,n._end=i.endPosition,n._isFullText=i.simpleValue1)},toCollabJSON:function(){var e=[],n=t.__super__.toCollabJSON.apply(this);return this._selectedBlockIds=[],r.each(this._selectedBlocks,function(t){e.push(t.getId())}),n.blockIds=e,n.styleNameValues=this._styleNameValues,n.oldStyleNameValues=this._oldStyleNameValues,n.startPosition=this._start,n.endPosition=this._end,this._isFullText&&(n.simpleValue1=!0),n},_setStyleToSelectedBlocks:function(e,t){var n,o,i=this,a={};a[e]=t,r.each(i._selectedBlocks,function(r){o=r.getId(),i._isFullText&&(i._start=r.getStartOffset(),i._end=r.getEndOffset()),n=r.getTextStyle(e,i._start,i._end),i._oldStyleNameValues[o]||(i._oldStyleNameValues[o]={}),i._oldStyleNameValues[o][e]=n,a=r.getInlineStylesForEmpty(),r.isEmpty()&&r.setInlineStylesForEmpty(i.getInlineStates(a,e,t)),r.setTextStyle(e,t,i._start,i._end)})},getInlineStates:function(e,t,n){if(e)return e[t]=n,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(3);return t=o.extend({name:"atom.SetBlockStyle",_selectedBlocks:null,_oldStyleNameValues:{},_styleNameValues:null,initialize:function(e){var n=this.options.args;this._oldStyleNameValues={},a.isCollabCommand(n)||(this._selectedBlocks=e.blocks,this._styleNameValues=this.options.styleNameValues),t.__super__.initialize.apply(this,arguments)},apply:function(){var e=this;r.each(e._styleNameValues,function(t,n){e._setStyleToSelectedBlocks(n,t)})},doUnapply:function(){var e,t=this;r.each(t._selectedBlocks,function(n){e=t._oldStyleNameValues[n.getId()],r.each(e,function(e,t){n.setBlockStyle(t,e)})})},fromCollabJSON:function(){var e=this,n=e.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(e),e._note=n.coreEditor.getNote(),o&&(e._selectedBlocks=[],r.each(o.blockIds,function(t){e._selectedBlocks.push(e._note.getBlockById(t))}),e._styleNameValues=o.styleNameValues,e._oldStyleNameValues=o.oldStyleNameValues)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this),n=[];return r.each(this._selectedBlocks,function(e){n.push(e.getId())}),e.blockIds=n,e.styleNameValues=this._styleNameValues,e.oldStyleNameValues=this._oldStyleNameValues,e},_setStyleToSelectedBlocks:function(e,t){var n,o,i=this;r.each(i._selectedBlocks,function(r){o=r.getId(),n=r.getBlockStyle(e),i._oldStyleNameValues[o]||(i._oldStyleNameValues[o]={}),i._oldStyleNameValues[o][e]=n,r.setBlockStyle(e,t)})}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(3),a={POINT:"point",CELL:"cell"};return t=o.extend({name:"atom.SetTableCellAttr",_table:null,_rect:null,_type:null,_value:null,_oldValue:null,effected:!1,initialize:function(){var e=this.options.args;r.isCollabCommand(e)||(this._table=this.options.table,this._rect=this.options.rect,this._type=this.options.type,this._value=this.options.value),t.__super__.initialize.apply(this)},apply:function(){var e=this._type,t=this._table,n=this._rect,o=this._value;if(o)return e===a.POINT?(this._oldValue=this._getOldAttr(n.row,n.col),t.setMergePointAttrAt(n.row,n.col,o.width,o.height),void(this.effected=!0)):e===a.CELL?(this._oldValue=this._getOldAttr(n.row,n.col),t.setMergedCellAttrAt(n.row,n.col,o.dx,o.dy),void(this.effected=!0)):void 0;(t.isMergePoint(n.row,n.col)||t.isMergedCell(n.row,n.col))&&(this._oldValue=this._getOldAttr(n.row,n.col),t.clearCellAttr(n.row,n.col),this.effected=!0)},_getOldAttr:function(e,t){var n=this._table;return n.isMergedCell(e,t)?n.getMergedCellAttrAt(e,t):n.isMergePoint(e,t)?n.getMergePointAttrAt(e,t):null},doUnapply:function(){var e=this._table,t=this._rect,n=this._oldValue;n?((n.width||n.height)&&e.setMergePointAttrAt(t.row,t.col,n.width,n.height),(n.dx||n.dy)&&e.setMergedCellAttrAt(t.row,t.col,n.dx,n.dy)):e.clearCellAttr(t.row,t.col)},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._value=o.styleNameValues,this._oldValue=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.styleNameValues=this._value,e.oldStyleNameValues=this._oldValue,e.simpleValue1=this._rect,e.simpleValue2=this._type,e}},{TYPES:a}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{keyBackspace:{currentLineIsEmpty:{backToLineStart:!1,backToPreLineEnd:!0}},keyEnter:{whenEndCharIs:{",":0,")":0,"}":0,";":0,":":4,"(":4,"{":4,default:0}},keyTab:{addSpacesNum:4}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(0),o=n(5),i=n(25),r=n(134),a=n(123),s=n(135),l=n(213),c=n(214);return function(e){var n=i(e),d=n.querySelectorAll("img[data-media-type=attachment]"),u=n.querySelectorAll("img[data-media-type=image]"),h=n.querySelectorAll("div[yne-bulb-block=paragraph]"),p=n.querySelectorAll("ol"),g=n.querySelectorAll("ul");return t.each([h,p,g],function(e){t.each(e,function(e){e.style.fontFamily='"宋体", sans-serif',e.style.zoom="1.15"})}),t.each(d,function(e){r.processHtmlContent(o(e))}),t.each(u,function(e){var t,n=o(e);n.attr("alt")&&((t=document.createElement("div")).className="img-title",t.appendChild(document.createTextNode(n.attr("alt"))),n.after(t))}),e="<head><style>"+s+"</style><style>"+l+"</style><style>"+c+"</style><style>"+a+"</style></head>"+n.outerHTML}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){(e.exports=n(44)(!1)).push([e.i,".mixin-common-font {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.mixin-token-font {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-default pre:first-child {\n  border-top: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre:last-child {\n  border-bottom: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre {\n  border-left: 1px solid rgba(208, 212, 217, 0.5);\n  border-right: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-default pre {\n  background-color: #f7f7f7;\n  line-height: 1.3;\n}\n.code-view.yne-code-theme-default .yne-plain {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default .yne-token {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-default .yne-token.yne-comment,\n.code-view.yne-code-theme-default .yne-token.yne-prolog,\n.code-view.yne-code-theme-default .yne-token.yne-doctype,\n.code-view.yne-code-theme-default .yne-token.yne-cdata {\n  color: slategray;\n}\n.code-view.yne-code-theme-default .yne-token.yne-punctuation {\n  color: #999;\n}\n.code-view.yne-code-theme-default .yne-token .namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-default .yne-token.yne-property,\n.code-view.yne-code-theme-default .yne-token.yne-tag,\n.code-view.yne-code-theme-default .yne-token.yne-boolean,\n.code-view.yne-code-theme-default .yne-token.yne-number,\n.code-view.yne-code-theme-default .yne-token.yne-constant,\n.code-view.yne-code-theme-default .yne-token.yne-symbol,\n.code-view.yne-code-theme-default .yne-token.yne-deleted {\n  color: #905;\n}\n.code-view.yne-code-theme-default .yne-token.yne-selector,\n.code-view.yne-code-theme-default .yne-token.yne-attr-name,\n.code-view.yne-code-theme-default .yne-token.yne-string,\n.code-view.yne-code-theme-default .yne-token.yne-char,\n.code-view.yne-code-theme-default .yne-token.yne-builtin,\n.code-view.yne-code-theme-default .yne-token.yne-inserted {\n  color: #690;\n}\n.code-view.yne-code-theme-default .yne-token.yne-operator,\n.code-view.yne-code-theme-default .yne-token.yne-entity,\n.code-view.yne-code-theme-default .yne-token.yne-url {\n  color: #9a6e3a;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-default .yne-token.yne-atrule,\n.code-view.yne-code-theme-default .yne-token.yne-attr-value,\n.code-view.yne-code-theme-default .yne-token.yne-keyword {\n  color: #07a;\n}\n.code-view.yne-code-theme-default .yne-token.yne-function,\n.code-view.yne-code-theme-default .yne-token.yne-class-name {\n  color: #DD4A68;\n}\n.code-view.yne-code-theme-default .yne-token.yne-regex,\n.code-view.yne-code-theme-default .yne-token.yne-important,\n.code-view.yne-code-theme-default .yne-token.yne-variable {\n  color: #e90;\n}\n.code-view.yne-code-theme-default .yne-token.yne-important,\n.code-view.yne-code-theme-default .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-default .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-default .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-coy {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-coy pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-coy pre {\n  color: black;\n  background: none;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.6;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-coy pre {\n  border-left: 10px solid #358ccb;\n  box-shadow: -1px 0px 0px 0px #358ccb, 0px 0px 0px 0px #dfdfdf;\n  background-color: #fdfdfd;\n  background-image: linear-gradient(transparent 50%, rgba(69, 142, 209, 0.04) 50%);\n  background-size: 3em 3em;\n  background-origin: content-box;\n  background-attachment: local;\n}\n.code-view.yne-code-theme-coy pre {\n  background-color: #fdfdfd;\n  -webkit-box-sizing: border-box;\n  -moz-box-sizing: border-box;\n  box-sizing: border-box;\n  padding-bottom: 0;\n  padding-top: 0;\n  padding-left: 1em;\n  position: relative;\n}\n.code-view.yne-code-theme-coy pre:nth-child(2n+1) {\n  background-color: #f6fafe;\n}\n.code-view.yne-code-theme-coy pre:before,\n.code-view.yne-code-theme-coy pre:after {\n  content: '';\n  z-index: -2;\n  display: block;\n  position: absolute;\n  bottom: 0.75em;\n  left: 0.18em;\n  width: 40%;\n  height: 20%;\n  max-height: 13em;\n  box-shadow: 0px 13px 8px #979797;\n  -webkit-transform: rotate(-2deg);\n  -moz-transform: rotate(-2deg);\n  -ms-transform: rotate(-2deg);\n  -o-transform: rotate(-2deg);\n  transform: rotate(-2deg);\n}\n.code-view.yne-code-theme-coy .yne-plain {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: normal;\n  color: #41464b;\n}\n.code-view.yne-code-theme-coy .yne-token {\n  font-size: 14px;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  font-weight: 500;\n  color: #41464b;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-comment,\n.code-view.yne-code-theme-coy .yne-token.yne-block-comment,\n.code-view.yne-code-theme-coy .yne-token.yne-prolog,\n.code-view.yne-code-theme-coy .yne-token.yne-doctype,\n.code-view.yne-code-theme-coy .yne-token.yne-cdata {\n  color: #7D8B99;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-punctuation {\n  color: #5F6364;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-property,\n.code-view.yne-code-theme-coy .yne-token.yne-tag,\n.code-view.yne-code-theme-coy .yne-token.yne-boolean,\n.code-view.yne-code-theme-coy .yne-token.yne-number,\n.code-view.yne-code-theme-coy .yne-token.yne-function-name,\n.code-view.yne-code-theme-coy .yne-token.yne-constant,\n.code-view.yne-code-theme-coy .yne-token.yne-symbol,\n.code-view.yne-code-theme-coy .yne-token.yne-deleted {\n  color: #c92c2c;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-selector,\n.code-view.yne-code-theme-coy .yne-token.yne-attr-name,\n.code-view.yne-code-theme-coy .yne-token.yne-string,\n.code-view.yne-code-theme-coy .yne-token.yne-char,\n.code-view.yne-code-theme-coy .yne-token.yne-function,\n.code-view.yne-code-theme-coy .yne-token.yne-builtin,\n.code-view.yne-code-theme-coy .yne-token.yne-inserted {\n  color: #2f9c0a;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-operator,\n.code-view.yne-code-theme-coy .yne-token.yne-entity,\n.code-view.yne-code-theme-coy .yne-token.yne-url,\n.code-view.yne-code-theme-coy .yne-token.yne-variable {\n  color: #a67f59;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-coy .yne-token.yne-atrule,\n.code-view.yne-code-theme-coy .yne-token.yne-attr-value,\n.code-view.yne-code-theme-coy .yne-token.yne-keyword,\n.code-view.yne-code-theme-coy .yne-token.yne-class-name {\n  color: #1990b8;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-regex,\n.code-view.yne-code-theme-coy .yne-token.yne-important {\n  color: #e90;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-style,\n.code-view.yne-code-theme-coy .yne-token.yne-string {\n  color: #a67f59;\n  background: rgba(255, 255, 255, 0.5);\n}\n.code-view.yne-code-theme-coy .yne-token.yne-important {\n  font-weight: normal;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-coy .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-tomorrow {\n  /* page-break affect */\n}\n.code-view.yne-code-theme-tomorrow pre {\n  color: #ccc;\n  background: none;\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.3;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-tomorrow pre {\n  background: #2d2d2d;\n  caret-color: white;\n}\n.code-view.yne-code-theme-tomorrow pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-comment,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-block-comment,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-prolog,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-doctype,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-cdata {\n  color: #999;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-punctuation {\n  color: #ccc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-tag,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-attr-name,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-namespace,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-deleted {\n  color: #e2777a;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-function-name {\n  color: #6196cc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-boolean,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-number,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-function {\n  color: #f08d49;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-property,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-class-name,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-constant,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-symbol {\n  color: #f8c555;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-selector,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-important,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-atrule,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-keyword,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-builtin {\n  color: #cc99cd;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-string,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-char,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-attr-value,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-regex,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-variable {\n  color: #7ec699;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-operator,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-entity,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-url {\n  color: #67cdcc;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-important,\n.code-view.yne-code-theme-tomorrow .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-tomorrow .yne-token.yne-inserted {\n  color: green;\n}\n.code-view.yne-code-theme-okaidia {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-okaidia pre {\n  color: #f8f8f2;\n  background: none;\n  text-shadow: 0 1px rgba(0, 0, 0, 0.3);\n  font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  word-wrap: normal;\n  line-height: 1.3;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-okaidia pre {\n  background: #272822;\n  caret-color: white;\n}\n.code-view.yne-code-theme-okaidia pre:first-child {\n  border-top: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia pre:last-child {\n  border-bottom: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia pre {\n  border-left: 1px solid transparent;\n  border-right: 1px solid transparent;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-comment,\n.code-view.yne-code-theme-okaidia .yne-token.yne-prolog,\n.code-view.yne-code-theme-okaidia .yne-token.yne-doctype,\n.code-view.yne-code-theme-okaidia .yne-token.yne-cdata {\n  color: slategray;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-punctuation {\n  color: #f8f8f2;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-property,\n.code-view.yne-code-theme-okaidia .yne-token.yne-tag,\n.code-view.yne-code-theme-okaidia .yne-token.yne-constant,\n.code-view.yne-code-theme-okaidia .yne-token.yne-symbol,\n.code-view.yne-code-theme-okaidia .yne-token.yne-deleted {\n  color: #f92672;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-boolean,\n.code-view.yne-code-theme-okaidia .yne-token.yne-number {\n  color: #ae81ff;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-selector,\n.code-view.yne-code-theme-okaidia .yne-token.yne-attr-name,\n.code-view.yne-code-theme-okaidia .yne-token.yne-string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-char,\n.code-view.yne-code-theme-okaidia .yne-token.yne-builtin,\n.code-view.yne-code-theme-okaidia .yne-token.yne-inserted {\n  color: #a6e22e;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-operator,\n.code-view.yne-code-theme-okaidia .yne-token.yne-entity,\n.code-view.yne-code-theme-okaidia .yne-token.yne-url,\n.code-view.yne-code-theme-okaidia .yne-token.yne-language-css .string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-style .string,\n.code-view.yne-code-theme-okaidia .yne-token.yne-variable {\n  color: #f8f8f2;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-atrule,\n.code-view.yne-code-theme-okaidia .yne-token.yne-attr-value,\n.code-view.yne-code-theme-okaidia .yne-token.yne-function,\n.code-view.yne-code-theme-okaidia .yne-token.yne-class-name {\n  color: #e6db74;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-keyword {\n  color: #66d9ef;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-regex,\n.code-view.yne-code-theme-okaidia .yne-token.yne-important {\n  color: #fd971f;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-important,\n.code-view.yne-code-theme-okaidia .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-okaidia .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-Ateliersulphurpool {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  font-family: Consolas, Menlo, Monaco, \"Andale Mono WT\", \"Andale Mono\", \"Lucida Console\", \"Lucida Sans Typewriter\", \"DejaVu Sans Mono\", \"Bitstream Vera Sans Mono\", \"Liberation Mono\", \"Nimbus Mono L\", \"Courier New\", Courier, monospace;\n  font-size: 14px;\n  line-height: 1.375;\n  direction: ltr;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n  background: #f5f7ff;\n  color: #5e6687;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre::-moz-selection,\n.code-view.yne-code-theme-Ateliersulphurpool pre::-moz-selection {\n  text-shadow: none;\n  background: #dfe2f1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre::selection,\n.code-view.yne-code-theme-Ateliersulphurpool pre::selection {\n  text-shadow: none;\n  background: #dfe2f1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  margin: 0;\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre:first-child {\n  border-top: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre:last-child {\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool pre {\n  border-left: 1px solid rgba(0, 0, 0, 0.05);\n  border-right: 1px solid rgba(0, 0, 0, 0.05);\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-comment,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-prolog,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-doctype,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-cdata {\n  color: #898ea4;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-punctuation {\n  color: #5e6687;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-operator,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-boolean,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-number {\n  color: #c76b29;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-property {\n  color: #c08b30;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-tag {\n  color: #3d8fd1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-selector {\n  color: #6679cc;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-attr-name {\n  color: #c76b29;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-entity,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-url,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-string {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-attr-value,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-keyword,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-control,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-directive,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-unit {\n  color: #ac9739;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-statement,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-regex,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-atrule {\n  color: #22a2c9;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-placeholder,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-variable {\n  color: #3d8fd1;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-deleted {\n  text-decoration: line-through;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-inserted {\n  border-bottom: 1px dotted #202746;\n  text-decoration: none;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-important,\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-important {\n  color: #c94922;\n}\n.code-view.yne-code-theme-Ateliersulphurpool .yne-token.yne-entity {\n  cursor: help;\n}\n.code-view.yne-code-theme-vs {\n  /* Code blocks */\n  /* page-break affect */\n}\n.code-view.yne-code-theme-vs pre {\n  color: #393A34;\n  font-family: \"Consolas\", \"Bitstream Vera Sans Mono\", \"Courier New\", Courier, monospace;\n  direction: ltr;\n  text-align: left;\n  word-spacing: normal;\n  word-break: normal;\n  font-size: 0.95em;\n  line-height: 1.6em;\n  -moz-tab-size: 4;\n  -o-tab-size: 4;\n  tab-size: 4;\n  -webkit-hyphens: none;\n  -moz-hyphens: none;\n  -ms-hyphens: none;\n  hyphens: none;\n}\n.code-view.yne-code-theme-vs pre::-moz-selection,\n.code-view.yne-code-theme-vs pre::-moz-selection {\n  background: #C1DEF1;\n}\n.code-view.yne-code-theme-vs pre::selection,\n.code-view.yne-code-theme-vs pre::selection {\n  background: #C1DEF1;\n}\n.code-view.yne-code-theme-vs pre {\n  padding: 0;\n  margin: 0;\n  background-color: white;\n}\n.code-view.yne-code-theme-vs pre:first-child {\n  border-top: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs pre:last-child {\n  border-bottom: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs pre {\n  border-left: 1px solid #dddddd;\n  border-right: 1px solid #dddddd;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-comment,\n.code-view.yne-code-theme-vs .yne-token.yne-prolog,\n.code-view.yne-code-theme-vs .yne-token.yne-doctype,\n.code-view.yne-code-theme-vs .yne-token.yne-cdata {\n  color: #008000;\n  font-style: italic;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-namespace {\n  opacity: .7;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-string {\n  color: #A31515;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-punctuation,\n.code-view.yne-code-theme-vs .yne-token.yne-operator {\n  color: #393A34;\n  /* no highlight */\n}\n.code-view.yne-code-theme-vs .yne-token.yne-url,\n.code-view.yne-code-theme-vs .yne-token.yne-symbol,\n.code-view.yne-code-theme-vs .yne-token.yne-number,\n.code-view.yne-code-theme-vs .yne-token.yne-boolean,\n.code-view.yne-code-theme-vs .yne-token.yne-variable,\n.code-view.yne-code-theme-vs .yne-token.yne-constant,\n.code-view.yne-code-theme-vs .yne-token.yne-inserted {\n  color: #36acaa;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-function {\n  color: #00009f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-deleted,\n.code-view.yne-code-theme-vs .yne-token.yne-tag {\n  color: #9a050f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-selector,\n.code-view.yne-code-theme-vs .yne-token.yne-keyword {\n  color: #00009f;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-important,\n.code-view.yne-code-theme-vs .yne-token.yne-bold {\n  font-weight: bold;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-italic {\n  font-style: italic;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-class-name,\n.code-view.yne-code-theme-vs .yne-token.yne-property {\n  color: #2B91AF;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-tag,\n.code-view.yne-code-theme-vs .yne-token.yne-selector {\n  color: #800000;\n}\n.code-view.yne-code-theme-vs .yne-token.yne-attr-name,\n.code-view.yne-code-theme-vs .yne-token.yne-property,\n.code-view.yne-code-theme-vs .yne-token.yne-regex,\n.code-view.yne-code-theme-vs .yne-token.yne-entity {\n  color: #ff0000;\n}\n.platform-pc .code-view {\n  width: calc(100vw - 60px);\n}\n.page-A4 .code-view,\n.read-mode .code-view {\n  width: 622px;\n}\n.page-A4 .code-view pre,\n.read-mode .code-view pre {\n  min-width: 605px;\n}\n.share .code-view {\n  width: 600px;\n}\n.share .code-view .para-text pre {\n  min-width: 590px;\n}\n.code-view .para-text.selectAll pre {\n  border-color: #4C98EF;\n}\n.combo-box-code-language .combo-menu-wrapper .combo-menu.combo-menu-code-language {\n  max-height: 300px;\n  overflow-y: scroll;\n}\n.code-view {\n  width: calc(100vw - 68px);\n  white-space: pre;\n  overflow-x: auto;\n  overflow-y: hidden;\n  counter-reset: lineNumber;\n  margin: 0 20px;\n}\n.code-view .para-text {\n  cursor: pointer;\n  margin: 0 auto;\n  padding: .5em .2em 0 .2em;\n  width: max-content;\n}\n.code-view .page-break-placeholder {\n  user-select: none;\n}\n.code-view pre {\n  counter-increment: lineNumber;\n  padding: .25em 0;\n  margin: 0;\n  min-width: calc(100vw - 77px);\n  cursor: auto;\n}\n.code-view pre:before {\n  content: counter(lineNumber);\n  width: 36px;\n  padding: 0 1em;\n  font-size: 12px;\n  color: grey;\n  user-select: none;\n}\n.note-view-wrapper .block-view.collab-editing-view.code-view {\n  margin: 0 20px;\n  padding-left: 0;\n}\n.note-view-wrapper .block-view.collab-editing-view.code-view {\n  pointer-events: initial;\n}\n",""])},function(e,t,n){(e.exports=n(44)(!1)).push([e.i,".code-view {\n  overflow-x: hidden;\n  margin: 0 auto;\n  white-space: normal;\n}\n.code-view .para-text {\n  box-sizing: border-box;\n  padding: 0;\n  margin: 0;\n  width: 100%;\n}\n.code-view .para-text pre {\n  text-indent: -1em;\n  padding-left: 1em;\n  border-right: none;\n  word-break: break-all;\n  white-space: normal;\n}\n.code-view.yne-code-theme-default .para-text {\n  border-right: 1px solid rgba(208, 212, 217, 0.5);\n}\n.code-view.yne-code-theme-vs .para-text {\n  border-right: 1px solid #dddddd;\n}\n",""])},function(e,t,n){var o;void 0===(o=function(e){var t=n(5);return function(e){if(!e)return!1;e=t.trim(e+"");return/^<\?xml /i.test(e)}}.call(t,n,t,e))||(e.exports=o)},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},,,,,,,,,,,function(e,t,n){var o;void 0===(o=function(e){var t=n(0);return{getAsArray:function(){return[9,12,14,16,18,22,26,30,36,42]},getAsList:function(){var e=this.getAsArray(),n={};return t.each(e,function(e){n[e]=e}),n},getMin:function(){return this.getAsArray()[0]},getMax:function(){var e=this.getAsArray();return e[e.length-1]}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){"use strict";return function(e){var t,n;window.getSelection?(t=window.getSelection()).getRangeAt&&t.rangeCount&&((n=t.getRangeAt(0)).deleteContents(),n.insertNode(document.createTextNode(e))):document.selection&&document.selection.createRange&&(document.selection.createRange().text=e)}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(e){var t=e.getSource();if(t.startsWith("http")){var n=t.split("/");n.length>=2&&(t=n[n.length-2])}return t}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(9),n(10)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var o,i=this.editor,r=!1;i&&t&&t.imgBlock?n.IS_PC&&i.isCollabEnabled()?this.isHidden=this.isDisabled=!0:((o=t.imgBlock.getSource(!0))&&(r=o.toLocaleLowerCase().endsWith("gif")),this.isDisabled=r,this.imgBlock=t.imgBlock):this.isHidden=this.isDisabled=!0},t.prototype.reset=function(){this.imgBlock=null},t.prototype.selectAction=function(){this.editor.trigger("yne-rotate-image",this.imgBlock.getId(),this.imgBlock.getSource(),this.direction)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.direction=t.direction||0},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({editorEvents:{"yne-selection-change":"onSelectionChange"},onSelectionChange:function(){this.$el.hasClass("disabled")||this.setState(this.querySelectionState())},querySelectionState:function(){return this.editor.querySelectionInlineStyle(this.name)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(372),o=n(0);return t.extend({editorEvents:{"yne-editing-state-change":"onEditingStateChange"},onEditingStateChange:function(e){o.has(e,this.name)&&(this.selectedValue=e[this.name])}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0)],void 0===(i=function(e,t,n){"use strict";var o,i,r={ACTION_SHOW_ENABLE:1,ACTION_HIDE:2,ACTION_ENABLE:3,ACTION_DISABLE:4},a={RANGE_DEFAULT:1,RANGE_HEADER_FOOTER:2,RANGE_TABLE_CELL:3,RANGE_CATALOGUE:4,RANGE_IMAGE:5,RANGE_ATTACHMENT:6,HANDWRITE_DEFAULT:11,RANGE_QUOTE:7,RANGE_CODE:8},s={EDITOR_BUTTON_STATE_MAP:{undo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],redo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],"remove-format":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"format-painter":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"base-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],heading:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.HANDWRITE_DEFAULT,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"no-table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE}],"font-family":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"font-size":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],bold:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],italic:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],underline:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],strike:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],color:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"back-color":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"unordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"ordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],todo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.HANDWRITE_DEFAULT,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],quote:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.HANDWRITE_DEFAULT,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],code:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],"code-theme":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],"code-language":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],align:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],"table-justify":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],indent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],outdent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],"line-height":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"table-wrap":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-operate":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-merge":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}]},NATIVE_HEADER_FOOTER_DISABLED_MAP:{attachment:!0,catalogue:!0,hr:!0,img:!0,link:!0,table:!0},NATIVE_TABLE_DISABLED_MAP:{catalogue:!0,table:!0,hr:!0},NATIVE_HANDWRITE_DISABLED_MAP:{catalogue:!0},NATIVE_CATALOGUE_DISABLED_MAP:{catalogue:!0,img:!0,attachment:!0,hr:!0,link:!0,table:!0},NATIVE_CODE_DISABLED_MAP:{catalogue:!0,img:!0,attachment:!0,hr:!0,link:!0,table:!0}},l=["font-family","font-size","table","table-justify","table-wrap","table-operate","table-split","table-merge"];return o=["undo","redo","code","code-language","code-theme"].concat(l),i={on:a.RANGE_CODE,action:r.ACTION_DISABLE},Object.keys(s.EDITOR_BUTTON_STATE_MAP).forEach(function(e){o.indexOf(e)>-1||s.EDITOR_BUTTON_STATE_MAP[e].push(i)}),function(e,t){e.forEach(function(e){s.EDITOR_BUTTON_STATE_MAP[e]&&s.EDITOR_BUTTON_STATE_MAP[e].push(t)})}(l,{on:a.RANGE_CODE,action:r.ACTION_HIDE}),n.extend(s,r,a),s}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(54)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.QUOTE},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(54)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.TODO},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(5);return{isDataUrl:function(e){return/^data:/i.test(e)},isFileUrl:function(e){return/^(file:\/\/)/i.test(e)},isHttpUrl:function(e){return/^http/i.test(e)},has:function(e){return/\?\d+$/.test(String(e))},remove:function(e){return String(e).replace(/\?\d+$/,"")},addIfNeeded:function(e,n){if(e=String(e),e=o.trim(e),this.isHttpUrl(e))return e;if(this.isDataUrl(e))return e;if(this.has(e)){if(!0!==n)return e;e=this.remove(e)}else if(/\?/.test(e))return e;return e+"?"+t.uniqueId()}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(80),o=new RegExp("^http[s]{0,1}://"+t.getNamespace()),i="//"+t.getNamespace(),r=!1;return{setUseConvert:function(e){r=!!e},isInnerResoures:function(e){return o.test(e)},getURL:function(e){return r&&this.isInnerResoures(e)?e.replace(o,i):e}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(59),i=n(14),r=n(5),a=n(28),s=n(1),l=n(35),c=n(239),d=n(444),u=n(445),h=n(64),p=n(17),g=n(41),f=n(446),m=n(468),y=n(469),_=n(7),I=n(470),b=n(166),v=n(19),k=n(38),C=n(2),w=n(39),A=n(96),S=n(66),N=n(73),T=n(9),M=n(52),x=n(88),E=n(8),D=n(241),L=n(42);return n(472),o.extend({className:"block-view table-view",_template:i.getTemplate("common","table_view"),_wrapperElClassName:"table-wrapper",_cellEditClassName:"cell-edit",_cellSelectedClassName:"cell-selected",_layoutElClassName:"table-layout",_layoutInnerElClassName:"table-layout-inner",_rectOnDragStart:null,_oldRangeType:null,_rending:null,_preSelectionRect:null,_isPasteAsText:!1,_OCRHighlightInfos:null,_OCRHighlightItem:null,events:{"mouseenter td":"_onCellMouseEnter","mouseleave td":"_onCellMouseLeave",mousedown:"_onMouseDown",dblclick:"_onDblclick",click:"_onClick","mouseenter a":"_onEnterLink","mouseleave a":"_onLeaveLink"},initialize:function(){o.prototype.initialize.apply(this,arguments),this._draggable=new c({el:this.el,disableDocSelection:!0}),this.bindSelectionEvents(),this._initEvents(),this._OCRHighlightInfos=[],this._OCRHighlightItem=[]},_initEvents:function(){var e=this.block,n=this._draggable,o={};t.bindAll(this,"_onAttributeChanged","_onDragging","_onStyleChange"),l.addListeners({"cell-inline-style-change":"_onCellInlineStyleChange","cell-block-style-change":"_onCellBlockStyleChange","row-height-set":"_onRowHeightSet","col-width-set":"_onColWidthSet","row-inserted":"_onRowInserted","col-inserted":"_onColInserted","row-deleted":"_onRowDeleted","col-deleted":"_onColDeleted","cell-content-change":"_onCellContentChange","content-change":"_reRenderCells","high-light":"onHighlight"},e,this),e.on("attribute-changed",t.throttle(this._onAttributeChanged),100),e.on("style-change",this._onStyleChange),o[c.DRAG_START]="_onDragStart",o[c.DRAG_END]="_onDragEnd",l.addListeners(o,n,this),n.on(c.DRAGGING,t.throttle(this._onDragging,100)),this._triggerResize=t.throttle(this._triggerResize,100)},_removeSubViews:function(){var e=this;t.each(["_cellEditView","_selectionView","_hiddenInputView"],function(t){var n=e[t];n&&(n.destroy?n.destroy():s.error("view has no destroy()",n),e[t]=null)})},_addSubViews:function(){var e,n=this,o=n._keyHandlerManager;n._removeSubViews(),n._cellEditView=f.create({table:n.block,tableView:n,styleRules:n._getStyleRules(),mapper:this._inlineStyleViewMapper}),l.addListeners({"set-cell-content":"_onSetCellContent",blur:"_onCellEditViewBlur","cell-edit-view-exit":"_onCellEditViewExit","cell-edit-view-enter":"_onCellEditViewEnter"},n._cellEditView,n),l.bubble({"cell-edit-view-selection-change":!0,"cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"cell-edit-view-command-executed":!0},n._cellEditView,n),n.addViewToInner(n._cellEditView),n._selectionView=new u({tableView:n}),n.addViewToInner(n._selectionView),n._cellResizeView=new y({tableView:n}),n.addViewToInner(n._cellResizeView),l.addListeners({"set-row-height":"_onSetRowHeight","set-col-width":"_onSetColWidth","set-cells-size":"_setCellsSize"},n._cellResizeView,n),n._hiddenInputView=m.create({}),o||(o=n._keyHandlerManager=new _({scope:"table-hidden-input"})),o.on("bind-key",function(e){var t=n._hiddenInputView;t&&t.bindKey(e)}),o.on("unbind-key",function(e){var t=n._hiddenInputView;t&&t.unbindKey(e)}),e=o.getAvailableHandlerNames(),t.each(e,function(e){o.bind(e)}),n.addView(n._hiddenInputView),l.addListeners({"key-monitor":"_onKey",copy:"_onCopy",cut:"_onCut",paste:"_onPaste","text-input":"_onTextInput"},n._hiddenInputView,n)},_onSetCellContent:function(e,t){var n=this.block.getCellById(e);n?this.trigger("command","comp.SetTableCellContent",{table:this.block,cellRect:{row:n.row,col:n.col},content:t}):s.error("Not find cell! by id:",e)},_onCellEditViewBlur:function(){},_onCellEditViewExit:function(){this._hiddenInputView.hideBehind()},_onKey:function(e,t){this._keyHandlerManager.execWithKey(e,this,t)},_onCopy:function(e){e.stopPropagation(),e.preventDefault(),this.trigger("copy",e)},_onCut:function(e){var t=this._getNoteRange();e.stopPropagation(),e.preventDefault(),this.trigger("cut",e),t.isSingleTableSelected()&&this._clearSelectCells()},_pasteBlobImg:function(e){var t,n,o,i=this;t=e.originalEvent.clipboardData.items,o=i._getRectOfNoteRange(),t&&1===t.length&&0===t[0].type.indexOf("image")&&o&&(n=t[0].getAsFile(),i.trigger("yne-blob-paste",{isImg:!0,data:n},function(e){e&&e.source&&i.trigger("command","comp.SetTableCellContent",{table:i.block,cellRect:{row:o.top,col:o.left},content:L.create({source:e.source})})}))},_onPaste:function(e){e.stopPropagation(),e.preventDefault();var t,n,o,i,r,a,s,l=this._isPasteAsText;T.IS_PC?this.trigger("yne-on-paste",l,e):(t=new D({event:e}),l?(r=t.getData("text/plain"))&&this._pastePlain(r):(n=t.getData("text/yne-json"))&&this._pasteJSON(n)||(o=t.getData("text/yne-table-json"))&&this._pasteYTableJson(o)||(i=t.getData("text/html"))&&this._pasteHTML(i)||(s=(a=this.noteView.options.editor)&&a.callMacNativeApi("macClipboardData",["image"]))&&this._pasteImages(s)||(r=t.getData("text/plain"))&&this._pastePlain(r)||this._pasteBlobImg(e))},_pasteHTML:function(e){var t=A.parseHtml(e);return this.pasteBlockList(t)},_pasteJSON:function(e){var t=A.parseJSON(e);return this.pasteBlockList(t)},_pasteYTableJson:function(e){if(t.isString(e))try{e=window.JSON.parse(e)}catch(e){return void s.error("parse ytable json  string error")}return this._pasteJSON([{blockType:C.TABLE,data:e}])},_pasteImages:function(e){var t,n=[];e=JSON.parse(e);for(var o=0;o<e.length;o++)(t=e[o])&&n.push(new w({source:t,title:""}));return this.pasteBlockList(n)},_pastePlain:function(e){var t=A.parsePlain(e);return this.pasteBlockList(t)},pasteBlockList:function(e){var t=this.block,n=[],o=[];return!(!e||!e.length)&&(1===e.length&&C.isTable(e[0])?(this.trigger("command","comp.InsertTableCells",{table:t,widths:e[0].colWidths,heights:e[0].rowHeights,cellsData:e[0].tableCells}),!0):(e.forEach(function(e){var t=S.blockToCell(e);t&&n.push(t)}),n.length>0?(n.forEach(function(e){o.push([e])}),this.trigger("command","comp.InsertTableCells",{table:t,cellsData:o}),!0):void 0))},deleteTable:function(){this.trigger("command","comp.DeleteNoteRange",{isTableDelete:!0})},isSelectAllRect:function(){var e=this._getRectRange().getRect(),t=this.block;return e.width*e.height==t.getColumnCount()*t.getRowCount()},_clearSelectCells:function(){var e=this.block;e.isEmptyContent()&&this.isSelectAllRect()?this.deleteTable():this.trigger("command","comp.InsertTableCells",{table:e})},_onTextInput:function(e){var t,n,o,i,r=this._getRectOfNoteRange();r?this.isLocked()||(t=this.block.getCell(r.top,r.left,{findMergePointIfNeeded:!0,withPosition:!0}))&&((n=t.cell)&&n.isEmpty()?(o=n.getStylesForEmpty(),(i=E.create(e,!1)).setStyles(0,i.getLength(),o)):i=E.create(e,!1),this._cellEditView.showAndEdit({row:t.row,col:t.col,content:i})):s.warn("Failed to show cellEditView",r)},moveWithDirection:function(e,t){var n,o=this.block,i=this._getRectOfNoteRange(),r=1,a=1;if(i){if(o.isMergePoint(i.top,i.left)&&(a=(n=o.getMergePointAttrAt(i.top,i.left)).height,r=n.width),e===N.UP){if(i.top-a<0)return this.trigger("move-caret",!1,t);this._setRange({top:i.top-a,left:i.left,width:1,height:1})}if(e===N.DOWN){if(i.top+a+i.height>o.getRowCount())return this.trigger("move-caret",!0,t);this._setRange({top:i.top+a,left:i.left,width:1,height:1})}if(e===N.LEFT)if(i.left-r<0){if(i.top-a<0)return this.trigger("move-caret",!1,t);this._setRange({top:i.top-a,left:o.getColumnCount()-1,width:1,height:1})}else this._setRange({top:i.top,left:i.left-r,width:1,height:1});if(e===N.RIGHT)if(i.left+r>o.getColumnCount()-1){if(o.isMergePoint(i.top,i.left)&&this._preSelectionRect&&o.getRowCount()-1===this._preSelectionRect.left&&this._preSelectionRect.top++,this._preSelectionRect&&this._preSelectionRect.top+1<o.getRowCount())return this._setRange({top:this._preSelectionRect.top+1,left:0,width:1,height:1});if(i.top+a+i.height>o.getRowCount())return this.trigger("move-caret",!0,t);this._setRange({top:i.top+a,left:0,width:1,height:1})}else o.isMergePoint(i.top,i.left)&&this._preSelectionRect?(o.getRowCount()-1===this._preSelectionRect.left&&this._preSelectionRect.top++,this._setRange({top:this._preSelectionRect.top,left:i.left+r,width:1,height:1})):this._setRange({top:i.top,left:i.left+r,width:1,height:1})}},toggleInlineStyle:function(e){this.trigger("command","comp.SetTableCellInlineStyle",{toggle:e})},clearSelectedCells:function(){this._clearSelectCells()},enterEditMode:function(){},selectAll:function(e){e&&this.trigger("select-all")},render:function(){var e=this.el;this._rending=!0,this._removeSubViews(),this._renderTemplate(),this.colgroupEl=e.querySelector("colgroup"),this.wrapperEl=e.querySelector("."+this._wrapperElClassName),this.tableEl=e.querySelector("table"),this._tableLayoutEl=e.querySelector("."+this._layoutElClassName),this._tableLayoutInnerEl=e.querySelector("."+this._layoutInnerElClassName),this._setTableStyles(),this._renderCells(),this._addSubViews(),o.prototype.render.apply(this,arguments),this._rending=!1,this._triggerResize()},addView:function(e){this._tableLayoutEl.appendChild(e.el),e.render()},addViewToInner:function(e){this._tableLayoutInnerEl.appendChild(e.el),e.render()},_renderTemplate:function(){this.$el.html(this._template())},_renderCells:function(){var e,t,n,o,i,a=this.block,l=this.tableEl,c=a.getRowCount(),d=a.getColumnCount(),u=l.querySelector("tbody"),h=[];for(r(u).hide(),o=0;o<c;o++){for(e=u.insertRow(o),i=0;i<d;i++)(t=a.getCell(o,i))||s.error("No find cell! row, col, block",o,i,a),t.isMergedCell()||(t.isAttachmentCell()&&h.push({row:o,col:i}),e.appendChild(this._renderCell(o,i)));n=a.getRowHeight(o),e.style.height=n?n+"px":""}r(u).show(),this._renderColumns(this.colgroupEl.querySelectorAll("col").length,d)},_loadCellImg:function(e,t){var n=this,o=e.querySelector("img");o&&r(o).load(function(){n._triggerResize(),t&&n._redrawRange()})},_createHighlightMark:function(){var e=this;e._clearHighlightMark(),t.each(e._OCRHighlightInfos,function(n){var o=r(e.getCellImageEl(n.cellId));if(null!=o&&0!==o.length){var a=o.position(),l=o.width()/n.width;t.each(n.pos,function(t){var n=r(i.render("common","high_light_item",{top:a.top+t.top*l-1,left:a.left+t.left*l-2,height:(t.bottom-t.top)*l,width:(t.right-t.left)*l}));n.appendTo(e.wrapperEl),e._OCRHighlightItem.push(n)})}else s.error("Failed to get TableCell by ID:",o)})},clearHighlight:function(){this._OCRHighlightInfos=[],this._clearHighlightMark()},_clearHighlightMark:function(){t.each(this._OCRHighlightItem,function(e){e.remove()}),this._OCRHighlightItem=[]},_replaceBlankToSymbol:function(e){var n=function(e){!e||e.length<1||t.forEach(e,function(e){e.children&&e.children.length>0&&n(e.children),e.childNodes[0]&&3===e.childNodes[0].nodeType&&(e.innerHTML=e.innerHTML.replace(/ /g,"&nbsp;"))})};e&&n(e.children)},_renderCell:function(e,t,n){var o,i,r,a,s,l=this.block,c=l.getCell(e,t,{findMergePointIfNeeded:!0,withPosition:!0});if(c){switch(o=c.cell,i=n||document.createElement("td"),r=o.getContent(),a=o.getType(),i.setAttribute("data-cell-id",o.getCellId()),this._setMergeCell(i,o),this._setCellStyles(i,o.getBlockStyles()),this._setBorder(i,e,t,o.getBlockStyles()),a){case g.TEXT:s=r.toHtml({styleRules:this._getStyleRules()});break;case g.IMAGE:s=I.renderImage(r,l.getExtraInfo("pcResMap"));break;case g.ATTACHMENT:s=I.renderAttachment(r)}return i.innerHTML=s,this._loadCellImg(i,n),n&&this._triggerResize(),i}},_getStyleRules:function(){var e=this._inlineStyleViewMapper;return{color:function(t){var n=t.color;return t.href!==v.getDefault("href")&&a.equals(t.color,"blue")?"#003884":null!=n&&e?e.valueToView("color",n):void 0},"font-family":function(t){var n,o=t["font-family"];return null!=o&&e&&(n=e.valueToView("font-family",o)),o!==n?n:k.getAllValueByFont(o)||o}}},_setMergeCell:function(e,t){if(t.isMergePoint()){var n=t.getMergePointAttr();n.width>0&&e.setAttribute("colspan",n.width),n.height>0&&e.setAttribute("rowspan",n.height)}},_reRenderCells:function(){var e=this.tableEl.querySelector("tbody");this._rending=!0,e.innerHTML="",this.colgroupEl.innerHTML="",this._renderCells(),this._rending=!1,this._triggerResize(),this._redrawRange()},_redrawRange:function(){var e=this._getRectOfNoteRange();this._setRange(e)},_onDownloadClick:function(e){var t,n,o,i=this.getCellElementByTarget(e.target),a=this.block;i&&(t=r(i).data("cellId"),(o=a.getCellById(t).cell)&&(n=o.getContent(),this.trigger("yne-download-attachment",n.getResource(),n.getFileName())))},_onClick:function(e){-1!==e.target.className.indexOf("attachment-download")&&this._onDownloadClick(e)},_onEnterLink:function(e){var t,n,o=r(e.target).closest("a").get(0),i=this.getCellElementByTarget(e.target),a=o.parentNode;t=r(i).data("cellId"),n=this.block.getCellById(t),!this.isOnCellEdit()&&n&&(a.innerText||"").trim()===(o.innerText||"").trim()&&(x.isNoteLinkUrl(o.href)||this.isCollabLocked()||!o||("file://"===o.origin&&r(o).click(function(){return!1}),this.trigger("link-menu-show",{linkNode:o,block:this.block,range:h.create({block:this.block,type:h.TYPES.NORMAL,rect:{width:1,height:1,left:n.col,top:n.row}})})))},_onLeaveLink:function(){this.trigger("link-menu-hide")},_onMouseDown:function(e){this.getCellElementByTarget(e)?this._handleDrag(e,c.DRAG_START,!0):this._setRange(h.TYPES.BLANK)},_onDblclick:function(){var e,t=this._getRectOfNoteRange();t&&!this.isLocked()&&(e=this.block.getCell(t.top,t.left,{findMergePointIfNeeded:!0,withPosition:!0}),this._cellEditView.showAndEdit(e))},_getTableRange:function(){var e,t=this._getNoteRange();if(t&&t.isInSingleBlock&&t.isInSingleBlock()&&(e=t.getStartBlockRange())&&e instanceof h&&e.block===this.block)return e},_getRectRange:function(){var e=this._getTableRange();if(e)return e.getAsRectRange()},_getRectOfNoteRange:function(){var e=this._getRectRange();return e&&e.getRect?e.getRect():null},_getNoteRange:function(){var e;return this.trigger("get-note-range",function(t){e=t}),e},_onDragStart:function(e){this._rectOnDragStart=null,this._handleDrag(e,c.DRAG_START)},_handleDrag:function(e,t,n){var o,i,a,l,d,u=this.getCellElementByTarget(e.target),h=e.shiftKey&&!e.ctrlKey&&!e.metaKey;if(o=r(u).data("cellId"),i=this.block.getCellById(o)){switch(this._preSelectionRect=null,l={width:1,height:1,left:i.col,top:i.row},t){case c.DRAG_START:if(h)d=this._getRectOfNoteRange(),this._rectOnDragStart=d,a=b.union(this._rectOnDragStart,l);else{if(n&&(d=this._getRectOfNoteRange(),b.contains(d,l)))return;a=this._rectOnDragStart=l}break;case c.DRAGGING:case c.DRAG_END:a=b.union(this._rectOnDragStart,l);break;default:s.error("unvalid drag type",t)}a&&this._setRange(a)}},_setRange:function(e){var t,n,o,i=h.TYPES.NORMAL;if(e)return e.width?o=e:i=e,t=h.create({block:this.block,type:i||h.TYPES.FIRST_CELL,rect:o}),n=new p({startRange:t,endRange:t}),this.trigger("set-range",n,!0,!0,!0),this._preSelectionRect=o,t},_onDragging:function(e){this._handleDrag(e,c.DRAGGING)},_onDragEnd:function(){this._handleDrag(event,c.DRAG_END),this._rectOnDragStart=null},_cancelEditMode:function(){s.log("hide cellEditView"),this._cellEditView.hide()},_setCellStyles:function(e,t){var n;n=t.textAlign,e.style.textAlign="center"===n||"right"===n||"left"===n?n:"",n=t.verticalAlign,e.style.verticalAlign="top"===n||"middle"===n||"bottom"===n?n:"",n=t.wrap,e.style.whiteSpace=!1===n||"false"===n?"nowrap":"pre-wrap",n=t.backColor,e.style.backgroundColor=n&&"inherit"!==n&&"transparent"!==n?n:""},_setBorder:function(e,t,n,o){var i,r=this.tableEl.querySelector("tbody"),a=o["border|vertical"],s=o["border|horizontal"];0===t?(i=e)&&(i.style.borderTop=s):(i=r.rows[t-1].cells[n])&&(i.style.borderBottom=s),0===n?(i=e)&&(i.style.borderLeft=a):(i=r.rows[t].cells[n-1])&&(i.style.borderRight=a)},_setRowHeight:function(e,t){var n=this._getRowElAt(e);n&&(n.style.height=t+"px",this._triggerResize())},_getRowElAt:function(e){var t=this.tableEl.tBodies[0];if(t)return t.rows[e]},getRowElHeight:function(e){var t=this._getRowElAt(e),n=0;return t?n=t.getBoundingClientRect().height:n},_renderColumns:function(e,n){if(!((e=e||0)>=n)){var o,i=this.block,r=i.getColumnCount(),a=this.colgroupEl,s=t.toArray(a.querySelectorAll("col"));for(n=n||r,o=e;o<n;++o)this._setColumnWidth(o,i.getColumnWidth(o));for(o=s.length-1;o>=r;--o)d(s[o])}},_setColumnWidth:function(e,t){var n=this._ensureColEl(e);n&&(n.style.width=t+"px",this._triggerResize())},_ensureColEl:function(e){var t,n=this._getColumnCount(),o=Math.max(e+1,n),i=this.colgroupEl,r=o-i.querySelectorAll("col").length,a=this._getColElAt(e);if(a)return a;for(t=0;t<r;++t)i.appendChild(document.createElement("col"));return this._getColElAt(e)},_getColumnCount:function(){var e=this.tableEl.rows[0];return e?e.cells.length:this.block.getColumnCount()},_getColElAt:function(e){if(!(e<0)){return this.colgroupEl.querySelectorAll("col")[e]}},getColElWidth:function(e){var t=this._getColElAt(e);return t?parseFloat(t.style.width):0},getCellElement:function(e){if(e&&e.getCellId&&(e=e.getCellId()),e)return this.$el.find('[data-cell-id="'+e+'"]:first').get(0)},getCellElementAt:function(e,t){var n=this.block.getCell(e,t,{findMergePointIfNeeded:!0});return this.getCellElement(n)},getCellTextElementAt:function(e,t){return this.getCellElementAt(e,t).querySelector(".table-cell-line > span")},getColumnIndex:function(e){var t=r(e).data("cellId"),n=this.block.getCellById(t);return n&&null!=n.col?n.col:null},getCellElementByTarget:function(e){if(e&&e.target&&(e=e.target),e)return r(e).closest("td").get(0)},getAbsoluteBoundingRectAt:function(e,t){var n=this.getBoundingRectAt(e,t),o=this._tableLayoutInnerEl.scrollLeft;if(n)return n.left-=o,n},getBoundingRectAt:function(e,t){var n=this.getCellElementAt(e,t);return this.getBoundingRect(n)},getBoundingRectByCell:function(e){var t=this.getCellElement(e);return this.getBoundingRect(t)},_triggerResize:function(){if(!this._rending){this._createHighlightMark()}},getBoundingRect:function(e){if(e){var t=this.wrapperEl.getBoundingClientRect(),n=this._tableLayoutInnerEl.scrollLeft,o=e.getBoundingClientRect();return{left:o.left-t.left-n,top:o.top-t.top,right:o.right-t.left-n,bottom:o.bottom-t.top,width:o.width,height:o.height}}},getEventBoundingRect:function(e){if(e){var t=this.wrapperEl.getBoundingClientRect();return{left:e.clientX-t.left,top:e.clientY-t.top}}},_onSetRowHeight:function(e,t){this._setCellsSize([{row:e,height:t}])},_onSetColWidth:function(e,t){this._setCellsSize([{col:e,width:t}])},_setCellsSize:function(e){this.trigger("command","comp.SetTableCellsSize",{table:this.block,sizes:e})},_onAttributeChanged:function(){this._reRenderCells()},_onRowHeightSet:function(e,t){this._setRowHeight(e,t)},_onColWidthSet:function(e,t){this._setColumnWidth(e,t)},_ensureRow:function(e){s.log("ensure the row has rendered",e)},_onColInserted:function(){this._reRenderCells()},_onColDeleted:function(){this._reRenderCells()},_onRowInserted:function(){this._reRenderCells()},_onRowDeleted:function(){this._reRenderCells()},_onCellInlineStyleChange:function(e,t){var n=this.getCellElementAt(e,t);this._renderCell(e,t,n)},_onCellBlockStyleChange:function(e,t,n,o){var i=this.getCellElementAt(e,t);i&&this._setCellStyles(i,o)},_onCellMouseEnter:function(e){this.trigger("cell-enter",e,this)},_onCellMouseLeave:function(e){this.trigger("cell-leave",e,this)},_onCellContentChange:function(e){var t,n=this.block.getCellById(e);n?(this._ensureRow(n.row),(t=this.getCellElement(e))?(this._renderCell(n.row,n.col,t),this._triggerResize()):this._reRenderCells()):s.error("unvalid cell info",n)},getHiddenInputView:function(){return this._hiddenInputView},getCellEditView:function(){return this._cellEditView},focusOutTbody:function(){this._setRange(h.TYPES.BLANK)},_setTableStyles:function(){var e=this,n=e.block.getBlockStyles();t.each(n,function(t,n){e._setTableStyle(n,t)})},_setTableStyle:function(e,t){var n=this.$el;switch(e){case"back-color":n.css("background-color",t);break;case"padding":t?n.css({padding:t,"padding-bottom":"5px","padding-top":"5px"}):n.css({padding:t,"padding-bottom":"","padding-top":""})}},_onStyleChange:function(e,t){this._setTableStyle(e,t)},getCellImageEl:function(e){var t=this.getCellElement(e);if(t)return t.querySelector("img")},getImageDomMapByTableRange:function(e){var t,n=e.tableRange,o=e.selectAll,i=this,r=i.block,a={};if(o&&(n=h.create({type:h.TYPES.ALL,block:r})),n&&(t=n.getAsRectRange()))return t.forEachCell(function(e){var t,n,o=e.getCellId();e.isImageCell()&&(t=i.getCellImageEl(o))&&(n=e.getContent(),a[r.getId()+"-"+n.getResId()]||(a[r.getId()+"-"+n.getResId()]={img:t,source:n.getSource()}))}),a},isLocked:function(){var e;return this._rending||this.trigger("get-read-only-status",function(t){e=t}),this.block.isLocked()||this.block.isReadOnly()||this._isReadOnly||e},selectTable:function(e){if(!this._selectionView)return s.error("No selectionView find!");if(e){if(this._getRectOfNoteRange())return;this._selectionView.draw(h.create({block:this.block,type:h.TYPES.ALL}))}else this._selectionView.draw()},onDrawRange:function(e){var t,n;if(!this._selectionView)return s.error("No selectionView find!");if(e&&!e.isInBlank()){if(this._selectionView.draw(e),!(t=e.getAsRectRange()))return;n=t.getRect(),this._hiddenInputView.focus(this.getAbsoluteBoundingRectAt(n.top,n.left))}else this._selectionView.draw()},convertToNativeRange:function(){var e=document.createRange(),t=this.$el.get(0);return e.setStart(t,0),e.setEnd(t,t.childNodes.length),e},parseNativeRange:function(e,t,n){var o,i,a,s,l,c=this.block,d=e.startContainer,u=e.endContainer;return e.collapsed||(i=this.getCellElementByTarget(u))&&(s=c.getCellById(r(i).data("cellId"))),(o=this.getCellElementByTarget(d))&&(a=c.getCellById(r(o).data("cellId"))),a?this._setRange({top:a.row,left:a.col,height:s?s.row-a.row:1,width:s?s.col-a.col:1}):n||M.isNodeInRange(this.wrapperEl,e)||M.isRangeInNode(this.el,e)?(l=new h({block:c,type:h.TYPES.ALL}),this._selectionView.draw(l),l):void 0},onHighlight:function(e,n,o){var i,r,a,s,l,c=this,d=c.block,u=d.getRowCount(),h=d.getColumnCount();function p(e){for(var t,i=e.getLength(),r=n.ignoreCase?e.toString().toLowerCase():e.toString(),a=s.indexOf(r,0);-1!==a;)(t=document.createRange()).setStart(l,a),t.setEnd(l,a+i),o(t),a=s.indexOf(r,a+i)}function g(o){s=o.textContent,s=n.ignoreCase?s.toLowerCase():s,l=o,t.each(e,p)}for(c._OCRHighlightInfos=[],r=0;r<u;r++)for(a=0;a<h;a++)if(!d.isMergedCell(r,a))if((i=d.getCell(r,a)).isImageCell())null!=n.images&&t.each(n.images,function(e){e.resID===i.getContent().getResId()&&(e.cellId=i.getCellId(),c._OCRHighlightInfos.push(e))});else{if(l=c.getCellTextElementAt(r,a),!i.isTextNoEmptyCell()||!l)continue;t.map(l.childNodes,g)}c._createHighlightMark()},editCellFromToolbar:function(e,t){return this._cellEditView.editFromToolbar(e,t)},isOnCellEdit:function(){var e=this._cellEditView,t=this._hiddenInputView;return e&&e.isOnEdit()||t&&t.isOnEdit()},_onCellEditViewEnter:function(e){e&&(e.blockId=this.block.getId()),this.trigger("cell-edit-view-enter",e)},setPasteAsText:function(e){this._isPasteAsText=e||!1}},{isRangeInCellEditArea:function(e){return f.isRangeIn(e)||m.isRangeIn(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(13),i=n(0);return t=o.extend({initialize:function(e){i.bindAll(this,"onMouseDown","onMouseMove","onMouseUp"),this.el=e.el,this.disableDocSelection=!0===e.disableDocSelection,this.document=this.el.ownerDocument,this._makeDraggable()},_makeDraggable:function(){var e=this.el;e.addEventListener("mousedown",this.onMouseDown),this._setUserSelect(e,"none")},_getUserSelect:function(e){return e.style.webkitUserSelect||e.style.mozUserSelect||e.style.msUserSelect||e.style.userSelect||""},_setUserSelect:function(e,t){e.style.webkitUserSelect=t,e.style.mozUserSelect=t,e.style.msUserSelect=t,e.style.userSelect=t},onMouseDown:function(e){if(1===e.which){var n=this.el,o=this.document;n.setCapture&&n.setCapture(),o.addEventListener("mousemove",this.onMouseMove),o.addEventListener("mouseup",this.onMouseUp),this.disableDocSelection&&(this._backupDocUserSelect=this._getUserSelect(o.body),this._setUserSelect(o.body,"none")),this.trigger(t.DRAG_START,e)}},onMouseMove:function(e){1===e.which&&this.trigger(t.DRAGGING,e)},cancel:function(){var e=this.el,t=this.document;e.releaseCapture&&e.releaseCapture(),t.removeEventListener("mousemove",this.onMouseMove),t.removeEventListener("mouseup",this.onMouseUp),this.disableDocSelection&&this._setUserSelect(t.body,this._backupDocUserSelect)},onMouseUp:function(e){1===e.which&&(this.cancel(),this.trigger(t.DRAG_END,e))}},{DRAG_START:"drag-start",DRAGGING:"dragging",DRAG_END:"drag-end"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t={bold:"bold",italic:"italic",strike:"strikeThrough",underline:"underline"};return{TOGGLE_INLINE_STYLES_CMD_MAP:t,INLINE_STYLES_CMD_MAP:n(0).extend({"back-color":"backColor",color:"foreColor","font-family":"fontName","font-size":"fontSize"},t)}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(242).extend({initialize:function(e){var t=e.event,n=t.originalEvent||t;this._dataTransfer=n.clipboardData}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(16),i=n(1),r=n(36).isEdge(),a=n(471),s={"text/html":!0,"text/plain":!0,"text/uri-list":!0,"text/yne-image-json":!1,"text/yne-json":!1,"text/yne-note-id":!1,"text/yne-table-json":!1};return o.extend({initialize:function(e){var t=e.event,n=t.originalEvent||t;this._dataTransfer=n.dataTransfer},_getCustomData:function(e){var t,n;if(!this._altData){t=this._dataTransfer.getData("application/json");try{n=JSON.parse(t),this._altData=n}catch(e){i.error(e),this._altData={}}}return this._altData[e]},getData:function(e){var t,n,o=this._dataTransfer;return r?(!0===(t=s[e])?(n=o.getData(e),i.log("get standard type",e,n)):!1===t?(n=this._getCustomData(e),i.log("get custom type",e,n)):i.error("type should be registered!",e),n):o.getData(e)},setDataMap:function(e){var n,o=this._dataTransfer,l=function(t,n){i.log("set data to data transfer",n,t);try{var r=t;"text/html"===n&&null!=e["text/yne-json"]&&null!=e["text/html"]&&(e["text/html"]=e["text/html"]+"\x3c!--5f39ae17-8c62-4a45-bc43-b32064c9388a:"+a.encode(e["text/yne-json"])+"--\x3e",r=e["text/html"]),o.setData(n,r)}catch(e){i.error(e)}},c={},d=0;if(r){if(t.each(e,function(e,t){var n=s[t];!0===n?l(e,t):!1===n?(i.log("set custom type",t),c[t]=e,d++):i.error("type should be registered!",t)}),d>0)try{n=JSON.stringify(c),l(n,"application/json")}catch(e){i.error(e)}}else t.each(e,l)},clearData:function(e){return this._dataTransfer.clearData(e)},setProperty:function(e,t){this._dataTransfer[e]=t}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(11),o=n(4),i=n(6),r=n(1),a=n(17),s=n(64),l=n(3),c=t.extend({name:"ManagerAdapter",effected:!0,_block:null,_dataBefore:null,_dataAfter:null,_args:null,initialize:function(e){var t;e.args=e.args||{},this._args=e.args,c.__super__.initialize.apply(this,arguments),l.isCollabCommand(this._args)||(this._block=e.block,this._dataBefore=e.dataBefore,this._dataAfter=e.dataAfter,(t=this._args.range)&&t.clone&&(this.setStartingRange(t),this.setEndingRange(t.clone(!0))))},apply:function(){var e=this._args.collabProperties||{},t=e.coreEditor;t.isCollabEnabled()&&e.isCollabCmd&&(this._block?this._NeedToSetData(t)&&this._block.setInnerData(this._dataAfter):(e.dataCmdError="Table block has been deleted",e.isOwnCmd&&t.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,e.coreEditor),this.effected=!1))},doReapply:function(e){var t,n,o=this._block,r=e.collabProperties,a=r.coreEditor;o&&(t=o.getInnerCommandManager()),a.isCollabEnabled()?(r.redoUndoEffected=!0,r.isCollabCmd?o?(o.setInnerData(this._dataAfter),r.isOwnCmd&&t&&(n=t.redoStack.pop())&&t.undoStack.push(n)):(r.dataCmdError="Table block has been deleted",r.isOwnCmd&&r.coreEditor.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,a),r.redoUndoEffected=!1):t&&t.redo()):t&&t.redo()},sendInfoToInner:function(e){var t=this._block;t&&t.sendInfoToInner?t.sendInfoToInner(e):r.error("The block or sendInfoToInner() method is not valid!")},doUnapply:function(e){var t,n,o=this._block,r=e.collabProperties||{},a=r.coreEditor;o&&(t=o.getInnerCommandManager()),a.isCollabEnabled()&&r.isCollabCmd?o?(o.setInnerData(this._dataBefore),r.isOwnCmd&&t&&(n=t.undoStack.pop())&&t.redoStack.push(n)):(r.dataCmdError="Table block has been deleted",r.isOwnCmd&&a.notifyErrorToHost(i.INVALIDACTION_BLOCKS_DIRTY,a),r.redoUndoEffected=!1):t&&t.undo()},fromCollabJSON:function(){var e=this._args.collabProperties,t=e.cmdJSON,n=e.coreEditor.getBlockById(t.blockId);this._block=n,this._dataBefore=t.dataBefore,this._dataAfter=t.dataAfter,c.__super__.fromCollabJSON.apply(this)},getBlockId:function(){var e=null;return this._block&&(e=this._block.getId()),e},toCollabJSON:function(){var e,t=this._block.getId();return this.rangeIsRequired=!1,(e=c.__super__.toCollabJSON.apply(this)).blockId=t,e.dataBefore=this._dataBefore,e.dataAfter=this._dataAfter,e},_NeedToSetData:function(e){var t=this._args.collabProperties||{},n=e.getLastNotOwnExecCmd(),o=!0;return t.isOwnCmd&&(n?n.name!==this.name?(r.log(this.name+": lastNotOwnCmd.name is "+n.name),o=!1):this._block.getId()!==this.getBlockId()?(r.log(this.name+": lastNotOwnCmd do NOT operate same table"),o=!1):this.getCmdOriginalNoteVersion()!==n.getCmdOriginalNoteVersion()?(r.log(this.name+": lastNotOwnCmd originalNoteVersion NOT same"),o=!1):r.log(this.name+": Need to set data again to resolve conflict"):(r.log(this.name+": lastNotOwnCmd is null"),o=!1)),o}},{create:function(e,t,n){var o,i,l={};if(e&&e.getInnerCommandManager&&e.setInnerData)return o=new s({block:e}),i=new a({startRange:o,endRange:o}),l.range=i,new c({args:l,block:e,dataBefore:t,dataAfter:n});r.error("The block is not valid: ",e)}});return o.add(c),c}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(16),o=n(6),i=n(3),r=n(1);return t.extend({name:"UnknownCommand",isSimple:!1,cmdError:null,cmdId:null,isCollabRedo:!1,isCollabUndo:!1,rangeIsRequired:null,initialize:function(){var e=this.options.args||{};i.isCollabCommand(e)?this.fromCollabJSON(e.collabProperties.cmdJSON):this.cmdId=i.newGUID()},apply:function(){throw"Method not implemented."},doReapply:function(){throw"Method not implemented."},doUnapply:function(){throw"Method not implemented."},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;null!=e.cmdId?this.cmdId=e.cmdId:r.debugAlert("cmdJSON.cmdId should NOT be null")},getCmdId:function(){var e=this.cmdId;return null==e&&r.debugAlert("cmdId should NOT be null"),e},setCollabRedo:function(e){this.isCollabRedo=e},setCollabUndo:function(e){this.isCollabUndo=e},toCollabJSON:function(){var e={};return e[o.CJSON_ACTION]=this.name,e.cmdId=this.getCmdId(),e}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(22),r=n(4),a=n(64),s=n(3);return t=i.extend({name:"atom.SetTableCellInlineStyle",_table:null,_rect:null,_type:null,effected:!1,_oldStyles:{},_styles:null,initialize:function(){var e=this.options.args;this._oldStyles={},s.isCollabCommand(e)||(this._table=this.options.table,this._styles=this.options.styles,this._rect=this.options.rect,this._type=this.options.type,this._toggle=this.options.toggle),this.type===a.TYPES.ALL&&(this._rect=this._rect||{top:0,left:0,width:this._table.getColumnCount(),height:this._table.getRowCount()}),t.__super__.initialize.apply(this)},apply:function(){var e,t,n,i,r,s=this._table,l=this._rect,c=this._styles||{},d=this._toggle,u=l.top+l.height,h=l.left+l.width;if(!l)return this.effected;if(d){if(i=a.create({block:s,type:a.TYPES.NORMAL,rect:l})){if(!(r=i.getAsRectRange()))return this.effected;e=s.getCommonInlineStyle(d,r)}c[d]=null==e||!e}for(t=l.top;t<u;t++)for(n=l.left;n<h;n++)this._oldStyles[t+"-"+n]=s.getCellInlineStyles({row:t,col:n,names:o.keys(c)}),s.setCellInlineStyles({row:t,col:n,styles:c})&&(this.effected=!0);return this.effected},doUnapply:function(){var e,t,n=this._table,o=this._rect,i=o.top+o.height,r=o.left+o.width;for(e=o.top;e<i;e++)for(t=o.left;t<r;t++)n.setCellInlineStyles({row:e,col:t,styles:this._oldStyles[e+"-"+t]})},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._styles=o.styleNameValues,this._oldStyles=o.oldStyleNameValues,this._rect=o.simpleValue1,this._type=o.simpleValue2,this._toggle=o.newBlkId)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.styleNameValues=this._styles||null,e.oldStyleNameValues=this._oldStyles,e.simpleValue1=this._rect,e.simpleValue2=this._type,e.newBlkId=this._toggle||null,e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(18),a=n(2),s=n(1),l=n(37),c=n(78),d=n(138),u=n(93),h=n(91),p=n(208),g=n(120),f=n(86);return t=o.extend({name:"abstract.comp.DeleteNoteRange",_cmdArgs:null,_note:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this)},apply:function(){var e,t,n,o,i,c,p=this._cmdArgs.range,g=[];if(!p)return s.error(this.name+":note range should NOT be null"),!1;if(t=(e=p.getStartBlockRange()).block,n=p.getEndBlockRange().block,o=this._note.getNextBlock(n),a.isCode(t))return e.selectWholeBlock||this._cmdArgs.isCodeDelete?(i=r.replaceBlockWithParagraph(this,this._note,t,""),r.setTextBlockAsEndingRange(this,i,0,0)):(p.isCollapsed()?(c=u.createNewRange({preCodeRange:e,charOffset:1}),this.executeAtomicCommand(new d({block:t,startBlockRange:e,endBlockRange:c}))):r.deleteSelectedContent(this,this._note,p),r.setCodeBlockAsEndingRange(this,e,0,0)),!0;if(!p.isCollapsed()&&(r.deleteSelectedContent(this,this._note,p),p.isInSingleBlock()&&a.isTextBlock(t)))return r.setTextBlockAsEndingRange(this,t,e.start,e.start),!0;if(p.isInSingleBlock()){if(a.isTextBlock(t)){if(p.isCollapsed())return e.start===t.getLength()?this._deleteAtTextBlockEnd(o,t):this._deleteAtTextBlockMiddle(t,e.start);r.setTextBlockAsEndingRange(this,t,e.start,e.start)}else o&&!a.isTable(o)?(this.executeAtomicCommand(new l({note:this._note,blocks:[t]})),t=o):t=r.replaceBlockWithParagraph(this,this._note,t,""),a.isTextBlock(t)?r.setTextBlockAsEndingRange(this,t,0,0):r.setNonTextBlockAsEndingRange(this,t);return!0}return p.isInMultiBlock(n)?(a.isTextBlock(t)&&a.isTextBlock(n)?(this.executeAtomicCommand(new h({block:t,start:t.getLength(),text:n.getText()})),g.push(n),r.setTextBlockAsEndingRange(this,t,e.start,e.start)):a.isTextBlock(t)?(g.push(n),r.setTextBlockAsEndingRange(this,t,e.start,e.start)):a.isTextBlock(n)?(g.push(t),r.setTextBlockAsEndingRange(this,n,0,0)):(g.push(t),o?g.push(n):n=r.replaceBlockWithParagraph(this,this._note,n,""),r.setTextBlockAsEndingRange(this,n,0,0)),this.executeAtomicCommand(new l({note:this._note,blocks:g})),!0):void 0},_deleteAtTextBlockEnd:function(e,t){var n;return!(e&&!a.isTable(e))||(a.isAttachment(e)||a.isImage(e)||a.isCode(e)?(this.setEndingRange(f.buildNoteRangeFromNonTextBlock(e)),!0):(n=t.getLength(),a.isTextBlock(e)&&this.executeAtomicCommand(new h({block:t,start:t.getLength(),text:e.getText()})),this.executeAtomicCommand(new l({note:this._note,blocks:[e]})),r.setTextBlockAsEndingRange(this,t,n,n),!0))},_deleteAtTextBlockMiddle:function(e,t){if(g.isAtHrefBorder(e,t,!1))return this._deleteHref(e,t,!1),!0;this.executeAtomicCommand(new c({block:e,start:t,end:t+1})),r.setTextBlockAsEndingRange(this,e,t,t)},_deleteHref:function(e,t){var n;-1!==(n=g.findHrefBorder(e,t,!1))&&this.executeAtomicCommand(new p({blocks:[e],styleNameValues:{href:"",color:"#393939",underline:!1},start:t,end:n+1}))},isSingleBlockAffected:function(){var e,n,o=this._args.range,i=t.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o&&o.isCollapsed()&&(e=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(e)&&r===e.getEndOffset()&&(i=!1)),i}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(83),a=n(3);return t=o.extend({name:"atom.InsertTableRowCol",_table:null,_rect:null,_cellsData:null,_dataLength:null,effected:!1,initialize:function(){var e=this.options,n=e.args;a.isCollabCommand(n)||(this._cellsData=e.cellsData,this._sizes=e.sizes,this._rect=e.rect,this._table=e.table,this._dataLength=this._cellsData.length),t.__super__.initialize.apply(this)},apply:function(){var e=this._rect,t=this._table,n=this._cellsData,o=this._sizes;null!=e.row&&(t.insertRows(e.row,n,o),this.effected=!0),null!=e.col&&(t.insertCols(e.col,n,o),this.effected=!0)},doUnapply:function(){var e=this._rect,t=this._table,n=this._dataLength;null!=e.row&&t.deleteRows(e.row,n),null!=e.col&&t.deleteCols(e.col,n)},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._cellsData=r.cellsFromCollabJSON(o.dataBefore),this._rect=o.simpleValue1,this._dataLength=o.simpleValue2)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.dataBefore=r.cellsToCollabJSON(this._cellsData),e.simpleValue1=this._rect,e.simpleValue2=this._dataLength,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(16)],void 0===(i=function(e,t,n){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.createCommandTypeEvent=function(e){return new t({data:e,type:t.EVENT_TYPES.COMMAND})},t.createUserTypeEvent=function(e){return new t({data:e,type:t.EVENT_TYPES.USER})},t.prototype.getType=function(){return this.type},t.prototype.getData=function(){return this.data},t.prototype.isCommandType=function(){return this.type===t.EVENT_TYPES.COMMAND},t.prototype.isUserType=function(){return this.type===t.EVENT_TYPES.USER},t.prototype.initialize=function(e){this.type=e.type,this.data=e.data,delete this.options},t.EVENT_TYPES={COMMAND:1,USER:2},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=window.JST={},o=n(0),i=n(14);n(594),n(601),n(250).files.forEach(function(e){var r=n(251)("./"+e+".jst");t["common/"+e]=o.template(i.trimTempalte(r))}),n(270).files.forEach(function(e){var r=n(271)("./"+e+".jst");t["pc/"+e]=o.template(i.trimTempalte(r))});var r,a,s,l,c=n(1),d=n(291),u=n(586),h=n(588),p=n(2),g=n(42),f=n(5),m=/^http/i.test(window.location.href);r=new d({parentEl:document.body,render:!0,buildVersion:1570697257e3}),a=new u({editor:r}),(s=new h).on("save-image",function(e,t){var n=function(e){if(e){var t,n,o=(e+="").indexOf(":");if(-1!==o&&(t=e.substring(0,o),n=e.substring(o+1),t&&n))return{source:t,localSource:n}}}(a.callNativeApi("SaveImageToNote",[t.extraSource,e]));if(n){var o=r.getBlockById(t.blockId);if(o){if(r.updateResMapWithKey(n.source,n.localSource,!1),p.isTable(o))o.forEach(function(e,t){var i=o.getCell(e,t);if(i&&i.isImageCell()){var r=i.getContent();r instanceof g&&(r.setSource(n.source),o.trigger("content-change"))}});else{if(!p.isImage(o))return;o.setSource(n.source)}a.callNativeApi("OnDocumentChange")}}}),r.on("content-set",function(e,t){s.updateNoteId(e);var n=o.filter(t,function(e){return!a.callNativeApi("IsImageSavedToNote",[e.extraSource,e.source])});s.addImgInfo(n,e),s.startSaveWithDelay()}).on("check-image",function(e,t){var n=o.filter(t,function(e){return!a.callNativeApi("IsImageSavedToNote",[e.extraSource,e.source])});s.addImgInfo(n,e),s.startSave()}).on("content-change",o.debounce(function(){a.callNativeApi("OnDocumentChange")},100)).on("context-menu",function(e,t,n){l=n;var i=3,r=2;o.each(t,function(e){e.type===r&&(e.type=i),e.key||(e.key="")}),a.callNativeApi("CtxMenu",[t])}).on("insert-photo",function(){a.callNativeApi("InsertAttachments",["image"])}).on("insert-attachment",function(){a.callNativeApi("InsertAttachments",[])}).on("insert-link",function(e){a.asyncCallNativeApi("ShowInsertLinkDialogAsync",["http://"],e)}).on("show-words",function(e,t){a.callNativeApi("ShowNoteCharNum",[e,t])}).on("download-image",function(e){a.callNativeApi("SaveImage",[e])}).on("download-attachment",function(e,t){a.callNativeApi("SaveAsAttachment",[e,t])}).on("get-entity",function(e,t){c.log("get-entity",e),a.callNativeApi("GetTemplateEntity",[e,t])}).on("request-image-rendered-src",function(e,t,n){var o=n.getSource(!0),i=n.blockId;c.log("RequestReplaceImage",[o,t,i]),/(http|https):\/\/([\w.]+\/?)\s*/.test(o)&&this.trigger("save-image",o,{source:t,extraSource:o,blockId:i,noteId:e,encode:!1}),a.callNativeApi("RequestReplaceImage",[o,t,i])}).on("replace-attachment",function(e,t,n){a.callNativeApi("ReplaceAttachments",[n,"",t])}).on("replace-image",function(e,t,n){a.callNativeApi("ReplaceAttachments",[n,"image",t])}).on("on-paste",function(e,t){var n=[];c.DEBUG&&m&&n.push(t),e?a.callNativeApi("PasteAsText",n):a.callNativeApi("Paste",n)}).on("snap-screen",function(e){var t={snap:"normal","snap-x":"hide"},n=t[e]||t.snap;a.callNativeApi("SnapScreen",[n])}).on("clipboard-status",function(e){e(a.callNativeApi("ClipboardAvailable"),a.callNativeApi("IsNoteLinkInClipboard"))}).on("require-paste",function(e,t){!0!==t?!0===e?a.callNativeApi("PasteNoteLink",[]):a.callNativeApi("Paste",[]):a.callNativeApi("PasteAsText",[])}).on("open-link",function(e,t){e=f.trim(e),t?a.callNativeApi("OpenNote",[e]):a.callNativeApi("OpenLink",[e])}).on("open-image",function(e){a.callNativeApi("OpenImage",[e])}).on("open-attachment",function(e,t){a.callNativeApi("OpenAttachment",[e,"",t])}).on("edit-link",function(e,t){var n=e.href;a.asyncCallNativeApi("ShowInsertLinkDialogAsync",[n],t)}).on("click",function(){a.callNativeApi("OnAreaClick")}).on("find",function(){a.callNativeApi("FindText")}).on("export-pdf",function(){a.callNativeApi("Export2PDF")}).on("export-word",function(){a.callNativeApi("Export2Word")}).on("download-file",function(){a.callNativeApi("DownloadOriginFile")}).on("exit-full-screen",function(){a.callNativeApi("ExitFullScreen")}).on("exit-presentation",function(){a.callNativeApi("ExitPresentation")}).on("view-mode-change",function(e){a.callNativeApi("PageModeChanged",[e])}).on("save-and-sync",function(){a.callNativeApi("StartSync")}).on("clipboard-error",function(e){c.warn("clipboard error: "+e)}).on("get-clipboard",function(e,t){var n={};o.each(e,function(e){n[e]=a.callNativeApi("GetClipboardData",[e])}),t(n)}).on("share-note",function(){a.callNativeApi("ShowShareMenu")}).on("clipboard-set",function(e){window.setTimeout(function(){a.callNativeApi("OnCopy",[!0===e])},25)}).on("rotate-image",function(e,t,n){a.callNativeApi("RotateImage",[e,t,n])}).on("zoom-changed",function(e){a.callNativeApi("OnChangeZoomByEditor",[e])}).on("background-changed",function(e,t){a.callNativeApi("ChangeBGImage",[e,t])}).on("background-failed-update",function(e){a.callNativeApi("ChangeBGImageFailed",[e])}).on("is-vip-user",function(e){e(a.callNativeApi("IsVIPUser"))}).on("log-to-native",function(e,t){t="EDITOR_LOG:"+t,a.callNativeApi("Log",[e,t])}).on("user-action-collection",function(e){a.callNativeApi("NoteEditorActionCollection",[e])}).on("scroll-in-content-loading",function(){a.callNativeApi("OnScrollInContentLoading")}),r.on("bridge-event",function(e){a.trigger.apply(a,e)}).on("select-context-menu",function(e){l&&l(e)}).on("bridge-off-events",function(){a.off()}).on("callback-to-native",function(e,t){null!=e&&""!==e&&((t=t||[]).unshift(e),a.callNativeApi("EditorCallBack",t))}).on("image-ocr",function(e){a.callNativeApi("ImageOCR",[e])}),r.on("collabsession-change",function(e){var t=window.JSON.stringify(e);a.callNativeApi("OnCollabSessionChange",[t])}),r.on("datacommand-success",function(e){a.callNativeApi("OnDataCommandSuccess",[e])}),r.on("session-built",function(e){c.log("session-built:",e),a.callNativeApi("OnSessionBuilt",[e]),r.toggleStats(!0)}),r.on("session-closed",function(e){c.log("session-closed:",e),a.callNativeApi("OnSessionClosed",[window.JSON.stringify(e)]),r.toggleStats(!1)}),r.on("session-initialized",function(e,t){c.log("session-initialized:",e,t),a.callNativeApi("OnSessionInitialized",[e,window.JSON.stringify(t)])}),r.on("useraction-failed",function(e){c.log("useraction-failed:",e),a.callNativeApi("OnUserActionFailed",[e])}),c.DEBUG&&(window.debugBridge=a,window.debugEditor=r),a.ready(document,r)}.call(t,n,t,e))||(e.exports=o)},function(e){e.exports={files:["attachment-view-attachment-container","catalogue_view","table_view","table_cell_resize","table_cell_edit","high_light_item","color_picker","handwrite-view-container","header-footer","high_light_item_image","image-title-input","image-view-image-container","link_view","list_item_view","page_break_view","paragraph_view","todo","content-load-progress"]}},function(e,t,n){var o={"./attachment-view-attachment-container.jst":252,"./catalogue_view.jst":253,"./color_picker.jst":254,"./content-load-progress.jst":255,"./handwrite-view-container.jst":256,"./header-footer.jst":257,"./high_light_item.jst":258,"./high_light_item_image.jst":259,"./image-title-input.jst":260,"./image-view-image-container.jst":261,"./link_view.jst":262,"./list_item_view.jst":263,"./page_break_view.jst":264,"./paragraph_view.jst":265,"./table_cell_edit.jst":266,"./table_cell_resize.jst":267,"./table_view.jst":268,"./todo.jst":269};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=r,e.exports=i,i.id=251},function(e,t){e.exports='<div class="attachment-block-container">\r\n    <div class="attachment-container" title="<%- title %>">\r\n        <div class="attachment-icon svg-common <%- name %>"></div>\r\n        <div class="attachment-title">\r\n            <p class="attachment-title-name"><%- fileName %></p><p class="attachment-title-type"><%- fileType %></p>\r\n        </div>\r\n        <div class="attachment-size"><%= size %></div>\r\n        <div class="attachment-download svg-common"></div>\r\n        <div class="attachment-mask" draggable="<%-!!draggable%>">\r\n            <div class="attachment-icon svg-common <%- name %>"></div>\r\n            <div class="attachment-title">\r\n                <p class="attachment-title-name"><%- fileName %></p><p class="attachment-title-type"><%- fileType %></p>\r\n            </div>\r\n            <div class="attachment-size"><%= size %></div>\r\n            <div class="attachment-download svg-common"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="catalogue-header cannot-edit">\r\n    <div class="catalogue-refresh" title="刷新">\r\n        <i class="svg-common src--svg--catalogue-refresh"></i>\r\n    </div>\r\n    <div class="catalogue-delete" title="删除">\r\n        <i class="svg-common src--svg--catalogue_remove"></i>\r\n    </div>\r\n</div>\r\n<div class="para-text"></div>'},function(e,t){e.exports='<div class="color-picker-panel" tabindex="0">\r\n    <div class="color-picker-panel-inner">\r\n        <div class="color-picker-panel-board">\r\n            <div class="color-picker-panel-board-hsv" style="background-color: rgb(255, 0, 0);">\r\n                <div class="color-picker-panel-board-value"></div>\r\n                <div class="color-picker-panel-board-saturation"></div>\r\n            </div>\r\n            <span style="left: 126px; top: 93.5px;"></span>\r\n        </div>\r\n        <div class="color-picker-panel-wrap">\r\n            <div class="color-picker-panel-wrap-ribbon">\r\n                <div class="color-picker-panel-ribbon">\r\n                    <span style="left: 0%;"></span>\r\n                </div>\r\n            </div>\r\n            <div class="color-picker-panel-wrap-alpha">\r\n                <div class="color-picker-panel-alpha">\r\n                    <div class="color-picker-panel-alpha-bg" style="background: linear-gradient(to right, rgba(57, 57, 57, 0), rgb(57, 57, 57));"></div>\r\n                    <span style="left: 100%;"></span>\r\n                </div>\r\n            </div>\r\n            <div class="color-picker-panel-wrap-preview">\r\n                <div class="color-picker-panel-preview">\r\n                    <span style="background-color: rgb(57, 57, 57); opacity: 1;"></span>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="color-picker-panel-wrap" style="height: 40px; margin-top: 6px;">\r\n            <div class="color-picker-panel-params">\r\n                <div class="color-picker-panel-params-input">\r\n                    <input type="text" class="color-picker-panel-params-hex" maxlength="6" value="393939">\r\n                    <input type="number" value="57">\r\n                    <input type="number" value="57">\r\n                    <input type="number" value="57">\r\n                    <input type="number" value="100">\r\n                </div>\r\n                <div class="color-picker-panel-params-lable">\r\n                    <label class="color-picker-panel-params-lable-hex">HEX</label>\r\n                    <label class="color-picker-panel-params-lable-number">R</label>\r\n                    <label class="color-picker-panel-params-lable-number">G</label>\r\n                    <label class="color-picker-panel-params-lable-number">B</label>\r\n                    <label class="color-picker-panel-params-lable-alpha">A</label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n</div>'},function(e,t){e.exports='<div class="progressbar-layer">\r\n    </div>\r\n    <div class="progressbar-mark">\r\n    </div>\r\n    <div class="progress-message">\r\n    <span class="progress-message-text">\r\n       <span class="progress-message-number"></span>  的内容已加载完成，请稍后...\r\n    </span>\r\n</div>'},function(e,t){e.exports='<div class="handwrite-container">\r\n    <img  src="<%= src %>"/>\r\n</div>\r\n<% if (needCopyHack) {%>\r\n    <p class="handwrite-copy-hack">select me</p>\r\n<% } %>'},function(e,t){e.exports="<div class=\"header-footer-input\" contenteditable=\"<%= readonly ? 'false' : 'true' %>\"></div>"},function(e,t){e.exports='<div class="high-light-item" style="left: <%= left %>px; top: <%= top %>px; height: <%= height %>px; width: <%= width %>px;"></div>'},function(e,t){e.exports='<div class="high-light-item-image" style="left: <%= left %>px; top: <%= top %>px; height: <%= height %>px; width: <%= width %>px;"></div>'},function(e,t){e.exports='<div class="image-title-input" contenteditable="true"\r\n    style="position: absolute; left: <%- left %>px; top: <%- top %>px; width: <%- width%>px; text-align: <%- textAlign%>; min-height: <%- height%>px;"><%- title %></div>\r\n<div class="image-title-placeholder"\r\n    style="position: absolute; left: <%- left %>px; top: <%- top %>px; width: <%- width%>px; text-align: <%- textAlign%>; min-height: <%- height%>px;">\r\n    输入标题\r\n</div>\r\n'},function(e,t){e.exports='<div class="image-block-container">\r\n    <div class="image-container">\r\n       <% if (src) { %>\r\n         <img <% if (width || height) { %> class="filter-blur" <% } %> src="<%= src %>"\r\n            <% if (width && height) { %> style="width: <%- width%>px; height: <%- height%>px;"\r\n            <% } else if (width) { %> style="width: <%- width%>px; height: auto;"<% } %>/>\r\n            <div class="resize-handle" data-corner="0"></div>\r\n            <div class="resize-handle" data-corner="1"></div>\r\n            <div class="resize-handle" data-corner="2"></div>\r\n            <div class="resize-handle" data-corner="3"></div>\r\n            <div class="menu-wrapper">\r\n                <div class="yne-button-group">\r\n                    <div class="yne-button-item yne-last" data-button-name="menu" title="快捷菜单">\r\n                        <span class="yne-button svg-common">快捷菜单</span>\r\n                        <span class="yne-arrow-down svg-common"></span>\r\n                    </div>\r\n                    <ul class="yne-popup-menu">\r\n                        <li class="yne-popup-item" data-cm-name="image-title"><span>标题</span></li>\r\n                        <li class="yne-popup-item" data-cm-name="float-left"><span>左浮动</span></li>\r\n                        <li class="yne-popup-item" data-cm-name="float-right"><span>右浮动</span></li>\r\n                        <li class="yne-popup-item" data-cm-name="clear-float"><span>清除浮动</span></li>\r\n                        <li class="yne-popup-item" data-cm-name="clear-resize"><span>清除缩放</span></li>\r\n                        <% if (hasOCR) {%>\r\n                            <li class="yne-popup-item" data-cm-name="image-ocr"><span>文本识别OCR</span></li>\r\n                        <% } %>\r\n                        <li class="yne-popup-item yne-popup-split"></li>\r\n                        <li class="yne-popup-item" data-cm-name="delete"><span>删除图片</span></li>\r\n                        <li class="yne-popup-item" data-cm-name="download"><span>另存为</span></li>\r\n                    </ul>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="image-title"></div>\r\n        <div class="image-split"></div>\r\n         <% } else {\r\n            %>\r\n              <% if (isImgError) { %>\r\n         <div class="image_error"><div class="svg-common src--svg--image_error"></div></div>\r\n         <% } else {\r\n            %><div class="loader-wrap"  <% if (width && height) {%>style="width: <%- width%>px; height: <%- height%>px;"<% } %>></div>\r\n         <% } %>\r\n\r\n         <% } %>\r\n\r\n\r\n    <% if (needCopyHack) {%>\r\n        <p class="image-copy-hack">select me</p>\r\n    <% } %>\r\n</div>\r\n'},function(e,t){e.exports='<div class="hover-menu hover-menu-show-link">\r\n    <div class="hover-menu-before"></div>\r\n    <div class="hover-menu-body">\r\n        <a href="<%= link%>" target=\'_blank\'><span><%= link%></span></a>\r\n        <% if (!isReadOnly) { %>\r\n            <div class="link-button">\r\n                <span class="link-modify-button">编辑</span>\r\n                <span class="link-split">|</span>\r\n                <span class="link-remove-button">移除</span>\r\n            </div>\r\n        <% } %>\r\n    </div>\r\n</div>\r\n<div class="hover-menu hover-menu-modify-link">\r\n    <div class="hover-menu-before"></div>\r\n    <div class="hover-menu-body">\r\n        <span class="link-label">链接</span>\r\n        <input class="link-input" type="text" name="link" value="<%= link%>" />\r\n        <div class="link-confirm-button">\r\n            <span class="link-button-text">确定</span>\r\n        </div>\r\n    </div>\r\n</div>'},function(e,t){e.exports='<% if (isOrdered) { %>\r\n    <ol class="li-box"><li><div class="para-text"></div></li></ol>\r\n<% } else { %>\r\n    <ul class="li-box"><li><div class="para-text"></div></li></ul>\r\n<% } %>'},function(e,t){e.exports='<div class="page-break">\r\n    <span class="spanMark topSpan"></span>\r\n    <span class="spanMark middleSpan"></span>\r\n    <span class="spanMark bottomSpan"></span>\r\n</div>'},function(e,t){e.exports='<div class="para-text"></div>'},function(e,t){e.exports='<div class="cell-edit-box" contenteditable="true"></div>'},function(e,t){e.exports='<div class="resize-up"></div>\r\n<div class="resize-right"></div>\r\n<div class="resize-down"></div>\r\n<div class="resize-left"></div>\r\n'},function(e,t){e.exports='<div class="table-layout">\r\n    <div class="table-layout-inner" contentEditable="false">\r\n        <div class="table-wrapper">\r\n            <table>\r\n                <colgroup></colgroup>\r\n                <tbody></tbody>   \r\n            </table>\r\n            <div class="row-resize-line"></div>\r\n            <div class="col-resize-line"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="todo-content">\r\n    <label class="todo-mark" contenteditable="false">\r\n        <span class="todo-inner"></span>\r\n    </label>\r\n    <div class="todo-input para-text">\r\n    </div>\r\n</div>'},function(e){e.exports={files:["toolbar-button-template","toolbar-combo-box-font-family","toolbar-combo-box-font-size","toolbar-combo-box-align","toolbar-combo-box-line-height","toolbar-combo-box-color","toolbar-combo-box-back-color","toolbar-combo-box-table","toolbar-combo-box-zoom","toolbar-combo-box-set-background","toolbar-combo-box-heading","toolbar_view","toolbar-combo-box-show-more","toolbar-combo-box-insert-link","presenter_page","presenter_article","float-modifiers","float-modifiers-li"],dependency:["common"]}},function(e,t,n){var o={"./float-modifiers-li.jst":272,"./float-modifiers.jst":273,"./presenter_article.jst":274,"./presenter_page.jst":275,"./toolbar-button-template.jst":276,"./toolbar-combo-box-align.jst":277,"./toolbar-combo-box-back-color.jst":278,"./toolbar-combo-box-color.jst":279,"./toolbar-combo-box-font-family.jst":280,"./toolbar-combo-box-font-size.jst":281,"./toolbar-combo-box-heading.jst":282,"./toolbar-combo-box-insert-link.jst":283,"./toolbar-combo-box-line-height.jst":284,"./toolbar-combo-box-set-background.jst":285,"./toolbar-combo-box-show-more.jst":286,"./toolbar-combo-box-table.jst":287,"./toolbar-combo-box-template.jst":288,"./toolbar-combo-box-zoom.jst":289,"./toolbar_view.jst":290};function i(e){var t=r(e);return n(t)}function r(e){if(!n.o(o,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return o[e]}i.keys=function(){return Object.keys(o)},i.resolve=r,e.exports=i,i.id=271},function(e,t){e.exports='<% for (index in allAttendees) { %>\r\n    <li id="<%=allAttendees[index].SID%>" class="attendee">\r\n        <span class="phote">\r\n            <% if (allAttendees[index].portrait) { %>\r\n            <i class="portrait" style="background-image:url(<%=allAttendees[index].portrait%>);"></i>\r\n            <% } else { %>\r\n            <i class="portrait" style="background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAIAAAGvZ15GAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyBpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6OUMzMzk1NzA1NDNFMTFFNTk5MURCMjJEMUNENUZFOTUiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6OUMzMzk1NkY1NDNFMTFFNTk5MURCMjJEMUNENUZFOTUiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNSBXaW5kb3dzIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RUNCQThDMTFDNDhBMTFERjg4MThCMUU5Rjk4RDBCMjQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RUNCQThDMTJDNDhBMTFERjg4MThCMUU5Rjk4RDBCMjQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz4YtSJRAAAGIUlEQVR42lSKQQrAMAgEay1+IuBB//8l8eYnEhNLQqEDe9jZBTO7/tyV3jsittbmnEdVZ2YiEpGjAGDvm6dS3d3rm5mvGmOo6neJiCWAGNFsBOoAmfX7929ubm4mMIAaz87OLiYmJi8vj3DXfzCAMKA2Ai2CmAjRyMLKygp0N9z4hw8fAgQgg4xRAAZCIIghjY0/EO7/z7L0AdYZMJhcYnEcy6KzK/+Mn2Hb2T94OyhvK1WVmU8PXQVXxsGo6jRxjEqLEbGhiGwmmM3szbvW6iB3PK64+2COD5FlJLsEYJSMVSAGgSB6iIWIlVaKjeD//5SV2Aq292CPDYQLdxbBJOPM7Iw/phNF8/pjXdNZa9HKOaeUJHJyuTxJTtSDCf4550II2ODYPYJSymXCmFqrMj16gvgL095bpXmOMe5MWKEpQmfDEGst9pq41TxYVAFCRkNLcVaL45bjV75yxc45c86PHO9o996lKaEB6r1vrYkBAz+IpxljjIDeApBSBisMg0AQBcm1eBL//+dCLp5E0Fzalw4YWaWldA/BtHF2HWfmuzI/Fz2ZxXXB/F/bDM9BMCcyDSF0NlU5ZxgnE87zhEZ5fgHEH8JSgoizEevxLtKBTiOKlYn2YD6h9F+MmWOMMyduJq+1ZrqZD7h2M+liIp1u3/dlsPBMKR3HwUSm2YIjiQ958pSvNCZMq5lQzEQWCHbYz5qF955ghTKNwxon1VphWglmI/x+2TaSST7p34EuRpiO1Os3gA5KKffeywLO0YQU4RTjZc1XNhaR37PyAlEWMTYozx8LlyJaSeElAPPlsqsgEATRaPgASPj/v2NN2LvwOAfLEXEI8S7uJCboOD39qKpufuVaxPHPuPb/DG1xZO2VGJ6HYUCb+bosCyCiMtQI6j+S8g7ubpMzscO/x3GE6NkCRBQIpYZoQBQT4Lam7g7X7ExiKvOA7YV2lcMt0oILtjEBgjPEeGAdLLoOHNoWWoa8VjFPc9nc76hwQFoPpO19xV6JbmNrRyEPlyZq6u8nG6FoWLmVZbttJRu3qXF9uZnOA9eIkgOp5R/gbZ7n5D5Z93C2WlIbc+CYY5Qvai2gp2nyWRX7qpDr+Fq8WMoC3FCEkBXZFPQz2d1naCZSiCP4TJ5OGnEk0G2FhglJBLgDcSdsFBqjBIjdeuzZZz8m0H/ga9vJFr/QVIgUp8g3nrZy1Pc9tNRcXfLXKFzGLGQAi7TJt/ITCwGr/+vIVNFVvy7PFT2gArw1mDJVbO2ZeA6tLycXmmWzfKSVD5kjfst0alENzvqKcbVHq6enBb/IMQvv7gK0Y0YrDcRAFJVSHwTf+///ty2lTyIoHnPqJSTbZbNW8cEBl1WT7M1k5s6d3KeufUeCRv96HruHP2b/gIbqfq9fm6qjtKR0k5S0PCRVf+gMhmYgG3gQ+cpE4p1nKKfn+lWADDE7P8mBF3oTKCZcyx+9v0h7Jmk+FWMk2TxNE/RsyRVTaHMMkAgslsyXG7E4z6UjtU2TYHUMs5A0lEi4VKYMAw/HkH2YX5KpRKMP4vOMaa4WHCPpwsmQLiNxWH8DsRZQzQ08lX8zmuGr257VMXKdheCxWLOBLVkmjUZEjGZNakr207d4awHpIWPI/NrCK7vrTVpuRpY3tgrQa7F6xSFjLtre6R5Zc+5rAb0VY4sENc3m+Xy+hem9WBOCRi6uvVwup9OJRerLmy08VDsWKKzLRskXiK6molxp1imtzIQY2YZXHgteWQXIHeeizWRhaRQVaMAEXyM2TJxABx8gXorxoriRsZo1hwFlZs4ixM9X/WRyONowv0bR19PrFYaZutbYyRQMxzRysm4D8+7TKnEVOsVEsyWGoulV+RwNWpmCyjE1m0uQ9u0oc5X0PL3OktVY5BaPLMVQ2gZw5Ph6V/c4ahKyN7d0AMuuww5/DNDhcGAfuTFMoV4m/tn6Iykw97kYaMBEzs4Dsj+Sciw9eMXcnu3Xh6pHkrT2q+KE3SIBAJebPoNkb03eF+OF0wEN/lyIu7sYruIrx+MRb5k3ItubCMSdUhCNIbX8gv7HSXwOL6TSfQLiB22gWDHQ+J+XUz8NiKgwQ3nx1DilD+SpF4rN641ZAAAAAElFTkSuQmCC);"></i>\r\n            <% } %>\r\n            <i class="color-bg"></i>\r\n            <i class="color" style="background-color:<%=allAttendees[index].color%>;"></i>\r\n        </span>\r\n        <span class="nickname"><%=allAttendees[index].nickname%></span>\r\n    </li>\r\n<% } %>\r\n'},function(e,t){e.exports='<div id="attendee-dialog">\r\n    <div id="attendee-hint">\r\n        <i id="attendee-icon"></i>\r\n        <span id="attendee-num">\r\n            <span id="attend-num-span">1</span>\r\n            <span>人正在编辑</span>\r\n        </span>\r\n    </div>\r\n    <ul id="attendee-list"></ul>\r\n</div>\r\n'},function(e,t){e.exports='<h1 style="text-align: center; font-size: 48px; margin-top: 100px; margin-bottom: 100px;">\r\n    <%=title%>\r\n</h1>\r\n<article class="editor-area" \r\n    ng-mouseover="over()" \r\n    ng-mouseleave="leave()"\r\n    style="padding: 10px 0 10px 0;">\r\n    <%=content%>\r\n</article>'},function(e,t){e.exports='<div class="demo-page">\r\n    <iframe frameborder="none" class="note-content"></iframe>\r\n    <div class="tool-bar" ng-class="{show : inDemoArea}">\r\n        <div>\r\n            <i class="demo-mode-icon zoom-in-icon" title="放大" data-action="zoom-in"></i>\r\n        </div>\r\n        <div>\r\n            <i class="demo-mode-icon zoom-out-icon" title="缩小" data-action="zoom-out"></i>\r\n        </div>\r\n        <div>\r\n            <i class="demo-mode-icon esc-icon" title="退出" data-action="esc"></i>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="button-wrapper button-wrapper-<%=name%>" title="<%=label%>">\r\n    <div class="button button-<%=name%> svg-common"></div>\r\n    <div class="button-text" <% if (!text) { %> style="display:none;" <% } %> ><%= text %></div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n        <% if (text) { %>\r\n            <span class="combo-text combo-text-<%=name%>"><%-text%></span>\r\n        <% } %>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (key in items) { %>\r\n        <li class="combo-item" data-value="<%=key%>">\r\n            <span class="combo-item-icon-<%=name%> <%=key%> svg-common">&nbsp;</span>\r\n            <span class="combo-item-span-<%=name%>"><%=items[key]%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value svg-common combo-value-<%=name%>">\r\n            <span class="combo-value-buttom-color"></span>\r\n        </span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <div class="combo-menu combo-menu-<%=name%>">\r\n        <div class="color-section color-section-default combo-item" data-value="<%=defaultValue%>">\r\n            <div class="color-cell combo-item back-color-cell-default" data-value="<%=defaultValue%>" style="background-color:<%=defaultValue%>;"></div>\r\n            <div class="color-label color-label-default">默认无背景色</div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-theme">\r\n            <div class="color-label color-label-theme">主题颜色</div>\r\n            <div class="color-row">\r\n            <% for (key in items.theme) { %>\r\n                <div class="color-cell combo-item" data-value="<%=items.theme[key]%>" style="background-color:<%=items.theme[key]%>;"></div>\r\n            <% } %>\r\n            </div>\r\n            <div class="color-row-split"></div>\r\n            <div class="color-part-theme">\r\n            <% for (row in items.other) { %>\r\n                <div class="color-row">\r\n                <% for (key in items.other[row]) { %>\r\n                    <div class="color-cell combo-item" data-value="<%=items.other[row][key]%>" style="background-color:<%=items.other[row][key]%>;"></div>\r\n                <% } %>\r\n                </div>\r\n            <% } %>\r\n            </div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-standard">\r\n            <div class="color-label color-label-standard">推荐颜色</div>\r\n            <div class="color-row">\r\n            <% for (key in items.standard) { %>\r\n                <div class="color-cell combo-item" data-value="<%=items.standard[key]%>" style="background-color:<%=items.standard[key]%>;"></div>\r\n            <% } %>\r\n            </div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-other combo-item">\r\n            <div class="color-img-other"></div>\r\n            <div class="color-label color-label-other">其他颜色</div>\r\n        <div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common">\r\n            <span class="combo-value-buttom-color"></span>\r\n        </span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <div class="combo-menu combo-menu-<%=name%>">\r\n        <div class="color-section color-section-default combo-item" data-value="<%=defaultValue%>">\r\n            <div class="color-cell combo-item color-cell-default" data-value="<%=defaultValue%>" style="background-color:<%=defaultValue%>;"></div>\r\n            <div class="color-label color-label-default">默认颜色</div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-theme">\r\n            <div class="color-label color-label-theme">主题颜色</div>\r\n            <div class="color-row">\r\n            <% for (key in items.theme) { %>\r\n                <div class="color-cell combo-item" data-value="<%=items.theme[key]%>" style="background-color:<%=items.theme[key]%>;"></div>\r\n            <% } %>\r\n            </div>\r\n            <div class="color-row-split"></div>\r\n            <div class="color-part-theme">\r\n            <% for (row in items.other) { %>\r\n                <div class="color-row">\r\n                <% for (key in items.other[row]) { %>\r\n                    <div class="color-cell combo-item" data-value="<%=items.other[row][key]%>" style="background-color:<%=items.other[row][key]%>;"></div>\r\n                <% } %>\r\n                </div>\r\n            <% } %>\r\n            </div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-standard">\r\n            <div class="color-label color-label-standard">推荐颜色</div>\r\n            <div class="color-row">\r\n            <% for (key in items.standard) { %>\r\n                <div class="color-cell combo-item" data-value="<%=items.standard[key]%>" style="background-color:<%=items.standard[key]%>;"></div>\r\n            <% } %>\r\n            </div>\r\n        </div>\r\n        <hr class="color-section-split">\r\n        <div class="color-section color-section-other combo-item">\r\n            <div class="color-img-other"></div>\r\n            <div class="color-label color-label-other">其他颜色</div>\r\n        <div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (font in items) { %>\r\n        <li class="combo-item" data-value="<%=items[font].singleValue%>">\r\n            <span style="font-family:<%=items[font].fullValue%>;"><%=items[font].name%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (key in items) { %>\r\n        <li class="combo-item" data-value="<%=key%>">\r\n            <span><%=items[key]%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%>"></span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (key in items) { %>\r\n        <li class="combo-item" data-value="<%=key%>">\r\n            <span style="font-size: <%=items[key][\'font-size\']%>px"><%=items[key].name%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper combo-link-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper combo-value-wrapper-<%=name%>">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n        <span class="combo-text" <% if (!text) { %> style="display:none;" <% } %> ><%= text %></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper  wrapper-<%=name%>">\r\n    <div class="combo-menu-<%=name%>">\r\n        <span class="link-label">链接</span>\r\n        <input class="link-input" type="text" name="link" placeholder="输入链接" />\r\n        <div class="link-button">\r\n            <span class="link-button-text">确定</span>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (idx in items) { %>\r\n        <li class="combo-item" data-value="<%=items[idx].key%>">\r\n            <span class="combo-item-icon-<%=name%> line-height-<%=idx%>">&nbsp;</span>\r\n            <span class="combo-item-span-<%=name%>"><%=items[idx].value%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common">\r\n        </span>\r\n        <span class="combo-text combo-text-<%=name%>">纸张背景</span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <div class="combo-menu combo-menu-<%=name%>">\r\n        <div class="background-section-top">\r\n            <% for (row in items.normalUser) { %>\r\n            <div class="background-row">\r\n                <% for (key in items.normalUser[row]) { %>\r\n                    <% if (items.normalUser[row][key] === \'NoBackground\') { %>\r\n                        <div class="background-cell combo-item" data-value="<%=items.normalUser[row][key]%>">\r\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\r\n                        </div>\r\n                    <% } else { %>\r\n                        <div class="background-cell combo-item" data-value="<%=items.normalUser[row][key]%>" style="background-image:url(\'<%=items.normalUser[row][key]%>\');">\r\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\r\n                        </div>\r\n                    <% } %>\r\n                <% } %>\r\n                </div>\r\n            <% } %>\r\n        </div>\r\n        <hr class="background-section-split">\r\n        <div class="background-section-bottom">\r\n            <div class="background-label background-label-vip">会员特权</div>\r\n            <% for (row in items.VIP) { %>\r\n                <div class="background-row">\r\n                <% for (key in items.VIP[row]) { %>\r\n                    <% if (items.VIP[row][key] === \'NoBackground\') { %>\r\n                        <div class="background-cell combo-item" data-value="<%=items.VIP[row][key]%>">\r\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\r\n                        </div>\r\n                    <% } else { %>\r\n                        <div class="background-cell combo-item" data-value="<%=items.VIP[row][key]%>" style="background-image:url(\'<%=items.VIP[row][key]%>\');">\r\n                            <svg class="background-cell-check-mark" xmlns="http://www.w3.org/2000/svg" viewBox="-16 -16 52 52"><path d="M1.05584113,8.97696545 C0.884930054,8.78831051 0.877161369,8.59965557 1.03253508,8.41100063 L1.52196226,7.7742902 C1.6617986,7.56991402 1.84047836,7.53847153 2.05800155,7.67996273 L6.39292802,10.6748599 C6.79689966,10.9421211 7.19310261,10.9185392 7.58153688,10.6041143 L19.1180347,0.982712344 C19.3044832,0.825499894 19.4831629,0.833360516 19.654074,1.00629421 L19.9104406,1.26569475 C20.0813517,1.43862845 20.0813517,1.61942277 19.9104406,1.80807771 L7.53492477,14.5187043 C7.17756524,14.880293 6.8279744,14.8881536 6.48615224,14.5422862 L1.05584113,8.97696545 Z"/></svg>\r\n                        </div>\r\n                    <% } %>\r\n                <% } %>\r\n                </div>\r\n            <% } %>\r\n        </div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="toolbar-more-split"></div>\r\n<div class="combo-display-wrapper combo-showmore-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper combo-value-wrapper-<%=name%>">\r\n        <span class="combo-value combo-value-<%=name%> svg-common">更多</span>\r\n        <span class="combo-expand-gray svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper  wrapper-<%=name%>">\r\n    <div class="combo-menu combo-menu-<%=name%>">\r\n    </div>\r\n</div>'},function(e,t){e.exports='<div class="combo-display-wrapper combo-display-wrapper-<%=name%>" title="<%=label%>">\r\n    <div class="combo-value-wrapper combo-value-wrapper-<%=name%>">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n        <span class="combo-text" <% if (!text) { %> style="display:none;" <% } %> ><%= text %></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <div class="combo-menu combo-menu-<%=name%>">\r\n    <% for (var i=0; i<maxRows; i++) { %>\r\n        <% for (var j=0; j<maxCols; j++) { %>\r\n            <span class="combo-item" data-row="<%=i%>" data-col="<%=j%>"></span>\r\n        <% } %>\r\n    <% } %>\r\n    <div class="combo-menu-label-<%=name%>">插入表格</div>\r\n    </div>\r\n</div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper">\r\n    <div class="combo-value-wrapper"></div>\r\n    <div class="combo-expand-wrapper"></div>\r\n</div>\r\n<div class="combo-menu-wrapper"></div>\r\n'},function(e,t){e.exports='<div class="combo-display-wrapper" title="<%=label%>">\r\n    <div class="combo-value-wrapper">\r\n        <span class="combo-value combo-value-<%=name%> svg-common"></span>\r\n    </div>\r\n    <div class="combo-expand-wrapper">\r\n        <span class="combo-expand svg-common"></span>\r\n    </div>\r\n</div>\r\n<div class="combo-menu-wrapper">\r\n    <ul class="combo-menu combo-menu-<%=name%>">\r\n    <% for (key in items) { %>\r\n        <li class="combo-item" data-value="<%=key%>">\r\n            <span><%=items[key]%></span>\r\n        </li>\r\n    <% } %>\r\n    </ul>\r\n</div>\r\n'},function(e,t){e.exports='<div class="toolbar-container">\r\n    <% \r\n        _.each(items, function(conf, key){\r\n            if(conf.type === \'button\') {\r\n    %>\r\n                <button class="<%= key%>" action="<%= conf.action%>" name="<%= conf.name%>" type="button" data-yne-is-block="<%= !!conf.block%>"><%= conf.label%></button>\r\n    <%      \r\n            } else if(conf.type === \'select\') {\r\n    %>\r\n                <select class="<%= key%>" action="<%= conf.action%>" name="<%= conf.name%>" data-yne-is-block="<%= !!conf.block%>">\r\n    <%\r\n                    _.each(conf.options, function(value, key) {\r\n    %>\r\n                        <option value="<%= key%>"><%= value%></option>\r\n    <%                       \r\n                    });\r\n    %>\r\n                </select>\r\n    <%\r\n            }\r\n        });\r\n    %>\r\n\r\n</div>'},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(1),n(292),n(577),n(581),n(583)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.getBlockById=function(e){return this.coreEditor.getNote().getBlockById(e)},t.prototype.isLegacyHost=function(){return this.coreEditor.isLegacyHost()},t.prototype.toggleStats=function(e){this.coreEditor.toggleStats(e)},t.prototype.updateResMapWithKey=function(e,t,n){this.coreEditor.updateResMapWithKey(e,t,n)},t.prototype.initialize=function(e){var t,r=this,a=[];if((e=n.defaults(e||{},{parentEl:null,render:!0})).render&&!e.parentEl)throw new Error("BulbEditor need `parentEl`!");r.coreEditor=t=new i({parentEl:e.parentEl}),e.render&&t.render(),n.each(s,function(e){if(a.indexOf(e)>-1)o.error("The event ["+e+"] has already bound");else{var n="yne-"+e;"collabsession-change"===e&&t.isLegacyHost()?t.bind(n,function(e){t.updateAttendees(e)}):t.bind(n,function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];r.trigger.bind(r,e).apply(r,t)}),a.push(e)}})},t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(6),n(293),n(295),n(298),n(2),n(169),n(38),n(227),n(14),n(77),n(51),n(17),n(35),n(95),n(316),n(317),n(318),n(1),n(0),n(319),n(356),n(359),n(425),n(428),n(488),n(575),n(576),n(19),n(80),n(39)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k,C,w,A,S,N,T,M,x,E,D){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isZoomHintShown=!1,t}return a(t,e),t.prototype.getDefaultFontSize=function(){return this.defaultFontSize},t.prototype.getdefaultFontName=function(){return this.defaultFontName},t.prototype.getDefaultStyle=function(){var e;return e=x.getAllDefault(["href"]),this.getdefaultFontName()&&(e["font-family"]=this.defaultFontName),this.getDefaultFontSize()&&(e["font-size"]=this.defaultFontSize),e},t.prototype.canRemoveFormat=function(){return this.controller.canRemoveFormat()},t.prototype.enterFullScreen=function(){$(document.body).addClass("full-screen"),this.toolbar.enterFullScreen(),this.isCollabEnabled()&&(this.$attendeesHintDiv.css("top","6px"),this.$attendeesHintDiv.css("right","140px"))},t.prototype.enterPresentation=function(e){var t=this._getPresenter(),n=this.getHtmlContent(!0);t.enter(e,n,this.currentBackground)},t.prototype.exitFullScreen=function(){$(document.body).removeClass("full-screen"),this.toolbar.exitFullScreen(),this.isCollabEnabled()&&(this.$attendeesHintDiv.css("top",this.attendeeHintDivDefaultStyle.top),this.$attendeesHintDiv.css("right",this.attendeeHintDivDefaultStyle.right))},t.prototype.getImages=function(){return v.filter(this.note.getAllBlocks(),function(e){return s.isImage(e)})},t.prototype.updateImageByOrigSrc=function(e,t,n){var o=this.note.getBlockById(n),i=this.noteView.getBlockViewByBlock(o);o instanceof D&&(this.updateResMapWithKey(e,t),o.setSource(e),i.updateRenderedSource(t))},t.prototype.focusEditor=function(){this.controller.focusEditor()},t.prototype.getCurrentZoomValue=function(){var e,t=this._getEditArea();return e=Number(t.css("zoom")),v.isNumber(e)||(e=1),e},t.prototype.getFirstLineTextContent=function(){var e,t=this._firstNotEmptyTextBlockIndex(),n="";return-1===t?"":((e=this.note.getBlockAt(t))instanceof p?e.getRichTexts().map(function(e){for(;n.length>100;)return n;n+=e.toString().replace(/\s+/g,"")}):n=e.toPlain(),n)},t.prototype.getNote=function(){return this.note},t.prototype.getExtraInfo=function(e){return this.note.getExtraInfo(e)},t.prototype.getNoteViewWrapper=function(){return $(this.noteViewWrapper)},t.prototype.getNoteViewFrame=function(){return $(this.noteViewFrame)},t.prototype.getPcResMap=function(){return this.getExtraInfo("pcResMap")},t.prototype.getScrollPercent=function(){var e=this.noteViewWrapper;return e.scrollTop/e.scrollHeight},t.prototype.imageOCR=function(e){this.trigger("yne-image-ocr",e)},t.prototype.initNoteViewWrapper=function(){var e,t=this,n=$(t.parentEl);t.noteViewWrapper||('<div class="note-view-wrapper"><div class="note-view-frame"></div></div>',t.noteViewWrapper=$('<div class="note-view-wrapper"><div class="note-view-frame"></div></div>').get(0),e=$(t.noteViewWrapper),t.noteViewFrame=e.find("div").get(0),e.bind("mousedown",function(e){var n=e.target;n!==t.noteViewFrame&&n!==t.noteViewWrapper||e.preventDefault()}),e.bind("scroll",function(){t.contentLoading&&(t.scrolledWhenLoading=!0,t.trigger("yne-scroll-in-content-loading"),b.log("scrolled during content loading"))}),n.append(t.noteViewWrapper),t.progressTracker=new M({}),new T({$parentEl:e,progressTracker:t.progressTracker}),null!=t.noteView&&t.noteView.setOptions({noteviewFrame:t.getNoteViewFrame(),noteviewWrapper:t.getNoteViewWrapper()})),t.updateNoteViewWrapperSize()},t.prototype.isCaretInFirstTextLine=function(e){(!v.isNumber(e)||e<=0||e>500)&&(e=80),b.log("limit: "+e);var t,n,o,i,r=this.note,a=this._firstNotEmptyTextBlockIndex(),l=0;if(-1===a)return!1;if(t=this.getNoteRange().getEndBlockRange(),(n=r.getBlockIndex(t.block))>a)return!1;for(o=0;o<n-1;o++)(i=r.getBlockAt(o))&&s.isTextOrTableBlock(i)&&(l+=i.countWords());return i=r.getBlockAt(n),s.isTextBlock(i)?l+=t.end:s.isTable(i)&&(l+=i.countWords()),l<=e},t.prototype.insertText=function(e,t){this.controller.insertText(e,t)},t.prototype.isFullScreen=function(){return $(document.body).hasClass("full-screen")},t.prototype.isLegacyHost=function(){var e=!0,t=this.getEditorProps();return null==t.pcVersion&&null!=window.YNote&&null!=window.YNote.GetVersion&&(t.pcVersion=parseInt(window.YNote.GetVersion(),10)),null!=t.pcVersion&&t.pcVersion>=parseInt("060000000000",10)&&(e=!1),e},t.prototype.isSameList=function(e){return this.controller.isSameList(e)},t.prototype.querySelectionInlineStyle=function(e){return this.controller.querySelectionInlineStyle(e)},t.prototype.querySelectionBlockStyle=function(e){return this.controller.querySelectionBlockStyle(e)},t.prototype.querySelectionInlineStyles=function(){return this.controller.querySelectionInlineStyles()},t.prototype.querySelectionBlockStyles=function(){return this.controller.querySelectionBlockStyles()},t.prototype.removeShortCut=function(e){this.controller.removeShortCut.apply(this.controller,[e])},t.prototype.render=function(){var t=this.noteView;this.renderCallCounter?(this.renderCallCounter++,b.error("The PcEditor - render() should be called only once: "+this.renderCallCounter)):this.renderCallCounter=1,t&&(this.initNoteViewWrapper(),$(this.noteViewFrame).append(t.$el),$(this.noteViewWrapper).append(this.linkView.$el),this.setViewMode(this.editorProps.viewMode,!0,!1),t.setOptions({pageType:this.editorProps.pageType}),t.render(),$(this.noteViewWrapper).append(this.imgTitleInput.$el),this.isCollabEnabled()&&!1===this.noteProps.hideAttendeeHint?this.toggleAttendeeHint(!0):this.toggleAttendeeHint(!1),e.prototype.render.call(this))},t.prototype.reset=function(){var t=this.defaultFontName,n=this.defaultFontSize;e.prototype.reset.call(this),this.getController().setDefaultFont(t,n),this.scrolledWhenLoading=!1,this.toolbar&&this.toolbar.isRendered&&(this.toolbar.reset(),this.toolbar.show()),this.colorpicker&&this.colorpicker.reset(),this._clearScrollTimeout(),this._toggleAttendees(!1),this.setIdleTimeout(!1),this.progressTracker.stop()},t.prototype.rotateSaveSyncIcon=function(e){this.toolbar.rotateSaveSyncIcon(e)},t.prototype.setCaretPosition=function(e,t){var n,o=document.caretRangeFromPoint(e,t);return!!o&&(!!(n=g.fromNativeRange(o,this.noteView))&&(this.setNoteRange(n),!0))},t.prototype.setDefaultFont=function(e,t){var n=c.getFontFirstValue(e),o=d.getAsArray();n&&(this.defaultFontName=n),o.indexOf(t)>-1&&(this.defaultFontSize=t),this.note&&this.note.isEmptyContent()&&this.useDefaultFontAsEditingStyle()},t.prototype.setHtmlContent=function(e,t,n,o){b.log("setHtmlContent"),this._setContent(!1,e,t,n,o),this.isLegacyHost()&&this.trigger("yne-content-change")},t.prototype.setIdleTimeout=function(t){e.prototype.setIdleTimeout.call(this,t),t&&this.toggleAttendeeHint(!1)},t.prototype.setScrollPercentWithDelay=function(e,t){var n=this;t=t||50,n._clearScrollTimeout(),n.scrollTimeout=window.setTimeout(function(){n._setScrollPercent(e)},t)},t.prototype.setStyles=function(e){this.noteView.$el.css(e)},t.prototype.setXmlContent=function(e,t,n,o){this._setContent(!0,e,t,n,o)},t.prototype.setZoomPercent=function(e,t){this._getPresenter().isPresenting()?e>0?this._getPresenter().zoomIn():this._getPresenter().zoomOut():t?this.zoomEditor(e/100,!0):e>0?this._zoomInEditor():this._zoomOutEditor()},t.prototype.showSaveSyncButton=function(e){this.toolbar.showSaveSyncButton(!0===e)},t.prototype.showToolbar=function(){this.toolbar&&this.toolbar.isRendered&&this.toolbar.show()},t.prototype.toggleAttendeeHint=function(e){e?this.$attendeesHintDiv.show():this.$attendeesHintDiv.hide()},t.prototype.toggleStats=function(e){var t;t=b.DEBUG?"http://test."+E.getNamespace()+"/editor/collab/pcCollabStats_debug.html":"https://"+E.getNamespace()+"/editor/collab/pcCollabStats.html",e?this.$statsIFrame.attr("src",t):this.$statsIFrame.attr("src","")},t.prototype.toggleToolbar=function(e){this.toolbar.toggleToolbar(e),this.updateNoteViewWrapperSize()},t.prototype.updateAttendees=function(e){var t,n,o=[],i="";v.each(e,function(e){m.parseToBoolean(e.readOnly,!1)||((t={}).SID=e.sessionId,t.portrait=e.portraitUrl,t.color=e.lockColor,t.nickname=e.nickname,o.push(t))}),n=v.size(o),this.$attendeesHintDiv.find("#attend-num-span").html(n),n>0&&(i=u.render("pc","float-modifiers-li",{allAttendees:o})),this.$attendeesHintDiv.find("#attendee-list").html(i)},t.prototype.updateFormatPainterCursorUI=function(e){this.noteView.updateFormatPainterCursorUI(e)},t.prototype.updateShortCut=function(e,t){this.controller.updateShortCut.apply(this.controller,[e,t])},t.prototype.updateNoteViewWrapperSize=function(){var e,t;this.toolbar&&this.noteViewWrapper&&(e=$(window).height(),t=this.toolbar.$el.outerHeight(),$(this.noteViewWrapper).outerHeight(e-t))},t.prototype.updateResMapWithKey=function(e,t,n){this.note.setExtraInfoWithKey("pcResMap",e,t,n)},t.prototype.useDefaultFontAsEditingStyle=function(){this.controller.setDefaultFont(this.defaultFontName,this.defaultFontSize)},t.prototype.zoomEditor=function(e,t){v.isNumber(e)&&(this._getEditArea().css("zoom",e),this.imgTitleInput.setZoom(e),this.linkView.setZoom(e),t&&this.trigger("yne-editing-zoom-change",e),this.trigger("yne-zoom-changed",100*e),this.noteView.trigger("resize",e),this._showZoomHint(100*e+"%"))},t.prototype.bindEventsForController=function(){var t=this,n=t.controller;n?(e.prototype.bindEventsForController.call(this),f.bubble(["contextmenu","yne-click","yne-download-attachment","yne-download-image","yne-get-entity","yne-editing-state-change","yne-request-image-rendered-src","yne-on-paste","yne-open-attachment","yne-open-image","yne-open-link","yne-replace-attachment","yne-replace-image","yne-save-content","yne-selection-change","yne-show-words","yne-image-ocr","yne-scroll-in-content-loading"],n,t),f.bubble({find:"yne-find"},n,t),n.on("ytable-key-esc",function(){t.isFullScreen()&&t.trigger("yne-exit-full-screen")})):b.warn("no controller!")},t.prototype.initialize=function(t){this.editorProps=v.extend({},t),this.parentEl=this.editorProps.parentEl,$(this.parentEl).html(""),v.bindAll(this,"_onWinResize"),this.note=l.createBlank(!0),this.noteView=new S({editor:this,inlineStyleViewMapper:A,note:this.note}),this.linkView=new I({editor:this}),this.imgTitleInput=new _({editor:this}),this.controller=new N({editor:this,imgTitleInput:this.imgTitleInput,note:this.note,noteView:this.noteView}),this._initToolbar(),this._initContextMenu(),this._bindEventsForDoc(),this._bindEventsForThis(),this._initZoomHint(),this._initAttendeesHint(),e.prototype.initialize.call(this,t),this.colorpicker=new y({editor:this}),$(this.parentEl).append(this.colorpicker.$el),f.bubble(["color-picker-show"],this,this.colorpicker),this.$statsIFrame=$('<iframe id="iframe_stats" style="display:none"></iframe>'),this.$statsIFrame.appendTo("html")},t.prototype.updateContainerBackground=function(e){var t=this.noteView.$el.parent(),o=t.css("background-image");return!(this.currentBackground===e&&o.indexOf(e)>0)&&(e&&e!==n.DEFAULT_BACKGROUND?(t.css("background-image",'url("'+e+'")'),this.currentBackground=e):(t.css("background-image",""),this.currentBackground=n.DEFAULT_BACKGROUND),!0)},t.prototype.makeReadOnly=function(t){e.prototype.makeReadOnly.call(this,t),this.updateNoteViewWrapperSize()},t.prototype.updateContentSetProgress=function(t){e.prototype.updateContentSetProgress.call(this,t),v.isNumber(t.percent)&&t.percent>=1&&(this.isCollabEnabled()||this.trigger("yne-content-set",this.note.getNoteId(),this.note.getAllResourceInfo(null,[s.IMAGE])),this.focusEditor())},t.prototype._bindEventsForDoc=function(){var e,t,n=this;$(window).on("resize",n._onWinResize),$(document.body).on("contextmenu",function(e){e.preventDefault()}).on("keydown",function(e){n.isFullScreen()&&e&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&h.isMatch("esc",e.keyCode)&&n.trigger("yne-exit-full-screen")}),t=window.devicePixelRatio,e=function(){var o=!1;t!==window.devicePixelRatio&&(o=!0,t=window.devicePixelRatio),o&&n._onWinResize(),setTimeout(e,500)},setTimeout(e,500)},t.prototype._bindEventsForThis=function(){var e=this;e.on("yne-exit-full-screen",function(){e.exitFullScreen()})},t.prototype._clearScrollTimeout=function(){this.scrollTimeout&&(window.clearTimeout(this.scrollTimeout),this.scrollTimeout=null)},t.prototype._firstNotEmptyTextBlockIndex=function(){var e,t,n=this.note.blocks,o=n.length,i=-1;for(e=0;e<o;e++)if(t=n[e],s.isTextOrTableBlock(t)&&!t.isEmptyContent()){i=e;break}return i},t.prototype._getEditArea=function(){return $(this.noteViewFrame)},t.prototype._getPresenter=function(){var e=this;return e.presenter||($('<div id="presenter"></div>').appendTo("html"),e.presenter=new C({el:"#presenter"}),e.presenter.on("exit",function(){e.trigger("yne-exit-presentation")}),e.presenter.on("open-link",function(t){e.trigger("yne-open-link",t)}),e.presenter.on("open-attachment",function(t,n){e.trigger("yne-open-attachment",t,n)})),e.presenter},t.prototype._getZoomHintDiv=function(){return this.$zoomHintDiv||(this.$zoomHintDiv=$("#ycm-zoomHint")),this.$zoomHintDiv},t.prototype._initZoomHint=function(){$('<div id="ycm-zoomHint" class="yne-zoom-hint">100%</div>').appendTo(document.body)},t.prototype._initAttendeesHint=function(){var e=this,t=u.render("pc","float-modifiers",{});e.$attendeesHintDiv=$(t),e.$attendeesHintDiv.appendTo(document.body),e.attendeeHintDivDefaultStyle={},e.attendeeHintDivDefaultStyle.top=e.$attendeesHintDiv.css("top"),e.attendeeHintDivDefaultStyle.right=e.$attendeesHintDiv.css("right"),e.$attendeesHintDiv.find("#attendee-hint").on("click",function(){e._toggleAttendees()}),e.$attendeesHintDiv.mouseleave(function(){e.attendeeListCloser=window.setTimeout(function(){e._toggleAttendees(!1),e.isZoomHintShown=!1},2e3)}),e.$attendeesHintDiv.mouseenter(function(){window.clearTimeout(e.attendeeListCloser)}),e.toolbar.on("tab-toggled",function(t){t?e.$attendeesHintDiv.css("visibility","visible"):e.$attendeesHintDiv.css("visibility","hidden")})},t.prototype._initToolbar=function(){var e=this;e.toolbar=new w({editor:e,parentEl:e.parentEl}),e.toolbar.on("resize",function(){e._onWinResize()})},t.prototype._initContextMenu=function(){var e,t=this,n=[];t.contextMenu||(e=t.contextMenu=new o({editor:t}),v.each(k,function(e){var t=e();v.isArray(t)?n=n.concat(t):n.push(t)}),e.addItems(n),t.on("contextmenu",function(n){var o=i(t,n);e.onContextMenu(n,o)}))},t.prototype._onWinResize=function(){b.log("_onWinResize"),this.updateNoteViewWrapperSize(),this.noteView&&this.noteView.trigger("resize")},t.prototype._setContent=function(e,t,n,o,i){var r=this,a=!0===o.isAsync,s=function(e){e.isAsync=a,r.updateContentSetProgress(e),e.percent>=1&&(r.makeReadOnly(!!r.noteProps.isReadOnly),null!=i&&i({resultCode:1}))};r.reset(),r.contentLoading=!0,r.updateContentSetProgress({percent:0,message:"加载中",isAsync:a}),r.noteProps=null==o?r.options||{}:o,r.resMap=n||{},r.note.setExtraInfo({pcResMap:r.resMap,pcTodoMap:r.noteProps.todoContents}),r.controller.setOptions({note:r.note}),r.noteView.setOptions({disableOCR:r.noteProps.disableOCR,isNoteSet:!0,note:r.note,pageType:r.editorProps.pageType}),r.setViewMode(r.editorProps.viewMode,!0,!1),r.setReadOnly(r.noteProps.isReadOnly),r.setCopyProhibited(r.noteProps.isCopyProhibited),r.setDragProhibited(r.noteProps.isDragProhibited),r.setBackground(r.noteProps.bgImageId),r.useDefaultFontAsEditingStyle(),r.noteProps.isReadOnly||!r.isLegacyHost()&&!r.isCollabEnabled()||r.makeReadOnly(!0),r.noteView.render(),r.updateContentSetProgress({percent:.05,isAsync:a}),e?l.fromXml(t,r.note,null,{isAsync:a,progressCallBack:s}):o.isOCR?(l.fromOCR(t,r.note,{type:o.ocrType,parseParagraph:o.ocrParseParagraph,parseIndent:o.ocrParseIndent}),s({percent:1})):null==l.fromHtml(t,r.note,null,{progressCallBack:s,isAsync:a})&&(l.createBlank(!0,r.note),s({percent:1})),r.notSetContent=!1},t.prototype._setScrollPercent=function(e){var t,n,o=this.noteViewWrapper;this.scrolledWhenLoading||this.contentChanged||(e=e||0,n=o.scrollHeight,t=Math.round(e*n),$(o).scrollTop(t))},t.prototype._showZoomHint=function(e){var t=this;t.isZoomHintShown?t.zoomHintCloser&&window.clearTimeout(t.zoomHintCloser):(t._getZoomHintDiv().show("slow"),t.isZoomHintShown=!0),t.zoomHintCloser=window.setTimeout(function(){t._getZoomHintDiv().hide("slow"),t.isZoomHintShown=!1},2e3),t._getZoomHintDiv().text(e)},t.prototype._toggleAttendees=function(e){var t;void 0===e&&(e=!0),t=this.$attendeesHintDiv.find("#attendee-list"),!0===e?t.css("display","inline-block"):!1===e?t.css("display","none"):t.slideToggle(10,function(){t.is(":visible")&&t.css("display","inline-block")})},t.prototype._zoomInEditor=function(){var e,t=this._getEditArea();if(e=Number(t.css("zoom")),v.isNumber(e)){if(e>=3)return}else e=1;(e+=.25)>3&&(e=3),this.zoomEditor(e,!0)},t.prototype._zoomOutEditor=function(){var e,t=this._getEditArea();e=Number(t.css("zoom")),!v.isNumber(e)||e<=1||((e-=.25)<1&&(e=1),this.zoomEditor(e,!0))},t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(16),n(1),n(10)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.filterItems=function(e){var o=!1,i=[];return n.each(e,function(e){var a=e;switch(e&&e.simplify&&(a=e.simplify()),a.type){case r.TYPE.SPLIT:o||(o=!0,i.push(a));break;case r.TYPE.SUBMENU:a.isHidden||(o=!1,a=n.extend({},a,{items:t.filterItems(a.items)}),i.push(a));break;default:a.isHidden||(o=!1,i.push(a))}}),i},t.prototype.addItems=function(e){this.items=this.items.concat(e),n.each(e,this.prepareItem.bind(this))},t.prototype.onContextMenu=function(e,o){var i,r=this,a={left:e.pageX,top:e.pageY};r.resetAll(),n.invoke(r.items,"checkStatus",e,o||{}),i=t.filterItems(r.items),r.editor.trigger("yne-context-menu",a,i,function(e){r.select(e),r.resetAll()})},t.prototype.prepareItem=function(e){var t=e.keyHandlerName;e.index=this.indexArray.length,e.editor=this.editor,t&&!this.editor.getController().hasKeyHandler(t)&&i.error("The keyHandlerName ["+t+"] of ContextMenuItem ["+e.name+"] does not exist!"),this.indexArray.push(e),e.type===r.TYPE.SUBMENU&&n.each(e.items,this.prepareItem.bind(this))},t.prototype.resetAll=function(){var e;n.map(this.items,function(t){if((e=t.reset)&&n.isFunction(e))return e.apply(t)})},t.prototype.select=function(e){var t=this.indexArray[e];if(t&&!t.items&&t.select)return t.select()},t.prototype.initialize=function(e){this.editor=e.editor,this.items=[],this.indexArray=[]},t}(o)}.apply(t,o))||(e.exports=i)},,function(e,t,n){var o;void 0===(o=function(e){var t=n(2),o=n(0),i=n(34),r=n(5),a=n(17),s=n(41),l={imageBlock:function(e,n,o){var i,r=e.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,t.isImage(i)&&(o.imgBlock=i,o.isImgAttachBlock=!0))},attachmentBlock:function(e,n,o){var i,r=e.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,t.isAttachment(i)&&(o.attachmentBlock=i,o.isImgAttachBlock=!0))},codeBlock:function(e,n,o){var i,r=e.getNoteRange();r&&r.isInSingleBlock()&&(i=r.getStartBlockRange().block,t.isCode(i)&&(o.codeBlock=i,o.isCodeBlock=!0))},tableBlock:function(e,n,i){var r,a,l,c,d=e.getNoteRange();if(d&&d.isInSingleBlock()&&(c=(a=d.getStartBlockRange()).block,t.isTable(c))){if(!(l=a.getAsRectRange()))return;r={},l.onlyMergePointAndCell()&&(r.onlyMergePointAndCell=!0),l.isOnlyImgCell()&&o.extend(r,{cell:l.getFirstCell().cell,type:s.IMAGE}),l.isOnlyAttachCell()&&o.extend(r,{cell:l.getFirstCell().cell,type:s.ATTACHMENT}),i.tableInfo=r}},hrefInfo:function(e,t,n){var o,s,l,c,d,u,h,p,g=t.target;r(g).is(".block-view a *")&&(o=function(e,t){if(e&&e.parentNode)for(var n=e.parentNode;n;){if(n.webkitMatchesSelector&&n.webkitMatchesSelector(t))return n;n=n.parentNode}}(g,"a"))&&((s=document.createRange()).selectNodeContents(o),l=a.fromNativeRange(s,e.noteView),s.detach(),l&&l.isInSingleBlock()&&((d=(c=l.getStartBlockRange()).block)&&d.getCommonInlineStyle&&(u=d.getCommonInlineStyle("href",c)),u&&((h=function(e,t){return e=r.trim(e||""),t=r.trim(t||""),!(!e||!t)&&(e===t||i.startsWith(t,e)||i.endsWith(t,e)||i.startsWith(e,t)||i.endsWith(e,t))}(u,c.getDataAsPlain()))&&(p=d.getCommonInlineStyles(c)),n.hrefInfo={noteRange:l,href:u,hrefAsLinkText:h,commonStyles:p})))},isRangeCollapsed:function(e,t,n){var o=e.getNoteRange();o&&(n.isRangeCollapsed=o.isCollapsed())}};return function(e){var t={};return o.each(l,function(n){n(e,event,t)}),t}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(16),n(1),n(30)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e,n,o){if(n&&e)return new t({filter:o,note:n,noteRange:e});i.error("Failed to create NoteRangeWalker, unvalid parameters",e,n,o)},t.prototype.current=function(){return this.walkerProps.blockRanges[this.walkerProps.blockRangeIndex]},t.prototype.first=function(){return this.walkerProps.blockRangeIndex=0,this._getAtIndex(this.walkerProps.blockRangeIndex)},t.prototype.last=function(){if(this._getAtIndex(this.walkerProps.endIndex),this.walkerProps.blockRangeIndex=this.walkerProps.blockRanges.length-1,-1!==this.walkerProps.blockRangeIndex)return this.walkerProps.blockRanges[this.walkerProps.blockRangeIndex]},t.prototype.next=function(){return this.walkerProps.blockRangeIndex++,this._getAtIndex(this.walkerProps.blockRangeIndex)},t.prototype.previous=function(){return this.walkerProps.blockRangeIndex--,this._getAtIndex(this.walkerProps.blockRangeIndex)},t.prototype.reset=function(){this.walkerProps.blockRangeIndex=-1},t.prototype.initialize=function(e){var t,o;e=n.defaults(e||{},{filter:function(){return!0},note:null,noteRange:null}),this.walkerProps=e,t=this.walkerProps.note=e.note,o=this.walkerProps.noteRange=e.noteRange,this.walkerProps.filter=e.filter,this.walkerProps.startRange=o.getStartBlockRange(),this.walkerProps.endRange=o.getEndBlockRange(),this.walkerProps.startIndex=t.getBlockIndex(this.walkerProps.startRange.block),this.walkerProps.endIndex=t.getBlockIndex(this.walkerProps.endRange.block),this.walkerProps.blockIndex=this.walkerProps.startIndex-1,this.walkerProps.blockRanges=[],this.walkerProps.blockRangeIndex=-1},t.prototype._getAtIndex=function(e){var t,n,o,i;if(o=this.walkerProps.blockRanges[e])return o.clone(!0);if(!this._hasWalked()){for(i=this.walkerProps.blockIndex+1;i<=this.walkerProps.endIndex&&(this.walkerProps.blockIndex=i,this.walkerProps.startIndex!==this.walkerProps.endIndex?i===this.walkerProps.startIndex?(t=this.walkerProps.startRange.clone(!0)).extendToBlockEnd():i===this.walkerProps.endIndex?(t=this.walkerProps.endRange.clone(!0)).extendToBlockStart():(n=this.walkerProps.note.getBlockAt(i),t=r.createRangeByBlock({allContent:!0,block:n})):t=this.walkerProps.startRange.clone(!0),!(!0===this.walkerProps.filter(t)&&(this.walkerProps.blockRanges.push(t),o=this.walkerProps.blockRanges[e])));i++);return o}},t.prototype._hasWalked=function(){return this.walkerProps.blockIndex>=this.walkerProps.endIndex},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(55),n(166),n(16),n(1)],void 0===(i=function(e,t,n,o,i,r,s){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.create=function(e){if(!(!e||!e.table||null==e.left||null==e.top||!e.width||!e.height||e.left<0||e.top<0||e.width<1||e.height<1))return new t(e);s.error("Failed to create RectRange",e)},t.prototype.clone=function(){var e=this.getRect();return t.create(e)},t.prototype.equals=function(e){var t=e.getRect();return this.props.table===e.getTable()&&this.props.height===t.height&&this.props.left===t.left&&this.props.top===t.top&&this.props.width===t.width},t.prototype.forEach=function(e,t){var n=this;n.forEachRow(function(o){return n.forEachColumn(function(t){return e(o,t)},t)},t)},t.prototype.forEachCell=function(e,t){var n=this,o={};n.forEach(function(t,i){var r,a=n.props.table.getCell(t,i,{findMergePointIfNeeded:!0,withPosition:!0});if(a&&(r=a.row+"-"+a.col,!0!==o[r]))return o[r]=!0,e(a.cell,a.row,a.col)},t)},t.prototype.forEachRow=function(e,t){var n;for(n=0;n<this.props.height;n++)if(!1===e(t?this.props.top+this.props.height-n:this.props.top+n))return!1},t.prototype.forEachColumn=function(e,t){var n;for(n=0;n<this.props.width;n++)if(!1===e(t?this.props.left+this.props.width-n:this.props.left+n))return!1},t.prototype.getDataAsHtml=function(){return this._getAsNewTable().toHtml()},t.prototype.getDataAsJSON=function(e){return this._getAsNewTable().toJSON(e)},t.prototype.getDataAsPlain=function(){return this._getAsNewTable().toPlain({returnString:!0})},t.prototype.getFirstCell=function(){return this.props.table.getCell(this.props.top,this.props.left,{findMergePointIfNeeded:!0,withPosition:!0})},t.prototype.getFirstCellRect=function(){return{col:this.props.left,row:this.props.top}},t.prototype.getLastCell=function(){return this.props.table.getCell(this.props.top+this.props.height-1,this.props.left+this.props.width-1,{findMergePointIfNeeded:!0,withPosition:!0})},t.prototype.getRect=function(){var e={};return e.height=this.props.height,e.left=this.props.left,e.top=this.props.top,e.width=this.props.width,e},t.prototype.getTable=function(){return this.props.table},t.prototype.isMerge=function(){},t.prototype.isOnlyAttachCell=function(){var e,t;return!(!(e=this.props.table.getCell(this.props.top,this.props.left))||!e.isAttachmentCell())&&(e.isMergePoint()?(t=e.getMergePointAttr()).width===this.props.width&&t.height===this.props.height:1===this.props.width&&1===this.props.height)},t.prototype.isOnlyImgCell=function(){var e,t;return!(!(e=this.props.table.getCell(this.props.top,this.props.left))||!e.isImageCell())&&(e.isMergePoint()?(t=e.getMergePointAttr()).width===this.props.width&&t.height===this.props.height:1===this.props.width&&1===this.props.height)},t.prototype.onlyOneCell=function(){return 1===this.props.width&&1===this.props.height},t.prototype.overlaps=function(){},t.prototype.onlyMergePointAndCell=function(){var e,t;return!!(e=this.props.table.getCell(this.props.top,this.props.left)).isMergePoint()&&(t=e.getMergePointAttr(),this.props.width===t.width&&this.props.height===t.height)},t.prototype.toJSON=function(){return this.getRect()},t.prototype.toString=function(){var e={};return e.height=this.props.height,e.left=this.props.left,e.top=this.props.top,e.width=this.props.width,"RectRange("+n.map(e,function(e,t){return t+":"+e}).join(",")+")"},t.prototype.initialize=function(e){e=e||{},this.props=this.props||{},this.props.table=e.table,this._setRect(e),this._checkBoundary(),this._fixMerge()},t.prototype._checkBoundary=function(){var e=this.props.table,t=e.getColumnCount(),n=e.getRowCount();this.props.left<0?this.props.left=0:this.props.left>=t&&(this.props.left=t-1),this.props.top<0?this.props.top=0:this.props.top>=n&&(this.props.top=n-1),this.props.width<1&&(this.props.width=1),this.props.left+this.props.width>t&&(this.props.width=t-this.props.left),this.props.height<1&&(this.props.height=1),this.props.top+this.props.height>n&&(this.props.height=n-this.props.top)},t.prototype._fixMerge=function(){this._walkToFixMergeCells({})},t.prototype._getAsNewTable=function(){var e,t,n,i,r,a=this.props.table,s=[],l=[],c=[],d=this.props.top;for(d=0;d<this.props.height;d++)for(i=[],s.push(i),t=this.props.top+d,l.push(a.getRowHeight(t)),e=0;e<this.props.width;e++)n=this.props.left+e,0===d&&c.push(a.getColumnWidth(n)),i.push(a.getCell(t,n));return(r=new o({colWidths:c,rowHeights:l,tableCells:s})).setBlockStyles(a.getBlockStyles()),r},t.prototype._markAsWalked=function(e,t){var n,o;for(n=0;n<e.width;n++)for(o=0;o<e.height;o++)t[this._makeMarkKey(e.top+o,e.left+n)]=!0},t.prototype._makeMarkKey=function(e,t){return e+","+t},t.prototype._setRect=function(e){this.props=this.props||{},this.props.height=e.height,this.props.left=e.left,this.props.top=e.top,this.props.width=e.width},t.prototype._shouldExtend=function(e,t,n){var o,r,a,l,c=this.props.table;return(!n||!n[this._makeMarkKey(e,t)])&&((a=c.getCell(e,t,{findMergePointIfNeeded:!0,withPosition:!0}))&&a.cell?(o=(l=a.cell).isMergePoint()?{height:(r=l.getMergePointAttr()).height,left:a.col,top:a.row,width:r.width}:{height:1,left:t,top:e,width:1},this._markAsWalked(o,n),!i.contains(this.props,o)&&i.union(this.props,o)):(s.warn("no table cell at row/col",e,t),!1))},t.prototype._walkToFixMergeCells=function(e){var t=this,n=function(n){var o,i,r=n?t.props.top:t.props.top+t.props.height-1;for(i=0;i<t.props.width;i++)if(o=t._shouldExtend(r,t.props.left+i,e))return o},o=function(n){var o,i,r=n?t.props.left:t.props.left+t.props.width-1;for(i=1;i<t.props.height;i++)if(o=t._shouldExtend(t.props.top+i,r,e))return o},i=n(!0)||n(!1)||o(!0)||o(!1);i&&(t._setRect(i),t._walkToFixMergeCells(e))},t}(r)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),s=this&&this.__assign||Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};o=[n,t,n(0),n(299),n(85),n(6),n(2),n(30),n(126),n(17),n(86),n(35),n(9),n(95),n(1),n(314)],void 0===(i=function(e,t,n,o,i,r,l,c,d,u,h,p,g,f,m,y){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.isSessionInitDone=!1,t}return a(t,e),t.prototype.buildCollabProperties=function(){var e={};return null!=this.collabEngine?e=this.collabEngine.buildCollabProperties(null):e.coreEditor=this,e.isCollabEnabled=this.isCollabEnabled(),e},t.prototype.buildCollabSession=function(e,t){var n=this,o=e.collabServer,i=e.userInfo;null!=this.collabEngine&&(this.collabEngine.closeCollabSession(null,null),this.collabEngine=null),this._initCollabEngine(),e.collabServer=o.address,e.useWSS=!!o.useWSS,e.nickname=i.nickname,e.userId=i.userId,e.portraitUrl=i.portraitUrl,this.collabEngine.buildCollabSession(e,function(e){1===e.resultCode&&n.trigger("yne-session-built",e.isCollabStarted),t(e)})},t.prototype.canRemoveFormat=function(){throw new Error("should be overridden.")},t.prototype.closeCollabSession=function(e,t){null!=this.collabEngine&&this.collabEngine.closeCollabSession(e,t),this.collabEngine=null},t.prototype.getCollabId=function(){if(null!=this.collabEngine)return this.collabEngine.getCollabId()},t.prototype.getLastNotOwnExecCmd=function(){if(null!=this.collabEngine)return this.collabEngine.getLastNotOwnExecCmd()},t.prototype.getModifiers=function(e,t){return null!=this.collabEngine?this.collabEngine.getModifiers(e,t):{status:r.ERRORID_COLLAB_ENGINE_NULL}},t.prototype.getCollabContent=function(e,t){var n={status:0,resultCode:0},o=this;return null!=this.collabEngine?(t&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.isContentLoading()?this.getCollabContentTimer=setTimeout(function(){o.getCollabContent(e,!1)},1e3):(n=this.collabEngine.getCollabContent(e)).status=n.resultCode,n):{status:r.ERRORID_COLLAB_ENGINE_NULL}},t.prototype.hasCachedDataCmd=function(){return null!=this.collabEngine&&this.collabEngine.hasCachedDataCmd()},t.prototype.isLastOwnDataCmdExecuted=function(){if(null!=this.collabEngine)return this.collabEngine.isLastOwnDataCmdExecuted()},t.prototype.isValidLocalDataCmd=function(e){if(null!=this.collabEngine)return this.collabEngine.isValidLocalDataCmd(e)},t.prototype.noteSetNotification=function(){var e=this;null!=this.collabEngine&&this.collabEngine.sendContentSetInfo(this.note.getFileVersion(),function(t){t.result===r.CJSON_INITIALIZE_DONE&&(e.isSessionInitDone=!0),e.trigger("yne-session-initialized",t.result,t)})},t.prototype.pushLocalDataCommand=function(e,t){null!=this.collabEngine&&this.collabEngine.pushLocalDataCommand(e,t)},t.prototype.saveNotification=function(e,t){null!=this.collabEngine&&this.collabEngine.saveNotification(e,t)},t.prototype.sendBlockLockInfo=function(e){null!=this.collabEngine&&this.collabEngine.sendOwnLockInfo(e)},t.prototype.sendCachedDataCommand=function(){null!=this.collabEngine&&this.collabEngine.sendCachedDataCmd(!1)},t.prototype.updateUserInfo=function(e){var t=this.getEditorProps();null!=e&&(n.extend(t.userInfo,e),null!=this.collabEngine&&this.collabEngine.updateSessionInfos(e))},t.prototype.applyCollabCmdRedoUndo=function(e){this.controller.cmdManager.applyCollabCmdRedoUndo(e)},t.prototype.buildNoteRangeFromJSON=function(e){return h.buildNoteRangeFromJSON(e,this)},t.prototype.createDataCommand=function(e,t){return this.controller.createCmd(e,t)},t.prototype.dropRedoCmd=function(){this.controller.cmdManager.dropRedoCmd()},t.prototype.dropUndoCmds=function(e,t,n){this.controller.cmdManager.dropUndoCmds(e,t,n)},t.prototype.getClientId=function(){return this.clientId},t.prototype.getDefaultNoteRange=function(){return this.controller.defaultNoteRange()},t.prototype.getInnerBlocksWithEdge=function(e){var t,n,o;return e&&d.isHeaderFooterRange(e.getStartBlockRange())?[e.getStartBlockRange().block]:(u.isNoteRange(e)&&(t=e.getStartBlockRange().block,n=e.getEndBlockRange().block,o=this.note.getInterBlocks(t,n,!0)),o)},t.prototype.getNextBlockById=function(e){var t=null,n=this.getBlockById(e);return n&&(t=this.note.getNextBlock(n)),t},t.prototype.getNoteVersion=function(){return this.note?this.note.getFileVersion():null},t.prototype.getPreBlockById=function(e){var t=null,n=this.getBlockById(e);return n&&(t=this.note.getPreBlock(n)),t},t.prototype.isListItem=function(e){return l.isListItem(e)},t.prototype.isNoteValidForCollab=function(){return this.controller.note.isValidForCollab()},t.prototype.isReadyForEdit=function(){return!0===this.isSessionInitDone},t.prototype.isContentLoading=function(){return!0===this.contentLoading},t.prototype.isTable=function(e){return l.isTable(e)},t.prototype.isTodo=function(e){return l.isTodo(e)},t.prototype.reset=function(){null!=this.getCollabContentTimer&&clearTimeout(this.getCollabContentTimer),e.prototype.reset.call(this)},t.prototype.setNoteVersion=function(e){m.log("SetNoteVersion:"+e),this.note.setFileVersion(e),this.trigger("yne-note-version-change",e)},t.prototype.buildBlockRangeFromJSON=function(e){var t,n;if(e&&e.blockId){if(t=e.blockId,n=this.getBlockById(t))return e.rangeType===l.CODE?c.createRangeByBlock(s({block:n},e)):c.createRangeByBlock({block:n,end:e.endPosition,rect:e.simpleValue1,start:e.startPosition,type:e.simpleValue2});m.log("block is NOT existing:",e)}else m.error("The blockRangeJSON.blockId is not valid!")},t.prototype.buildInnerCommandFromJSON=function(e,t){var o=e[r.CJSON_ACTION],i={};return i.collabProperties=n.clone(t.collabProperties),i.collabProperties.cmdJSON=e,this.createDataCommand(o,i)},t.prototype.getBlockById=function(e){return this.note.getBlockById(e)},t.prototype.getEditorProps=function(){return this.editorProps},t.prototype.getNoteProps=function(){return this.noteProps},t.prototype.getNote=function(){return this.note},t.prototype.isCollabEnabled=function(){return!(null==this.noteProps||!this.noteProps.isCollabEnabled)},t.prototype.isIdleTimeout=function(){return this.idleTimeout},t.prototype.isMyOwnLockedBlock=function(e){var t,n=!1,o=this._getMyOwnBlockId();return null!=e&&null!=o&&""!==o&&(u.isNoteRange(e)&&e.isInSingleBlock()?t=e.getStartBlockRange().getBlockId():c.isBlockRange(e)&&(t=e.getBlockId()),t&&t===o&&!this.isTable(this.getBlockById(t))&&(n=!0)),n},t.prototype.render=function(){e.prototype.render.call(this),this.isCollabEnabled()||this.updateNoteViewVisibility(!0)},t.prototype.setIdleTimeout=function(e){e&&(this.noteView.render(),this.setReadOnly(!0)),this.idleTimeout=e},t.prototype.updateEditorOptions=function(e){if(this.options||(this.options=e?n.clone(e):{}),e)for(var t in e)e.hasOwnProperty(t)&&("shareKey"===t&&this.options[t]!==e[t]&&(this.idleTimeout=!1),this.options[t]=e[t]);this.options.isCollabEnabled=f.parseToBoolean(this.options.isCollabEnabled,!0),this.options.isCollabEnabled||(this.idleTimeout=!1),this.options.hideAttendeeHint=f.parseToBoolean(this.options.hideAttendeeHint,!1),this.options.disableBackground=f.parseToBoolean(this.options.disableBackground,!1),this.options.useWSS=f.parseToBoolean(this.options.useWSS,!1),this.options.pageType=f.parseToPageType(this.options.pageType),this.options.sessionId||(this.options.sessionId=this.clientId),this.options.readOnly=f.parseToBoolean(this.options.readOnly,!1),this.options.hasOriginFile=f.parseToBoolean(this.options.hasOriginFile,!1),n.extend(this.editorProps,this.options)},t.prototype.notifyErrorToHost=function(e){this.trigger("yne-useraction-failed",e)},t.prototype.onDocSelectionChange=function(){m.log("onDocSelectionChange")},t.prototype.recoverFromIdleTimeout=function(){var e;this.idleTimeout&&this.isCollabEnabled()&&(e={code:0,customCode:8e3,shareKey:this.getCollabId()},this.trigger("yne-session-closed",e))},t.prototype.testSendMsgToCollabServer=function(e){null!=this.collabEngine&&this.collabEngine.sendMessageToCollabServer(e)},t.prototype.bindEventsForController=function(){var e=this,t=this.controller;t.on("command-exec",function(t,n){t&&t.name?e.isCollabEnabled()?((n=n||{}).collabProperties=n.collabProperties||{},n.collabProperties.finalNoteVersion&&e.setNoteVersion(n.collabProperties.finalNoteVersion),t&&t.effected&&(!n.collabProperties.isCollabCmd||n.collabProperties.isCollabCmd&&n.collabProperties.isOwnCmd&&!n.collabProperties.isLocalExecutedCmd)&&(e.contentChanged=!0,e.trigger("yne-content-change"))):t&&t.effected?(e.contentChanged=!0,e.trigger("yne-content-change")):m.warn("The command has no effected",t):m.error("The command is not valid",t)}),p.bubble(["redo-stack-change","undo-stack-change","selectstart","mouse-down","command-exec","esc","yne-clipboard-status","yne-clipboard-error","yne-get-clipboard","yne-clipboard-set","color-picker-show","yne-user-action-collection","cell-edit-view-enter","cell-edit-view-exit","cell-edit-view-history-change"],t,this)},t.prototype._getMyOwnBlockId=function(){var e=this.collabEngine.getMyOwnBlockIds();return null!=e&&e.length>0?e[0]:null},t.prototype._initCollabEngine=function(){var e=this;e.idleTimeout=!1,e.isSessionInitDone=!1,e.collabEngine=new o.default(e,n,m),e.collabEngine.on(i.default.WS_CLOSED,function(t){8e3===t.customCode&&g.IS_PC?e.setIdleTimeout(!0):e.trigger("yne-session-closed",t)}),e.collabEngine.on(i.default.DATACMD_FAILURE,function(t){e.trigger("yne-useraction-failed",t.message)}),e.collabEngine.on(i.default.DATACMD_SUCCESS,function(t){e.trigger("yne-datacommand-success",t.rawCollabJSON)}),e.collabEngine.on(i.default.LOCK_LOCKED,function(t){var n,o=t.sessionProps;null!=o&&null!=o.lockedBlkIds&&o.lockedBlkIds.length>0&&(n=o.lockedBlkIds[0],e._lockBlock(n,o))}),e.collabEngine.on(i.default.LOCK_RELEASED,function(t){e._unlockBlock(t.unlockedBlockId)}),e.collabEngine.on(i.default.SESSION_CHNAGED,function(t){null!=t&&t.length>0&&n.each(t,function(t){t.propUpdated&&null!=t.nickname&&null!=t.lockedBlkIds&&t.lockedBlkIds.length>0&&t.sessionId!==e.clientId&&(t.lockUpdated=!0,e._lockBlock(t.lockedBlkIds[0],t))}),e.trigger("yne-collabsession-change",t)})},t.prototype._lockBlock=function(e,t){var n=this.note,o=this.getBlockById(e);null==o||this.isTable(o)||n.lockBlock(e,t)},t.prototype._unlockBlock=function(e){this.note.unlockBlock(e)},t}(y)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(300),n(301),n(302),n(303),n(304),n(305),n(306),n(94),n(307),n(57),n(308),n(309),n(310),n(48),n(85)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var _=function(){},I=function(e){function t(t,a,d){var u=e.call(this)||this;if(u.localCmdPerSec=0,null==a)throw new Error("Missing underscorejs");if(null==d)throw new Error("Missing logger instance");return h.ExternalLibs.setUnderscore(a),h.ExternalLibs.setLogger(d),u.isLocalCmdTooFast=!1,u.coreEditor=t,u.clientId=u.coreEditor.getClientId(),u.keyTranslator=new s.CollabKeyTranslator,u.collabPropsHandler=new o.CmdCollabPropsHandler(u.clientId,u.keyTranslator,u.coreEditor),u.wsClient=new f.WebSocketClient(u.collabPropsHandler),u.cmdMergeHandler=new i.CmdMergeHandler,u.nondataCmdHandler=new p.NonDataCmdHandler(u.wsClient),u.sessionHandler=new l.CollabSessionHandler(u.clientId,u.nondataCmdHandler),u.blockLockHandler=new n.BlockLockHandler(u.clientId,u.sessionHandler,u.nondataCmdHandler),u.conflictHandler=new r.CollabConfilctHandler(u.coreEditor,u.blockLockHandler),u.redoundoHandler=new g.RedoUndoHandler(u.coreEditor),u.dataCmdHandler=new c.DataCmdHandler(u.coreEditor,u.blockLockHandler,u.conflictHandler,u.redoundoHandler,u.cmdMergeHandler,u.keyTranslator,u.wsClient),u._createEventEmitter(),u}return a(t,e),t.prototype.buildCollabProperties=function(e){return this.collabPropsHandler.buildCollabProperties(e)},t.prototype.buildCollabSession=function(e,t){var n,o,i=this,r={resultCode:d.CustomResultCode.NO_ERROR};e.sessionId=this.clientId,t=t||_,null!=this.callbackBuildCollabSession&&(r.resultCode=d.CustomResultCode.STOP_CALL,r.message="StopPreviousCall",this.callbackBuildCollabSession(r)),this.callbackBuildCollabSession=function(e){clearTimeout(i.timeoutBuildCollabSession),i.wsClient.off(y.default.SESSION_INIT_BUILT,n),i.wsClient.off(y.default.WS_CLOSED,o),t(e)};try{o=function(e){h.loggerInst.log("WS_CLOSED Callback in buildCollabSession"),i.callbackBuildCollabSession(e)},this.wsClient.once(y.default.WS_CLOSED,o),n=function(e){h.loggerInst.log("SESSION_INIT_BUILT Callback in buildCollabSession"),i.callbackBuildCollabSession(e)},this.nondataCmdHandler.once(y.default.SESSION_INIT_BUILT,n),this.wsClient.connect(e),this.timeoutBuildCollabSession=setTimeout(function(){var e={resultCode:d.CustomResultCode.TIME_OUT,message:"TimeOut"};i.callbackBuildCollabSession(e)},5e3)}catch(e){r.resultCode=d.CustomResultCode.EXCEPTION,r.message=e.message||e,this.callbackBuildCollabSession(r)}},t.prototype.closeCollabSession=function(e,t,n){var o={resultCode:d.CustomResultCode.NO_ERROR};n=n||_;try{this.wsClient.close(e,t),this.blockLockHandler.destroy(),this.blockLockHandler=null,this.collabPropsHandler.destroy(),this.collabPropsHandler=null,this.conflictHandler.destroy(),this.conflictHandler=null,this.cmdMergeHandler.destroy(),this.cmdMergeHandler=null,this.dataCmdHandler.destroy(),this.dataCmdHandler=null,this.nondataCmdHandler.destroy(),this.nondataCmdHandler=null,this.redoundoHandler.destroy(),this.redoundoHandler=null,this.sessionHandler.destroy(),this.sessionHandler=null}catch(e){o.resultCode=d.CustomResultCode.EXCEPTION,o.message=e.message||e}n(o)},t.prototype.isLastOwnDataCmdExecuted=function(){return this.dataCmdHandler.isLastOwnCmdExecuted()},t.prototype.sendContentSetInfo=function(e,t){var n=this,o={collabId:this.wsClient.getCollabId(),isReadOnly:this.wsClient.isReadOnlySession(),nickname:this.wsClient.getNickname(),result:u.ConstValueInJSON.SESSION_INIT_DONE,resultCode:d.CustomResultCode.NO_ERROR,sessionId:this.wsClient.getSessionId(),userId:this.wsClient.getUserId()},i={};t=t||_,null!=this.callbackSendContentSetInfo&&(o.resultCode=d.CustomResultCode.STOP_CALL,o.message="StopPreviousCall",this.callbackSendContentSetInfo(o)),this.callbackSendContentSetInfo=function(e){clearTimeout(n.timeoutSendContentSetInfo),n.nondataCmdHandler.off(y.default.SESSION_INIT_DONE,n.callbackSendContentSetInfo),t(e)},this.coreEditor.isNoteValidForCollab()?(i.noteVersion=e,this.nondataCmdHandler.once(y.default.SESSION_INIT_DONE,this.callbackSendContentSetInfo),this.nondataCmdHandler.sendCollabNonDataCommand(d.CmdNames.NONDATACMD_CLINTPONG,i),this.timeoutSendContentSetInfo=setTimeout(function(){o.resultCode=d.CustomResultCode.TIME_OUT,null!=n.callbackSendContentSetInfo&&n.callbackSendContentSetInfo(o)},5e3)):(o.result=u.ConstValueInJSON.SESSION_INIT_INVALID,this.callbackSendContentSetInfo(o))},t.prototype.getCollabContent=function(e){var t=this,n={resultCode:0},o=function(n){n.resultCode===d.CustomResultCode.NO_ERROR&&(n.version=t.coreEditor.getNoteVersion(),n.content=t.coreEditor.getXmlContent(),n.sessionCount=t.sessionHandler.getSessionCount()),null!=t.callbackGetCollabContent&&t.dataCmdHandler.off(y.default.DATACMD_NO_PENDING,t.callbackGetCollabContent),t.callbackGetCollabContent=null,clearTimeout(t.timeoutGetCollabContent),e(n)};return e=e||_,this.coreEditor.isContentLoading()?(n.resultCode=0,o(n)):this.dataCmdHandler.hasPendingCmds()?this.wsClient.isOpened()?(n.resultCode=0,null==this.callbackGetCollabContent&&(this.callbackGetCollabContent=function(e){null==e&&(e={resultCode:d.CustomResultCode.NO_ERROR}),o(e)},this.dataCmdHandler.once(y.default.DATACMD_NO_PENDING,this.callbackGetCollabContent),this.timeoutGetCollabContent=setTimeout(function(){n.resultCode=d.CustomResultCode.TIME_OUT,n.message="TimeOut",null!=t.callbackGetCollabContent&&t.callbackGetCollabContent(n)},6e4))):(n.resultCode=d.WSCustomCode.COLLAB_SESSION_CLOSED,o(n)):(n.resultCode=d.CustomResultCode.NO_ERROR,o(n)),n},t.prototype.getModifiers=function(e,t){var n=this,o={status:0,resultCode:d.CustomResultCode.NO_ERROR};return t=t||_,null!=this.callbackGetModifiers&&(o.resultCode=d.CustomResultCode.STOP_CALL,o.status=2,o.message="StopPreviousCall",this.callbackGetModifiers(o)),this.callbackGetModifiers=function(e){n.nondataCmdHandler.off(y.default.NONDATACMD_MODIFIERS_RESULT,n.callbackGetModifiers),n.callbackGetModifiers=null,clearTimeout(n.timeoutGetModifiers),t(e)},0!==(o=this.nondataCmdHandler.getModifiers(e)).status?(t(o),o):(this.nondataCmdHandler.once(y.default.NONDATACMD_MODIFIERS_RESULT,this.callbackGetModifiers),this.timeoutGetModifiers=setTimeout(function(){null!=n.callbackGetModifiers&&(o.resultCode=d.CustomResultCode.TIME_OUT,o.status=2,o.message="TimeOut",n.callbackGetModifiers(o))},5e3),o)},t.prototype.saveNotification=function(e,t){var n={};n.noteVersion=e,n.isHistorySave=!!t,this.nondataCmdHandler.sendCollabNonDataCommand(d.CmdNames.NONDATACMD_NOTESAVE,n)},t.prototype.getLastNotOwnExecCmd=function(){return this.dataCmdHandler.getLastNotOwnExecCmd()},t.prototype.getMyOwnBlockIds=function(){return this.blockLockHandler.getOwnBlockIds()},t.prototype.sendOwnLockInfo=function(e){var t={};t.lockedBlockId=e,t.sessionId=this.clientId,this.nondataCmdHandler.sendCollabNonDataCommand(d.CmdNames.NONDATACMD_COLLABINFO,t)},t.prototype.sendCachedDataCmd=function(e){this.dataCmdHandler.sendCachedDataCommand(e)},t.prototype.hasCachedDataCmd=function(){return this.dataCmdHandler.hasPendingCmds()},t.prototype.pushLocalDataCommand=function(e,n){var o=d.CustomResultCode.NO_ERROR;return(o=this.dataCmdHandler.pushLocalDataCommand(e,n))===d.CustomResultCode.NO_ERROR&&1===this.dataCmdHandler.getCachedCmdCount()&&(this._checkCommandSendDelay(),this._updateCmdSpeed(!0)),o===d.CustomResultCode.NO_ERROR&&e.isLocalExecutedCmd&&(this.localCmdPerSec++,this.localCmdPerSec>t.LACAL_CMD_SPEED_LIMITATION&&(this.isLocalCmdTooFast=!0)),o},t.prototype.isValidLocalDataCmd=function(e){var t=!0,n={closeSession:!1,resultCode:d.CustomResultCode.NO_ERROR};return t&&(t=this._isLocalCommandTooFast()),t&&!1===e.isReadyToApply&&(n.message="命令不满足执行条件",n.resultCode=d.DataCmdFailureCode.LOCAL_NOT_READY_APPLY,this.emit(y.default.DATACMD_FAILURE,n),t=!1),t&&!this.wsClient.isOpened()&&(n.resultCode=d.WSCustomCode.SESSION_NOT_OPENED,n.message="协同链接已断开",this.emit(y.default.DATACMD_FAILURE,n),t=!1),t&&!this.coreEditor.isNoteValidForCollab()&&(n.resultCode=d.DataCmdFailureCode.LOCAL_INVALID_FOR_COLLAB,n.message="笔记不满足协同条件",this.emit(y.default.DATACMD_FAILURE,n),t=!1),t&&!e&&(n.message="空的本地命令，已被忽略",n.resultCode=d.DataCmdFailureCode.LOCAL_EMPTY_CMD,this.emit(y.default.DATACMD_FAILURE,n),t=!1),!t||e.isCollabRedo||e.isCollabUndo||(t=!this._isLocalCommandConflict(e)),t&&(e.isCollabRedo||e.isCollabUndo)&&!1===(t=this.redoundoHandler.ValidateLocalRedoUndo(e))&&(n.message="目标区域已经被修改，不能撤销或重做",n.resultCode=d.DataCmdFailureCode.LOCAL_DIRTY_BLOCKS,this.emit(y.default.DATACMD_FAILURE,n)),t},t.prototype.updateSessionInfos=function(e){this.nondataCmdHandler.sendCollabNonDataCommand(d.CmdNames.NONDATACMD_COLLABINFO,e)},t.prototype.sendMessageToCollabServer=function(e){this.wsClient.send(e)},t.prototype.getCollabId=function(){return this.wsClient.getCollabId()},t.prototype._sendDataCmdFailedMessage=function(e,t){var n={};n.errToClose=t,n.dataCmdErrorCode=e.toString(),this.nondataCmdHandler.sendCollabNonDataCommand(d.CmdNames.NONDATACMD_DATACMDFAILED,n)},t.prototype._createEventEmitter=function(){var e=this;e.wsClient.on(y.default.WS_CLOSED,function(t){e.emit(y.default.WS_CLOSED,t)}),e.nondataCmdHandler.on(y.default.SESSION_INIT_BUILT,function(t){e.emit(y.default.SESSION_INIT_BUILT,t)}),e.nondataCmdHandler.on(y.default.SESSION_INIT_DONE,function(t){e.emit(y.default.SESSION_INIT_DONE,t)}),e.sessionHandler.on(y.default.SESSION_CHNAGED,function(t){h.underscoreInst.each(t,function(t){if(t.propUpdated){var n=e.blockLockHandler.getLockedBlockIdsBy(t.sessionId);null!=n&&n.length>0&&(t.lockedBlkIds=n)}}),e.emit(y.default.SESSION_CHNAGED,t)}),e.blockLockHandler.on(y.default.LOCK_LOCKED,function(t){var n;t.sessionProps&&t.sessionProps.lockedBlkIds&&t.sessionProps.lockedBlkIds.length>0&&(n=t.sessionProps.lockedBlkIds[0]),null!=n&&(t.sessionId===e.wsClient.getSessionId()?e.sendOwnLockInfo(n):e.emit(y.default.LOCK_LOCKED,t))}),e.blockLockHandler.on(y.default.LOCK_RELEASED,function(t){t.sessionId!==e.wsClient.getSessionId()&&e.emit(y.default.LOCK_RELEASED,t)}),e.dataCmdHandler.on(y.default.DATACMD_FAILURE,function(t){e._sendDataCmdFailedMessage(t.resultCode,t.closeSession),e.emit(y.default.DATACMD_FAILURE,t)}),e.dataCmdHandler.on(y.default.DATACMD_SUCCESS,function(t){e.emit(y.default.DATACMD_SUCCESS,t)})},t.prototype._checkCommandSendDelay=function(){!this.isLocalCmdTooFast&&null!=this.dataCmdHandler&&this.dataCmdHandler.getCmdDelay()>t.MAX_CMD_DELAY_MILLIS?this.wsClient.close(d.WSCustomCode.FAILED_SEND_LOCAL_CMD,"ExceedMaxSendDelay"):null!=this.dataCmdHandler&&this.dataCmdHandler.getCachedCmdCount()>0&&this.wsClient.isOpened()&&window.setTimeout(this._checkCommandSendDelay.bind(this),t.MAX_CMD_DELAY_MILLIS)},t.prototype._isLocalCommandConflict=function(e){var t=!1,n=e.getStartingRange(),o=e.getCollabProps();if(n&&(t=this.conflictHandler.isNoteRangeConflict(n,e.name,o))){var i={closeSession:o.errorToClose,message:o.dataCmdError,resultCode:o.errorCode};this.emit(y.default.DATACMD_FAILURE,i)}return t},t.prototype._isLocalCommandTooFast=function(){var e=!0,t=this.dataCmdHandler.getCachedCmdCount();if(this.isLocalCmdTooFast&&t>0){e=!1;var n={closeSession:!1,message:"命令输入过快，等待执行命令个数："+(t=this.dataCmdHandler.getCachedCmdCount()),resultCode:d.DataCmdFailureCode.LOCAL_CMD_TOO_FAST};this.emit(y.default.DATACMD_FAILURE,n),this.sendCachedDataCmd(!1)}return e},t.prototype._updateCmdSpeed=function(e){var n,o=0;null!=this.dataCmdHandler&&(o=this.dataCmdHandler.getCachedCmdCount()),e&&(this.isLocalCmdTooFast=!1),o>0?((n=o/t.LACAL_CMD_SPEED_LIMITATION)<1&&(n=1),this.localCmdPerSec=0,this.wsClient.isOpened()&&window.setTimeout(this._updateCmdSpeed.bind(this,!1),1e3*n)):this.isLocalCmdTooFast=!1},t.LACAL_CMD_SPEED_LIMITATION=20,t.MAX_CMD_DELAY_MILLIS=4e3,t}(m.YEvent);t.default=I}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(94),n(57),n(48),n(85)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n,o){var i=e.call(this)||this;if(null==t)throw new Error("ownSID cannot be null in BlockLockHandler");return i.lockedBlocksMap={},i.sessionId=t,i.sessionHandler=n,i.nonDataCmdHandler=o,i.sessionHandler.on(r.default.SESSION_LOCK_UPDATE,i._onSessionLockChanged.bind(i)),i.sessionHandler.on(r.default.SESSION_QUIT,i._onSessionQuit.bind(i)),i.nonDataCmdHandler.on(r.default.LOCK_RELEASED,function(e){i._releaseLockOf(e.sessionId)}),i}return a(t,e),t.prototype.destroy=function(){this.lockedBlocksMap=null,this.sessionHandler=null,this.nonDataCmdHandler=null,this.removeAllListeners(null)},t.prototype.isBlockLockedBy=function(e,t){var n,o=!1;return null!=e&&null!=t&&null!=(n=this.lockedBlocksMap[e])&&n===t&&(o=!0),o},t.prototype.getOwnBlockIds=function(){var e=this,t=[];return o.underscoreInst.each(this.lockedBlocksMap,function(n,o){n===e.sessionId&&t.push(o)}),t},t.prototype.getLockedBlockIdsBy=function(e){var t=[];return o.underscoreInst.each(this.lockedBlocksMap,function(n,o){e===n&&t.push(o)}),t},t.prototype.updateLockByDataCmd=function(e){var t,n=e.getCollabProps();if(null!=(t=e.isCollabUndo?e.getStartingRange():e.getEndingRange())){var o=t.getEndBlockRange();if(null!=o){var i=o.block.getId();if(null!=i&&(this._releaseLockOf(n.cmdSessionId),null==this.lockedBlocksMap[i])){var r=this.sessionHandler.getSessionPropertiesBy(n.cmdSessionId);null!=r&&(r.lockedBlkIds=[i],this._lockBlock(r))}}}},t.prototype._releaseLockOf=function(e){var t=this,n=[];o.underscoreInst.each(this.lockedBlocksMap,function(t,o){t===e&&n.push(o)}),o.underscoreInst.each(n,function(n){t._unlockBlock(n,e)})},t.prototype._onSessionQuit=function(e){this._releaseLockOf(e.sessionId)},t.prototype._onSessionLockChanged=function(e){var t=this,n=!1;o.underscoreInst.each(e,function(e){n=!1,null!=e.lockedBlkIds&&e.lockedBlkIds.length>0&&(o.underscoreInst.some(e.lockedBlkIds,function(o){return t.lockedBlocksMap[o]!==e.sessionId&&(n=!0),n}),n&&(t._releaseLockOf(e.sessionId),t._lockBlock(e)))})},t.prototype._unlockBlock=function(e,t){delete this.lockedBlocksMap[e];var o={resultCode:n.CustomResultCode.NO_ERROR,sessionId:t,unlockedBlockId:e};this.emit(r.default.LOCK_RELEASED,o)},t.prototype._lockBlock=function(e){var t=this,n={resultCode:1,sessionId:e.sessionId,sessionProps:e},i=!1;o.underscoreInst.each(e.lockedBlkIds,function(n){t.lockedBlocksMap[n]!==e.sessionId&&(t.lockedBlocksMap[n]=e.sessionId,i=!0)}),i&&this.emit(r.default.LOCK_LOCKED,n)},t}(i.YEvent);t.BlockLockHandler=s}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(48)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){function t(t,n,o){var i=e.call(this)||this;return i.clientId=t,i.collabKeyTranslator=n,i.coreEditor=o,i}return a(t,e),t.prototype.destroy=function(){this.removeAllListeners(null)},t.prototype.buildCollabProperties=function(e){var t,n,o,i,r={coreEditor:this.coreEditor,isCollabEnabled:this.coreEditor.isCollabEnabled()};return e?(r.cmdSessionId=e.sessionId,t=r.cmdSessionId===this.clientId,r.isOwnCmd=t,r.finalNoteVersion=parseInt(e.finalVersion,10),r.ownerName=e.cmdOwner,r.isCollabEnabled=!0,r.isCollabCmd=!0,r.isServerCmd=!1,(n=e.collabCmds).nondataCmds?i=n.nondataCmds[0]:(this.collabKeyTranslator.decode(n),o=n.dataCommands[0]),null!=i?r.isServerCmd=!0===i.isServerCmd:null!=o&&(r.isLocalExecutedCmd=!0===o.isLocalExecutedCmd,r.cmdId=o.cmdId)):r.cmdSessionId=this.clientId,r},t}(n.YEvent);t.CmdCollabPropsHandler=o}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(57),n(48)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){return e.call(this)||this}return a(t,e),t.prototype.destroy=function(){this.removeAllListeners(null)},t.prototype.mergeLocalCommands=function(e){var t,o,i=null,r=0;if(e&&e.length>0)if(1===e.length)i=e[0];else{for(i=e.shift();e.length>0&&(t=e[0],i.canBeMerged(t));)n.loggerInst.log("merge pending command:",i,t),i.mergeLocalCmd(t),e.shift(),r++;r>0&&e[0]&&e[0].isCollabUndo&&((o=n.underscoreInst.clone(i)).isLocalExecutedCmd=e[0].isLocalExecutedCmd,o.setCollabUndo(!0),o.setCollabRedo(!1),e[0]=o),e.unshift(i)}},t}(o.YEvent);t.CmdMergeHandler=i}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(94),n(57),n(48)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e){function t(t,n){var o=e.call(this)||this;return o.coreEditor=t,o.lockHandler=n,o}return a(t,e),t.prototype.destroy=function(){this.lockHandler=null,this.removeAllListeners(null)},t.prototype.isConflictWithOwnLockedBlock=function(e,t,n){var r,a,s,l,c=this.lockHandler.getOwnBlockIds(),d=!1;return null!=c&&c.length>0&&(l=c[0]),i.loggerInst.log("LOCK/UNLOCK: isConflictWithOwnLockedBlock Enter"),"comp.AppendBlank"!==t&&l&&((r=this.coreEditor.getBlockById(l))&&!this.coreEditor.isTable(r)&&((a=this.coreEditor.getInnerBlocksWithEdge(e))&&0!==a.length?i.underscoreInst.some(a,function(e){return e.getId()===l&&(n.collabProperties.dataCmdError="协同命令执行失败：编辑目标段落被锁定",n.collabProperties.errorToClose=!!n.collabProperties.isLocalExecutedCmd,n.collabProperties.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED,d=!0),d}):i.loggerInst.warn("Failed to get the blocks from range",e)),d||null==n.dropRange||null==n.dropRange.block||(s=n.dropRange.block.getId())&&(d=s===l)&&(n.collabProperties.dataCmdError="协同命令执行失败：拖拽目标段落被锁定",n.collabProperties.errorToClose=!!n.collabProperties.isLocalExecutedCmd,n.collabProperties.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED)),i.loggerInst.log("LOCK/UNLOCK: isConflictWithOwnLockedBlock Exit"),d},t.prototype.isNoteRangeConflict=function(e,t,n){var r,a,s,l,c,d=this,u=!1;return i.loggerInst.log("LOCK/UNLOCK: isNoteRangeConflict Enter"),a=n.cmdSessionId,c=!n.isCollabCmd||n.isOwnCmd,"comp.AppendBlank"!==t&&"ManagerAdapter"!==t&&((r=this.coreEditor.getInnerBlocksWithEdge(e))&&0!==r.length?(i.underscoreInst.some(r,function(e){return i.loggerInst.log("LOCK/UNLOCK: "+e.getId()+" LockState:"+e.isLocked()),e.isLocked()&&(u=c||!d.lockHandler.isBlockLockedBy(e.getId(),a))&&(n.dataCmdError="目标段落已被其他用户锁定",n.isCollabCmd?(n.errorToClose=!!n.isLocalExecutedCmd,n.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):n.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED),u}),u||(u=this._isConflictWithNeighborBlock(t,e,n))):(n.dataCmdError="目标段落不存在",n.isCollabCmd?(n.errorToClose=!0,n.errorCode=o.DataCmdFailureCode.COLLAB_BLOCKS_MISSING):n.errorCode=o.DataCmdFailureCode.LOCAL_BLOCKS_MISSING,u=!0),u||null==n.cmdJSON||null==n.cmdJSON.dropRange||((s=n.cmdJSON.dropRange.blockId)&&(l=this.coreEditor.getBlockById(s)),l&&l.isLocked()&&(u=c||!this.lockHandler.isBlockLockedBy(s,a)))),i.loggerInst.log("LOCK/UNLOCK: isNoteRangeConflict Exit"),u},t.prototype._isConflictWithNeighborBlock=function(e,t,r){var a,s,l,c,d=r.cmdSessionId,u=!1;if(!t)return i.loggerInst.warn("_isConflictWithNeighborBlock:noteRange should not be null"),!1;switch(a=t.getStartBlockRange(),s=!r.isCollabCmd||r.isOwnCmd,e){case"comp.KeyBackspace":a&&n.isTextBlock(a.block)&&0===a.start&&!this.coreEditor.isTodo(a.block)&&(l=this.coreEditor.getPreBlockById(a.getBlockId()))&&t.isCollapsed()&&!this.coreEditor.isListItem(a.block)&&0===a.block.getBlockStyle("text-indent")&&l.isLocked()&&(u=s||!this.lockHandler.isBlockLockedBy(l.getId(),d))&&(r.dataCmdError="目标段落已被其他用户锁定",r.isCollabCmd?(r.errorToClose=!0,r.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):r.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED);break;case"comp.KeyDelete":t.isCollapsed()&&n.isTextBlock(a.block)&&a.end===a.block.getLength(!1)&&(c=this.coreEditor.getNextBlockById(a.getBlockId()))&&c.isLocked()&&(u=s||!this.lockHandler.isBlockLockedBy(c.getId(),d))&&(r.dataCmdError="目标段落已被其他用户锁定",r.isCollabCmd?(r.errorToClose=!0,r.errorCode=o.DataCmdFailureCode.COLLAB_TARGET_BLOCK_LOCKED):r.errorCode=o.DataCmdFailureCode.LOCAL_TARGET_BLOCK_LOCKED)}return u},t}(r.YEvent);t.CollabConfilctHandler=s}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(57),n(48)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(){var t=e.call(this)||this;return t.KEY_MAP_DECODE={a:{key:"sessionId",type:0},b:{key:"finalVersion",type:0},c:{key:"cmdOwner",type:0},d:{key:"collabCmds",type:1},e:{key:"dataCommands",type:1},f:{key:"action",type:0},g:{key:"cmdId",type:0},h:{key:"nondataCmds",type:1},i:{key:"updateVersion",type:0},j:{key:"startNoteRange",type:1},k:{key:"startBlockRange",type:1},l:{key:"rangeType",type:0},m:{key:"startPosition",type:0},n:{key:"endPosition",type:0},o:{key:"isInSingleBlock",type:0},p:{key:"cmdNoteVersion",type:0},q:{key:"isLocalExecutedCmd",type:0},r:{key:"skipBlockLocking",type:0},s:{key:"blockId",type:0},t:{key:"richText",type:0},u:{key:"newBlkId",type:0},v:{key:"inlineStyles",type:0},w:{key:"blockStyles",type:0},x:{key:"newStartBlkId",type:0},y:{key:"newEndBlkId",type:0},z:{key:"dropRange",type:1},0:{key:"colNums",type:0},1:{key:"rowNums",type:0},2:{key:"simpleValue1",type:0},3:{key:"src",type:0},4:{key:"simpleValue2",type:0},5:{key:"recogLink",type:0},6:{key:"attachRes",type:0},7:{key:"fileName",type:0},8:{key:"fileLen",type:0},9:{key:"innerCmds",type:1},A:{key:"affectedBlockIds",type:0},B:{key:"endNoteRange",type:1},C:{key:"isCollabUndo",type:0},D:{key:"preBlockId",type:0},E:{key:"deletedBlocks",type:0},F:{key:"insertedBlocks",type:0},G:{key:"isCollabRedo",type:0},H:{key:"resIds",type:0},J:{key:"dataBefore",type:0},K:{key:"dataAfter",type:0},L:{key:"endBlockRange",type:1},N:{key:"blockIds",type:0},O:{key:"styleNameValues",type:0},P:{key:"oldStyleNameValues",type:0},Q:{key:"abstractSimpleValue1",type:0},R:{key:"indentStep",type:0},S:{key:"listId",type:0},T:{key:"listType",type:0},U:{key:"abstractSimpleValue2",type:0},V:{key:"oldLevels",type:0},W:{key:"newLevels",type:0},X:{key:"listItemIds",type:0},Y:{key:"headerFooterInfo",type:0},aa:{key:"selectWholeBlock",type:0},ab:{key:"startLineIndex",type:0},ac:{key:"startLineCharIndex",type:0},ad:{key:"endLineCharIndex",type:0},ae:{key:"endLineIndex",type:0}},t._assembleEncodeMap(),t}return a(t,e),t.prototype.destroy=function(){},t.prototype.decode=function(e){var t,o=this;if(!1!==this.isValidKeyMap){if(n.underscoreInst.isArray(e))n.underscoreInst.each(e,function(e){o.decode(e)});else if(null!==e&&"object"==typeof e)for(var i=0,r=n.underscoreInst.keys(e);i<r.length;i++){var a=r[i];e.hasOwnProperty(a)&&(a in this.KEY_MAP_DECODE&&(e[t=this.KEY_MAP_DECODE[a].key]=e[a],delete e[a],null!==e[t]&&"object"==typeof e[t]&&1===this.KEY_MAP_DECODE[a].type&&this.decode(e[t])))}}else n.loggerInst.error("KeyMap is not valid, skip decode.")},t.prototype.encode=function(e){var t,o=this;if(!1!==this.isValidKeyMap){if(n.underscoreInst.isArray(e))n.underscoreInst.each(e,function(e){o.encode(e)});else if(null!==e&&"object"==typeof e)for(var i=0,r=n.underscoreInst.keys(e);i<r.length;i++){var a=r[i];e.hasOwnProperty(a)&&(a in this.KEY_MAP_ENCODE?(e[t=this.KEY_MAP_ENCODE[a].key]=e[a],delete e[a],null!==e[t]&&"object"==typeof e[t]&&1===this.KEY_MAP_ENCODE[a].type&&this.encode(e[t])):(n.loggerInst.log("key:",typeof a),n.loggerInst.error('Key - "',a,'" does NOT exist in COLLAB_MAP_ENCODE!')))}}else n.loggerInst.error("KeyMap is not valid, skip encode.")},t.prototype._assembleEncodeMap=function(){var e,t;for(t in this.isValidKeyMap=!0,this.KEY_MAP_ENCODE={},this.KEY_MAP_DECODE)if(this.KEY_MAP_DECODE.hasOwnProperty(t)){if(e=this.KEY_MAP_DECODE[t].key,n.underscoreInst.has(this.KEY_MAP_DECODE,e)){this.isValidKeyMap=!1,n.loggerInst.error("original JSON key is conflict with encoded key, please rename it",e);break}if(n.underscoreInst.has(this.KEY_MAP_ENCODE,e)){this.isValidKeyMap=!1,n.loggerInst.error("original JSON key is duplicated, please rename them",e);break}this.KEY_MAP_ENCODE[e]={},this.KEY_MAP_ENCODE[e].key=t,this.KEY_MAP_ENCODE[e].type=this.KEY_MAP_DECODE[t].type}},t}(o.YEvent);t.CollabKeyTranslator=i}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(57),n(48),n(85)],void 0===(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){function t(t,n){var o=e.call(this)||this;return o.sessionsMap={},o.nondataCmdHandler=n,o.nondataCmdHandler.on(i.default.SESSION_CHNAGED,o._onSessionChanged.bind(o)),o.nondataCmdHandler.on(i.default.SESSION_QUIT,o._onSessionQuit.bind(o)),o}return a(t,e),t.prototype.destroy=function(){this.sessionsMap=null,this.removeAllListeners(null)},t.prototype.getSessionCount=function(){return n.underscoreInst.size(this.sessionsMap)},t.prototype.getSessionPropertiesBy=function(e){var t=this.sessionsMap[e];if(t)return n.underscoreInst.clone(t)},t.prototype._onSessionChanged=function(e){var t,o,r=this,a=[],s=[],l=!1;e.length>0&&(n.underscoreInst.each(this.sessionsMap,function(e){e.propUpdated=!1,a.push(e)}),n.underscoreInst.each(e,function(e){if(null==r.sessionsMap[e.sessionId]&&(r.sessionsMap[e.sessionId]={sessionId:e.sessionId},a.push(r.sessionsMap[e.sessionId]),l=!0),o=e.lockedBlkIds,delete e.lockedBlkIds,(t=r.sessionsMap[e.sessionId]).propUpdated=!1,n.underscoreInst.each(Object.keys(e),function(n){t[n]!==e[n]&&(t[n]=e[n],t.propUpdated=!0,l=!0)}),null!=o&&o.length>0){var i={lockedBlkIds:o,sessionId:e.sessionId};n.underscoreInst.defaults(i,t),s.push(i)}}),l&&this.emit(i.default.SESSION_CHNAGED,a),s.length>0&&this.emit(i.default.SESSION_LOCK_UPDATE,s))},t.prototype._onSessionQuit=function(e){var t=[];delete this.sessionsMap[e.sessionId],this.emit(i.default.SESSION_QUIT,e),n.underscoreInst.each(this.sessionsMap,function(e){e.propUpdated=!1,t.push(e)}),this.emit(i.default.SESSION_CHNAGED,t)},t}(o.YEvent);t.CollabSessionHandler=r}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(94),n(57),n(168),n(48),n(85)],void 0===(i=function(e,t,n,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t,n,o,i,r,a,l){var c=e.call(this)||this;return c.regularCmdSendIntervalMS=2e3,c.pendingSentCmdsQueue=[],c.coreEditor=t,c.blockLockHandler=n,c.conflictHandler=o,c.redoundoHandler=i,c.cmdMergeHandler=r,c.keyTranslator=a,c.wsClient=l,c.callbackWSOnMessage=c._execCollabDataCommand.bind(c),c.wsClient.on(s.default.WS_MESSAGE,c.callbackWSOnMessage),c}return a(t,e),t.prototype.destroy=function(){this.wsClient.off(s.default.WS_MESSAGE,this.callbackWSOnMessage),this.wsClient=null,this.removeAllListeners(null),this.pendingSentCmdsQueue=[]},t.prototype.getLastNotOwnExecCmd=function(){return this.lastNotOwnExecCmd},t.prototype.hasPendingCmds=function(){return this.pendingSentCmdsQueue&&this.pendingSentCmdsQueue.length>0},t.prototype.isLastOwnCmdExecuted=function(){var e=!0;return this.pendingSentCmdsQueue.length>0&&(e=this.pendingSentCmdsQueue[0].isLocalExecutedCmd),e},t.prototype.getCachedCmdCount=function(){return this.pendingSentCmdsQueue.length},t.prototype.getCmdDelay=function(){var e=this.pendingSentCmdsQueue[0],t=0;return null!=e&&null!=e.sendingToCollabServerMillis&&(t=Date.now()-e.sendingToCollabServerMillis),t},t.prototype.pushLocalDataCommand=function(e,t){var i=n.CustomResultCode.NO_ERROR;return e.isLocalExecutedCmd||0!==this.pendingSentCmdsQueue.length||(o.loggerInst.log("Process: sending non-local-executed first command"),i=this._sendCollabDataCommand(e,!1)),!t&&e.isLocalExecutedCmd&&0===this.pendingSentCmdsQueue.length&&(o.loggerInst.log("Process: delay sending local-executed first command"),this.sendCachedDataCommand(!0)),i===n.CustomResultCode.NO_ERROR&&(this.pendingSentCmdsQueue.push(e),!this.pendingSentCmdsQueue[0].sendingToCollabServerMillis&&(t||this.pendingSentCmdsQueue.length>1&&!e.isLocalExecutedCmd)&&(i=this.sendCachedDataCommand(!1)),o.loggerInst.log("Process: enqueue Command:(len:"+this.pendingSentCmdsQueue.length+")",e)),!0===e.isLocalExecutedCmd&&this.blockLockHandler.updateLockByDataCmd(e),i},t.prototype.sendCachedDataCommand=function(e){var t=n.CustomResultCode.NO_ERROR;return e?this.cmdSendingTimer=setTimeout(this._dispatchCachedDataCommand.bind(this),this.regularCmdSendIntervalMS):(clearTimeout(this.cmdSendingTimer),t=this._dispatchCachedDataCommand()),t},t.prototype._execCollabDataCommand=function(e){var t,n=e.collabCmdsJSON,i=e.collabProps,r={collabProperties:i};try{if(this.keyTranslator.decode(n),null==n.dataCommands)return null;if(null!=this.lastCmdId&&this.lastCmdId===i.cmdId)return null;null!=i.cmdId&&(this.lastCmdId=i.cmdId);var a=n.dataCommands[0],l=a.action,c=this.coreEditor.getDefaultNoteRange(),d=!1,u=void 0,h=void 0,p=void 0;u=this.coreEditor.getNoteRange(),r.collabProperties.cmdJSON=a,this._validateCollabDataCmd(n,r)&&(t=this._executeDataCommand(l,r)),!r.collabProperties.isOwnCmd&&"comp.DeleteNoteRange"===l&&r.range.isInSingleBlock()&&u.isInSingleBlock()&&(p=r.range.getStartBlockRange().block,h=u.getStartBlockRange().block,this.coreEditor.isTable(p)&&h.getId()===p.getId()&&(d=!0)),d&&c&&this.coreEditor.setNoteRange(c),this._postCollabDataCmdExecution(t,r)}catch(e){o.loggerInst.error(e)}finally{this.pendingSentCmdsQueue.length>0?this.sendCachedDataCommand(!1):this.emit(s.default.DATACMD_NO_PENDING)}return t},t.prototype._dispatchCachedDataCommand=function(){for(var e,t;this.pendingSentCmdsQueue.length>0&&(o.loggerInst.log("Process: sending cached command from queue"),e=this.pendingSentCmdsQueue[0],this.cmdMergeHandler.mergeLocalCommands(this.pendingSentCmdsQueue),(t=this._sendCollabDataCommand(e,!0))!==n.CustomResultCode.NO_ERROR)&&!e.isLocalExecutedCmd;)o.loggerInst.warn("skip failed-sent command and try next",e),this.pendingSentCmdsQueue.shift();return t},t.prototype._sendCollabDataCommand=function(e,t){var i,r,a,l,c=[],d={};if(t){if(e.sendingToCollabServerMillis)return o.loggerInst.warn("current cmd has been sent",e),n.CustomResultCode.NO_ERROR;if(e.isLocalExecutedCmd||e.isCollabRedo||e.isCollabUndo)o.loggerInst.log("Update-Range: NoUpdate");else{if(a=this._updateLocalCmdStartRange(e),!e.isValidStartNoteRange())return this.emit(s.default.DATACMD_FAILURE,n.DataCmdFailureCode.LOCAL_INVALID_STARTRANGE),n.DataCmdFailureCode.LOCAL_INVALID_STARTRANGE;if(a&&this.conflictHandler.isNoteRangeConflict(a,e.name,e.getCollabProps()))return o.loggerInst.log("Do NOT send Conflict Local Command"),e.getCollabProps().errorCode}}if(i=e.toCollabJSON())c[0]=i,d.dataCommands=c,o.loggerInst.log("_sendCollabDataCommand(original):",JSON.stringify(d)),this.keyTranslator.encode(d),r=JSON.stringify(d),o.loggerInst.log("_sendCollabDataCommand(compressd):",r),(l=this.wsClient.send(r))===n.CustomResultCode.NO_ERROR&&(e.sendingToCollabServerMillis=Date.now());else{l=n.DataCmdFailureCode.LOCAL_INVALID_CMDJSON;var u={closeSession:e.isLocalExecutedCmd,message:"无效的命令格式，无法协同",resultCode:l};this.emit(s.default.DATACMD_FAILURE,u)}return l===n.CustomResultCode.NO_ERROR&&e.isLocalExecutedCmd&&(o.loggerInst.log("Update-Range: set local command as last executed command"),this._setLastOwnExecutedCmd(e)),l},t.prototype._updateLocalCmdStartRange=function(e){var t;return this.lastOwnExecCmd?this.lastOwnExecCmd.isLocalExecutedCmd?o.loggerInst.log("Update-Range: last own executed command is local executed"):null!=(t=this.lastOwnExecCmd.getEndingRange())&&(e.setStartingRange(t),o.loggerInst.log("Update-Range: UpdateTo-",t.getStartBlockRange())):o.loggerInst.log("Update-Range: No last own executed command"),t},t.prototype._postCollabDataCmdExecution=function(e,t){var i,r=t.collabProperties.isLocalExecutedCmd,a=t.collabProperties.isOwnCmd;if(a&&(i=this.pendingSentCmdsQueue.shift()),t.collabProperties.dataCmdError){o.loggerInst.error(t.collabProperties.dataCmdError),e&&(e.effected||r)&&(t.collabProperties.errorToClose=!0);var l={closeSession:t.collabProperties.errorToClose,message:t.collabProperties.dataCmdError,resultCode:t.collabProperties.errorCode};return a&&this.emit(s.default.DATACMD_FAILURE,l),void(null==e&&this.coreEditor.setNoteVersion(t.collabProperties.finalNoteVersion))}if(e){if(a&&this.coreEditor.isReadyForEdit()&&(o.loggerInst.log("clear sendingToCollabServerMillis:",e,i),e.sendingToCollabServerMillis=null,i.sendingToCollabServerMillis=null,o.loggerInst.log("Process: Dequeue Command(len:"+this.pendingSentCmdsQueue.length+")")),e.setCmdFinalNoteVersion(this.coreEditor.getNoteVersion()),!a&&e.effected&&(this.redoundoHandler.pushNotOwnExecCmd(e),this.lastNotOwnExecCmd=e),a){var c={rawCollabJSON:t.collabProperties.rawWSMessage,resultCode:n.CustomResultCode.NO_ERROR};this.emit(s.default.DATACMD_SUCCESS,c),r||this._setLastOwnExecutedCmd(e)}this.blockLockHandler.updateLockByDataCmd(e)}else o.loggerInst.error("execCommand should NOT be null when no dataCmdError")},t.prototype._setLastOwnExecutedCmd=function(e){this.lastOwnExecCmd=e},t.prototype._executeDataCommand=function(e,t){var n=t.collabProperties.cmdJSON,i=n.isCollabUndo,r=n.isCollabRedo;return o.loggerInst.log("Executing "+e),i||r?this.redoundoHandler.applyCollabRedoUndo(e,t):this.coreEditor.execCommand(e,t)},t.prototype._validateCollabDataCmd=function(e,t){var r,a=t.collabProperties,s=a.cmdJSON,l=this.coreEditor.getNoteVersion(),c=a.finalNoteVersion,d=!this.coreEditor.isReadyForEdit(),u=a.isLocalExecutedCmd,h=s.startNoteRange,p=!0;return o.loggerInst.log("Executing Validation Enter"),d?0===c?(p=!1,o.loggerInst.log("Executing Validation - ignore cmd whose finalVersion is 0")):o.loggerInst.log("Executing Validation - executing unsaved cmd"):i.Utils.isCmdVersionMatchNoteVersion(c,l)?u||(r=this.coreEditor.buildNoteRangeFromJSON(h),a.isOwnCmd||(p=!this.conflictHandler.isConflictWithOwnLockedBlock(r,s.action,t)),p&&(s.isCollabUndo||s.isCollabRedo?(p=this.redoundoHandler.ValidateCollabRedoUndo(s.affectedBlockIds,s.cmdNoteVersion))||(a.errorToClose=!0,a.errorCode=n.DataCmdFailureCode.COLLAB_DIRTY_BLOCKS,a.dataCmdError="协同：目标区域已经被修改，不能撤销或重做"):p=!this.conflictHandler.isNoteRangeConflict(r,s.action,a))):(p=!1,a.errorToClose=!0,a.errorCode=n.DataCmdFailureCode.COLLAB_NOTEVERSION_MISMATCH,a.dataCmdError="命令对应版本和本地笔记版本不匹配:("+l+"/"+c+")"),o.loggerInst.log("Executing Validation Exit"),p},t}(r.YEvent);t.DataCmdHandler=l}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(){}return e.SESSION_INIT_DONE="done",e.SESSION_INIT_COLLABSTARTED="collabStarted",e.SESSION_INIT_TIMEOUT="timeout",e.SESSION_INIT_INVALID="notValidForCollab",e}();t.ConstValueInJSON=n}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(94),n(57),n(168),n(48),n(85)],void 0===(i=function(e,t,n,o,i,r,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var l=function(e){function t(t){var n=e.call(this)||this;if(n.retryIntervalMilliSec=1e3,n.retryMaxCount=2,null==t)throw new Error("wsClient should NOT be null");return n.wsClient=t,n.callbackWSOnMessage=n._execCollabNondataCommand.bind(n),n.wsClient.on(s.default.WS_MESSAGE,n.callbackWSOnMessage),n}return a(t,e),t.prototype._queueCollabCmdJSON=function(e){var t;return(t=this._sendCollabJSON(e))&&(e.sendingToCollabServerMillis=Date.now(),e.retryRemainedCount=this.retryMaxCount,this.retriableCmdsQueue.push(e),null==this.retryCollabJSONDispatcher&&(this.retryCollabJSONDispatcher=setTimeout(this._handleCollabJSONRetry.bind(this),this.retryIntervalMilliSec))),t},t.prototype.destroy=function(){this.wsClient.off(s.default.WS_MESSAGE,this.callbackWSOnMessage),this.wsClient=null,this.removeAllListeners(null)},t.prototype.getModifiers=function(e){return this.wsClient.isOpened()?this.modifiers&&1===this.modifiers.status&&this.modifiers.endVersion===e||(this.modifiers={resultCode:n.CustomResultCode.NO_ERROR,status:0},this._requestModifiers(e)||(this.modifiers.status=2)):this.modifiers={resultCode:n.WSCustomCode.SESSION_NOT_OPENED,status:2},this.modifiers},t.prototype.sendCollabNonDataCommand=function(e,t){var o,i=!0;return o=this._buildCollabCmdJSON(e,t),e===n.CmdNames.NONDATACMD_GETMODIFIERS?this._isModifiersReqeustSent(t.endNoteVersion)||(this._clearRetryQueueByAction(e),i=this._queueCollabCmdJSON(o)):i=e===n.CmdNames.NONDATACMD_COLLABINFO||e===n.CmdNames.NONDATACMD_NOTESAVE?this._queueCollabCmdJSON(o):this._sendCollabJSON(o),i},t.prototype._execCollabNondataCommand=function(e){var t,o=e.collabCmdsJSON,i=e.collabProps,r=i.cmdSessionId;if(null!=o.nondataCmds){switch((t=o.nondataCmds[0]).action){case n.CmdNames.NONDATACMD_BLOCKSELECTION:break;case n.CmdNames.NONDATACMD_COLLABCLOSE:var a={resultCode:n.CustomResultCode.NO_ERROR,sessionId:r};this.emit(s.default.SESSION_QUIT,a);break;case n.CmdNames.NONDATACMD_COLLABINFO:this._handleCollabInfo(t,i);break;case n.CmdNames.NONDATACMD_SESSIONINITIALIZED:var l={collabId:this.wsClient.getCollabId(),collabVersion:t.collabVersion,isReadOnly:this.wsClient.isReadOnlySession(),nickname:this.wsClient.getNickname(),result:t.initResult,resultCode:1,sessionId:this.wsClient.getSessionId(),userId:this.wsClient.getUserId()};this.emit(s.default.SESSION_INIT_DONE,l);break;case n.CmdNames.NONDATACMD_LOCKRELEASE:var c={resultCode:n.CustomResultCode.NO_ERROR,sessionId:r,unlockedBlockId:null};this.emit(s.default.LOCK_RELEASED,c);break;case n.CmdNames.NONDATACMD_SEVERPING:this._handleServerPing(t);break;case n.CmdNames.NONDATACMD_GETMODIFIERS:this._handleModifiers(t);break;case n.CmdNames.NONDATACMD_NOTESAVE:this._handleNoteSave(t);break;default:throw new Error("unknown nondata cmd:"+t.action)}this._removeFromRetryQueue(t.cmdId)}},t.prototype._requestModifiers=function(e){var t={};return t.endNoteVersion=e,this.sendCollabNonDataCommand(n.CmdNames.NONDATACMD_GETMODIFIERS,t)},t.prototype._handleCollabJSONRetry=function(){var e,t=this,i=!1;o.underscoreInst.each(this.retriableCmdsQueue,function(r){!0!==i&&null!=t.wsClient&&!1!==t.wsClient.isOpened()?Date.now()-r.sendingToCollabServerMillis>t.retryIntervalMilliSec&&((e=r.retryRemainedCount)>0?(o.loggerInst.log("NonDataCmd-Resend:",r),delete r.sendingToCollabServerMillis,delete r.retryRemainedCount,t._sendCollabJSON(r),r.sendingToCollabServerMillis=Date.now(),r.retryRemainedCount=e-1):(o.loggerInst.error("NondataCmd-Send Failed after retry:",r),t.wsClient&&t.wsClient.isOpened()&&t.wsClient.close(n.WSCustomCode.FAILED_RECEIVE_COLLAB_CMD,n.WSCustomCode[n.WSCustomCode.FAILED_RECEIVE_COLLAB_CMD]),i=!0)):i=!0}),i&&(this.retriableCmdsQueue=[]),this.retriableCmdsQueue.length>0?this.retryCollabJSONDispatcher=setTimeout(this._handleCollabJSONRetry.bind(this),this.retryIntervalMilliSec):(clearTimeout(this.retryCollabJSONDispatcher),this.retryCollabJSONDispatcher=null)},t.prototype._sendCollabJSON=function(e){return null!=e&&this.wsClient.send(JSON.stringify(e)),!0},t.prototype._isModifiersReqeustSent=function(e){var t,i;return o.underscoreInst.some(this.retriableCmdsQueue,function(o){return(t=o.nondataCmds[0]).action===n.CmdNames.NONDATACMD_GETMODIFIERS&&t.endVersion===e&&(i=!0,!0)}),i},t.prototype._buildCollabCmdJSON=function(e,t){var o,r=[],a={};switch(o={action:e,cmdId:i.Utils.newGUID()},r.push(o),a.nondataCmds=r,e){case n.CmdNames.NONDATACMD_BLOCKSELECTION:o.blockId=t.selectedBlockId;break;case n.CmdNames.NONDATACMD_COLLABINFO:var s={sessionId:t.sessionId};void 0!==t.nickname&&(s.nickname=t.nickname),void 0!==t.lockedBlockId&&(s.lockedBlkIds=[],s.lockedBlkIds.push(t.lockedBlockId)),void 0!==t.portraitUrl&&(s.portraitUrl=t.portraitUrl),this._buildSessionInfoJSON(o,s);break;case n.CmdNames.NONDATACMD_DATACMDFAILED:o.dataCmdError=t.dataCmdErrorCode,o.errToClose=!!t.errToClose;break;case n.CmdNames.NONDATACMD_CLINTPONG:o.versionUpdate=t.noteVersion;break;case n.CmdNames.NONDATACMD_GETMODIFIERS:o.endVersion=t.endNoteVersion;break;case n.CmdNames.NONDATACMD_NOTESAVE:o.versionUpdate=t.noteVersion,o.isHistorySave=t.isHistorySave;break;default:throw a=null,new Error("Unsupported NondataCmd:"+e)}return a},t.prototype._buildSessionInfoJSON=function(e,t){var n={sessionId:t.sessionId};null!=t.nickname&&(n.nickname=t.nickname),null!=t.portraitUrl&&(n.portraitUrl=t.portraitUrl),null!=t.lockedBlkIds&&t.lockedBlkIds.length>0&&(n.lockedBlkId=t.lockedBlkIds[0]),e.sessionProp=[],e.sessionProp.push(n)},t.prototype._handleCollabInfo=function(e,t){var n=e.sessionProp,i=[];o.underscoreInst.each(n,function(e){var n={sessionId:null};null!=e.lockedBlkId&&(n.lockedBlkIds=[e.lockedBlkId],delete e.lockedBlkId),o.underscoreInst.extend(n,e),null==n.sessionId&&(n.sessionId=t.cmdSessionId),i.push(n)}),this.emit(s.default.SESSION_CHNAGED,i)},t.prototype._handleServerPing=function(e){if(null!=e.collabNoteReady){var t={isCollabStarted:e.collabNoteReady,resultCode:n.CustomResultCode.NO_ERROR,sessionId:this.wsClient.getSessionId()};this.emit(s.default.SESSION_INIT_BUILT,t)}},t.prototype._handleModifiers=function(e){var t=this;this.modifiers.status=1,this.modifiers.startVersion=e.startVersion,this.modifiers.endVersion=e.endVersion,this.modifiers.modifiers=[],o.underscoreInst.each(e.modifiers,function(e){var n={userId:e.userId};t.modifiers.modifiers.push(n)}),this._clearRetryQueueByAction(n.CmdNames.NONDATACMD_GETMODIFIERS),this.emit(s.default.NONDATACMD_MODIFIERS_RESULT,this.modifiers)},t.prototype._clearRetryQueueByAction=function(e){this.retriableCmdsQueue=o.underscoreInst.reject(this.retriableCmdsQueue,function(t){return t.nondataCmds[0].action===e&&(o.loggerInst.log("remove cmd from retryQueue by actionName:",e),!0)})||[]},t.prototype._removeFromRetryQueue=function(e){this.retriableCmdsQueue=o.underscoreInst.reject(this.retriableCmdsQueue,function(t){return t.nondataCmds[0].cmdId===e&&(o.loggerInst.log("remove cmd from retryQueue:",e),!0)})||[]},t.prototype._handleNoteSave=function(e){o.loggerInst.log("SaveNotification:",e)},t}(r.YEvent);t.NonDataCmdHandler=l}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(57),n(48)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){function t(t){var n=e.call(this)||this;return n.coreEditor=t,n.executedNotOwnCmdQueue=[],n}return a(t,e),t.prototype.destroy=function(){this.removeAllListeners(null)},t.prototype.applyCollabRedoUndo=function(e,t){var n,o=t.collabProperties.cmdJSON,i=o.isCollabUndo,r=o.isCollabRedo;return i?(t.collabProperties.isCollabUndo=!0,t.collabProperties.isCollabRedo=!1):r&&(t.collabProperties.isCollabUndo=!1,t.collabProperties.isCollabRedo=!0),(n=this.coreEditor.createDataCommand(e,t))&&(n.isOriginalCmd=!0,this.coreEditor.applyCollabCmdRedoUndo(n)),n},t.prototype.pushNotOwnExecCmd=function(e){this.executedNotOwnCmdQueue.push(e)},t.prototype.ValidateLocalRedoUndo=function(e){var t,o=!0,i=!1;return e.isCollabUndo?t=this.lastValidUndoCmd:e.isCollabRedo&&(t=this.lastValidRedoCmd),o&&((o=!this._isConflicted(e.getAffectedBlockIds(),e.getCmdFinalNoteVersion()))||(i=!0)),o&&t&&t.cmdId===e.cmdId&&(o=!1,n.loggerInst.warn("skip duplicated redo/undo command")),o?e.isCollabRedo?(this.lastValidRedoCmd=e,this.lastValidUndoCmd=null):e.isCollabUndo&&(this.lastValidUndoCmd=e,this.lastValidRedoCmd=null):(n.loggerInst.warn("Skip invalid Redo/Undo"),i&&(n.loggerInst.warn("Drop invalid Redo/Undo"),e.isCollabRedo?this.coreEditor.dropRedoCmd():e.isCollabUndo&&this.coreEditor.dropUndoCmds(null,null,null))),o},t.prototype.ValidateCollabRedoUndo=function(e,t){return!this._isConflicted(e,t)},t.prototype._isConflicted=function(e,t){var o,i,r=this,a=!1;return(i=(i=n.underscoreInst.filter(this.executedNotOwnCmdQueue,function(e){return e.getCmdFinalNoteVersion()>t}))||[]).length>0&&n.underscoreInst.some(i,function(t){if(r._isNoteRangeOverlap(e,t.getAffectedBlockIds()))return a=!0,o=t.getCollabProps(),n.loggerInst.log("Conflict: data has been edited by "+o.ownerName),!0}),a},t.prototype._isNoteRangeOverlap=function(e,t){var o=!1;return e&&e.length>0&&t&&t.length>0&&n.underscoreInst.some(e,function(e){return n.underscoreInst.some(t,function(t){return e===t&&(o=!0),o}),o}),o},t}(o.YEvent);t.RedoUndoHandler=i}.apply(t,o))||(e.exports=i)},function(e,t,n){(function(o){var i,r,a,s=this&&this.__extends||(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});i=[n,t,n(94),n(57),n(168),n(48),n(85)],void 0===(r=function(e,t,i,r,a,l,c){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var d,u="buildVersion",h="collabId",p="nickname",g="portraitUrl",f="sessionId",m="sessionType",y="userId";!function(e){e[e.normal=0]="normal",e[e.readonly=1]="readonly",e[e.owner=2]="owner"}(d||(d={}));var _=function(e){function t(t){var i=e.call(this)||this;"undefined"==typeof window&&void 0!==o&&(o.WebSocket=n(311).w3cwebsocket);return i.collabPropsHandler=t,i}return s(t,e),t.prototype.connect=function(e){var t,n=e.useWSS?"wss":"ws";if("undefined"==typeof WebSocket)throw new Error("There is NO WebSocket type in Context.");if(null==e.collabServer)throw new Error("Param of options.collabServer should not be null");if(null==e.shareKey)throw new Error("Param of options.shareKey should not be null");if(null==e.nickname)throw new Error("Param of options.nickname should not be null");if(null==e.portraitUrl)throw new Error("Param of options.portraitUrl should not be null");if(null==e.userId)throw new Error("Param of options.userId should not be null");if(null==e.sessionId)throw new Error("Param of options.sessionId should not be null");if(null==e.sessionType)throw new Error("Param of options.sessionType should not be null");if(null==e.buildVersion)throw new Error("Param of options.buildVersion should not be null");t=n+"://"+e.collabServer+"?"+h+"="+e.shareKey+"&"+p+"="+e.nickname+"&"+g+"="+e.portraitUrl+"&"+y+"="+e.userId+"&"+m+"="+e.sessionType+"&"+f+"="+e.sessionId+"&"+u+"="+e.buildVersion,this.sessionOptions=e,r.loggerInst.log("Connect to",t),this.wsInst=new WebSocket(t),this.wsInst.onopen=this._onOpen.bind(this),this.wsInst.onclose=this._onClose.bind(this),this.wsInst.onmessage=this._onMessage.bind(this),this.wsInst.onerror=this._onError.bind(this)},t.prototype.getSessionId=function(){return this.sessionOptions.sessionId},t.prototype.getNickname=function(){return this.sessionOptions.nickname},t.prototype.getPortraitUrl=function(){return this.sessionOptions.portraitUrl},t.prototype.getUserId=function(){return this.sessionOptions.userId},t.prototype.getCollabId=function(){return this.sessionOptions.shareKey},t.prototype.isReadOnlySession=function(){return this.sessionOptions.sessionType===d.readonly},t.prototype.isOpened=function(){return null!=this.wsInst&&this.wsInst.readyState===this.wsInst.OPEN},t.prototype.send=function(e){var t,n=i.CustomResultCode.NO_ERROR;return t=2*e.length/1024,a.Utils.isMessageTooLarge(t)?n=i.WSCustomCode.MESSAGE_TOO_BIG:this.wsInst&&this.wsInst.readyState===WebSocket.OPEN?(r.loggerInst.log("sending message:",e),this.wsInst.send(e)):n=i.WSCustomCode.SESSION_NOT_OPENED,n},t.prototype.close=function(e,t){this.wsInst&&this.wsInst.readyState===WebSocket.OPEN&&(this.wsInst.onopen=null,this.wsInst.onclose=null,this.wsInst.onmessage=null,this.wsInst.onerror=null,this.wsInst.close(e,t),e!==i.WSCustomCode.CLOSED_BY_HOST&&this.emit(c.default.WS_CLOSED,this._assembleSessionError(e,e)))},t.prototype.sendDataCmdErrorCode=function(e){this.send(e.toString())},t.prototype._onOpen=function(e){r.loggerInst.log("Connection is opened.");var t={resultCode:i.CustomResultCode.NO_ERROR};this.emit(c.default.WS_OPENED,t)},t.prototype._onClose=function(e){r.loggerInst.log("Connection is closed."),this.emit(c.default.WS_CLOSED,this._assembleSessionError(e.code,parseInt(e.reason,10)))},t.prototype._onMessage=function(e){r.loggerInst.log("Received Message in WSClient:",e.data);try{if(null!=e.data&&""!==e.data){var t=JSON.parse(e.data),n=this.collabPropsHandler.buildCollabProperties(t);n.rawWSMessage=e.data;var o={collabCmdsJSON:t.collabCmds,collabProps:n,resultCode:i.CustomResultCode.NO_ERROR};this.emit(c.default.WS_MESSAGE,o)}}catch(e){r.loggerInst.error("Exception in WebSocketClient._onMessage:",e)}},t.prototype._onError=function(e){r.loggerInst.log("Caught Error:",e)},t.prototype._assembleSessionError=function(e,t){var n;switch(r.underscoreInst.isNaN(t)&&(t=1006===e?i.WSCustomCode.COLLAB_SERVER_UNREACHABLE:1005===e?i.WSCustomCode.COLLAB_SERVER_SHUTDOWN:1001===e?i.WSCustomCode.COLLAB_SESSION_CLOSED:e),t){case 2e3:n="连接总数超过上限";break;case 2001:n="单个文件连接总数超过上限";break;case 2002:n="重复的session链接";break;case 2003:n="所有者链接超过上限";break;case 3e3:n="转发命令失败";break;case 3001:n="添加链接失败";break;case 3003:n="命令转发进程无响应";break;case 3004:n="创建链接失败";break;case 3005:n="创建命令转发进程失败";break;case 3006:n="广播命令失败";break;case 3007:n="初始化链接失败";break;case 3008:n="未转发命令总数超上限";break;case 4001:n="等待命令返回超时";break;case 4002:n="发送命令失败";break;case 8e3:n="笔记长时间无操作";break;case 9e3:n="链接协同服务器失败";break;case 9003:n="协同服务器被强制关闭";break;case 9004:n="协同链接异常关闭，请检测session是否初始化成功";break;case 9100:n="当前编辑器版本太低";break;case 9101:n="链接被主动强制关闭";break;case 9102:n="协同命令执行失败";break;case 9103:n="重连次数超限";break;default:n="未知错误"}return{code:e,customCode:t,reason:n,resultCode:e,shareKey:this.sessionOptions.shareKey}},t}(l.YEvent);t.WebSocketClient=_}.apply(t,i))||(e.exports=r)}).call(this,n(60))},function(e,t,n){var o=function(){return this}(),i=o.WebSocket||o.MozWebSocket,r=n(312);function a(e,t){return t?new i(e,t):new i(e)}i&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(e){Object.defineProperty(a,e,{get:function(){return i[e]}})}),e.exports={w3cwebsocket:i?a:null,version:r}},function(e,t,n){e.exports=n(313).version},function(e){e.exports={_args:[["websocket@1.0.28","C:\\Users\\louluya\\Desktop\\新建文件夹 (2)\\pc-web-mac\\bulbeditor"]],_from:"websocket@1.0.28",_id:"websocket@1.0.28",_inBundle:!1,_integrity:"sha512-00y/20/80P7H4bCYkzuuvvfDvh+dgtXi5kzDf3UcZwN6boTYaKvsrtZ5lIYm1Gsg48siMErd9M4zjSYfYFHTrA==",_location:"/websocket",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"websocket@1.0.28",name:"websocket",escapedName:"websocket",rawSpec:"1.0.28",saveSpec:null,fetchSpec:"1.0.28"},_requiredBy:["/","/ycollablib"],_resolved:"https://registry.npmjs.org/websocket/-/websocket-1.0.28.tgz",_spec:"1.0.28",_where:"C:\\Users\\louluya\\Desktop\\新建文件夹 (2)\\pc-web-mac\\bulbeditor",author:{name:"Brian McKelvey",email:"theturtle32@gmail.com",url:"https://github.com/theturtle32"},browser:"lib/browser.js",bugs:{url:"https://github.com/theturtle32/WebSocket-Node/issues"},config:{verbose:!1},contributors:[{name:"Iñaki Baz Castillo",email:"ibc@aliax.net",url:"http://dev.sipdoc.net"}],dependencies:{debug:"^2.2.0",nan:"^2.11.0","typedarray-to-buffer":"^3.1.5",yaeti:"^0.0.6"},description:"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.",devDependencies:{"buffer-equal":"^1.0.0",faucet:"^0.0.1",gulp:"git+https://github.com/gulpjs/gulp.git#4.0","gulp-jshint":"^2.0.4",jshint:"^2.0.0","jshint-stylish":"^2.2.1",tape:"^4.9.1"},directories:{lib:"./lib"},engines:{node:">=0.10.0"},homepage:"https://github.com/theturtle32/WebSocket-Node",keywords:["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],license:"Apache-2.0",main:"index",name:"websocket",repository:{type:"git",url:"git+https://github.com/theturtle32/WebSocket-Node.git"},scripts:{gulp:"gulp",install:"(node-gyp rebuild 2> builderror.log) || (exit 0)",test:"faucet test/unit"},version:"1.0.28"}},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(6),n(24),n(19),n(35),n(9),n(95),n(13),n(1),n(125)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p){"use strict";return function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.currentBackground=i.DEFAULT_BACKGROUND,t}return a(t,e),t.prototype.canUndo=function(){return this.controller.canUndo()},t.prototype.canRedo=function(){return this.controller.canRedo()},t.prototype.clearHighlight=function(){this.note&&this.note.highlight([""]),this.note.clearHighlight()},t.prototype.countWords=function(e){var t=this.getNoteRange();return this.note.countWords(t,e)},t.prototype.execCommandByToolbar=function(e,t){var n,o,i=this.getNoteRange(),r=this.getTableOnCellEdit(i);r&&(n=this.noteView.getBlockViewByBlock(r))&&n.editCellFromToolbar&&(o=n.editCellFromToolbar(e,t)),o||("undo"===e?this.undo():"redo"===e?this.redo():this.execCommand(e,t))},t.prototype.execCommand=function(e,t){return this.controller.execCommand(e,t)},t.prototype.focus=function(){this.noteView.$el.focus()},t.prototype.getController=function(){return this.controller},t.prototype.getHtmlContent=function(e,t,n){var o;if(null!=this.getHtmlContentTimer&&(clearTimeout(this.getHtmlContentTimer),this.getHtmlContentTimer=null),!this.contentLoading||null==t)return o=this.note.toHtml(null,!0===e),null!=t&&t({status:1,content:o}),o;n&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.getHtmlContentTimer=setTimeout(this.getHtmlContent.bind(this,e,t,n),100)},t.prototype.getNoteRange=function(){return this.controller.getNoteRange()},t.prototype.getPlainContent=function(){return this.note.toPlain()},t.prototype.getSchemaVersion=function(){return this.note.getSchemaVersion()},t.prototype.getXmlContent=function(e,t){var n;if(null!=this.getXmlContentTimer&&(clearTimeout(this.getXmlContentTimer),this.getXmlContentTimer=null),!this.contentLoading||null==e)return n=this.note.toXml(),null!=e&&e({status:1,content:n}),n;t&&(this.isReadOnly()||this.makeReadOnly(!0),this.noteView.removeNote()),this.getXmlContentTimer=setTimeout(this.getXmlContent.bind(this,e,t),100)},t.prototype.hasHandWriteBlock=function(){return this.note.hasHandWriteBlock()},t.prototype.highlight=function(e,t){this.note&&this.note.highlight(e,t)},t.prototype.insertImage=function(e){return this.controller.insertImage(e)},t.prototype.insertAttachment=function(e){return this.controller.insertAttachment(e)},t.prototype.isNotSetContent=function(){return this.notSetContent},t.prototype.isReadOnly=function(){return this.controller.isReadOnly()},t.prototype.nextHighlight=function(){this.note&&this.note.nextHighlight()},t.prototype.preHighlight=function(){this.note&&this.note.preHighlight()},t.prototype.getNoteContentStatus=function(){return!!this.note&&this.note.getContentStatus()},t.prototype.querySelectionInlineStyle=function(e){return this.controller.querySelectionInlineStyle(e)},t.prototype.querySelectionBlockStyle=function(e){return this.controller.querySelectionBlockStyle(e)},t.prototype.querySelectionInlineStyles=function(){return this.controller.querySelectionInlineStyles()},t.prototype.querySelectionBlockStyles=function(){return this.controller.querySelectionBlockStyles()},t.prototype.redo=function(){return this.controller.redo()},t.prototype.render=function(){null!=this.noteProps&&(this.noteProps.sessionType?(this.noteProps.sessionType=parseInt(this.noteProps.sessionType,10),1===this.noteProps.sessionType?this.setReadOnly(!0):this.setReadOnly(!1)):this.noteProps.readOnly?this.setReadOnly(!0):this.setReadOnly(!1))},t.prototype.rerenderNoteView=function(){this.noteView.render()},t.prototype.resetEditingInlineStates=function(){return this.controller.resetEditingInlineStates()},t.prototype.setEditingInlineStyles=function(e){return this.controller.setEditingInlineStyles(e)},t.prototype.reset=function(){var e=this.getNoteViewWrapper();this.controller&&this.controller.reset(),this.noteView&&this.noteView.reset(),this.note&&this.note.reset(),this.note.removeEntityCache(),p.reset(),this.notSetContent=!0,e&&this.noteView.isInPageMode()&&e.find(".page-break").remove(),null!=this.getHtmlContentTimer&&(clearTimeout(this.getHtmlContentTimer),this.getHtmlContentTimer=null),null!=this.getXmlContentTimer&&(clearTimeout(this.getXmlContentTimer),this.getXmlContentTimer=null),this.contentChanged=!1,this.contentLoading=!1,this.currentBackground=i.DEFAULT_BACKGROUND},t.prototype.resetFont=function(){r.resetCssRules(),s.reset(),this.noteView.reRenderTextBlockView()},t.prototype.selectAll=function(){return this.controller.selectAll()},t.prototype.setAllBackgrounds=function(e,t){this.trigger("set-all-backgrounds",n.clone(e),t),this.currentBackground=i.DEFAULT_BACKGROUND},t.prototype.setBackground=function(e){var t=this.currentBackground;this.updateContainerBackground(e)&&this.trigger("set-background",t,e)},t.prototype.setFont=function(e,t){if(e||t){var n,o={};e&&(n=s.getDefault("font-size"),o["font-size"]=function(t){var o=t["font-size"];if(null!=o)return Math.round(e*o/n)+"px"},r.setCssRules(o)),t&&(s.setDefault("font-family",t),r.resetInlineStyleDefaultForHtml("font-family")),this.noteView.reRenderTextBlockView()}},t.prototype.setNoteRange=function(e){this.controller.noteSelection.setRange(e)},t.prototype.setPasteAsText=function(e){this.controller.setPasteAsText(e)},t.prototype.setEntity=function(e,t){var n=this;this.controller.setEntity(e,t),setTimeout(function(){n.trigger("yne-content-change")})},t.prototype.setReadOnly=function(e){e=!!e,this.noteProps.isReadOnly=e,this.makeReadOnly(e)},t.prototype.setDragProhibited=function(e){e=!!e,this.noteProps.isDragProhibited=e,this.controller.setDragProhibited(e)},t.prototype.setCopyProhibited=function(e){e=!!e,this.noteProps.isCopyProhibited=e,this.controller.setCopyProhibited(e)},t.prototype.setViewMode=function(e,t,n){e=c.IS_PC?d.parseToNumber(e,1):d.parseToNumber(e,0),this.updateEditorProps({viewMode:e}),c.IS_PC&&(1===e?$(this.getNoteViewWrapper()).toggleClass("read-mode",!0):$(this.getNoteViewWrapper()).toggleClass("read-mode",!1)),this.noteView.setViewMode(e,!this.isNotSetContent()),!0===t&&this.trigger("view-mode-change",e),!0===n&&this.trigger("yne-view-mode-change",e),this.controller.resizeSpecialBlock()},t.prototype.undo=function(){return this.controller.undo()},t.prototype.updateBackground=function(e){var t=this.currentBackground;this.updateContainerBackground(e)&&(t||(t=i.DEFAULT_BACKGROUND),this.trigger("yne-background-changed",t,e))},t.prototype.updateEditorProps=function(e){null==this.editorProps&&(this.editorProps={}),n.extend(this.editorProps,e),n.extend(this.options,e)},t.prototype.updateNoteViewVisibility=function(e){e?this.noteView.$el.css("visibility","visible"):this.noteView.$el.css("visibility","hidden")},t.prototype.initialize=function(e){var t=this;this.clientId=o.newGUID(),this.notSetContent=!0,this.bindEventsForController(),this.on("background-failed-update",function(e,n){null!=n&&t.updateContainerBackground(n),0===e&&t.trigger("yne-background-failed-update",e)}),this.contentChanged=!1,this.contentLoading=!1},t.prototype.makeReadOnly=function(e){this.controller.setReadOnly(e),c.IS_PC?e?this.toolbar.toggleToolbar(!1):this.toolbar.toggleToolbar(!0):e?this.toolbar.disable():this.toolbar.enable()},t.prototype.bindEventsForController=function(){var e=this,t=this.controller;t.on("command-exec",function(t,n){t&&t.name?t&&t.effected?(e.contentChanged=!0,e.trigger("yne-content-change")):h.warn("The command has no effected",t):h.error("The command is not valid",t)}),l.bubble(["redo-stack-change","undo-stack-change","selectstart","mouse-down","command-exec","esc","yne-clipboard-status","yne-clipboard-error","yne-get-clipboard","yne-clipboard-set","color-picker-show","yne-user-action-collection","cell-edit-view-enter","cell-edit-view-exit","cell-edit-view-history-change"],t,this)},t.prototype.updateContentSetProgress=function(e){!0===this.contentLoading&&(e.isAsync&&this.progressTracker.updateContentSetProgress(e),n.isNumber(e.percent)&&e.percent>=1&&(this.isLegacyHost()&&!this.noteProps.isReadOnly&&this.makeReadOnly(!1),this.contentLoading=!1))},t.prototype.getTableOnCellEdit=function(e){var t;if(e&&e.isSingleTableSelected())return(t=e.getStartBlockRange())&&t.isOnCellEdit&&t.isOnCellEdit()?t.block:void 0},t}(u)}.apply(t,o))||(e.exports=i)},,function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14),a=n(28),s=n(77),l=[["r","g","b"],["h","s","v"],["h","s","l"]],c=[[255,255,255],[360,100,100],[360,100,100]];return t.View.extend({className:"color-picker",name:"colorpicker",label:"选色器",templateName:"color_picker",events:{mousedown:"onMouseDown","mousedown .color-picker-panel":"onPanelMouseDown","mousedown .color-picker-panel-board":"onBoardMousedown","mousedown .color-picker-panel-alpha":"onAlphaMousedown","mousedown .color-picker-panel-ribbon":"onRibbonMousedown","click .color-picker-panel-params-lable-number":"onParamsLabelClick"},initialize:function(e){this.editor=e.editor,this.render(),this.hidePicker(),this.mode=0,o.bindAll(this,"onDocumentMouseDown","onBoardMousedown","onBoardDrag","onBoardDragEnd","onAlphaMousedown","onAlphaDrag","onAlphaDragEnd","onRibbonMousedown","onRibbonDrag","onRibbonDragEnd","onParamsLabelClick"),this.on("color-picker-show",this.showPicker),i(document).on("mousedown",this.onDocumentMouseDown)},render:function(){var e,t=this.$el;e=r.render("common",this.templateName),t.html(e),this.panel=t.find(".color-picker-panel")[0],this.board=t.find(".color-picker-panel-board")[0],this.boardBg=i(this.board).find(".color-picker-panel-board-hsv"),this.ribbon=t.find(".color-picker-panel-ribbon")[0],this.alpha=t.find(".color-picker-panel-alpha")[0],this.preview=t.find(".color-picker-panel-preview")[0],this.inputs=t.find(".color-picker-panel-params-input"),this.inputHex=i(this.inputs).find("input")[0],this.inputR=i(this.inputs).find("input")[1],this.inputG=i(this.inputs).find("input")[2],this.inputB=i(this.inputs).find("input")[3],this.inputA=i(this.inputs).find("input")[4],this.labelR=t.find(".color-picker-panel-params-lable-number")[0],this.labelG=t.find(".color-picker-panel-params-lable-number")[1],this.labelB=t.find(".color-picker-panel-params-lable-number")[2],this.bindEvents()},bindEvents:function(){o.bindAll(this,"onHexChange","onRedChange","onGreenChange","onBlueChange","onAlphaChange","updateInputHex","updateInputR","updateInputG","updateInputB","updateInputA","onKeyDown","onLastInputKeyDown"),i(this.inputHex).on("input propertychange",this.onHexChange),i(this.inputHex).on("blur",this.updateInputHex),i(this.inputHex).on("keydown",this.onKeyDown),i(this.inputR).on("input propertychange",this.onRedChange),i(this.inputR).on("blur",this.updateInputR),i(this.inputR).on("keydown",this.onKeyDown),i(this.inputG).on("input propertychange",this.onGreenChange),i(this.inputG).on("blur",this.updateInputG),i(this.inputG).on("keydown",this.onKeyDown),i(this.inputB).on("input propertychange",this.onBlueChange),i(this.inputB).on("blur",this.updateInputB),i(this.inputB).on("keydown",this.onKeyDown),i(this.inputA).on("input propertychange",this.onAlphaChange),i(this.inputA).on("blur",this.updateInputA),i(this.inputA).on("keydown",this.onLastInputKeyDown)},showPicker:function(e){var t=this.solidColor(e.selectedValue);t.isValid()||(t=this.solidColor(e.value)),t.isValid()||(t=a("#393939")),this.color=t,this.mode=0,this.item=e,this.$el.show(),this.updateUI()},solidColor:function(e){var t=a(e),n=t.toRgb();return 0===n.r&&0===n.g&&0===n.b&&0===n.a&&t.setAlpha(1),t},hidePicker:function(){var e;this.removeWindowListeners(),this.$el.hide(),this.item&&(e=this.color.toRgbString(),this.item.changeValue(e),this.item=null)},removeWindowListeners:function(){i(window).off("mousemove",this.onBoardDrag),i(window).off("mouseup",this.onBoardDragEnd),i(window).off("mousemove",this.onAlphaDrag),i(window).off("mouseup",this.onAlphaDragEnd),i(window).off("mousemove",this.onRibbonDrag),i(window).off("mouseup",this.onRibbonDragEnd)},onDocumentMouseDown:function(){this.hidePicker()},onMouseDown:function(e){this.hidePicker(),e.stopPropagation(),e.preventDefault()},onPanelMouseDown:function(e){e.stopPropagation()},onBoardMousedown:function(e){this.onBoardDrag(e),this.removeWindowListeners(),i(window).on("mousemove",this.onBoardDrag),i(window).on("mouseup",this.onBoardDragEnd)},onBoardDrag:function(e){var t=e.clientX,n=e.clientY;e.preventDefault(),this.pointMoveTo({x:t,y:n})},onBoardDragEnd:function(e){this.onBoardDrag(e),this.removeWindowListeners()},pointMoveTo:function(e){var t,n,o=this.board.getBoundingClientRect(),r=e.x-o.left,s=e.y-o.top,l=this.color.toHsv(),c=i(this.boardBg).css("background-color"),d=l.h;(t=a(c)).isValid()&&(d=t.toHsv().h),r=Math.max(0,r),r=Math.min(r,200),s=Math.max(0,s),s=Math.min(s,150),(n=a.fromRatio({h:d/360,s:r/200,v:1-s/150,a:l.a})).isValid()&&(this.color=n,this.updateBoardPoint(r-4,s-4),this.updatePreview(),this.updateAlpha(),this.updateInputHex(),this.updateInputG(),this.updateInputB(),this.updateInputR())},onAlphaMousedown:function(e){this.onAlphaDrag(e),this.removeWindowListeners(),i(window).on("mousemove",this.onAlphaDrag),i(window).on("mouseup",this.onAlphaDragEnd)},onAlphaDrag:function(e){var t=e.clientX,n=e.clientY;e.preventDefault(),this.alphaMoveTo({x:t,y:n})},onAlphaDragEnd:function(e){this.onAlphaDrag(e),this.removeWindowListeners()},alphaMoveTo:function(e){var t,n=this.alpha.getBoundingClientRect(),o=n.width,i=e.x-n.left;i=Math.max(0,i),t=(i=Math.min(i,o))/o,this.color.setAlpha(t),this.updateAlpha(100*t),this.updatePreview(),this.updateInputA()},onRibbonMousedown:function(e){this.onRibbonDrag(e),this.removeWindowListeners(),i(window).on("mousemove",this.onRibbonDrag),i(window).on("mouseup",this.onRibbonDragEnd)},onRibbonDrag:function(e){var t=e.clientX,n=e.clientY;e.preventDefault(),this.ribbonMoveTo({x:t,y:n})},onRibbonDragEnd:function(e){this.onRibbonDrag(e),this.removeWindowListeners()},ribbonMoveTo:function(e){var t,n,o=this.ribbon.getBoundingClientRect(),i=o.width,r=e.x-o.left,s=this.color.toHsv();r=Math.max(0,r),t=(r=Math.min(r,i))/i,(n=a.fromRatio({h:t,s:s.s,v:s.v,a:s.a})).isValid()&&(this.color=n,this.updateRibbon(100*t),this.updateBoardBg(360*t),this.updatePreview(),this.updateAlpha(),this.updateInputHex(),this.updateInputR(),0===this.mode&&(this.updateInputG(),this.updateInputB()))},onHexChange:function(){var e,t=i(this.inputHex).val();t.length>0&&t.length<6&&(t=t.concat("0".repeat(6-t.length))),(e=a(t)).isValid()&&(e.setAlpha(this.color.getAlpha()),this.color=e,this.updateOnHexChange())},updateOnHexChange:function(){this.updateBoardPoint(),this.updateBoardBg(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputR(),this.updateInputG(),this.updateInputB()},onRedChange:function(){var e=i(this.inputR).val(),t=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();e=parseInt(e),o.isNumber(e)&&!o.isNaN(e)&&(e<0||e>c[t][0]||(this.color=1===t?a.fromRatio({h:e/360,s:n.s,v:n.v,a:n.a}):2===t?a.fromRatio({h:e/360,s:s.s,l:s.l,a:s.a}):a({r:e,g:r.g,b:r.b,a:r.a}),this.updateOnRedChange()))},updateOnRedChange:function(){0===this.mode&&this.updateBoardPoint(),this.updateBoardBg(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputHex()},onGreenChange:function(){var e=i(this.inputG).val(),t=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();e=parseInt(e),o.isNumber(e)&&!o.isNaN(e)&&(e<0||e>c[t][1]||(this.color=1===t?a.fromRatio({h:n.h,s:e/100,v:n.v,a:n.a}):2===t?a.fromRatio({h:s.h,s:e/100,l:s.l,a:s.a}):a({r:r.r,g:e,b:r.b,a:r.a}),this.updateOnGreenChange()))},updateOnGreenChange:function(){this.updateBoardPoint(),0===this.mode&&(this.updateBoardBg(),this.updateRibbon()),this.updatePreview(),this.updateAlpha(),this.updateInputHex()},onBlueChange:function(){var e=i(this.inputB).val(),t=this.mode,n=this.color.toHsv(),r=this.color.toRgb(),s=this.color.toHsl();e=parseInt(e),o.isNumber(e)&&!o.isNaN(e)&&(e<0||e>c[t][2]||(this.color=1===t?a.fromRatio({h:n.h,s:n.s,v:e/100,a:n.a}):2===t?a.fromRatio({h:s.h,s:s.s,l:e/100,a:s.a}):a({r:r.r,g:r.g,b:e,a:r.a}),this.updateOnBlueChange()))},updateOnBlueChange:function(){this.updateBoardPoint(),0===this.mode&&(this.updateBoardBg(),this.updateRibbon()),this.updatePreview(),this.updateAlpha(),this.updateInputHex()},onAlphaChange:function(){var e=i(this.inputA).val();e=parseInt(e),o.isNumber(e)&&!o.isNaN(e)&&(e<0||e>100||(this.color.setAlpha(e/100),this.updateOnAlphaChange()))},updateOnAlphaChange:function(){this.updatePreview(),this.updateAlpha()},onParamsLabelClick:function(){var e=this.mode;e+=1,e%=3,this.mode=e,this.updateInputR(),this.updateInputB(),this.updateInputG()},onKeyDown:function(e){s.isMatch("enter",e.keyCode)&&(e.stopPropagation(),e.preventDefault(),this.hidePicker(),this.editor.focus())},onLastInputKeyDown:function(e){(s.isMatch("enter",e.keyCode)||s.isMatch("tab",e.keyCode))&&(e.stopPropagation(),e.preventDefault(),this.hidePicker(),this.editor.focus())},inputValue:function(e,t){var n,o=this.color,i=o.toRgb(),r=o.toHsv(),a=o.toHsl(),s=1;switch(e){case 0:n=i;break;case 1:n=r;break;case 2:n=a;break;default:n=i}return(0===e||1!==t&&2!==t)&&3!==t||(s=100),Math.round(n[l[e][t]]*s)},updateInputHex:function(){var e=this.color;i(this.inputHex).val(e.toHex().toUpperCase())},updateInputR:function(){var e=this.mode;i(this.labelR).text(l[e][0].toUpperCase()),i(this.inputR).val(this.inputValue(e,0))},updateInputG:function(){var e=this.mode;i(this.labelG).text(l[e][1].toUpperCase()),i(this.inputG).val(this.inputValue(e,1))},updateInputB:function(){var e=this.mode;i(this.labelB).text(l[e][2].toUpperCase()),i(this.inputB).val(this.inputValue(e,2))},updateInputA:function(){var e=this.color.getAlpha();i(this.inputA).val(Math.round(100*e))},updateBoardBg:function(e){var t,n=this.color.toHsv(),o=this.boardBg;e>=0&&e<=360||(e=n.h),t=a.fromRatio({h:e/360,s:1,v:1}),o.css("background-color",t.toHexString())},updateBoardPoint:function(e,t){var n=this.color.toHsv(),o=i(this.board).find("span");e>=0&&e<=200||(e=200*n.s-4),t>=0&&t<=150||(t=150*(1-n.v)-4),o.css("left",e+"px"),o.css("top",t+"px")},updatePreview:function(){var e=this.color,t=e.getAlpha(),n=i(this.preview).find("span");n.css("background-color",e.toHexString()),n.css("opacity",t)},updateAlpha:function(e){var t,n=this.color.toRgb(),o=i(this.alpha).find(".color-picker-panel-alpha-bg"),r=i(this.alpha).find("span");e>=0&&e<=100||(e=100*n.a),t="linear-gradient(to right, "+a({r:n.r,g:n.g,b:n.b,a:0}).toRgbString()+", "+a({r:n.r,g:n.g,b:n.b,a:1}).toRgbString()+")",o.css("background",t),r.css("left",e+"%")},updateRibbon:function(e){var t=this.color.toHsv().h,n=i(this.ribbon).find("span");e>=0&&e<=100||(e=Math.round(t/360*100)),n.css("left",e+"%")},updateUI:function(){this.updateBoardBg(),this.updateBoardPoint(),this.updatePreview(),this.updateAlpha(),this.updateRibbon(),this.updateInputHex(),this.updateInputA(),this.updateInputR(),this.updateInputB(),this.updateInputG(),this.updateInputHex()},reset:function(){this.$el.hide()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){"use strict";var o;void 0===(o=function(e){var t=n(14),o=n(20),i=n(0),r=n(77),a=n(9),s=n(1),l=n(228),c=function(){};return o.View.extend({className:"image-title-input-wrapper",name:"ImageTitleInputView",events:{"keydown .image-title-input":"_onKeyDown","paste .image-title-input":"_onPaste","input .image-title-input":"_onInput"},zoom:1,initialize:function(e){this.editor=e.editor,i.bindAll(this,"_onEditStart","_onEditEnd","_onKeyDown","_onExit","_onUpdate","_getPosition","_onPaste","_show","_hide","_onInput","_handlerPlaceholder","_onLockedChange"),this.on("img-title-edit-start",this._onEditStart),this.on("img-title-edit-end",this._onEditEnd),this.on("img-title-edit-focus",this._onFocus),this.on("img-title-edit-exit",this._onExit),this.on("img-title-edit-update",this._onUpdate),this.on("locked-change",this._onLockedChange),this._callback=c},render:function(){var e=t.render("common","image-title-input",{title:""});this.$el.html(e)},_getPosition:function(e){var t=this.editor.getNoteViewWrapper(),n=a.IS_PC?this.editor.getNoteViewFrame():this.editor.noteView.$el,o=n.offset(),i=parseInt(n.css("margin-top"));e.left=e.left-t.offset().left+t.scrollLeft(),e.top=e.top-o.top+i},_show:function(){var e=this._origialNode;this.$el.show(),e&&e.css("color","transparent")},_hide:function(){var e=this._origialNode;e&&(e.css("color",""),e.css("height","auto")),this.$el.hide()},_onEditStart:function(e,n,o,r,a){var s,l=this,d=n();l.getOffset=n,l._getPosition(d),l._callback!==c&&l._onEditEnd(),e||(e=""),s=t.render("common","image-title-input",i.defaults({title:e},d)),l.$el.html(s),l.$input=this.$el.find(".image-title-input"),l.$placeholder=this.$el.find(".image-title-placeholder"),l.$input.on("blur",function(){l._handlerPlaceholder(),l._onEditEnd()}).on("focus",function(){l._handlerPlaceholder(),l.editor.controller.lockBlockById(a)}),l._callback=o||c,l._origialNode=r,l._handlerPlaceholder(),e&&l._show(),l.$placeholder.click(function(){l.$input.focus()})},_onEditEnd:function(e,t){if(this.$input&&this.$input.is(":visible")){var n=this.$input.text();this._callback(n,e,t,this.$el.is(":visible"))}},_onKeyDown:function(e){if(this.$input.is(":visible")&&r.isMatch("enter",e.keyCode)&&i.isFunction(this._onEditEnd))return e.preventDefault(),this._onEditEnd(!0,this.editor.controller.getNextCaretBlockRange()),void this._onExit();(e.ctrlKey||e.metaKey)&&["B","b","U","u","I","i"].forEach(function(t){r.isMatch(t,e.keyCode)&&e.preventDefault()})},_onFocus:function(){var e=this.$input;e&&e.is(":visible")||this._show(),e.focus()},_onExit:function(){this._hide(),this._callback=c},_onUpdate:function(e){var t=e();this.getOffset=e,this._getPosition(t),this.$input.css({left:t.left,top:t.top,width:t.width+"px","min-height":t.height+"px"}),this.$placeholder.css({left:t.left,top:t.top,width:t.width+"px"})},_handlerPlaceholder:function(){this.$input.text()?this.$placeholder.hide():this.$placeholder.show()},setZoom:function(e){this.zoom=e,this.$el.css("zoom",this.zoom)},_transferString:function(e){var t=e;try{t=(t=t.replace(/\r\n/g," ")).replace(/\n/g," ")}catch(e){s.log("replace image title line break failed!")}return t},_onPaste:function(e){var t,n,o=e.originalEvent;e.preventDefault(),o.clipboardData&&o.clipboardData.getData?(t=o.clipboardData.getData("text/plain"),n=this._transferString(t),document.execCommand("insertHTML",!1,n)):window.clipboardData&&window.clipboardData.getData&&(t=window.clipboardData.getData("Text"),l(t))},_onInput:function(){var e=this.$input.height();e!==this._origialNode.height()&&this._origialNode.height(e),this._handlerPlaceholder()},_onLockedChange:function(){this.getOffset&&this._onUpdate(this.getOffset)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14),a=n(77),s=n(9),l=n(2),c=n(62),d=n(17);return t.View.extend({className:"link-view",templateName:"link_view",zoom:1,events:{"click .link-confirm-button":"onConfirmButtonClick","click .link-modify-button":"onModifyButtonClick","click .link-remove-button":"onRemoveButtonClick","keydown .link-input":"onKeyDown",mousedown:"onMouseDown",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave"},initialize:function(e){this.editor=e.editor,this.on("link-menu-show",this.timeoutToShowMenu),this.on("link-menu-hide",this.timeoutToHideMenu),this.bindDocumentEvents(),this.modifyMode=!1,this.on("locked-change",this.recalPosition),i(window).on("resize",this.recalPosition.bind(this))},render:function(){var e,t=this.$el;e=r.render("common",this.templateName,{link:c.safeHref(this.link),isReadOnly:this.editor.isReadOnly()}),t.html(e),this.menuPreviewLink=t.find(".hover-menu-show-link"),this.menuModifyLink=t.find(".hover-menu-modify-link"),this.input=t.find(".link-input"),this.hideModifyMenu()},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},onKeyDown:function(e){e.stopPropagation(),a.isMatch("enter",e.keyCode)&&(e.preventDefault(),this.onConfirmButtonClick())},onDocumentMouseDown:function(){this.fadeOutMenu()},onMouseDown:function(e){e.stopPropagation()},onConfirmButtonClick:function(){var e=this.range,t=c.safeHref(i(this.input).val());t!==this.link?(window.focus(),t&&this.editor.execCommand("comp.InsertLink",{src:t,range:e}),this.fadeOutMenu()):this.fadeOutMenu()},onRemoveButtonClick:function(){var e=this.range;l.isCatalogue(this.block)?this.editor.execCommand("atom.SetCatalogueHref",{range:e,block:this.block,href:null}):this.editor.execCommand("comp.ApplyStyles",{range:e,inlineStyles:{href:"",color:"#393939",underline:!1}}),this.fadeOutMenu()},onModifyButtonClick:function(){this.hidePreviewMenu(),this.showModifyMenu()},showMenu:function(e){var t=e.range.clone(),n=e.linkNode.href;if(l.isCatalogue(e.block)&&(n=e.block.getViewHref()),!this.modifyMode&&n){var o=new RegExp("^note://");n.match(o)||(this.hideTimerId&&(clearTimeout(this.hideTimerId),this.hideTimerId=null),this.link&&this.hideMenu(),this.linkNode=e.linkNode,this.link=n,this.block=e.block,this.blockId=e.block.getId(),this.range=new d({startRange:t,endRange:t}),this.render(),this.showPreviewMenu())}},recalPosition:function(){this.link&&this.modifyMode&&this.setPosition()},setPosition:function(){var e,t,n,r,a,l,c,d,u,h,p=this.linkNode,g=this.editor.noteView,f=this.editor.getNoteViewWrapper(),m=this.editor.getNoteViewWrapper(),y=s.IS_PC?this.editor.getNoteViewFrame().offset():this.editor.noteView.$el.offset();(e=i(p).offset()).left=e.left-m.offset().left+m.scrollLeft()/this.zoom,e.top=e.top-y.top,t=e.top+i(p).outerHeight(),n=e.left+i(p).outerWidth()/2,l=e.left,h=this.$el.find(".hover-menu-before"),a=i(h[0]).outerWidth()/2,c=t+i(h[0]).outerHeight(),n-l-a<15&&(l=n-15-a),d=this.modifyMode?this.$el.find(".hover-menu-modify-link .hover-menu-body").outerWidth():this.$el.find(".hover-menu-show-link .hover-menu-body").outerWidth(),u=g.$el.outerWidth()-30,f.hasClass("read-mode")&&(u+=parseInt(f.find(".note-view-frame").css("margin-left"))),l+d>u&&(l=u-d),r=n-l-a,i(p).outerHeight()>parseFloat(i(p).css("line-height"))&&(l=e.left-15-a,r=15),this.$el.css("left",l),this.$el.css("top",c),o.each(h,function(e){i(e).css("left",r)})},setZoom:function(e){this.zoom=e,this.$el.css("zoom",this.zoom)},showPreviewMenu:function(){var e=this.menuPreviewLink;this.setPosition(),i(e).show()},hidePreviewMenu:function(){var e=this.menuPreviewLink;i(e).hide()},fadeOutPreviewMenu:function(){var e=this.menuPreviewLink;i(e).fadeOut()},showModifyMenu:function(){var e=this.menuModifyLink;this.modifyMode=!0,this.editor.controller.lockBlockById(this.blockId),this.setPosition(),i(e).show()},hideModifyMenu:function(){var e=this.menuModifyLink;i(e).hide(),this.modifyMode=!1},fadeOutModifyMenu:function(){var e=this.menuModifyLink;i(e).fadeOut(),this.modifyMode=!1},hideMenu:function(){this.stay||(this.hideModifyMenu(),this.hidePreviewMenu(),this.link=null)},fadeOutMenu:function(){this.fadeOutModifyMenu(),this.fadeOutPreviewMenu(),this.link=null,this.range=null,this.linkNode=null,this.hideTimerId=null,this.blockId=null,this.block=null,this.showTimerId&&(clearTimeout(this.showTimerId),this.showTimerId=null)},onMouseEnter:function(e){e.stopPropagation(),this.hideTimerId&&(clearTimeout(this.hideTimerId),this.hideTimerId=null)},onMouseLeave:function(){this.trigger("link-menu-hide")},timeoutToHideMenu:function(){var e=this;e.modifyMode||e.hideTimerId||(e.hideTimerId=setTimeout(function(){e.fadeOutMenu()},100))},timeoutToShowMenu:function(e){var t=this;t.showTimerId||(t.showTimerId=setTimeout(function(){t.showMenu(e)},500))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(320),n(321),n(322),n(323),n(324),n(325),n(326),n(327),n(328),n(329),n(330),n(331),n(332),n(333),n(334),n(335),n(336),n(337),n(338),n(340),n(341),n(342),n(343),n(344),n(345),n(348),n(349),n(350),n(351),n(352),n(353),n(354),n(355)],void 0===(i=function(e,t,n,o,i,r,a,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k,C,w,A,S,N,T,M,x,E,D,L,O){"use strict";return[O,E,c,D,c,i,n,T,x,M,c,r,S,k,C,w,c,b,c,l,s,a,c,v,A,c,L,c,N,o,c,I,m,f,u,c,p,g,d,c,h,y,_]}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(9),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=e.target,o=n.ownerDocument;t.isRangeCollapsed?this.isDisabled=!0:(this.targetEl=n,this.doc=o)},t.prototype.selectAction=function(){var e,t,o,i=this.doc,r=this.editor,a=this.targetEl;if((e=r.getNoteRange()).isSingleTableSelected()&&(t=e.getStartBlockRange().block,a=r.getController().noteView.getBlockViewByBlock(t).getHiddenInputView()),a.focus(),n.IS_MAC)r.callMacNativeApi("menuCopy");else{try{o=i.execCommand("copy")}catch(e){o=!1}o||r.trigger("yne-clipboard-error","copy",function(){r.focus()})}},t.prototype.reset=function(){e.prototype.reset.call(this),this.doc=null,this.targetEl=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="copy",this.label="复制",this.key="mod+c"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!t.isImgAttachBlock&&!t.tableInfo},t.prototype.selectAction=function(){var e=this.editor,t=this.editor.countWords(!0),n=t.count,o=t.isSelected,i=t.detail;e.trigger("yne-show-words",n,o,i)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="countWords",this.label="统计字数"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(9),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=e.target,o=n.ownerDocument;t.isRangeCollapsed?this.isDisabled=!0:(this.doc=o,this.targetEl=n)},t.prototype.selectAction=function(){var e,t,o,i=this.doc,r=this.editor,a=this.targetEl;if((e=r.getNoteRange()).isSingleTableSelected()&&(t=e.getStartBlockRange().block,a=r.getController().noteView.getBlockViewByBlock(t).getHiddenInputView()),a.focus(),n.IS_MAC)r.callMacNativeApi("menuCut");else{try{o=i.execCommand("cut")}catch(e){o=!1}o||r.trigger("yne-clipboard-error","cut",function(){r.focus()})}},t.prototype.reset=function(){e.prototype.reset.call(this),this.doc=null,this.targetEl=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="cut",this.label="剪切",this.key="mod+x"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return this.block=t.imgBlock,!!t.imgBlock},t.prototype.selectAction=function(){this.block&&this.block.trigger("edit-image-title")},t.prototype.reset=function(){e.prototype.reset.call(this),this.block=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="imageTitle",this.label="标题"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(229),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this.editor.getNoteProps(),o=n&&!!n.disableOCR;return this.imgBlock=t.imgBlock,!o&&null!=this.imgBlock},t.prototype.selectAction=function(){if(null!=this.imgBlock){var e=n(this.imgBlock);this.editor.imageOCR(e)}},t.prototype.reset=function(){e.prototype.reset.call(this),this.imgBlock=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="recogOCR",this.label="文本识别OCR"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this.editor.canRemoveFormat()&&!t.isImgAttachBlock&&!t.tableInfo;return this.isDisabled=!n,!t.tableInfo&&!t.isImgAttachBlock},t.prototype.selectAction=function(){this.editor.execCommand("comp.RemoveFormat",{inlineStyles:this.editor.getDefaultStyle()})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="removeFormat",this.label="清除格式"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!t.isImgAttachBlock&&!t.tableInfo},t.prototype.selectAction=function(){this.editor.selectAll()},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="selectAll",this.label="全选"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){},t.prototype.selectAction=function(){},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="split",this.label="---",this.type=n.TYPE.SPLIT},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteTableRowCol",{describe:{col:!0}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="deleteCol",this.label="删除整列"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteTableRowCol",{describe:{row:!0}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="deleteRow",this.label="删除整行"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteNoteRange",{isTableDelete:!0})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="deleteTable",this.label="删除整个表格"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(73),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{col:n.LEFT}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="insertColLeft",this.label="在左侧插入列"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(73),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{col:n.RIGHT}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="insertColRight",this.label="在右侧插入列"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(73),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{row:n.DOWN}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="insertRowDown",this.label="在下方插入行"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(73),n(10)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo},t.prototype.selectAction=function(){this.editor.execCommand("comp.InsertTableRowCol",{describe:{row:n.UP}})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="insertRowUp",this.label="在上方插入行"},t}(o))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.isCodeBlock},t.prototype.selectAction=function(){this.editor.execCommand("comp.DeleteNoteRange",{isCodeDelete:!0})},t.prototype.reset=function(){e.prototype.reset.call(this)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="deleteCode",this.label="删除代码块"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this.editor;this.noteRange=n.getNoteRange();var o=this.noteRange.getStartBlockRange().block;return this.noteView=n.getController().noteView,this.blockView=this.noteView.getBlockViewByBlock(o),!!t.isCodeBlock},t.prototype.selectAction=function(){this.blockView.onSetRange(this.noteRange.getStartBlockRange())},t.prototype.reset=function(){e.prototype.reset.call(this),this.noteRange=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="selectCode",this.label="选中代码块"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return!!t.tableInfo&&(t.tableInfo.onlyMergePointAndCell?(this.label="拆分单元格",!0):!1===t.tableInfo.onlyOneCell&&(this.label="合并单元格",!0))},t.prototype.selectAction=function(){this.editor.execCommand("comp.ToggleMergeTableCell",{})},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="mergeCell",this.label="合并单元格"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(339),n(0)],void 0===(i=function(e,t,n,o){"use strict";return function(){var e={left:"左浮动",none:"清除浮动",right:"右浮动"};return o.map(["left","right","none"],function(t){return new n({float:t,label:e[t],name:"attachmentFloat-"+t})})}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(30),n(17),n(10)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){return t&&t.attachmentBlock&&(this.attachmentBlock=t.attachmentBlock),!!this.attachmentBlock},t.prototype.reset=function(){this.attachmentBlock=null,e.prototype.reset.call(this)},t.prototype.selectAction=function(){var e,t,i=this.editor,r=this.attachmentBlock,a=this.float;i&&r&&-1!==["left","right","none"].indexOf(a)&&(e=n.createRangeByBlock({block:r}),t=new o({endRange:e,startRange:e}),i.execCommand("comp.ApplyStyles",{blockStyles:{float:a},range:t}),this.attachmentBlock=null)},t.prototype.initialize=function(t){t=t||{percent:100},e.prototype.initialize.call(this,t),this.float=t.float},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10),n(41)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n,i=t.tableInfo;this.editor&&t&&(t.attachmentBlock||i&&i.type===o.ATTACHMENT)?(n=i?i.cell.getContent():t.attachmentBlock,this.resource=n.getResource(),this.fileName=n.getFileName()):this.isHidden=this.isDisabled=!0},t.prototype.selectAction=function(){this.resource&&this.editor.trigger("yne-download-attachment",this.resource,this.fileName)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="attachmentSaveAs",this.label="另存为"},t}(n))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10),n(30),n(17)],void 0===(i=function(e,t,n,o,i){"use strict";var r=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){this.editor&&t&&t.imgBlock?this.imgBlock=t.imgBlock:this.isHidden=this.isDisabled=!0},t.prototype.selectAction=function(){var e,t,n=this.imgBlock;this.editor&&n&&(e=o.createRangeByBlock({block:n}),t=new i({endRange:e,startRange:e}),this.editor.execCommand("comp.ApplyStyles",{blockStyles:{width:null},range:t}),this.imgBlock=null)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="imageClearZoom",this.label="清除缩放"},t}(n))({});return function(){return r}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(230)],void 0===(i=function(e,t,n){"use strict";return function(){return new n({direction:0,label:"向左转",name:"imageLeftRotation"})}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(230)],void 0===(i=function(e,t,n){"use strict";return function(){return new n({direction:1,label:"向右转",name:"imageRightRotation"})}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10),n(41)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n,i=t.tableInfo;if(this.editor&&t&&(t.imgBlock||i&&i.type===o.IMAGE)){if(i)return n=i.cell.getContent(),void(this.imgSrc=n.getSource(this.editor.getExtraInfo("pcResMap")));n=t.imgBlock,this.imgSrc=n.getSource(!0)}else this.isHidden=this.isDisabled=!0},t.prototype.selectAction=function(){this.imgSrc&&this.editor.trigger("yne-download-image",this.imgSrc),this.imgSrc=null},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="imageSaveAs",this.label="另存为"},t}(n))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(10),n(346)],void 0===(i=function(e,t,n,o,i){"use strict";var r=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){this.editor&&t&&t.imgBlock||(this.isHidden=this.isDisabled=!0)},t.prototype.selectAction=function(){},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="imageZoom",this.label="图片缩放",this.type=o.TYPE.SUBMENU},t}(o);return function(){var e=n.map([10,25,50,75,100,125,150,200],function(e){return new i({label:e+"%",name:"imageZoom-"+e+"%",percent:e})});return new r({items:e})}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(30),n(17),n(347),n(10)],void 0===(i=function(e,t,n,o,i,r,s){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){t&&t.imgBlock&&(this.imgBlock=t.imgBlock)},t.prototype.reset=function(){e.prototype.reset.call(this),this.imgBlock=null},t.prototype.selectAction=function(){var e=this,t=e.editor,n=e.imgBlock;t&&n&&r.get(n.getSource(!0),function(r){var a,s,l,c;r&&r.width&&(a=Math.round(r.width*e.percent/100),null!=r.height&&(s=Math.round(r.height*e.percent/100)),l=o.createRangeByBlock({block:n}),c=new i({endRange:l,startRange:l}),t.execCommand("comp.ApplyStyles",{blockStyles:{height:s,width:a},range:c})),e.imgBlock=null},!0)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),t=n.defaults(t,{percent:100}),this.percent=t.percent},t.prototype.resetStatus=function(){e.prototype.resetStatus.call(this),this.imgBlock=null},t}(s)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return function(){function e(){}return e.clearCache=function(t){t?delete e.sizeCache[t]:e.sizeCache={}},e.get=function(t,n,o){var i;o||e.clearCache(t),(i=e.sizeCache[t])&&n(i),e.downloadImg(t,n)},e.downloadImg=function(t,n){var o=new Image;o.onload=function(){var i={height:o.height,width:o.width};o.onload=o.onerror=o.onabort=null,o=null,e.sizeCache[t]=i,n(i)},o.onerror=o.onabort=function(){o.onload=o.onerror=o.onabort=null,o=null,n()},o.src=t},e.sizeCache={},e}()}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10),n(2)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this.editor.getNoteRange(),i=[o.PARAGRAPH,o.LIST_ITEM,o.ATTACHMENT,o.IMAGE];n&&n.isMatchBlockTypes(this.editor.getNote(),i)||(this.isDisabled=!0)},t.prototype.selectAction=function(){},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="insertDate",this.label="插入当前时间",this.keyHandlerName="insertDate"},t}(n))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this;this.editor.trigger("yne-clipboard-status",function(e,t){n.isDisabled=!e,n.isHidden=t})},t.prototype.selectAction=function(){this.editor.trigger("yne-require-paste",!1,!1)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="paste",this.label="粘贴",this.key="mod+v"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this;n.isHidden=!1,n.editor.trigger("yne-clipboard-status",function(e){n.isDisabled=!e})},t.prototype.selectAction=function(){this.editor.trigger("yne-require-paste",!1,!0)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="pasteAsText",this.label="纯文本粘贴",this.key="mod+shift+v"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=this;n.editor.trigger("yne-clipboard-status",function(e,t){n.isDisabled=n.isHidden=!t})},t.prototype.selectAction=function(){this.editor.trigger("yne-require-paste",!0,!1)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="pasteNoteLink",this.label="粘贴引用链接",this.key="mod+v"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){this.isDisabled=!this.editor.canRedo()},t.prototype.selectAction=function(){},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="redo",this.label="重做",this.keyHandlerName="redo"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10),n(88)],void 0===(i=function(e,t,n,o){"use strict";var i=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){var n=t.hrefInfo;if(this.hrefInfo=null,!n||!o.isNoteLinkUrl(n.href))return!1;this.hrefInfo=n},t.prototype.selectAction=function(){this.hrefInfo&&(this.editor.execCommand("comp.ApplyStyles",{inlineStyles:{color:"#393939",href:"",underline:!1},range:this.hrefInfo.noteRange}),this.hrefInfo=null)},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="removeNoteLink",this.label="清除引用链接"},t}(n))({});return function(){return i}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){},t.prototype.selectAction=function(){this.editor.trigger("yne-share-note")},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="share",this.label="分享链接"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(10)],void 0===(i=function(e,t,n){"use strict";var o=new(function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.queryAction=function(e,t){this.isDisabled=!this.editor.canUndo()},t.prototype.selectAction=function(){},t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.name="undo",this.label="撤销",this.keyHandlerName="undo"},t}(n))({});return function(){return o}}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(5),o=n(0),i=n(6),r=n(1),a=n(13),s=n(14),l=n(77),c=n(134),d=n(3),u=n(123),h=n(357),p=n(358),g=n(135);return a.extend({_contentDoc:null,_contentWin:null,initialize:function(e){var n,i,a;o.isUndefined(e.el)&&r.error("options.el is needed"),n=this.$el=t(e.el),i=s.render("pc","presenter_page",{}),n.hide().html(i),a=n.find("iframe")[0],this._contentDoc=a.contentDocument,this._contentWin=a.contentWindow,this._insertNoteCss(),this._bindEvents()},_insertNoteCss:function(){var e=t("head",this._contentDoc);e.append("<style>"+u+"</style>"),e.append("<style>"+h+"</style>"),e.append("<style>"+g+"</style>"),e.append("<style>"+p+"</style>")},_bindEvents:function(){var e=this,n=t("body",e._contentDoc);e.$el.find(".demo-mode-icon").on("click",e._onClick.bind(e)),n.delegate("a","click",function(n){var o,i,r=t(n.currentTarget);if((i=r.attr("href")).startsWith("file://"))n.preventDefault();else{if("catalogue"===r.parent().attr("yne-bulb-block")&&/^#/.test(i)&&d.isGUID(i.replace(/^#/,""))){try{(o=n.currentTarget.ownerDocument.defaultView).location.hash=i,o.location.hash="#!"}catch(e){}return n.preventDefault(),void n.stopPropagation()}r.attr("target","_blank"),e.trigger("open-link",r[0].href)}}),n.delegate("img","click",function(n){var o=t(n.currentTarget);o.attr("path")?e.trigger("open-attachment",o.attr("path"),o.attr("filename")):t(document.activeElement).blur()}),n.on("keydown",e._escKeyHandler.bind(e)),t(document).on("keydown",e._escKeyHandler.bind(e))},_processAttachment:function(){var e=this,n=t("body",e._contentDoc);t('img[data-media-type="attachment"]',n).each(function(n,o){var i=t(o);c.processHtmlContent(i).click(function(){i.attr("path")?e.trigger("open-attachment",i.attr("path"),i.attr("filename")):t(document.activeElement).blur()})})},_processImage:function(){var e=t("body",this._contentDoc);t('img[data-media-type="image"]',e).each(function(e,n){var o,i=t(n);i.attr("alt")&&((o=document.createElement("div")).className="img-title",o.appendChild(document.createTextNode(i.attr("alt"))),i.after(o)),i.parent().css({"padding-top":"5px","padding-bottom":"5px"})})},_render:function(e,n){var o=t("body",this._contentDoc),i=s.render("pc","presenter_article",{content:n,title:e});o.empty().append(i),o.find("article").css("zoom",1.5)},_onClick:function(e){switch(t(e.target).data("action")){case"zoom-in":this.zoomIn();break;case"zoom-out":this.zoomOut();break;case"esc":this._exitFullscreen()}},_close:function(e){e&&this.exit()},enter:function(e,n,o){var r,a=document.documentElement,s=a.requestFullScreen||a.webkitRequestFullScreen||a.mozRequestFullScreen;r=o&&o!==i.DEFAULT_BACKGROUND?'url("'+o+'")':"",this.$el.find(".demo-page").css("background-image",r),s.call(a),this._render(e,n),t("body").addClass("presentation"),this._processAttachment(),this._processImage(),this.$el.show(),t("body",this._contentDoc).focus(),this._contentWin.scrollTo(0,0)},exit:function(){this.$el.hide(),t("body").removeClass("presentation"),this.trigger("exit")},zoomIn:function(){var e,n=t("article",this._contentDoc);o.isUndefined(n)||0===n.length||(e=Number(n.css("zoom")))>=3||((e+=.25)>3&&(e=3),n.css("zoom",e))},zoomOut:function(){var e,n=t("article",this._contentDoc);o.isUndefined(n)||0===n.length||(e=Number(n.css("zoom")))<=1||((e-=.25)<1&&(e=1),n.css("zoom",e))},_exitFullscreen:function(){document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen&&document.mozCancelFullScreen(),this._close(this.isPresenting())},isPresenting:function(){return t("body").hasClass("presentation")},_escKeyHandler:function(e){this.isPresenting()&&e&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey&&l.isMatch("esc",e.keyCode)&&this._exitFullscreen()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){(e.exports=n(44)(!1)).push([e.i,'article {\r\n    width: 75%;\r\n    margin-left: 12.5%;\r\n}\r\nhtml,\r\nimg {\r\n    cursor: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAWCAYAAADAQbwGAAABOUlEQVR42mL8//8/g/G8DwxIgA2IS4F4DxCfZCABnE0SYGDCIu4MxC1AvAOIVRhIBNgM1IDSAkC8AYj5KTVQE4mtDcSLgJiRWgaCgB8QN1HTQBCoBuIQcgwUA2JhLOpAXl4IxHqkGqiBRy0XEG8EYlFSDNQi4AAFIF4FxKzEGqhJRDA5AHEfNbyMDHKAOIVaLoSBqUBsjc9AXiCWJcFAUJ5fC8QyuAzUYCAdiAPxemgKwDBQk4E8YALEs0kx8C+09JkJxHdxqIkC4iwQg4WAgSDD4oB4GZKYIhC7QLETEItAxYOAeBo+A38BcTQQr0ETvw/14myoDw2ght9DdiE7ECujGRYKxJsIhN8/ID4HxQzIBqoBMTOU/R3q/B3kxBDMQB4o/Q1a/u0lM8bhsXwCmj/dKTEMBAACDAA6Oi9O6DlyWwAAAABJRU5ErkJggg==), auto !important;\r\n}\r\n\r\nimg[filename]{cursor:pointer !important;}\r\n\r\nimg[src="DEFAULTIMAGE"] {display: none !important;}\r\n.search-hit-node {font-style: normal;background-color: #FFFF00;}\r\n.search-hit-node.current {background-color:#FF9632;}\r\n\r\n.innerlink-icon {\r\n    width: 16px;\r\n    height: 16px;\r\n    margin: 0 6px;\r\n    vertical-align: middle;\r\n}\r\n::-webkit-scrollbar{height:8px;width:10px;background:transparent;border-radius:5px;}\r\n::-webkit-scrollbar-button{display:none;}\r\n::-webkit-scrollbar-track{background-color:transparent;}\r\n::-webkit-scrollbar-track-piece{background:transparent;}\r\n::-webkit-scrollbar-thumb{width:10px;min-height:15px;background:rgba(118, 176, 243, 0.3);border-radius: 0;margin-right:1px;}\r\n::-webkit-scrollbar-thumb:hover{background: rgba(118, 176, 243, 0.3);}\r\n::-webkit-scrollbar-thumb:active{background: rgba(118, 176, 243, 0.3);}\r\n\r\nhtml,body{margin:0;padding:0;overflow:auto;pointer-events:none}body{overflow:visible;position:relative;padding-bottom:3px}.editor-area{display:block;padding:20px 20px 0 25px;min-height:100%;pointer-events:all;box-sizing:border-box;outline:0;overflow:visible;font-size:14px;font-family:Microsoft YaHei;word-break:break-word}.editor-area *{background-color:inherit}.editor-attachment{cursor:default}p{margin:5px 0}img:not(.editor-attachment){cursor:default;display:inline-block;margin-top:8px}img[data-media-type=image]{max-width:800px!important;height:auto!important}table{font-size:inherit;border-collapse:collapse;margin-top:10px;margin-bottom:10px;display:table}table td,table th{word-break:break-all;word-wrap: break-word;border:1px solid #999;padding:5px 10px;min-height:25px;min-width:25px;height:25px}table td>div{min-width:2px}a[href]{cursor:pointer}code,pre{font-family:Monaco,Consolas,Courier,"Lucida Console",monospace;font-size:12px;line-height:16px;font-style:normal}pre{white-space:pre-wrap}.ynote-handwrite-br{display:block!important;clear:both;width:0;height:0;visibility:hidden}.ynote-handwrite-caret{display:inline-block;width:0;line-height:99px;height:60px}.ynote-handwrite-area{line-height:60px}img[data-media-type=todo]{margin-top:6px;cursor:pointer}\r\n',""])},function(e,t,n){(e.exports=n(44)(!1)).push([e.i,"\r\n.code-view {\r\n  width: calc(50vw - 20px);\r\n  white-space: initial;\r\n}\r\n.code-view .para-text {\r\n  margin: 0;\r\n  padding: 0;\r\n}\r\n.code-view .para-text pre {\r\n  min-width: calc(50vw - 25px);\r\n}",""])},function(e,t,n){var o;void 0===(o=function(e){var t=n(202),o=n(0),i=n(5),r=n(360),a=n(419);return t.extend({className:"bulb-big-toolbar",_tabHead:null,_tabBody:null,initialize:function(e){this._editor=e.editor,this._parentEl=e.parentEl,this.render(),this._editor.isLegacyHost()&&(this._tabHead=new r({editor:e.editor,parentEl:this.el})),this._tabBody=new a({editor:e.editor,parentEl:this.el}),this._bindEvents()},_bindEvents:function(){o.bindAll(this,"_onRequestSwitch","_onExitFullScreen","_onToggleTab"),this._editor.isLegacyHost()&&(this._tabHead.bind("request-switch",this._onRequestSwitch),this._tabHead.bind("exit-full-screen",this._onExitFullScreen),this._tabHead.bind("user-action-collection",this._onUserActionCollection),this._tabBody.bind("toggle-tab",this._onToggleTab))},_canSwitchTab:function(){return!0},_onRequestSwitch:function(e){this.switchTo(e)},_onExitFullScreen:function(){this._editor.trigger("yne-exit-full-screen")},_onUserActionCollection:function(e){this._editor.trigger("yne-user-action-collection",e)},_onToggleTab:function(){this._tabHead.toggle(),this.trigger("resize"),"none"===this._tabHead.$el.css("display")?this.trigger("tab-toggled",!1):this.trigger("tab-toggled",!0)},switchTo:function(e){this._canSwitchTab()&&(this._tabHead&&this._tabHead.switchTo(e),this._tabBody.switchTo(e))},render:function(){this.isRendered||(this.isRendered=!0,i(this._parentEl).append(this.$el))},enable:function(){this.$el.removeClass("disabled"),this._tabHead&&this._tabHead.enable(),this._tabBody.enable()},disable:function(){this.$el.removeClass("disabled"),this._tabHead&&this._tabHead.disable(),this._tabBody.disable()},reset:function(){this._tabHead&&this._tabHead.reset(),this._tabBody.reset(),this.enable()},enterFullScreen:function(){this._tabHead&&this._tabHead.enterFullScreen(),this._tabBody.enterFullScreen(),this.trigger("resize")},exitFullScreen:function(){this._tabHead&&this._tabHead.exitFullScreen(),this._tabBody.exitFullScreen(),this.trigger("resize")},showSaveSyncButton:function(e){var t;if(this._tabHead){if(!(t=this._tabHead.getItemByName("save-and-sync")))return;e?t.show():t.hide()}},rotateSaveSyncIcon:function(e){var t;this._tabHead&&(t=this._tabHead.getItemByName("save-and-sync"))&&t.rotateSyncIcon(e)},toggleToolbar:function(e){this._tabBody&&this._tabBody.toggle(e)},getCurrentTabName:function(){var e=this._tabBody;if(e&&e.getCurrentTabName)return e.getCurrentTabName()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(100),o=n(0),i=n(5),r=n(35);return t.extend({className:"bulb-tab-head",buttonConfig:["edit","insert","view","export","full-screen","save-and-sync"],initialize:function(e){t.prototype.initialize.apply(this,arguments),i(e.parentEl).append(this.$el),this.show()},_bindEvents:function(){var e=this,t=e._getTextButtons(),n=e._getFullScreenButton();o.each(t,function(t){t.bind("on-click",function(){e.trigger("request-switch",this.name,this),e.trigger("user-action-collection","tab-head-"+this.name+"-click")})}),n&&r.bubble(["exit-full-screen"],n,e)},_shrink:function(){},_addButtons:function(){t.prototype._addButtons.call(this,!1)},_getTextButtons:function(){var e=this,t=["edit","insert","view","export"];return e._textButtonList||(e._textButtonList=[],o.each(e._items,function(n){t.indexOf(n.name)>-1&&e._textButtonList.push(n)})),e._textButtonList},_getFullScreenButton:function(){return this._fullScreenButton||(this._fullScreenButton=this.getItemByName("full-screen")),this._fullScreenButton},_enableTextButtons:function(e){var t=this._getTextButtons();o.each(t,function(t){e?t.enable():t.disable()})},_activeTextButton:function(e){var t=this._getTextButtons();o.each(t,function(t){t.setState(t.name===e)})},switchTo:function(e){this._enableTextButtons(!0),this._activeTextButton(e)},toggle:function(){this.$el.toggle()},enterFullScreen:function(){var e=this._getFullScreenButton();this.show(),e&&e.show()},exitFullScreen:function(){var e=this._getFullScreenButton();this.show(),e&&e.hide()},reset:function(){this._invoke("reset"),this.switchTo("edit")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return function(){}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"full-screen",text:"退出全屏",label:"退出全屏",onClick:function(){this.trigger("exit-full-screen")},show:function(){this.$el.show()},hide:function(){this.$el.hide()},disable:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"toggle-tab",label:"收缩/展开工具栏",onClick:function(){this.trigger("toggle-tab"),this.$el.toggleClass("reverse")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"toggle-allItems",label:"收缩/展开工具栏",onClick:function(){this.$el.toggleClass("reverse"),this.trigger("toggle-allItems")},isCollapsed:function(){return!this.$el.hasClass("reverse")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(102),o=n(2),i=n(14),r=n(0),a=n(5),s=t.extend({name:"align",label:"对齐方式",defaultValue:"left",items:{justify:"两端对齐",left:"左对齐",center:"居中对齐",right:"右对齐"},templateName:"toolbar-combo-box-align",render:function(){var e,t=this.$el;t.addClass("combo-box-"+this.name),e=i.render("pc",this.templateName,{name:this.name,label:this.label,defaultValue:this.defaultValue,text:!1,items:this.items}),t.html(e),this.valueWrapperEl=t.find(".combo-value-wrapper")[0],this.expandWrapperEl=t.find(".combo-expand-wrapper")[0],this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],t.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},onChange:function(e){var t,n,i,r;(i=(t=this.editor).getNoteRange())&&(r=(n=i.getStartBlockRange()).block)&&o.isHeaderFooter(r)?t.execCommandByToolbar("comp.SetHeaderFooter",{align:e,headerFooter:r,range:n}):s.__super__.onChange.apply(this,arguments)},updateValueUI:function(e){var t=a(this.valueWrapperEl).find(".combo-value")[0];a(t).removeClass(r.keys(this.items).join(" ")),a(t).addClass(e)},onSelectionChange:function(){var e,t=this.editor.getNoteRange(),n=t&&t.getStartBlockRange().block;this.$el.hasClass("disabled")||(e=n&&o.isHeaderFooter(n)?n.getAlign():this.editor.querySelectionBlockStyle(this.name),this.items[e]?this.select(e):this.select(this.defaultValue))}});return s}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"indent",label:"增加缩进",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.IndentOutdent",{indentStep:1}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(102),o=n(0),i=n(6),r=n(5);return t.extend({name:"line-height",label:"行高",defaultValue:i.PLATFORM_LINE_HEIGHT,keys:[1,1.25,1.5,1.75,2,2.5,3],items:[{key:1,value:"1.0"},{key:1.25,value:"1.25"},{key:1.5,value:"1.5"},{key:1.75,value:"1.75"},{key:2,value:"2.0"},{key:2.5,value:"2.5"},{key:3,value:"3.0"}],templateName:"toolbar-combo-box-line-height",initialize:function(){t.prototype.initialize.apply(this,arguments),this._keys=o.map(this.items,function(e){return e.key})},updateValueUI:function(e){var t=r(this.menuWrapperEl),n=o.indexOf(this._keys,e);t.find(".active").removeClass("active svg-common"),-1!==n&&t.find(".line-height-"+n).addClass("active svg-common")},onSelectionChange:function(){var e,t,n;this.$el.hasClass("disabled")||(e=this.editor.querySelectionBlockStyle(this.name),-1!==o.indexOf(this._keys,e)?this.select(e):parseFloat(e)==e?(t=parseFloat(e),o.each(this.keys,function(o){var i=Math.abs(o-e);i<t&&(n=o,t=i)}),this.select(n)):(this.select(this.defaultValue),this._isForceSelectWhenClick=!0))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(231),o=n(29);return t.extend({name:"ordered-list",label:"项目编号",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:"Ctrl+Shift+L",querySelectionState:function(){return this.editor.isSameList("ordered")},onClick:function(){this.editor.execCommandByToolbar("comp.InsertList",{type:o.ORDERED}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"outdent",label:"减少缩进",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.IndentOutdent",{indentStep:-1}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(231),o=n(29);return t.extend({name:"unordered-list",label:"无序列表",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:"Ctrl+L",querySelectionState:function(){return this.editor.isSameList("unordered")},onClick:function(){this.editor.execCommandByToolbar("comp.InsertList",{type:o.UNORDERED}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(232).extend({name:"back-color",label:"背景色",defaultValue:"transparent",defaultSetValue:"#FAE220",templateName:"toolbar-combo-box-back-color",doAction:function(e){var t={};t[this.name]=e||this.value,this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:t})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(118),o=n(5),i=n(373);return t.extend({name:"color",defaultValue:"#000000",items:i,templateName:"toolbar-combo-box-color",editorEvents:{"yne-selection-change":"onSelectionChange"},onValueWrapperElClick:function(){var e=this.value;this.hideMenu(),this.onChange(e)},onChange:function(e){this.doAction(e)},doAction:function(){},onItemClick:function(e){var t=o(e).data("value");if(o(e).hasClass("color-section-other"))return this.editor.trigger("color-picker-show",this),void this.hideMenu();this.changeValue(t)},changeValue:function(e){this.select(e),this.onChange(e)},updateValueUI:function(e){var t=o(this.valueWrapperEl).find(".combo-value-buttom-color")[0];o(t).css("background-color",e)},onSelectionChange:function(){var e;this.$el.hasClass("disabled")||(e=this.editor.querySelectionInlineStyle(this.name),this.selectedValue=e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{theme:["#ffffff","#000000","#eeece0","#1c487f","#4d80bf","#c24f4a","#9abc52","#7b5ba1","#46acc8","#f9963b"],other:[["#f2f2f2","#808080","#ddd9c2","#c5d9f2","#dce6f3","#f3dcdb","#ebf1dd","#e6e0ec","#daeef4","#feead9"],["#d9d9d9","#595959","#c4be95","#8db3e5","#b8cde6","#e7b9b7","#d7e5bb","#ccc0db","#b6dee9","#fdd5b3"],["#bfbfbf","#404040","#948b50","#528cd8","#94b2d9","#da9693","#c3d798","#b3a1c8","#91cdde","#fbc08c"],["#a6a6a6","#262626","#4a4528","#15365f","#355f94","#973632","#769436","#60487c","#2c859d","#e66c00"],["#808080","#0d0d0d","#1e1c10","#0f2340","#243f62","#642422","#4f6324","#403053","#1e5969","#994800"]],standard:["#df402a","#f77567","#fad4d3","#fae220","#b19067","#77c94b","#98dede","#184e87","#9896a4","#90a7d1"]}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(136).extend({name:"bold",label:"加粗",shortcut:"Ctrl+B"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(232),o=n(1),i=n(28);return t.extend({name:"color",label:"文字颜色",defaultValue:"#000000",defaultSetValue:"#DF402A",doAction:function(e){var t={},n=e||this.value,r=i(n);r&&!1!==r.isValid()?(t[this.name]=r.toHexString(),this.editor.execCommandByToolbar("comp.ApplyStyles",{inlineStyles:t})):o.error("tiny color object is not valid",r)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(119),i=n(6),r=n(38),a=n(5);return t=o.extend({name:"font-family",label:"字体",defaultValue:r.DEFAULT_FONT,items:r.getItems(),templateName:"toolbar-combo-box-font-family",getUnlistedText:function(e){var t;return e&&e!==i.INTERM&&(t=r.getFont(e)),t=t||r.splitFontFamily(e)[0]||"微软雅黑"},render:function(){var e,n=this;t.__super__.render.apply(n,arguments),e=n.$el.find(".combo-value-font-family"),a(e).hover(function(){a(n.displayWrapperEl).tooltipster({animation:"",animationDuration:0,content:e.text(),delay:[800,300]})},function(){a(n.displayWrapperEl).tooltipster({animation:"",animationDuration:0,content:n.label,delay:[800,300]})})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(119),o=n(227);return t.extend({name:"font-size",label:"字号",defaultValue:"14",items:o.getAsList(),templateName:"toolbar-combo-box-font-size",getUnlistedText:function(e){var t=parseInt(e,10);return t&&!isNaN(t)?t+"":this.defaultValue+""}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(136).extend({name:"italic",label:"斜体",shortcut:"Ctrl+I"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(136).extend({name:"strike",label:"删除线",shortcut:"Ctrl+E"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(136).extend({name:"underline",label:"下划线",shortcut:"Ctrl+U"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(89).extend({name:"attachment",label:"插入附件",text:"附件",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.trigger("yne-insert-attachment"),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(89).extend({name:"hr",label:"水平线",text:"横线",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:"Ctrl+H",onClick:function(){this.editor.execCommandByToolbar("comp.InsertHorizontalRule"),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(89).extend({name:"img",label:"插入图片",text:"图片",defaultState:!1,state:!1,onClick:function(){this.editor.trigger("yne-insert-photo"),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14),a=n(62),s=n(77);return t.View.extend({className:"toolbar-item toolbar-combo-box toolbar-combo-link",name:"link",label:"插入链接",text:"链接",templateName:"toolbar-combo-box-insert-link",events:{"mousedown .combo-value-wrapper-link":"onValueWrapperMouseDown","click .combo-value-wrapper-link":"onValueWrapperClick","click .link-button":"onConfirmButtonClick",mousedown:"onMouseDown"},initialize:function(e){this.editor=e.editor,this.items=e.items,this.render(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var e,t=this,n=t.$el;e=r.render("pc",t.templateName,{name:t.name,label:t.label,text:t.text}),n.html(e),t.menuWrapperEl=n.find(".combo-menu-wrapper")[0],t.menuItemContainer=n.find(".combo-menu")[0],t.input=n.find(".link-input"),i(t.input).keydown(function(e){e.stopPropagation(),s.isMatch("enter",e.keyCode)&&(e.preventDefault(),t.onConfirmButtonClick())}),n.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},onDocumentMouseDown:function(){this.hideMenu()},onMouseDown:function(e){e.stopPropagation(),e.preventDefault()},onConfirmButtonClick:function(){var e=a.safeHref(i(this.input).val().trim());e&&this.editor.execCommandByToolbar("comp.InsertLink",{src:e,styles:this.editor.controller.getEditingInlineState()}),window.focus(),this.hideMenu()},onValueWrapperMouseDown:function(e){e.preventDefault()},onValueWrapperClick:function(){this.toggleMenu(),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")},toggleMenu:function(){i(this.menuWrapperEl).toggleClass("show")},showMenu:function(){var e=this.menuWrapperEl;i(e).addClass("show")},hideMenu:function(){var e=this.menuWrapperEl;i(e).removeClass("show"),i(this.input).val("")},show:function(){return this.$el.show(),!0},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},reset:function(){this.hideMenu()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14);return t.View.extend({className:"toolbar-item toolbar-combo-box toolbar-combo-box-table",events:{"click .combo-value-wrapper":"onValueWrapperClick","mouseleave .combo-menu":"onMenuMouseLeave","mouseenter .combo-item":"onItemMouseEnter","click .combo-item":"onItemClick",mousedown:"onMouseDown"},editorEvents:{"yne-editing-state-change":"onEditingStateChange"},name:"table",label:"表格",text:"表格",templateName:"toolbar-combo-box-table",initialize:function(e){this.editor=e.editor,this.render(),this.bindDocumentEvents(),this.bindEditorEvents()},render:function(){var e,t=this.$el;e=r.render("pc",this.templateName,{name:this.name,label:this.label,text:this.text,maxRows:6,maxCols:8}),t.html(e),this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],this.menuLabelEl=t.find(".combo-menu-label-table")[0],this.comboItems=t.find(".combo-item"),t.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})},onDocumentMouseDown:function(e){var t=e.target;i.contains(this.el,t)||this.hideMenu()},onValueWrapperClick:function(){this.toggleMenu(),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")},onItemMouseEnter:function(e){var t=e.target,n=this.getItemCoordinate(t);this.selectItems(n.row+1,n.col+1)},onItemClick:function(e){var t=e.target,n=this.getItemCoordinate(t);this.insertTable(n.row+1,n.col+1),this.hideMenu()},onMenuMouseLeave:function(){this.resetSelected()},onMouseDown:function(e){e.preventDefault()},getItemCoordinate:function(e){var t=i(e);return{row:t.data("row"),col:t.data("col")}},resetSelected:function(){this.selectItems(0,0)},selectItems:function(e,t){this.updateSelectedLabelText(e,t),this.updateSelectedItemsUI(e,t)},updateSelectedLabelText:function(e,t){var n=i(this.menuLabelEl);e>0&&t>0?n.html(e+" 行 "+t+" 列"):n.html("插入表格")},updateSelectedItemsUI:function(e,t){var n,o;for(i(this.comboItems).removeClass("selected"),n=0;n<e;n++)for(o=0;o<t;o++)i(this.comboItems[8*n+o]).addClass("selected")},insertTable:function(e,t){this.editor.execCommandByToolbar("comp.InsertTable",{rows:e,cols:t})},toggleMenu:function(){i(this.menuWrapperEl).hasClass("show")?this.hideMenu():this.showMenu()},showMenu:function(){var e=this.menuWrapperEl;i(e).removeClass("menu-position-fix"),i(e).addClass("show"),e.getBoundingClientRect().right>document.documentElement.offsetWidth&&i(e).addClass("menu-position-fix")},hideMenu:function(){i(this.menuWrapperEl).removeClass("show"),this.resetSelected()},isVisible:!0,show:function(){this.$el.show(),this.isVisible=!0},hide:function(){this.$el.hide(),this.isVisible=!1},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},reset:function(){this.resetSelected(),this.hideMenu()},onEditingStateChange:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(5),o=n(119),i=n(111);return o.extend({name:"heading",label:"标题",defaultValue:"default",items:i.headingArray,templateName:"toolbar-combo-box-heading",editorEvents:{"yne-editing-state-change":"onEditingStateChange","yne-selection-change":"onSelectionChange"},updateValueUI:function(e){var n=t(this.valueWrapperEl).find(".combo-value")[0];i.headingMap[e]?t(n).text(i.headingMap[e].name):t(n).text(this.getUnlistedText(e)||"")},getUnlistedText:function(e){return e?i.headingMap[e].name:i.headingMap[this.defaultValue].name+""},onItemClick:function(e){var t,n;for(t in i.headingMap)if(i.headingMap[t].name===e.innerText){n=t;break}this.editor.execCommandByToolbar("comp.InsertHeading",{level:n})},onEditingStateChange:function(){var e=this.editor.querySelectionBlockStyle(this.name);i.headingMap[e]?this.select(e):this.select(this.defaultValue)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(89).extend({name:"catalogue",label:"目录",text:"目录",defaultState:!1,state:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.InsertCatalogue")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(89).extend({name:"todo",label:"待办",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:"Ctrl+D",onClick:function(){this.editor.execCommandByToolbar("comp.InsertTodo",{checked:!1})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(89),o=n(6);return t.extend({name:"quote",label:"引用",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:o.IS_MAC?"Control+Q":"Ctrl+Q",onClick:function(){this.editor.execCommandByToolbar("comp.InsertQuote")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(89),o=n(6);return t.extend({name:"code",label:"代码块",defaultState:!1,state:!1,templateName:"toolbar-button-template",shortcut:o.IS_MAC?"Control+Alt+D":"Ctrl+Alt+D",onClick:function(){this.editor.execCommandByToolbar("comp.InsertCode")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"export-pdf",label:"导出为PDF",text:"导出为PDF",defaultState:!1,state:!1,onClick:function(){this.editor.trigger("yne-export-pdf")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"export-word",label:"导出为Word",text:"导出为Word",defaultState:!1,state:!1,onClick:function(){this.editor.trigger("yne-export-word")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(27);return t.extend({name:"download-file",label:"下载原始文件",text:"下载原始文件",defaultState:!1,state:!1,enable:function(){t.prototype.enable.apply(this),this._updateVisibleState()},disable:function(){t.prototype.disable.apply(this),this._updateVisibleState()},onClick:function(){this.editor.trigger("yne-download-file")},_updateVisibleState:function(){var e=this.editor.getNoteProps();null!=e&&!0===e.hasOriginFile?this.$el.removeClass("hidden"):this.$el.addClass("hidden")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(27),o=n(395);return t.extend({name:"format-painter",label:"格式刷",events:{click:"onClick",dblclick:"onDblClick",mousedown:"onMouseDown"},defaultState:!1,state:!1,templateName:"toolbar-button-template",initialize:function(){t.prototype.initialize.apply(this,arguments),this._initFormatPainterManager()},_initFormatPainterManager:function(){this._formatPainterManager=new o({editor:this.editor}),this._formatPainterManager.on("formatpainter-state-change",this.onFormatPainterStateChange.bind(this))},clickAction:function(){!0===this.state?this.reset():this.stash(!0)},onClick:function(){var e=this;clearTimeout(e._timer),e._timer=setTimeout(function(){e.clickAction()},300),e.editor.trigger("yne-user-action-collection","tab-body-"+e.name+"-click")},onDblClick:function(){clearTimeout(this._timer),this.stash()},stash:function(e){this._formatPainterManager.stash(e)},reset:function(){this._formatPainterManager.reset()},onFormatPainterStateChange:function(e){this.setState(!!e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(16),i=n(5),r=n(20),a=n(0),s=n(6),l=n(28),c=0,d=1,u=2;return t={state:null,data:null,initialize:function(e){this._editor=e.editor,this.state=c,a.bindAll(this,"stash","_paintWithDebounce","reset","_onSelectStart","_onCommandExec")},_isLinkStyle:function(e){return e&&e.color&&e.color!==s.INTERM&&l.equals(e.color,"blue")&&!0===e.underline},stash:function(e){var t,n=this._editor;this.reset(),t=n.querySelectionInlineStyles(),this._isLinkStyle(t)&&t.href&&(delete t.color,delete t.underline),this.data={inlineStyles:t,blockStyles:n.querySelectionBlockStyles()},e?this.setState(d):this.setState(u),this.bindEvents()},paint:function(){this.data&&this._editor.execCommandByToolbar("comp.FormatPainter",{data:this.data}),this.state===d&&this.reset()},reset:function(){this._clearPaintTimeout(),this.data=null,this.setState(c),this.unbindEvents()},setState:function(e){this.state!==e&&(this.state=e,this.trigger("formatpainter-state-change",!!e),this.updateFormatPainterCursorUI(!!e))},updateFormatPainterCursorUI:function(e){this._editor.updateFormatPainterCursorUI(e)},bindEvents:function(){var e=this._editor;this.unbindEvents(),e.on("selectstart",this._onSelectStart),e.on("mouse-down",this._onSelectStart),e.on("esc",this.reset),e.on("command-exec",this._onCommandExec)},unbindEvents:function(){var e=this._editor;e.off("selectstart",this._onSelectStart),e.off("mouse-down",this._onSelectStart),e.off("esc",this.reset),e.off("command-exec",this._onCommandExec),i(document).off("mouseup",this._paintWithDebounce)},_onSelectStart:function(){i(document).one("mouseup",this._paintWithDebounce)},_clearPaintTimeout:function(){this._paintTimeout&&(window.clearTimeout(this._paintTimeout),this._paintTimeout=null)},_paintWithDebounce:function(){var e=this;e._clearPaintTimeout(),e._paintTimeout=window.setTimeout(function(){e.paint()},100)},_onCommandExec:function(e){"comp.FormatPainter"!==(e||{}).name&&this.reset()}},a.extend(t,r.Events),o.extend(t)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(102),o=n(14),i=n(0),r=n(5);return t.extend({editorEvents:{"view-mode-change":"_onViewModeChange"},name:"view-mode",label:"视图模式",defaultValue:"read",items:{normal:"普通视图",read:"阅读视图",page:"文档视图"},templateName:"toolbar-combo-box-align",_itemsKeyMap:{0:"normal",1:"read",2:"page"},render:function(){var e,t=this.$el;t.addClass("combo-box-"+this.name),e=o.render("pc",this.templateName,{name:this.name,label:this.label,defaultValue:this.defaultValue,text:this.items[this.defaultValue],items:this.items}),t.html(e),this.valueWrapperEl=t.find(".combo-value-wrapper")[0],this.expandWrapperEl=t.find(".combo-expand-wrapper")[0],this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],t.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},updateValueUI:function(e){var t=r(this.valueWrapperEl);t.find(".combo-value").removeClass(i.keys(this.items).join(" ")).addClass(e),t.find(".combo-text").text(this.items[e])},onChange:function(e){var t=1;i.some(this._itemsKeyMap,function(n,o){return n===e&&(t=o,!0)}),this.editor.setViewMode(t,!1,!0),this.editor.trigger("yne-user-action-collection","tab-body-pagemode-"+e+"-click")},_onViewModeChange:function(e){var t=this._itemsKeyMap[e];this.select(t)},reset:function(){this.hideMenu()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"redo",label:"重做",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"command-exec":"_onHistoryChange","redo-stack-change":"_onHistoryChange","cell-edit-view-exit":"_onHistoryChange","cell-edit-view-enter":"_onCellEditViewHistoryChange","cell-edit-view-history-change":"_onCellEditViewHistoryChange"},_onHistoryChange:function(){this.setState(this.editor.canRedo())},_onCellEditViewHistoryChange:function(e){this.setState(e.canRedo)},onClick:function(){!0===this.state&&(this.editor.execCommandByToolbar("redo"),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click"))},reset:function(){this.setState(!1)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"remove-format",label:"清除格式",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"yne-selection-change":"_onSelectionChange","yne-editing-state-change":"_onEditingStateChange"},_onEditingStateChange:function(e){this.$el.hasClass("disabled")||(e&&null!==e.cellEditViewRangeCollapsed?this.setState(!1===e.cellEditViewRangeCollapsed):this.setState(!0))},_onSelectionChange:function(){this.$el.hasClass("disabled")||this.setState(!0)},onClick:function(){var e,t=this.editor.getDefaultStyle();(e=this.editor.getNoteRange())&&!e.isCollapsed()?(this.editor.execCommandByToolbar("comp.RemoveFormat",{inlineStyles:t,resetAllStyles:!0}),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")):this.editor.setEditingInlineStyles(t)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"save-and-sync",label:"保存并同步",text:"保存并同步",defaultState:!1,state:!1,onClick:function(){this.editor.trigger("yne-save-and-sync")},rotateSyncIcon:function(e){this.$el.find(".button-save-and-sync").toggleClass("rotating",e),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(206);var t=n(102),o=n(14),i=n(0),r=n(5);return t.extend({name:"snap-screen",text:"截图",label:"截图",defaultValue:"snap",items:{snap:"截图","snap-x":"截图并隐藏当前窗口"},templateName:"toolbar-combo-box-align",editorEvents:{"yne-editing-state-change":"onEditingStateChange"},render:function(){var e,t=this.$el;t.addClass("combo-box-"+this.name),e=o.render("pc",this.templateName,{name:this.name,label:this.label,defaultValue:this.defaultValue,text:this.items[this.defaultValue],items:this.items}),t.html(e),this.valueWrapperEl=t.find(".combo-value-wrapper")[0],this.expandWrapperEl=t.find(".combo-expand-wrapper")[0],this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],t.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},updateValueUI:function(e){var t=r(this.valueWrapperEl),n=t.find(".combo-value"),o=this.items[e];n.removeClass(i.keys(this.items).join(" ")).addClass(e),t.find(".combo-text").text(o),this.$el.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,content:o,delay:[800,300]})},onValueWrapperElClick:function(){var e=this.value;this.hideMenu(),this.select(e),this._snapScreen()},onItemClick:function(e){var t=r(e).data("value");t&&t!==this.value&&this.select(t),this._snapScreen()},onChange:function(){},_snapScreen:function(){this.editor.trigger("yne-snap-screen",this.value)},reset:function(){this.hideMenu(),this.value=this.defaultValue,this.updateValueUI(this.value)},onEditingStateChange:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"undo",label:"撤销",defaultState:!1,state:!1,templateName:"toolbar-button-template",editorEvents:{"command-exec":"_onHistoryChange","undo-stack-change":"_onHistoryChange","cell-edit-view-exit":"_onHistoryChange","cell-edit-view-enter":"_onCellEditViewHistoryChange","cell-edit-view-history-change":"_onCellEditViewHistoryChange"},_onHistoryChange:function(){this.setState(this.editor.canUndo())},_onCellEditViewHistoryChange:function(e){this.setState(e.canUndo)},onClick:function(){!0===this.state&&(this.editor.execCommandByToolbar("undo"),this.editor.trigger("yne-user-action-collection","tab-body-"+this.name+"-click"))},reset:function(){this.setState(!1)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14);return t.View.extend({className:"toolbar-item toolbar-combo-box toolbar-combo-more",name:"showmore",label:"查看更多",templateName:"toolbar-combo-box-show-more",events:{"click .combo-value-wrapper-showmore":"onValueWrapperClick",mousedown:"onMouseDown"},initialize:function(e){this.editor=e.editor,this.items=e.items,this.render(),this.bindDocumentEvents()},render:function(){var e,t=this.$el;e=r.render("pc",this.templateName,{name:this.name,label:this.label}),t.html(e),this.menuWrapperEl=t.find(".combo-menu-wrapper")[0],this.menuItemContainer=t.find(".combo-menu")[0],this.$split=t.find(".toolbar-more-split"),t.find(".combo-display-wrapper").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-borderless","tooltipster-borderless-customized"],side:"bottom",delay:[800,300]})},bindDocumentEvents:function(){o.bindAll(this,"onDocumentMouseDown"),i(document).on("mousedown",this.onDocumentMouseDown)},onDocumentMouseDown:function(e){var t=e.target;i.contains(this.el,t)||this.hideMenu()},onMouseDown:function(e){e.preventDefault()},onValueWrapperClick:function(){this.toggleMenu()},toggleMenu:function(){i(this.menuWrapperEl).toggleClass("show")},showMenu:function(){var e=this.menuWrapperEl;i(e).addClass("show")},hideMenu:function(){var e=this.menuWrapperEl;i(e).removeClass("show")},resetMenu:function(){var e,t=this.items,n=i(this.menuItemContainer);o.map(t,function(e){n.append(e.$el)}),n.children().length>0?((e=this.$el.prev()).is(".toolbar-split")?e.hide():e.show(),this.$el.show()):this.$el.hide()},enable:function(){this.$el.removeClass("disabled")},disable:function(){this.$el.addClass("disabled")},reset:function(){this.hideMenu()},show:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(118),o=n(1),i=n(5);return t.extend({name:"zoom",label:"缩放",defaultValue:100,items:{100:"100%",125:"125%",150:"150%",175:"175%",200:"200%",225:"225%",250:"250%",275:"275%",300:"300%"},templateName:"toolbar-combo-box-zoom",editorEvents:{"yne-editing-zoom-change":"onEditingZoomChange"},getUnlistedText:function(e){var t=parseInt(e,10);return t&&!isNaN(t)?t+"%":this.defaultValue+"%"},onChange:function(e){o.log("selected item is ",e),this.editor.zoomEditor(e/100)},onEditingZoomChange:function(e){this.select(100*e)},reset:function(){var e;this.hideMenu(),e=this.editor.getCurrentZoomValue(),this.select(100*e)},updateValueUI:function(e){var t=i(this.valueWrapperEl).find(".combo-value")[0];this.items[e]?i(t).text(this.items[e]):(o.warn("unexpected zoom value:",e),i(t).text(this.getUnlistedText(e)||""))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(118),o=n(5),i=n(0),r=n(6),a=n(1),s=n(95);return t.extend({name:"set-background",defaultValue:r.DEFAULT_BACKGROUND,label:"笔记背景",items:{},templateName:"toolbar-combo-box-set-background",editorEvents:{"set-all-backgrounds":"onAllBackgroundsSet","set-background":"onBackgroundChanged","yne-background-changed":"onBackgroundChanged"},_isAllBackgroundsReady:!1,_isVIPUser:!1,_normalBackground:null,_vipBackground:null,_CSS_SHADOW:"0px 0px 0px 1.5px #4C98EF",enable:function(){this._updateEnableState()},disable:function(){this._updateEnableState()},render:function(){i.isEmpty(this.items)&&this._isAllBackgroundsReady&&(this.items={normalUser:this._normalBackground,VIP:this._vipBackground}),t.prototype.render.apply(this)},onAllBackgroundsSet:function(e,t){var n,o=this,r=0,a=0,l={};o._isVIPUser=!!t,o._normalBackground=[],o._vipBackground=[],l.URI=o.defaultValue,l.isForVIP="false",(n=JSON.parse(e)).unshift(l),i.each(n,function(e){s.parseToBoolean(e.isForVIP,!1)?(o._vipBackground[a]||(o._vipBackground[a]=[]),o._vipBackground[a].push(e.URI),3===o._vipBackground[a].length&&a++):(o._normalBackground[r]||(o._normalBackground[r]=[]),o._normalBackground[r].push(e.URI),3===o._normalBackground[r].length&&r++)}),o.items={},o._isAllBackgroundsReady=!0,o.render(),o.show()},onBackgroundChanged:function(e,t){var n,r,s,l=this,c=[t,l.defaultValue];l._resetAllSelection(),i.some(c,function(e){return 0!==(r=l.$el.find('[data-value="'+e+'"]')).length&&(n=e,!0)}),o(r[0]).css("box-shadow",l._CSS_SHADOW),s=o(r[0]).find(".background-cell-check-mark"),o(s).css("visibility","visible"),l.value=n,n!==t&&(a.error("failed to find specified URI:",t),l.editor.trigger("background-failed-update",1,n))},onChange:function(e){this.editor.updateBackground(e)},onItemClick:function(e){var n=this,i=o(e).data("value");n.editor.trigger("yne-is-vip-user",function(e){null!==e&&(n._isVIPUser=!!e)}),n._isVIPUser||!n._isVIPBackground(i)?t.prototype.onItemClick.apply(n,[e]):n.editor.trigger("background-failed-update",0)},show:function(){var e=!1;return this._isAllBackgroundsReady?(e=!0,this.$el.show(),this._updateEnableState()):this.$el.hide(),e},reset:function(){this.value=null,this.$el.find(".background-cell").css("box-shadow",""),this.$el.find(".background-cell-check-mark").css("visibility","hidden"),this._updateEnableState()},_isBackgroundDisabled:function(){return(this.editor.getEditorProps()||{}).disableBackground},_isVIPBackground:function(e){var t=!0;return i.some(this._normalBackground,function(n){if(i.contains(n,e))return t=!1,!0}),t},_resetAllSelection:function(){this.$el.find(".background-cell-check-mark").css("visibility","hidden"),this.$el.find(".background-cell").css("box-shadow","")},_updateEnableState:function(){this._isBackgroundDisabled()?t.prototype.disable.apply(this):t.prototype.enable.apply(this)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"edit",text:"编辑"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"insert",text:"插入"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"more",text:"更多"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"view",text:"视图"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(101).extend({name:"export",text:"导出"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(119),o=n(411);return t.extend({name:"code-language",label:"语言",defaultValue:"javascript",items:o,templateName:"toolbar-combo-box-font-size",onChange:function(e){var t=this.editor.controller.getNoteRange().getStartBlockRange().block;this.editor.execCommandByToolbar("comp.SetCodeLanguage",{block:t,newLanguage:e})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{javascript:"JavaScript",java:"Java",python:"Python",php:"PHP",csharp:"C#",cpp:"C++",css:"CSS",ruby:"Ruby",c:"C",objectivec:"Objective-C",swift:"Swift",scala:"Scala",shell:"Shell",go:"Go",r:"R",typescript:"Typescript",html:"HTML",markdown:"Markdown",kotlin:"Kotlin",json:"JSON",xml:"XML",sql:"SQL",matlab:"MATLAB"}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(119).extend({name:"code-theme",label:"主题",defaultValue:"default",items:{default:"默认主题",tomorrow:"宁静深邃",coy:"清新条纹",okaidia:"暗夜繁星",Ateliersulphurpool:"轻快蓝调",vs:"简约线条"},templateName:"toolbar-combo-box-font-size",onChange:function(e){var t=this.editor.controller.getNoteRange().getStartBlockRange().block;this.editor.execCommandByToolbar("comp.SetCodeTheme",{block:t,newTheme:e})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(102),o=n(0),i=n(5);return t.extend({name:"table-justify",label:"垂直对齐",defaultValue:"middle",isVisible:!1,items:{top:"顶端对齐",middle:"水平居中",bottom:"底端对齐"},templateName:"toolbar-combo-box-align",updateValueUI:function(e){var t=i(this.valueWrapperEl).find(".combo-value")[0];i(t).removeClass(o.keys(this.items).join(" ")),i(t).addClass(e)},onEditingStateChange:function(){this.enable()},onChange:function(e){var t=this.editor;e&&t.execCommandByToolbar("comp.SetTableCellBlockStyle",{styles:{verticalAlign:e}})},onSelectionChange:function(){var e;e=this.editor.querySelectionBlockStyle("verticalAlign"),this.items[e]?this.select(e):this.select(this.defaultValue)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"table-wrap",label:"自动换行",defaultState:!0,isVisible:!1,templateName:"toolbar-button-template",onEditingStateChange:function(){var e;e=this.editor.querySelectionBlockStyle("wrap"),this.setState(null==e?this.defaultState:e)},onClick:function(){this.editor.execCommandByToolbar("comp.SetTableCellBlockStyle",{toggle:"wrap",default:this.defaultState})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(102),o=n(73),i=n(0),r=n(5);return t.extend({name:"table-operate",label:"操作表格",defaultValue:"",isVisible:!1,items:{insertRowUp:"在上方插入行",insertRowDown:"在下方插入行",deleteRow:"删除整行",insertColLeft:"在左侧插入列",insertColRight:"在右侧插入列",deleteCol:"删除整列",deleteTable:"删除整个表格"},templateName:"toolbar-combo-box-align",updateValueUI:function(e){var t=r(this.valueWrapperEl).find(".combo-value")[0];r(t).removeClass(i.keys(this.items).join(" ")),r(t).addClass(e)},onChange:function(e){var t,n,i=this.editor;e&&("insertRowUp"===e&&(t=o.UP),"insertRowDown"===e&&(t=o.DOWN),"insertColLeft"===e&&(n=o.LEFT),"insertColRight"===e&&(n=o.RIGHT),t&&i.execCommandByToolbar("comp.InsertTableRowCol",{describe:{row:t}}),n&&i.execCommandByToolbar("comp.InsertTableRowCol",{describe:{col:n}}),"deleteRow"===e&&i.execCommandByToolbar("comp.DeleteTableRowCol",{describe:{row:!0}}),"deleteCol"===e&&i.execCommandByToolbar("comp.DeleteTableRowCol",{describe:{col:!0}}),"deleteTable"===e&&i.execCommandByToolbar("comp.DeleteNoteRange",{isTableDelete:!0}),this.value="")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(204),o=n(0);return t.extend({name:"table-split",isVisible:!1,initialize:function(e){this.editor=e.editor,this.bindEditorEvents(),this.isVisible||this.hide()},editorEvents:{"yne-selection-change":"onSelectionChange"},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(27).extend({name:"table-merge",label:"合并单元格",defaultState:!1,isVisible:!1,templateName:"toolbar-button-template",onClick:function(){this.editor.execCommandByToolbar("comp.ToggleMergeTableCell")},onSelectionChange:function(){var e=this.editor.controller.getNoteRange().getStartBlockRange(),t=e.getAsRectRange&&e.getAsRectRange(),n=t&&t.onlyMergePointAndCell();this.label=n?"拆分单元格":"合并单元格",this.render(),this.setState(n)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(204),o=n(0);return t.extend({name:"no-table-split",isVisible:!1,initialize:function(e){this.editor=e.editor,this.bindEditorEvents(),this.isVisible||this.hide()},editorEvents:{"yne-selection-change":"onSelectionChange"},bindEditorEvents:function(){var e=this,t=e.editor,n=e.editorEvents;n&&o.each(n,function(n,o){t.on(o,e[n].bind(e))})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(202),o=n(203).get("toggle-tab"),i=n(420),r=n(421),a=n(422),s=n(423),l=n(424),c=n(0),d=n(5),u=n(95);return t.extend({className:"bulb-tab-body",initialize:function(e){var t;this._editor=e.editor,this._parentEl=e.parentEl,this.isRendered=!1,this._toggleTabButton=null,this._current=null,t={editor:e.editor,shrinkOffset:this.shrinkOffsetForPanel.bind(this)},this._toolPanels={edit:new i(t)},this._editor.isLegacyHost()&&(this._toolPanels.insert=new r(t),this._toolPanels.view=new s(t),this._toolPanels.export=new l(t),this._toolPanels.more=new a(t)),this.render(),this.switchTo("edit")},shrinkOffsetForPanel:function(){return this._toggleTabButton?0-this._toggleTabButton.$el.outerWidth(!0):0},render:function(){var e=this;e.isRendered||(e.isRendered=!0,d(e._parentEl).append(e.$el),e._editor.isLegacyHost()&&(e._toggleTabButton=new o({editor:e._editor}),e.$el.append(e._toggleTabButton.$el),e._toggleTabButton.on("toggle-tab",function(){e.trigger("toggle-tab")})),c.each(e._toolPanels,function(t,n){if(!t)throw"No panel objecet for "+n;e.$el.append(t.$el)}))},switchTo:function(e){var t=this,n=t._toolPanels;t._current!==e&&n[e]&&c.each(n,function(n,o){o===e?(n.show(),t._current=e):n.hide()})},_setEnable:function(e){c.each(this._toolPanels,function(t){t&&(e&&t.enable?t.enable():!e&&t.disable&&t.disable())})},enable:function(){this._setEnable(!0)},disable:function(){this._setEnable(!1)},reset:function(){c.each(this._toolPanels,function(e){e.reset()}),this._current=null,this.switchTo("edit")},enterFullScreen:function(){this._toggleTabButton&&this._toggleTabButton.hide()},exitFullScreen:function(){this._toggleTabButton&&this._toggleTabButton.show()},getCurrentTabName:function(){return this._current},toggle:function(e){null!=e?(e=u.parseToBoolean(e,!0),this.$el.toggle(e)):this.$el.toggle()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(100),o=n(2),i=n(203),r=n(233),a=n(0),s=n(5),l=t.extend({className:"tool-panel tool-panel-edit",buttonConfig:["undo","redo","remove-format","format-painter","---","heading","no-table-split","code-language","font-family","---","font-size","code-theme","bold","italic","underline","strike","---","color","back-color","no-table-split","unordered-list","ordered-list","todo","quote","code","---","align","table-justify","indent","outdent","line-height","table-wrap","table-operate","table-split","table-merge"],_morePanelName:".tool-panel-edit-more",_btnToggleAllItems:null,_$morePanel:null,_lastRangeType:null,initialize:function(){l.__super__.initialize.apply(this,arguments),this._bindEvents()},_bindEvents:function(){var e=this,t=e._editor,n=r.EDITOR_BUTTON_STATE_MAP;l.__super__._bindEvents.apply(e,arguments),t.on("yne-editing-state-change",function(){var i,s=t.getNoteRange(),l=t.hasHandWriteBlock(),c=r.RANGE_DEFAULT;s&&(i=s.getStartBlockRange().block,o.isHeaderFooter(i)?c=l?r.HANDWRITE_DEFAULT:r.RANGE_HEADER_FOOTER:o.isImage(i)?c=r.RANGE_IMAGE:o.isAttachment(i)?c=r.RANGE_ATTACHMENT:o.isCatalogue(i)?c=l?r.HANDWRITE_DEFAULT:r.RANGE_CATALOGUE:s.isSingleTableSelected()?c=r.RANGE_TABLE_CELL:o.isQuote(i)?c=r.RANGE_QUOTE:o.isCode(i)&&(c=r.RANGE_CODE)),e._lastRangeType!==c&&(e._$morePanel&&e._$morePanel.css("height",e._$morePanel.height()),e._lastRangeType=c,a.each(e._items,function(e){var t,o=n[e.name],i=r.ACTION_SHOW_ENABLE;switch(a.each(o,function(e){e.on===r.RANGE_DEFAULT&&(i=e.action),e.on===c&&(t=e.action)}),null==t&&(t=i),t){case r.ACTION_SHOW_ENABLE:e.show(),e.enable();break;case r.ACTION_HIDE:e.hide();break;case r.ACTION_ENABLE:e.enable();break;case r.ACTION_DISABLE:e.show(),e.disable()}}),e._reShrink())})},_addButtons:function(e){var t;l.__super__._addButtons.apply(this,[e]),this._editor.isLegacyHost()||(t=i.get("toggle-allItems"),this._btnToggleAllItems=new t({editor:this._editor}),this.addItems(this._btnToggleAllItems),this._btnToggleAllItems.bind("toggle-allItems",this._onToggleAllItems.bind(this)))},_shrink:function(){var e,t=this;e=l.__super__._shrink.apply(t),t._editor.isLegacyHost()||(null==t._$morePanel&&(t.$el.after('<div class="tool-panel tool-panel-edit-more"></div>'),t._$morePanel=s(t._morePanelName),t._$morePanel.hide()),0===e.length?(t._$morePanel.slideUp(500,function(){t._editor.updateNoteViewWrapperSize()}),t._btnToggleAllItems.hide()):(t._$morePanel.empty(),a.each(e,function(e){t._$morePanel.append(e.$el)}),t._btnToggleAllItems.show()),t._onToggleAllItems())},_onToggleAllItems:function(){var e=this;null!=e._$morePanel&&null!=e._btnToggleAllItems&&(e._btnToggleAllItems.isCollapsed()||!1===e._btnToggleAllItems.isVisible?e._$morePanel.slideUp(500,function(){e._editor.updateNoteViewWrapperSize()}):(e._$morePanel.css("height","auto"),e._$morePanel.slideDown(250,function(){e._editor.updateNoteViewWrapperSize()})))}});return l}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(100).extend({className:"tool-panel tool-panel-insert",buttonConfig:["undo","redo","img","attachment","table","hr","link","catalogue","snap-screen"]})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(100).extend({className:"tool-panel tool-panel-more",buttonConfig:["undo","redo","zoom","view-mode","export-pdf","set-background"]})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(100).extend({className:"tool-panel tool-panel-view",buttonConfig:["undo","redo","view-mode","zoom","set-background"]})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(100).extend({className:"tool-panel tool-panel-export",buttonConfig:["undo","redo","export-pdf","export-word","download-file"]})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(426),o=n(19),i=n(0),r=n(28),a=new t({}),s={color:{valueInView:"#393939",compareEqual:function(e,t){return r.equals(e,t)}},"font-family":{valueInView:["-apple-system","BlinkMacSystemFont","PingFang SC","Helvetica","Tahoma","Arial","Hiragino Sans GB","Microsoft YaHei","微软雅黑","SimSun","宋体","Heiti","黑体","sans-serif"].join(",")},"color-catalogue":{valueInView:"#003884",value:o.getDefault("color"),compareEqual:function(e,t){return r.equals(e,t)}}};return i.each(s,function(e,t){var n={name:t,valueInView:e.valueInView,value:o.getDefault(t)||e.value,compareEqual:e.compareEqual};a.addMappingRule(n)}),a}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){return n(427).extend({name:"InlineStyleViewMapper"})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(16),o=n(1);return t.extend({initialize:function(){this._mappingRules={},delete this.options},_isValidMappingRule:function(e){return!(!e||!e.name||null==e.value||null==e.valueInView)},addMappingRule:function(e){var t,n=this._mappingRules;this._isValidMappingRule(e)?n[t=e.name]?o.error("Failed to add mapping rule, mapping rule do exists",e):this._mappingRules[t]=e:o.error("Failed to add mapping rule, parameter is not valid",e)},valueFromView:function(e,t){var n=this._mappingRules[e],i=t;return n&&(n.compareEqual?n.compareEqual(t,n.valueInView):t===n.valueInView)&&(i=n.value),o.log("valueFromView name/valueInView => value: "+e+"/"+t+" => "+i),i},valueToView:function(e,t){var n=this._mappingRules[e],o=t;return n&&(n.compareEqual?n.compareEqual(t,n.value):t===n.value)&&(o=n.valueInView),o}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(1),i=n(429);return t=i.extend({render:function(){var e=this;t.__super__.render.apply(e,arguments),e.options.noteviewFrame.off("contextmenu"),e.options.noteviewFrame.contextmenu(function(t){e._onContextMenu(t)}),o.log("PC noteview render done.")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(5),i=n(20),r=n(6),a=n(137),s=n(127),l=n(128),c=n(17),d=n(52),u=n(430),h=n(2),p=n(434),g=n(40),f=n(43),m=n(36),y=n(1),_=n(35),I=n(88),b=n(36),v=n(486),k=n(133),C=n(487),w=n(238);return i.View.extend({className:"note-view",attributes:{tabIndex:1,spellcheck:!1,contenteditable:"true"},directionKeyJustMoved:!1,_isOnMouseDown:!1,events:{textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",mousedown:"_onMouseDown",mouseup:"_onMouseUp",selectstart:"_onSelectStart",contextmenu:"_onContextMenu",dragstart:"_onDragDropEvent",dragover:"_onDragDropEvent",drop:"_onDragDropEvent",dragend:"_onDragEnd",copy:"_onCopy",cut:"_onCut",paste:"_onPaste","click a[href]":"_onAnchorClick",click:"_onClick",blur:"_onBlur",focus:"_onFocus"},note:null,blockViews:null,tableViews:null,headerView:null,footerView:null,_keyMonitor:null,_inlineStyleViewMapper:null,isOnComposition:!1,_isSilent:!1,_noteEvents:{"insert-block":"_onInsertBlock","remove-block":"_onRemoveBlock","replace-block":"_onReplaceBlock","read-only-change":"_onReadOnlyChange","high-light":"_onHighlight","next-high-light":"_onNextHighlight","pre-high-light":"_onPreHighlight","content-parse-done":"_onContentParseDone","header-footer-changed":"_OnHeaderFooterChanged","clear-high-light":"_onClearHighlight","copy-prohibited":"_onCopyPSrohibited"},_docEvents:{selectionchange:"_onSelectionChange"},_shouldStopComposition:!1,_affectedViewsByComposition:null,_pageBatchTimer:null,_pageBatchPendingQueue:null,_viewMode:null,_renderBatchTimer:null,_currentZoom:null,_disableOCR:null,initialize:function(e){this._bindEventHandlers(),this.setOptions(e),this._bindEventsForDoc(),this._bindEventsForThis(),this.highlightView=new v,this._pageBatchPendingQueue=[],e.inlineStyleViewMapper&&(this._inlineStyleViewMapper=e.inlineStyleViewMapper),this._currentZoom=1},createHeaderFooterView:function(e){var t,n,o,i;if(null!=(n=(t=this).note))return(o=n.getHeaderFooter(e))||(o=k.createBlank(e),n.setHeaderFooter(o,e)),(i=new C(o,t.isReadOnly())).on("focus",function(){t.trigger("set-range",c.createForHeaderFooter(o),!0,!0)}).on("blur",function(e){t.trigger("selectionchange",e)}).on("text-input",function(e){t.trigger("header-footer-view-text-change",e,i.block)}),i},_renderHeaderFooterView:function(e){e.prepend(this.headerView.$el),e.append(this.footerView.$el)},_removeHeaderFooterView:function(){null!=this.headerView&&(this.headerView.remove(),this.headerView=null),null!=this.footerView&&(this.footerView.remove(),this.footerView=null)},_OnHeaderFooterChanged:function(e){var t=this.options.noteviewFrame;this.isInPageMode()&&(e?(null!=this.footerView&&this.footerView.remove(),this.footerView=this.createHeaderFooterView(e),null!=t&&t.append(this.footerView.$el)):(null!=this.headerView&&this.headerView.remove(),this.headerView=this.createHeaderFooterView(e),null!=t&&t.prepend(this.headerView.$el)))},_bindEventHandlers:function(){var e=this,n=function(n){y.log("bindHandlers: "+n),t.bindAll(e,n)};t.each(e._noteEvents,n),t.each(e._docEvents,n)},_setNote:function(e){this.removeNote(),this.note=e,this._bindEventsForNote()},removeNote:function(){this.note&&this._unbindEventsForNote(),this.note=null},reset:function(){var e;(this.removeNote(),this.$el.html(""),this.blockViews=this._clearBlockViews(this.blockViews),this.options&&(this.options.note=null,this.options.isNoteSet=!1,(e=this.options.noteviewFrame)&&(e.find(".header-footer-input").prop("contenteditable",!0),e.removeClass("has-handwrite"))),this.$el.removeClass("read-only"),this._keyMonitor&&this._keyMonitor.clearCache(),o(document.head).find("style.note-style").remove(),this._isSilent=!1,window.parent!==window)&&window.getSelection().removeAllRanges();this._pageBatchTimer&&(window.clearTimeout(this._pageBatchTimer),this._pageBatchTimer=null),this._renderBatchTimer&&(clearTimeout(this._renderBatchTimer),this._renderBatchTimer=null),this._pageBatchPendingQueue=[],this._removeHeaderFooterView()},setOptions:function(e){if(e=e||{},null==this.options)this.options=t.clone(e);else for(var n in e)e.hasOwnProperty(n)&&(this.options[n]=e[n]);null!=this.options.note&&this._setNote(this.options.note),null!=this.options.viewMode&&(this._viewMode=this.options.viewMode),this._disableOCR=!!this.options.disableOCR},render:function(){var e=this.$el,t=this.highlightView,n=this.options.noteviewFrame;this.blockViews=this.blockViews?this._clearBlockViews(this.blockViews):[],this.tableViews=[],e.html(""),o(document.head).find("style.note-style").remove(),o(document.head).append('<style class="note-style"></style>'),e.append(t.$el),this.isInPageMode()?this._enablePageMode(!1):this._disablePageMode(this._viewMode),window.YNE_PLATFORM&&e.addClass("platform-"+window.YNE_PLATFORM),null!=n&&n.find(".header-footer-input").prop("contenteditable",!this.isReadOnly()),null!=this._renderBatchTimer&&(clearTimeout(this._renderBatchTimer),this._renderBatchTimer=null),this._renderInBatch(0)},_renderInBatch:function(e){var t,n,o=this.note,i=Date.now();if(null!=o){for(;e<o.blocks.length&&(t=o.blocks[e],(n=this._createBlockView(t))||y.warn("Failed to create block view!"),this.blockViews.push(n),this.$el.append(n.$el),n.render(),this._bindEventsForBlockView(t,n),this._setPageInfo(e),e++,!(Date.now()-i>100)););e<o.blocks.length&&(this._renderBatchTimer=setTimeout(this._renderInBatch.bind(this,e),10))}},_repairBlockViews:function(e){var n,o,i,r=this,a=[];e&&e.length>0&&(n=e.shift(),a.push(n),e.length>0&&(o=e.pop(),a.push(o)),r._isElementExisting(n.cid)||((i=r.getBlockViewIndex(n)-1)>=0?r.getBlockViewAt(i).$el.after(n.$el):r.getBlockViewAt(0).$el.before(n.$el)),o&&!r._isElementExisting(o.cid)&&n.$el.after(o.$el),r.reRenderTextBlockView(a),t.each(e,function(e){r._isElementExisting(e.cid)||o.$el.before(e.$el)}))},_isElementExisting:function(e){return this.$el.find('[data-yne-cid="'+e+'"]').length>0},reRenderTextBlockView:function(e){e=e||this.blockViews,t.each(e,function(e){var t=e.block;h.isTextBlock(t)&&e.render()})},_listenerEventsForBlockView:function(e){var n={command:"onCommand","get-read-only-status":"_onGetReadOnlyStatus"};return h.isTable(e)&&(n=t.extend(n,{"select-all":"onSelectAll","save-content":"_onSaveContent"})),n},_bubbleEventsForBlockView:function(e){var n={"locked-change":!0};switch(h.getType(e)){case h.IMAGE:n=t.extend(n,{contextmenu:!0,"request-rendered-imagSrc":!0,"yne-replace-image":!0,"yne-open-image":!0,"yne-download-image":!0,"get-image-items":!0,"img-title-edit-start":!0,"img-title-edit-end":!0,"img-title-edit-focus":!0,"img-title-edit-exit":!0,"img-title-edit-update":!0,"yne-image-ocr":!0,"yne-request-image-rendered-src":!0});break;case h.ATTACHMENT:n=t.extend(n,{"yne-replace-attachment":!0,"yne-open-attachment":!0,"yne-download-attachment":!0,"yne-mac-preview":!0});break;case h.TABLE:n=t.extend(n,{"yne-download-attachment":!0,"yne-on-paste":!0,"get-note-range":!0,"link-menu-show":!0,"link-menu-hide":!0,"move-caret":!0,"set-range":!0,"global-redo":!0,"global-undo":!0,copy:!0,cut:!0,"cell-edit-view-selection-change":!0,"cell-edit-view-enter":!0,"cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"cell-edit-view-command-executed":!0,"yne-blob-paste":!0});break;case h.QUOTE:case h.TODO:case h.PARAGRAPH:case h.HEADING:n=t.extend(n,{"link-menu-show":!0,"link-menu-hide":!0,"get-entity":!0});break;case h.LIST_ITEM:n=t.extend(n,{"get-editing-styles":!0,"link-menu-show":!0,"link-menu-hide":!0});break;case h.CATALOGUE:n=t.extend(n,{"inner-goto":!0})}return n},_unbindEventsForBlockView:function(e,n){var o=function(e){e&&t.each(e,function(e,t){n.off(t)})};o(this._listenerEventsForBlockView(e)),o(this._bubbleEventsForBlockView(e))},_bindEventsForBlockView:function(e,t,n){var o;(n=!1!==n)&&this._unbindEventsForBlockView(e,t),o=this._listenerEventsForBlockView(e),_.addListeners(o,t,this),o=this._bubbleEventsForBlockView(e),_.bubble(o,t,this)},setHtmlContentEditable:function(e){this.$el.attr("contenteditable",!!e)},getHtmlContentEditable:function(){return"true"===this.el.contentEditable+""},updateFormatPainterCursorUI:function(e){e?this.$el.addClass("format-painter-active"):this.$el.removeClass("format-painter-active")},_handleNoteEvents:function(e){var n=this,o=n.note;o&&o.on&&o.off?t.each(n._noteEvents,function(t,i){e?o.on(i,n[t]):o.off(i,n[t])}):y.warn("Failed to bind note events!")},_bindEventsForNote:function(){this._handleNoteEvents(!0)},_unbindEventsForNote:function(){this._handleNoteEvents(!1)},_bindEventsForDoc:function(){var e=this,n=o(document);t.each(e._docEvents,function(t,o){y.log("bind document event: "+o+" -> "+t),y.log(e[t]),n.on(o,e[t])})},_bindEventsForThis:function(){this.on("draw-range",this._onDrawRange.bind(this)),this.on("resize",this._onResize.bind(this))},_onChangeHandwriteBlock:function(e){var t=this.options.noteviewFrame;e?t.addClass("has-handwrite"):this.note.hasHandWriteBlock()||t.removeClass("has-handwrite")},bindKey:function(e){var t=this,n=t._keyMonitor;e&&(n||(t._keyMonitor=n=new a({el:t.el})),n.unbind(e),n.bind(e,function(n){t.trigger("key-pressed",e,n)}),t._keyMonitor=n)},unbindKey:function(e){var t=this._keyMonitor;t&&e&&t.unbind(e)},_onDrawRange:function(e,t){var n=this;n._silentDo(function(){n._drawRange(e,t)})},_updateSelectionUI:function(e){var t,n,o,i,r,a;e?null!=this.note?(c.isNoteRange(e)?(o=e.getStartBlockRange(),i=e.getEndBlockRange(),t=this.note.getBlockIndex(o.block),n=this.note.getBlockIndex(i.block)):(r=this.getBlockViewContainer(e.startContainer),a=this.getBlockViewContainer(e.endContainer),t=this.getBlockViewIndex(r),n=this.getBlockViewIndex(a)),this._selectAttachments(t,n,e),this._selectCatalogueTables(t,n)):y.warn("Note has been dettached."):y.warn("The range is not valid!")},_selectAttachments:function(e,n){-1!==e&&-1!==n?e!==n&&t.each(this.blockViews,function(t,o){if(t){var i=o>=e&&o<=n;t.selectAttachment&&t.selectAttachment(i)}}):y.warn("start or end is -1")},_selectCatalogueTables:function(e,n){var o,i=[];-1!==e&&-1!==n&&t.each(this.blockViews,function(t,r){if(t){var a=r>=e&&r<=n;if(t.selectTable)t.selectTable(a);else if(t.selectCatalogue){if(o=t.getOwnerId(),!a&&i[o])return;i[o]=!0,t.selectCatalogue(a)}}})},_drawRange:function(e,t){if(e&&e.canDrawedByNative){var n,o,i,r,a=e.getStartBlockRange(),s=a.block;if(t=!1!==t,this._clearCustomSelectionUI(s),h.isCode(s)&&(r=this.getBlockViewByBlock(s)),e.canDrawedByNative())this.setHtmlContentEditable(!0),this._updateSelectionUI(e),n=e.toNativeRange(this),d.setRange(n,window),t&&this._scrollNativeSelectionIntoWrapper(n,r);else{if(this.setHtmlContentEditable(!1),e.isInMultiBlock())return void y.warn("The note range is note valid!");a=e.getStartBlockRange(),null!=this.note&&(o=this.note.getBlockIndex(a.block),(i=this.getBlockViewAt(o))&&i.trigger("draw-range",a,s))}}else y.log("note range is not valid!")},_isZeroRect:function(e){return!e||0===e.width&&0===e.height},_scrollNativeSelectionIntoWrapper:function(e,t){var n,o;this._isOnMouseDown||(e?(e.collapsed?(n=e.getClientRects()[0],this._isZeroRect(n)&&(n=e.getBoundingClientRect())):n=e.getBoundingClientRect(),this._isZeroRect(n)&&(1!==(o=e.commonAncestorContainer).nodeType&&(o=o.parentNode),n=o.getBoundingClientRect()),this._isZeroRect(n)?y.error("can not get selection client rect"):this._scrollRectIntoWrapper(n,t)):y.warn("range not found"))},_getWrapper:function(){for(var e=this.el.parentNode;e;){if(o(e).is(".note-view-wrapper"))return e;e=e.parentNode}},_scrollRectIntoWrapper:function(e,t){var n,o,i=this._getWrapper(),r=i.getBoundingClientRect(),a=r.top,s=r.bottom,l=r.height,c=r.left,d=r.right,u=e.top*this._currentZoom,h=e.bottom*this._currentZoom,p=e.height*this._currentZoom,g=e.left*this._currentZoom,f=null,m=null,y=c+30+10;this._isZeroRect(e)||(t&&(o=(n=t._getContentContainer().get(0)).clientWidth),i.scrollHeight!==i.clientHeight&&(s-=11,l-=11),i.scrollBarWidth!==i.clientWidth&&(d-=11),p>l?(h<0||u>l)&&(m=h-l):u<a||u-a<=10?m=-1*Math.abs(u-a):h>s||s-h<=10?m=Math.abs(h-s):h===s&&(m=10),g>=d||d-g<=10?f=Math.abs(g-d):(g<=c||g-c<=10)&&(f=-1*Math.abs(g-c)),this._scrollWrapperBy(f,m),n&&(g>o||g<y)&&(n.scrollLeft+=g-y))},_scrollWrapperBy:function(e,n){var o=this._getWrapper();e>0?e+=20:e<0&&(e-=20),n>0?n+=20:n<0&&(n-=20),t.isNumber(e)&&(o.scrollLeft+=e),t.isNumber(n)&&(o.scrollTop+=n)},parseNativeRange:function(e){if(e&&e.startContainer){var t=e.startContainer,n=e.endContainer;if(C.isHeaderView(t))return[new u[h.HEADER_FOOTER]({block:this.note.getHeaderFooter(!1)})];if(C.isFooterView(t))return[new u[h.HEADER_FOOTER]({block:this.note.getHeaderFooter(!0)})];var o,i,r,a,s=this.getBlockViewContainer(t),l=this.getBlockViewContainer(n),c=this.getBlockViewIndex(s),d=this.getBlockViewIndex(l),p=[];if(-1!==c&&-1!==d){if(null!=this.note){for(o=c;o<=d;o++)r=this.blockViews[o],i=this.note.getBlockAt(o),(a=r.parseNativeRange(e,i,o!==c&&o!==d))?p.push(a):y.warn("Failed to parse native range to block range!");return p}y.warn("note has been dettached.")}else y.warn("start/end block index is -1 !")}else y.warn("no native range!")},_isRangeInTableBlock:function(){return d.isRangeInSelector(".block-view.table-view")},_onSelectionChange:function(e){var t=!d.isRangeInNode(this.el),n=d.getRange(),o=null;if(this._updateSelectionUI(n),t?(o="The native range is not in note view!",y.log(o)):w.isRangeInCellEditArea(n)?(o="The native range is in table cell edit area",y.log(o)):this._isSilent?o="The _isSilent flag is true!":this.isOnComposition&&(o="The isOnComposition flag is true!"),!o){if(this._isRangeInTableBlock()){if(!this.directionKeyJustMoved)return o="The selection/range is in table box!",y.log("  selection change deprecated!XXXXXXX"),void y.log(o);this.directionKeyJustMoved=!1}this.trigger("selectionchange",e),this._scrollNativeSelectionIntoWrapper(n)}},_silentDo:function(e){var t=this;if(t._isSilent=!0,y.DEBUG)e();else try{e()}catch(e){y.warn("silent do error")}window.setTimeout(function(){t._isSilent=!1},0)},clearNativeSelectionUI:function(){d.getSelection(window).removeAllRanges()},_clearCustomSelectionUI:function(e){var n=this.blockViews;t.each(n,function(t){t.trigger("draw-range",null,e)})},_appendBlankLineIfNeed:function(){var e,t=this.note;t&&((e=t.getLastBlock())&&(!e||t.lastBlockIsEasyInput()&&!e.isLocked())||this.trigger("note-append-blankparagraph",e))},focusLastBlankLine:function(){var e=this;e._appendBlankLineIfNeed(),window.setTimeout(function(){var t=e.getLastBlockView();o(t.el).trigger("mousedown")},50)},isReadOnly:function(){var e=this.note;return null==e||e&&e.isReadOnly()},isDragProhibited:function(){var e=this.note;return null==e||e&&e.isDragProhibited()},isCopyProhibited:function(){var e=this.note;return null==e||e&&e.isCopyProhibited()},_onGetReadOnlyStatus:function(e){e&&e(this.isReadOnly())},_isAtEndOfTextBlock:function(e,t){if(!document.caretRangeFromPoint)return!1;var n,i,r=document.caretRangeFromPoint(e.clientX,e.clientY),a=t.querySelector(".para-text");if(!a||!r||!r.collapsed)return!1;if(n=r.commonAncestorContainer,f.isText(n)){if(r.startOffset!==n.nodeValue.length)return!1;n=n.parentNode}if(!o.contains(a,n))return!1;for(;n&&n!==a;){if((i=n.parentNode).lastChild!==n)return!1;n=i}return!0},_onMouseDown:function(e){var t,n,i,r,a,s,l,d=3===(e.keyCode||e.which);if(this._isOnMouseDown=!0,this._clearHighlight(),this.$el.removeClass("highlight"),!this.isReadOnly()&&(t=this.getBlockViewContainer(e.target),n=this.getBlock(e.target),this._preventSelectStart=!1,!d||(b.isSafari()&&t&&this._isAtEndOfTextBlock(e,t)&&(this._preventSelectStart=!0),o(t).is(".image-view, .attachment-view, .table-view")))){if(!n||n.isLocked())return y.log("_onMouseDown(): block is null or locked!"),void this.focusLastBlankLine();if(this.trigger("mouse-down",e),i=h.getType(n),s=u[i])switch(r=new s({block:n}),a=new c({startRange:r,endRange:r}),i){case h.IMAGE:case h.ATTACHMENT:case h.HANDWRITE:this.setHtmlContentEditable(!0),t.focus(),this.trigger("set-range",a,!0,!0);break;case h.QUOTE:case h.CODE:case h.TODO:case h.PARAGRAPH:case h.LIST_ITEM:case h.HEADING:case h.CATALOGUE:(e=e.originalEvent||e).detail>2?(e.preventDefault(),r.expandToEnd(),l=!0):(l=!1,a=document.caretRangeFromPoint(e.clientX,e.clientY)),this.setHtmlContentEditable(!0),this._clearCustomSelectionUI(n),this.trigger("backup-drag-range"),window.Cypress?setTimeout(function(){this.trigger("set-range",a,!0,!0)}.bind(this),0):this.trigger("set-range",a,l,!0);break;case h.TABLE:break;case h.HR:this.trigger("set-range",a,!0,!0);break;case h.UNKNOWN:this.setHtmlContentEditable(!1),this.trigger("set-range",a,!0,!0)}else y.warn("_onMouseDown is not handled, block type is "+i);this.lastBlock=n}},_clearHighlight:function(){this.highlightView.$el.remove(),this._onClearHighlight()},_onMouseUp:function(){this._isOnMouseDown=!1},_onAnchorClick:function(e){var t,n=e.currentTarget;if(e.preventDefault(),t=n&&n.getAttribute("href"))return I.isNoteLinkUrl(t)?this.trigger("open-link",I.getNoteId(t),!0):void this.trigger("open-link",t)},_onSelectStart:function(e){if(!0===this._preventSelectStart)return e.preventDefault(),e.stopPropagation(),!1;this.trigger("selectstart",e)},_onTextInput:function(e){var t,n;e.preventDefault(),this.isReadOnly()||(n=e.originalEvent||e)&&(t=n.data+"")&&this.trigger("text-input",t)},_onCompositionStart:function(e){var t=this;if(t.isReadOnly())e.preventDefault();else{if(y.log("note view compositionstart ----------\x3e>>>>>"),window.clearTimeout(t._compositionEndTimer),t.setCompositionState(!0),t._shouldStopComposition=!1,t._affectedViewsByComposition=null,t.trigger("onCompositionStart",function(e,n){t._shouldStopComposition=e,t._affectedViewsByComposition=n}),t._shouldStopComposition)return e.preventDefault(),void e.stopPropagation();t.trigger("delete-selection")}},_onCompositionEnd:function(e){var t=this,n=e.originalEvent||e;if(t.isReadOnly()||t._shouldStopComposition)return e.preventDefault(),void(t._affectedViewsByComposition&&t._repairBlockViews(t._affectedViewsByComposition));y.log("note view compositionend ----------\x3e>>>>>"),n.data||t.trigger("delete-selection"),t._compositionEndTimer=window.setTimeout(function(){t.setCompositionState(!1)},0)},setCompositionState:function(e){var t;e&&(t=d.getRange(),this.trigger("set-range",t,!1,!1)),this.isOnComposition=e},_onInsertBlock:function(e,t){var n=this._createBlockView(t);g(n),this._bindEventsForBlockView(t,n),this._insertBlockView(e,n)},_onRemoveBlock:function(e,t){this._removeBlockView(e),!1!==t&&this._setPageInfo(e)},_onReplaceBlock:function(e,t){var n=this._createBlockView(t);g(n),this._replaceBlockView(e,n)},_createBlockView:function(e){var t,n=h.getType(e),o=p(n),i={};return this.isInPageMode()?this.options.pageType===r.PAGE_TYPE_A4?(i.height=r.PAGE_HEIGHT_A4,i.width=r.PAGE_WIDTH_A4):this.options.pageType===r.PAGE_TYPE_B5?(i.height=r.PAGE_HEIGHT_B5,i.width=r.PAGE_WIDTH_B5):this.options.pageType===r.PAGE_TYPE_TEST?(i.height=r.PAGE_HEIGHT_TEST,i.width=r.PAGE_WIDTH_TEST):this.options.pageType===r.PAGE_TYPE_NONE?(i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE):(y.debugAlert("Invalid pageType in PageMode:",this.options.pageType),i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE):(i.height=r.PAGE_HEIGHT_NONE,i.width=r.PAGE_WIDTH_NONE),g(!!o),(t=new o({editor:this.options.editor,block:e,isReadOnly:e.isReadOnly(),inlineStyleViewMapper:this._inlineStyleViewMapper,pageSize:i,pageBreakContainer:this.options.noteviewFrame,noteView:this,disableOCR:this._disableOCR})).on("view-height-changed",this._onBlockViewHeightChanged.bind(this)),t.on("pageBreak-inserted",this._onPageBreakInserted.bind(this)),t.on("pageBreak-positionChanged",this._onPageBreakPosChanged.bind(this)),t instanceof p(h.HANDWRITE)&&this._onChangeHandwriteBlock(!0),t},_insertBlockView:function(e,t){var n,o=this.blockViews,i=t.block,r=this.$el,a=r.children().filter(".block-view"),s=a.length;h.isQuote(i)&&(n=i.getDefaultSetFont()),o.splice(e,0,t),e===s?r.append(t.$el):a.eq(e).before(t.$el),t.render(n)},_removeBlockView:function(e){var n,o,i,r,a=this.blockViews,s=this.$el,l=this.tableViews;n=a.splice(e,1)[0],(i=t.indexOf(l,n))>=0&&l.splice(i,1),(o=(r=s.children().filter(".block-view")).eq(e))&&(o.attr("data-yne-cid")===n.cid?r.eq(e).remove():y.warn("skip div deletion whose attr is "+o.attr("data-yne-cid"))),n instanceof p(h.HANDWRITE)&&this._onChangeHandwriteBlock(!1),n.clearPageBreaks(),n.off(),n.onDestroy()},_replaceBlockView:function(e,t){var n=this.blockViews,o=this.$el;this._clearBlockViews(n.splice(e,1,t)),o.children().filter(".block-view").eq(e).replaceWith(t.$el),t.render()},getBlockViewAt:function(e){return this.blockViews[e]},getLastBlockView:function(){var e=this.blockViews;return e[e.length-1]},getBlockViewContainer:function(e){var t,n;return o(e).is(".highlight-view")?(t=this.getBlockViewAt(0))&&(n=t.el):n=o(e).closest(".block-view")[0],n},getBlockViewIndex:function(e){if(!e)return-1;return this.$el.find(">.block-view").index(e)},getBlock:function(e){var t,n,o=this.note;if(null!=o)return t=this.getBlockViewContainer(e),n=this.getBlockViewIndex(t),o.getBlockAt(n)},getBlockViewByBlock:function(e){var t;if(null!=this.note)return t=this.note.getBlockIndex(e),this.getBlockViewAt(t)},onCommand:function(e,t){var n,o,i;null==t.range&&(t.imageBlockView?(n=t.imageBlockView,t.imageBlockView=null,i=new l({block:n.block}),o=new c({blockRanges:[i]}),t.range=o):t.attachmentBlockView&&(n=t.attachmentBlockView,t.attachmentBlockView=null,i=new s({block:n.block}),o=new c({blockRanges:[i]}),t.range=o)),this.trigger("command",e,t)},_onCopy:function(e){this.trigger("copy",e)},_onCut:function(e){this.isReadOnly()?e.preventDefault():this.trigger("cut",e)},_onPaste:function(e){this.isReadOnly()?e.preventDefault():this.trigger("paste",e)},_onContextMenu:function(e){e.preventDefault(),e.stopPropagation(),this.isReadOnly()||this.trigger("contextmenu",e)},_onDragDropEvent:function(e){var t;if(!this.isReadOnly()&&!this.isDragProhibited())switch((e=e.originalEvent).type){case"dragstart":t=this.getBlock(e.srcElement),this.trigger("dragstart",e,t);break;case"dragover":t=this.getBlock(e.srcElement),this.trigger("dragover",e,t);break;case"drop":this.trigger("drop",e)}},_onDragEnd:function(e){this.trigger("dragend",e)},_onBlur:function(){this.trigger("blur")},_onFocus:function(){window.parent!==window&&m.isSafari()&&window.parent.getSelection().removeAllRanges()},_onClick:function(){this.trigger("yne-click")},onSelectAll:function(){var e,n=document.createRange();e=h.isTodo(t.first(this.note.blocks))?this.el.firstChild.querySelector(".todo-input"):this.el.firstChild,n.setStart(e,0),n.setEnd(this.el.lastChild,1),d.setRange(n,window),this.parseNativeRange(n)},_onSaveContent:function(){this.trigger("save-content")},_onReadOnlyChange:function(){var e=this.isReadOnly(),t=this.options.noteviewFrame;this.setHtmlContentEditable(!e),e?(this.$el.addClass("read-only"),null!=t&&t.find(".header-footer-input").prop("contenteditable",!1)):(this.$el.removeClass("read-only"),null!=t&&t.find(".header-footer-input").prop("contenteditable",!0))},_checkHighlightView:function(){this.$el.children()[0]!==this.highlightView.$el.get(0)&&this.$el.prepend(this.highlightView.$el)},_onHighlight:function(e){var t,n=this.options.noteviewFrame,o=this.options.noteviewWrapper.get(0);e.length?(o.style.background=this.$el.css("background"),n.css("background","transparent"),this.$el.css("background",""),this.$el.addClass("highlight"),this._checkHighlightView()):((t=o.style.background)&&this.$el.css("background",t),this.$el.removeClass("highlight")),this.highlightView.showHighlight(this.el,e)},_onCopyPSrohibited:function(){this.isCopyProhibited()&&this.$el.addClass("copyProhibited")},_onClearHighlight:function(){t.each(this.blockViews,function(e){e.clearHighlight()})},_onNextHighlight:function(){this._checkHighlightView(),this.highlightView.nextHighlight()},_onPreHighlight:function(){this._checkHighlightView(),this.highlightView.preHighlight()},_onResize:function(e){var n=this;t.isNumber(e)&&(n._currentZoom=e),t.each(n.blockViews,function(e){e.trigger("resize"),n.isInPageMode()&&e.coincideAllPageBreaks()}),n._scrollNativeSelectionIntoWrapper(d.getRange())},_clearBlockViews:function(e){return t.each(e,function(e){e.onDestroy()}),[]},isInPageMode:function(){return 2===this._viewMode},setViewMode:function(e,t){this._viewMode=e,this.isInPageMode()?this._enablePageMode(t):this._disablePageMode(e)},_calcNoteViewFrameHeight:function(){var e,n,o,i,a,s=t.last(this.blockViews),l=this.options.noteviewFrame;if(null!=s){if(e=(s.getLastTransPageIndex()||0)+1,this.options.pageType===r.PAGE_TYPE_A4?n=r.PAGE_HEIGHT_A4:this.options.pageType===r.PAGE_TYPE_B5?n=r.PAGE_HEIGHT_B5:this.options.pageType===r.PAGE_TYPE_TEST&&(n=r.PAGE_HEIGHT_TEST),null!=n&&e>1){if(o=e-2,0===(i=l.find('[data-page-id="'+o+'"]')).length)return void y.debugAlert("Failed to find pageBreak:",o);i.length>1&&(y.debugAlert("Should not find more than one pageBreak:",o),i=i.first()),(a=n-(l.height()-parseInt(this.$el.css("padding-bottom"))-parseInt(i.css("top"))-i.height()))<0&&y.log("lastPageShortHeight < 0",a),l.height(l.height()+a),s.$el.position().top-parseInt(this.$el.css("padding-top"))+s.$el.height()>this.$el.height()&&(y.debugAlert("noteview content is overflowed"),l.height("auto"))}else l.height(n+parseInt(this.$el.css("padding-top"))+parseInt(this.$el.css("padding-bottom")));this._coincideAllPageBreaks()}},_coincideAllPageBreaks:function(){t.each(this.blockViews,function(e){e.coincideAllPageBreaks()})},_disablePageMode:function(e){var n=this.options.noteviewFrame;this._pageBatchTimer&&(window.clearTimeout(this._pageBatchTimer),this._pageBatchTimer=null),n?(n.removeClass(r.PAGE_CLASS_A4),n.removeClass(r.PAGE_CLASS_B5),n.removeClass(r.PAGE_CLASS_TEST),t.each(this.blockViews,function(e){e.disablePageMode()}),this._viewMode=e,this._removeHeaderFooterView(),n.css("height","auto")):y.debugAlert("noteviewFrame should NOT be null when _disablePageMode")},_enablePageMode:function(e){var n=this,o=n.options.noteviewFrame;n._pageBatchTimer&&(window.clearTimeout(n._pageBatchTimer),n._pageBatchTimer=null),n._pageBatchPendingQueue=[],o?(o.removeClass(r.PAGE_CLASS_A4),o.removeClass(r.PAGE_CLASS_B5),o.removeClass(r.PAGE_CLASS_TEST),n.options.pageType===r.PAGE_TYPE_A4?o.addClass(r.PAGE_CLASS_A4):n.options.pageType===r.PAGE_TYPE_B5?o.addClass(r.PAGE_CLASS_B5):n.options.pageType===r.PAGE_TYPE_TEST&&o.addClass(r.PAGE_CLASS_TEST),n._removeHeaderFooterView(),n.headerView=n.createHeaderFooterView(!1),n.footerView=n.createHeaderFooterView(!0),n._renderHeaderFooterView(o),!0===e&&null!=n.note&&(t.each(n.blockViews,function(e){e.enablePageMode(n.options.pageType)}),n._setPageInfo(0))):y.debugAlert("noteviewFrame should NOT be null when _enablePageMode")},_getBlockViewIndexByCID:function(e){var n;return t.some(this.blockViews,function(t,o){return t.cid===e&&(n=o,!0)}),n},_onBlockViewHeightChanged:function(e){var t;null!=(t=this._getBlockViewIndexByCID(e))&&this._setPageInfo(t)},_onContentParseDone:function(){this.isInPageMode()&&this._calcNoteViewFrameHeight()},_onPageBreakInserted:function(){},_onPageBreakPosChanged:function(){},_setPageInfo:function(e,t){var n,o,i,r;if(this.isInPageMode()&&null!=this.blockViews&&0!==this.blockViews.length&&null!=(n=this.blockViews[e])&&null!=n.cid)if(this._setPageInfoInBatch(e),!0===t&&(this._pageBatchTimer=null),this._pageBatchPendingQueue.length>0){if(null==this._pageBatchTimer){for(r=null;null==r&&this._pageBatchPendingQueue.length>0;)i=this._pageBatchPendingQueue.shift(),r=null!=(o=this.blockViews[i.index])&&o.cid===i.cid?i.index:this._getBlockViewIndexByCID(i.cid);y.log("resetPageInfo: startTimer for ",r),null!=r&&(this._pageBatchTimer=setTimeout(this._setPageInfo.bind(this,r,!0),10))}}else this._pageBatchTimer=null,this.note.isParsingData()?this.options.noteviewFrame.height("auto"):this._calcNoteViewFrameHeight()},_setPageInfoInBatch:function(e){var t,n,o,i,r,a,s,l,c=Date.now();if(null!=this.blockViews&&0!==this.blockViews.length&&null!=e&&null!=(o=this.blockViews[e]))for(y.log("Start PageInfoInBatch from:",o,e),t=0===e?0:o.getFirstTransPageIndex();e<this.blockViews.length;){if(o=this.blockViews[e],0===e)s=o.resetPageInfo(0,0),n=0;else{if(null==(n=(i=this.blockViews[e-1]).getLastTransPageIndex()))break;-1===(a=i.getBottomPosInPage(n))&&(a=0),s=o.resetPageInfo(n,a)}if(e++,null!=n&&null!=t&&n-t,!0===s){if(h.isImage(o.block)&&o.isOnFloat()&&(l=n+1),(null==l||l<=n)&&Date.now()-c>100){null!=(r=this.blockViews[e])&&this._pageBatchPendingQueue.push({cid:r.cid,index:e});break}}else if(null==l||l<=n)break}}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(2),n(127),n(431),n(154),n(126),n(432),n(155),n(128),n(433),n(54),n(234),n(93),n(64),n(235),n(167)],void 0===(i=function(e,t,n,o,i,r,a,s,l,c,d,u,h,p,g,f,m){"use strict";var y={};return y[n.ATTACHMENT]=o,y[n.CATALOGUE]=i,y[n.HEADING]=s,y[n.HR]=l,y[n.IMAGE]=c,y[n.LIST_ITEM]=d,y[n.PARAGRAPH]=u,y[n.TABLE]=g,y[n.TODO]=f,y[n.QUOTE]=h,y[n.CODE]=p,y[n.HANDWRITE]=r,y[n.HEADER_FOOTER]=a,y[n.UNKNOWN]=m,y}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(54)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.HEADING},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(54)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.HEADING},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(2),n(54)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this.type=n.LIST_ITEM},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(2),o=n(59),i={};return i[t.ATTACHMENT]=n(436),i[t.CATALOGUE]=n(437),i[t.HANDWRITE]=n(438),i[t.HEADING]=n(439),i[t.HR]=n(440),i[t.IMAGE]=n(441),i[t.LIST_ITEM]=n(443),i[t.PARAGRAPH]=n(90),i[t.TABLE]=n(238),i[t.TODO]=n(481),i[t.QUOTE]=n(482),i[t.CODE]=n(483),i[t.UNKNOWN]=n(485),function(e){var t=i[e];return t||o}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(6),i=n(14),r=n(1),a=n(5);return t.View.extend({className:"page-break-view",templateName:"page_break_view",PLACEHOLDER_PREFIX:"p_",_$placeholder:null,_$pageBreak:null,_$container:null,_isAtViewBeginning:null,_topBlankHeight:null,_bottomBlankHeight:null,coincide:function(){var e,t,n,o;e=this._getOffsetTopPos(this.getPlaceholder()),t=this.getTopBlankHeight(),n=this.getPageBreak(),o=e+t,r.log("placeHolderTop/pageBreakTop/topBlankHeight:",e,o,this.getTopBlankHeight()),n.offset({top:o}),n.css({"margin-top":-t})},destroy:function(){this._$pageBreak.remove(),this._$placeholder.remove()},getPlaceholder:function(){return this._$placeholder},getPageBreak:function(){return this._$pageBreak},getTopBlankHeight:function(){return this._topBlankHeight},initialize:function(e){var t,n,s,l,c=e.pageIndex;this._topBlankHeight=e.topBlankHeight||0,this._bottomBlankHeight=e.bottomBlankHeight||0,this._$placeholder=e.placeholder||a('<div class="page-break-placeholder"></div>'),this._$pageBreak=a(i.render("common",this.templateName,{})),this._$container=e.container,this._$pageBreak.prepend(e.noteView.createHeaderFooterView(!0).$el),this._$pageBreak.append(e.noteView.createHeaderFooterView(!1).$el),0!==(l=this._$container.find('[data-page-id="'+c+'"]')).length&&l.attr("data-page-cid")===this.cid&&(r.debugAlert("should not create existing pageBreak for same view"),l.remove()),this._topBlankHeight<0&&(r.debugAlert("topBlankHeight should not be less than 0"),this._topBlankHeight=0),this._bottomBlankHeight<0&&(r.debugAlert("bottomBlankHeight should not be less than 0"),this._bottomBlankHeight=0),this._$pageBreak.attr("data-page-id",c),this._$pageBreak.attr("data-page-cid",this.cid),this._$pageBreak.attr("contenteditable","false"),t=this._$pageBreak.find(".bottomSpan"),n=this._$pageBreak.find(".topSpan"),s=this._$pageBreak.find(".middleSpan"),n.outerHeight(o.PAGE_SPLIT_BLANK_HEIGHT),t.outerHeight(o.PAGE_SPLIT_BLANK_HEIGHT),s.outerHeight(o.PAGE_SPLIT_MIDDLE_HEIGHT),this._$pageBreak.appendTo(this._$container),this._$pageBreak.height(n.outerHeight()+s.outerHeight()+t.outerHeight()),this._$placeholder.attr("data-page-id",this.PLACEHOLDER_PREFIX+this._$pageBreak.attr("data-page-id")),this._$placeholder.attr("data-page-cid",this.PLACEHOLDER_PREFIX+this._$pageBreak.attr("data-page-cid")),this._$placeholder.attr("contenteditable","false"),this._$placeholder.height(this._$pageBreak.height()+this._topBlankHeight+this._bottomBlankHeight)},isAtViewBeginning:function(){return!0===this._isAtViewBeginning},setAtViewBeginning:function(e){this._isAtViewBeginning=!0===e},_getOffsetTopPos:function(e){return e.offset().top}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(206);var t=n(59),o=n(5),i=n(0),r=n(14),a=n(127),s=n(1),l=n(52),c=n(36),d=n(9),u=n(47),h=n(6),p=n(117);return t.extend({className:"block-view attachment-view",DEFAULT_HEIGHT:100,timer:null,events:{"dblclick .attachment-container":"_onImgDblclick","mousemove .attachment-container":"_onMouseMove","mouseout .attachment-container":"_onMouseOut","click .attachment-download":"_onDownloadClick","dragstart .attachment-mask":"_onDragstart","dragend .attachment-mask":"_onDragEnd"},_isFloatSwitch:!1,_viewFrameHeight:null,initialize:function(){t.prototype.initialize.apply(this,arguments),i.bindAll(this,"_onStyleChange","_onContentChange","_onMouseMove","_onMouseOut"),this.block.on("style-change",this._onStyleChange),this.block.on("content-change",i.debounce(this._onContentChange,100)),this.bindSelectionEvents()},render:function(){var e,n,i,a,l,g=this,f=g.block,m=f.getSource(!0),y=f.getFileName(),_=f.getFileLength();d.IS_PC&&(m=u(m)),(d.IS_WEB_NOTE||d.IS_WEB_GROUP)&&!0===f.getFakeLoading()&&(m=h.LOADING_IMAGE_PATH,f.setFakeLoading(!1)),n=(e=p.getFileType(y))?"src--svg--type_"+e+"_large":"src--svg--type_other_large",a=void 0===_?"未知大小":p.getSizeString(_),l=p.splitFileFullName(y),i=r.render("common","attachment-view-attachment-container",{name:n,fileName:l.fileName,fileType:l.fileType,size:a,title:y,draggable:!0}),g.$el.find(".attachment-container").remove(),g.$el.append(i),g._viewFrameHeight=g.$el.outerHeight(!0)-g.$el.height(),g.$el.find(".attachment-container").tooltipster({animation:"",animationDuration:0,theme:["tooltipster-attachment","tooltipster-attachment-customized"],side:"bottom",delay:[800,300],arrow:!1,functionPosition:function(e,t,n){var i,r,a=o(t.tooltipClone);return i=g.mousePosY+a.height()>document.body.clientHeight?g.mousePosY-a.height()+10:g.mousePosY-10,r=g.mousePosX+a.width()>document.body.clientWidth?g.mousePosX-a.width()-10:g.mousePosX+10,n.coord.top=i>0?i:0,n.coord.left=r>0?r:0,n}}),g._renderStyles(),c.isSafari()&&g.$el.find(".attachment-container").attr("contenteditable","true"),t.prototype.render.apply(g,arguments),s.log("Attachment width/height",g.$el.width(),g.$el.height())},_renderStyles:function(){var e=this,t=e.block.getBlockStyles();i.each(t,function(t,n){e._setStyle(n,t)})},_setStyle:function(e,t){var n=this.$el,o=n.find(".attachment-block-container");switch(e){case"align":n.css("text-align",t);break;case"float":n.css("float")!==t?(this._isFloatSwitch=!0,n.css("float",t)):this._isFloatSwitch=!1;break;case"back-color":o.css("background-color",t),t||n.css("margin","");break;case"padding":o.css("padding",t),"0px"===n.css("padding-top")&&n.find(".attachment-block-container").css({"padding-top":"4px","padding-bottom":"4px"})}},_onStyleChange:function(e,t){this._setStyle(e,t),this.trigger("view-height-changed",this.cid)},_onContentChange:function(){this.render(),s.log("redraw attachment"),this.trigger("view-height-changed",this.cid)},getImgElement:function(){return this.$el.find("img").get(0)},getAttachmentContainerElm:function(){return this.$el.find(".attachment-container").get(0)},convertToNativeRange:function(){var e=document.createRange(),t=this.$el.get(0);return e.setStart(t,0),e.setEnd(t,t.childNodes.length),e},parseNativeRange:function(e,t,n){if(n||l.isNodeInRange(this.getAttachmentContainerElm(),e)||l.isRangeInNode(this.el,e)||this._isSelected())return new a({block:t})},_removeFocusedClass:function(){this.$el.removeClass("focused")},_addFocusedClass:function(){this.$el.addClass("focused")},onDrawRange:function(e){var t;e?(this._addFocusedClass(),(t=document.createRange()).selectNodeContents(this.$el.find(".attachment-container")[0]),l.setRange(t,window)):(this._removeFocusedClass(),this.selectAttachment())},_onImgDblclick:function(){var e=this.block.getResource(),t=this.block.getFileName();d.IS_PC&&this.trigger("yne-open-attachment",e,t),d.IS_MAC&&this.trigger("yne-mac-preview",e,t)},_onDownloadClick:function(){var e=this.block,t=e.getResource(),n=e.getFileName();(d.IS_WEB_GROUP||d.IS_WEB_NOTE||d.IS_MAC||d.IS_PC)&&this.trigger("yne-download-attachment",t,n)},_onDragstart:function(){this.$el.find(".attachment-mask").css("opacity",1)},_onDragEnd:function(){this.$el.find(".attachment-mask").css("opacity",0)},_isSelected:function(){return this.$el.find(".attachment-container").hasClass("selected")},selectAttachment:function(e){e?this.$el.find(".attachment-container").addClass("selected"):this.$el.find(".attachment-container").removeClass("selected")},disablePageMode:function(){t.prototype.disablePageMode.apply(this),this.$el.css("max-height","none")},_isPagingContinue:function(){return this._isFloatSwitch},_setViewMaxHeight:function(e){var t,n=this._pageInfo[e-1],o=0,i=this._getTopPosInPage(e);n&&(o=this._getPageBreakBottomPosInView(e-1)),(t=this.PAGE_HEIGHT+o-this._viewFrameHeight-i)<h.PAGE_SPLIT_BLANK_HEIGHT/2&&(t=h.PAGE_SPLIT_BLANK_HEIGHT/2),this.$el.css("max-height",t),s.log("Attachment max-height",this.$el.css("max-height"))},_onMouseMove:function(e){var t=this;clearTimeout(t.timer),t.timer=setTimeout(function(){t.mousePosX=e.originalEvent.x||e.originalEvent.layerX||0,t.mousePosY=e.originalEvent.y||e.originalEvent.layerY||0},200)},_onMouseOut:function(){clearTimeout(this.timer)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(5),o=n(14),i=n(6),r=n(28),a=n(90),s=n(54),l=n(24),c=n(99),d=n(19),u=n(38),h=n(88),p=a.extend({className:"block-view catalogue-view",events:{"click a":"_onAnchorClick"},_forcePageBreakBegin:!0,initialize:function(){a.prototype.initialize.apply(this,arguments);var e=this,t=e.block;t.on("sorting-change",function(){e._renderSorting()}),t.on("focus",e.focus.bind(e)),t.on("blur",e.blur.bind(e))},_renderTemplate:function(){this.$el.html(o.render("common","catalogue_view",{isFirst:this.block.isFirst()}))},_renderText:function(){var e,n=this.block.getReadOnlyText(),o=this._inlineStyleViewMapper,i=this.$el.find(".para-text"),a=t("<a></a>");e=l.rich2html(n,{styleRules:{color:function(e){var t=e.color;return e.href!==d.getDefault("href")&&r.equals(e.color,"blue")?"#003884":null!=t&&o?o.valueToView("color-catalogue",t):void 0},"font-family":function(e){var t,n=e["font-family"];return null!=n&&o&&(t=o.valueToView("font-family",n)),n!==t?t:u.getAllValueByFont(n)||n}}}),a.html(e),i.html(a),this._renderSorting(),this._addLinkMenu()},_onAnchorClick:function(e){var t=this.block.getHref();e.stopPropagation(),c.test(t)?this.trigger("open-link",t):this.trigger("inner-goto",t)},_addLinkMenu:function(){var e,t=this,n=t.block,o=t.$el.find("a");o.off("hover"),o.hover(function(){h.isNoteLinkUrl(n.getHref())||t.isCollabLocked()||(e=new s({start:0,end:n.getLength(),block:n}),t.trigger("link-menu-show",{linkNode:o[0],href:n.getViewHref(),range:e,block:n}))},function(){t.trigger("link-menu-hide")})},_renderSorting:function(){this._renderFirst(),this._renderLast()},_renderFirst:function(){var e,t,n=this,o=n.block,i=n.$el;if(!o.isFirst())return i.removeClass("catalogue-first");i.addClass("catalogue-first"),e=i.find(".catalogue-refresh"),t=i.find(".catalogue-delete"),e.off("click"),t.off("click"),e.on("click",function(){n.trigger("command","comp.RefreshCatalogue",{ownerId:o.getOwnerId()})}),t.on("click",function(){n.trigger("command","comp.RefreshCatalogue",{ownerId:o.getOwnerId(),delete:!0})})},_renderLast:function(){if(!this.block.isLast())return this.$el.removeClass("catalogue-last");this.$el.addClass("catalogue-last")},_setStyle:function(e,t){var n=this.$el,o=n.find(".para-text"),r=this.block;switch(e){case"indent":t=(t=r.getBlockStyle("text-indent")+t)>0?t:0,o.css("text-indent",t*i.INDENT_WIDTH||"");break;case"text-indent":t=(t=r.getBlockStyle("indent")+t)>0?t:0,o.css("text-indent",t*i.INDENT_WIDTH||"");break;case"href":n.find("a").attr("href",r.getViewHref());break;case"back-color":n.css("background-color",t);break;case"padding":n.css("padding",t),n.css("padding-top","0px");break;default:a.prototype._setStyle.call(this,e,t)}},_onLockedChange:function(e){var t=this.block.getOwnerList();a.prototype._onLockedChange.call(this,e),t.updateLockState(this.isLocked())},getOwnerId:function(){return this.block.getOwnerId()},selectCatalogue:function(e){var t=this.block;e?t.trigger("select"):t.trigger("remove-select")},focus:function(){this.$el.addClass("catalogue-focus")},blur:function(){this.$el.removeClass("catalogue-focus")},_getHeightInPage:function(e){var t=p.__super__._getHeightInPage.apply(this,[e]),n=parseInt(this.$el.css("marginTop")),o=parseInt(this.$el.css("marginBottom"));return isNaN(n)||(t+=n),isNaN(o)||(t+=o),t}});return p}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(59),n(14),n(9),n(154),n(52),n(36)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";var c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.initialize=function(t){e.prototype.initialize.call(this,t),this._viewProps={block:t.block},this.bindSelectionEvents()},t.prototype.convertToNativeRange=function(){var e=document.createRange(),t=this.$el.get(0);return e.setStart(t,0),e.setStart(t,t.childNodes.length),e},t.prototype.getImgElement=function(){return this.$el.find("img").get(0)},t.prototype.onDrawRange=function(e){var t;if(e){if(this._addFocusedClass(),t=document.createRange(),!this.$el.children(".handwrite-copy-hack")[0])return;t.selectNodeContents(this.$el.children(".handwrite-copy-hack")[0]),s.setRange(t,window)}else this._removeFocusedClass(),this.selectHandWrite(!1)},t.prototype.parseNativeRange=function(e,t,n){if(n||this._isHandWriteInNativeRange(e)||this._isNativeRangeInHandWriteView(e)||this._isSelected())return new r({block:t})},t.prototype.selectHandWrite=function(e){e?this.$el.find(".attachment-container").addClass("selected"):this.$el.find(".attachment-container").removeClass("selected")},t.prototype.render=function(){var t,n;e.prototype.render.call(this),n=this.block.getSource(i.IS_PC),t=o.render("common","handwrite-view-container",{src:n,needCopyHack:i.IS_MAC||l.isSafari()}),this.$el.html(t)},t.prototype._addFocusedClass=function(){this.$el.addClass("focused")},t.prototype._isHandWriteInNativeRange=function(e){var t,n=this.getImgElement(),o=window.Range;return(t=n.ownerDocument.createRange()).selectNode(n),e.compareBoundaryPoints(o.START_TO_START,t)<1&&e.compareBoundaryPoints(o.END_TO_END,t)>-1},t.prototype._isNativeRangeInHandWriteView=function(e){var t,n=this.el;return 3===(t=e.commonAncestorContainer).nodeType&&(t=t.parentNode),!(t!==n&&!$.contains(n,t))},t.prototype._isSelected=function(){return this.$el.find(".attachment-container").hasClass("selected")},t.prototype._removeFocusedClass=function(){this.$el.removeClass("focused")},t}(n);return delete c.prototype.constructor,c.prototype.className="block-view handwrite-view",n.extend(c.prototype)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(90);return t.extend({initialize:function(){t.prototype.initialize.apply(this,arguments)},className:"block-view heading-view",_renderText:function(){this.$el.find(".para-text").attr("id",this.block.getId()),t.prototype._renderText.apply(this)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(59),i=n(155);return o.extend({className:"block-view hr-view",initialize:function(){o.prototype.initialize.apply(this,arguments),t.bindAll(this,"_onStyleChange"),this.block.on("style-change",this._onStyleChange)},render:function(){var e=this.block,t=e.getBlockStyle("width"),n=e.getBlockStyle("height");this.$el.html('<div class="hr-container"></div>').css({"text-align":e.getBlockStyle("align")}).find(".hr-container").css({width:t+"%",height:n,backgroundColor:e.getBlockStyle("color")}),o.prototype.render.apply(this,arguments),this._renderStyles()},_renderStyles:function(){var e=this,n=e.block.getBlockStyles();t.each(n,function(t,n){e._setStyle(n,t)})},_setStyle:function(e,t){var n=this.$el;switch(e){case"back-color":n.css("background-color",t);break;case"padding":t?(n.css({padding:t,margin:"0 20px"}),"0px"===n.css("padding-top")&&n.css({"padding-top":"4px","padding-bottom":"4px"})):n.css({padding:t})}},_onStyleChange:function(e,t){this._setStyle(e,t)},convertToNativeRange:function(){var e=document.createRange(),t=this.$el.get(0);return e.setStart(t,0),e.setEnd(t,t.childNodes.length),e},parseNativeRange:function(e,t,n){if(n||this._isHrInNativeRange(e))return new i({block:t})},_isHrInNativeRange:function(e){var t,n=this.$el.find(".hr-container").get(0);return(t=n.ownerDocument.createRange()).selectNode(n),e.compareBoundaryPoints(Range.START_TO_START,t)<1&&e.compareBoundaryPoints(Range.END_TO_END,t)>-1}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t=n(59),o=n(5),i=n(0),r=n(14),a=n(128),s=n(1),l=n(442),c=n(52),d=n(36),u=n(47),h=n(236),p=n(237),g=n(9),f=n(75),m=n(6),y=n(229);return t.extend({className:"block-view image-view",DEFAULT_HEIGHT:100,_isFloatSwitch:!1,_isImgError:!1,_$imgDiv:null,_$imgContainerDiv:null,_$imgTitle:null,_viewFrameHeight:null,_isImgLoaded:null,events:{contextmenu:"_onContextMenu","mousedown .resize-handle":"_onMouseDownResizeHandle","mousedown img":"_onMouseDownImgPreview",mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave","mouseleave .menu-wrapper":"_onMouseLeaveMenuWrapper","click .yne-button-item":"_onButtonItemClick","click .yne-popup-item":"_onPopupMenuItemClick","dblclick img":"_onImgDblclick","click img":"_onImgClick","mousedown .image-title":"_onMouseDownImageTitleHandle"},_imageResizeStartInfo:null,_imageResizeEventNS:null,_imgHeightInData:null,_imgWidthInData:null,_imgHeightBeforeLoad:null,_imgLoadWidth:null,_disableOCR:null,_OCRHighlightInfo:null,_OCRHighlightItem:null,initialize:function(e){var n=this;t.prototype.initialize.apply(n,[e]),n._imageResizeEventNS=".img-resize-"+i.uniqueId(),i.bindAll(n,"_onStyleChange","_onContentChange","_onChangeImageTitle","_onUpdateImageTitle","_editImgTitle","_handlerImgTitle","_onWinResize","_onHighlight","_onHideImageTitle"),n.block.on("edit-image-title",n._editImgTitle),n.block.on("style-change",n._onStyleChange),n.block.on("content-change",n._onContentChange),n.block.on("extra-info-change",n._onContentChange),n.block.on("view-resize",n._onWinResize),n.block.on("high-light",n._onHighlight),n.block.on("hide-image-title",n._onHideImageTitle),n.bindSelectionEvents(),n.on("resize",n._onWinResize),n.on("locked-change",function(){n.isLocked()&&(n.trigger("img-title-edit-exit"),n._removeFocusedClass())}),n._disableOCR=!!e.disableOCR||!g.IS_PC,n._OCRHighlightItem=[],n._OCRHighlightInfo=null},render:function(){var e=this.block,t=e.getSource(!0),n="";this.renderImageSource(t),g.IS_PC&&!f.isNoteImageSource(t)&&(e.getResId()===e.getSource()&&(n=e.getResId()),this.trigger("request-rendered-imagSrc",n,e))},updateRenderedSource:function(e){g.IS_PC&&(e=u(e)),/^\//.test(e)&&!g.IS_MAC&&(e=window.location.origin+e),this._$imgDiv.attr("src",p.getURL(h.addIfNeeded(e))),this._$imgDiv.show()},renderImageSource:function(e){var n,o,i=this,r=i.block,a=r.getImageInfo(),s=null,l=r.getTitle(),c=e;a&&(e="/yws/res/thumb/"+a.resId,a.rawWide<=620?(s=a.rawWide,a.rawHeight):s=620),i._imgLoadWidth=s,g.IS_PC&&(e=u(e)),(g.IS_WEB_NOTE||g.IS_WEB_GROUP)&&!0===r.getFakeLoading()&&(e=m.LOADING_IMAGE_PATH,r.setFakeLoading(!1)),i._renderWithLoadedImage(e),i._isImgLoaded=!1,i._$imgContainerDiv=i.$el.find(".image-container"),i._$imgDiv=i.$el.find("img"),i._$imgTitle=i.$el.find(".image-title"),i._viewFrameHeight=i.$el.outerHeight(!0)-i.$el.height(),i._imgHeightInData=r.getBlockStyle("height",!0),i._imgWidthInData=r.getBlockStyle("width",!0),i._imgHeightBeforeLoad=i._$imgDiv.height(),n=i._imgWidthInData<=10||!i._imgWidthInData?620:i._imgWidthInData,o=i._imgHeightInData?i._imgHeightInData:6*i._imgWidthInData/8,i._$imgContainerDiv.css({width:n+"px",height:o+"px",background:"#F5F6F7"}),i._$imgDiv.load(function(){i.$el.hasClass("focused")&&i._onUpdateImageTitle(!0),i._$imgContainerDiv.css({width:"inherit",height:"inherit",background:"transparent"}),i._onImgLoaded()}),i._$imgDiv.error(function(){i._renderWithLoadedImage(null,!0)}),/^\//.test(e)&&!g.IS_MAC&&(e=window.location.origin+e),i._$imgDiv.attr("src",p.getURL(h.addIfNeeded(e))),i._renderStyles(),d.isSafari()&&i._$imgContainerDiv.attr("contenteditable","true"),t.prototype.render.apply(i,arguments),i.title=l,i._$imgTitle&&(l?i._$imgTitle.text(l):i._$imgTitle.hide()),(g.IS_WEB_NOTE||g.IS_WEB_GROUP)&&i._loadOriginImg(c)},_renderWithLoadedImage:function(e,t){var n,o,a,s=this.block.getImageInfo();s&&(s.rawWide<=620?(o=s.rawWide,a=s.rawHeight):o=620),this._imgLoadWidth=o,n=r.render("common","image-view-image-container",{randomId:i.uniqueId("img-view"),width:o,height:a,src:e,isImgError:t,hasOCR:!this._disableOCR,needCopyHack:g.IS_MAC||d.isSafari()}),this.$el.html(n)},_renderStyles:function(){var e=this,t=e.block.getBlockStyles();i.each(t,function(t,n){e._setStyle(n,t)})},_setStyle:function(e,t){var n,i=this.$el,r=i.find(".image-block-container"),a=r.find(".image-container"),l=o("body").find(".image-title-hidden");switch("100%"===t&&a.css("display","block"),e){case"align":i.css("text-align",t),l.length&&l.css("text-align",t);break;case"width":n=this.getImgElement(),null==t&&null==this._imgLoadWidth?o(n).css("width",""):null==t&&this._imgLoadWidth?o(n).css("width",this._imgLoadWidth):this._setImageWidth(t);break;case"float":i.css("float")!==t?(this._isFloatSwitch=!0,i.css("float",t)):this._isFloatSwitch=!1,!1===this.isOnFloat()&&this._resetImageMaxWidth();break;case"height":break;case"back-color":r.css("background-color",t),t?i.css({"padding-top":0,"padding-bottom":0}):i.css({"padding-top":"","padding-bottom":""});break;case"padding":r.css("padding",t),"0px"===r.css("padding-top")&&r.css({"padding-top":"4px","padding-bottom":"4px"});break;default:s.error("unkown style name:",e)}},_onStyleChange:function(e,t){this._setStyle(e,t),this.trigger("view-height-changed",this.cid)},_onContentChange:function(){var e=this.block,t=this.$el,n=e.getTitle(),o=e.getSource(!0);g.IS_PC&&(o=u(o)),o=p.getURL(h.addIfNeeded(o)),t.find("img").attr("src",o),this._$imgTitle&&(this._$imgTitle.text(n),this.title=n,this._handlerImgTitle(),this.trigger("img-title-edit-exit"),this.trigger("view-height-changed",this.cid))},getImgElement:function(){return this.$el.find("img").get(0)},convertToNativeRange:function(){var e=document.createRange(),t=this.$el.get(0);return e.setStart(t,0),e.setEnd(t,t.childNodes.length),e},parseNativeRange:function(e,t,n){if(n||c.isNodeInRange(this.getImgElement(),e)||c.isRangeInNode(this.el,e))return new a({block:t})},_showButtonGroup:function(){this._hidePopupMenu(),l.adjustMenu(this.$el)},_hideButtonGroup:function(){this.$el.find(".menu-wrapper").hide(),this._hidePopupMenu()},_onButtonItemClick:function(e){var t=e.currentTarget.dataset.buttonName;if(!this.isLocked())switch(t){case"menu":default:this._togglePopupMenu()}},_togglePopupMenu:function(){var e,t,n,o,i=this.$el.find(".yne-popup-menu");i.toggle(),i.is(":visible")?(e=this.$el.find(".yne-button-group").outerHeight(),n=(t=i.get(0).getBoundingClientRect()).top+(o=t.height)>document.documentElement.clientHeight?-(o+5):e+5,i.css({top:n+"px"})):i.css({top:""})},_hidePopupMenu:function(){var e=this.$el.find(".yne-popup-menu");e.hide(),e.css({top:""})},_onContextMenu:function(e){e.preventDefault(),e.stopPropagation(),this._isReadOnly||this._isImgError||this.trigger("contextmenu",e)},_onMouseEnter:function(){var e=this.block;this.isLocked()||e.isReadOnly()||this._showButtonGroup()},_onMouseLeave:function(){this.isLocked()||this._hideButtonGroup()},_onMouseLeaveMenuWrapper:function(){this.isLocked()||this._hidePopupMenu()},_onPopupMenuItemClick:function(e){var t=e.currentTarget,n=o(t).attr("data-cm-name"),r={},a=this.block;if(!this.isLocked()&&!a.isReadOnly()){switch(this._hidePopupMenu(),n){case"image-title":this._editImgTitle();break;case"float-left":case"float-right":case"clear-float":r.float="float-left"===n?"left":"float-right"===n?"right":"none";break;case"clear-resize":r.width=null;break;case"delete":this.trigger("command","comp.DeleteNoteRange",{range:null,imageBlockView:this});break;case"download":this.trigger("yne-download-image",a.getSource(!0));break;case"image-ocr":this.trigger("yne-image-ocr",y(a))}i.isEmpty(r)||this.trigger("command","comp.ApplyStyles",{range:null,imageBlockView:this,blockStyles:r})}},_removeFocusedClass:function(){!this.$el.hasClass("focused")||this.isLocked()||this.block.isReadOnly()||(this.trigger("img-title-edit-end"),this.trigger("img-title-edit-exit"),this._handlerImgTitle()),this.$el.removeClass("focused")},_onUpdateImageTitle:function(e){var t=this,n=function(){if(t._$imgTitle){var e=t._$imgTitle.offset();return{left:e.left,top:e.top,width:t.$el.width(),height:t._$imgTitle.height(),textAlign:t.block.getStyles("align")}}};t.isLocked()||t.block.isReadOnly()||(e?t.trigger("img-title-edit-update",n):t.$el.hasClass("focused")||t.trigger("img-title-edit-start",t.block.getTitle(),n,t._onChangeImageTitle,t._$imgTitle,t.block.getId()))},_addFocusedClass:function(){this._onUpdateImageTitle(),this.$el.addClass("focused")},_drawNativeRange:function(){var e=document.createRange(),t=this.getImgElement();e.selectNode(t),e.collapse(!0),c.setRange(e)},onDrawRange:function(e){var t;e&&!this.isLocked()?(this._addFocusedClass(),(t=document.createRange()).selectNode(this.$el.find(".image-container")[0]),c.setRange(t,window)):this._removeFocusedClass()},_onMouseDownResizeHandle:function(e){var t,n,i=this.getImgElement(),r=e.pageX,a=e.pageY,s={centerX:0,centerY:0,startWidth:0,startHeight:0,startToCenter:0},l=this.block;this.isLocked()||l.isReadOnly()||i&&(t=o(i),s.startWidth=t.width(),s.startHeight=t.height(),n=t.offset(),s.centerX=n.left+s.startWidth/2,s.centerY=n.top+s.startHeight/2,s.startToCenter=Math.sqrt(Math.pow(s.centerX-r,2)+Math.pow(s.centerY-a,2)),this._imageResizeStartInfo=s,this._bindEventsForResize(),e.preventDefault(),this.$el.css("height",this.$el.height()))},_bindEventsForResize:function(){var e=this.el.ownerDocument,t=this._imageResizeEventNS;this._unbindEventsForResize(),o(e).bind("mousemove"+t,this._onResizeMove.bind(this)).bind("mouseup"+t,this._onResizeEnd.bind(this))},_unbindEventsForResize:function(){var e=this.el.ownerDocument;o(e).unbind(this._imageResizeEventNS)},_onResizeMove:function(e){this._handleImageResize(e.pageX,e.pageY)},_onResizeEnd:function(e){this.$el.css("height","auto"),this._unbindEventsForResize(),this._handleImageResize(e.pageX,e.pageY,!0)},_handleImageResize:function(e,t,n){var o,i,r=this._imageResizeStartInfo,a={};r&&(i=(o=Math.sqrt(Math.pow(r.centerX-e,2)+Math.pow(r.centerY-t,2)))*r.startWidth/r.startToCenter,o*r.startHeight/r.startToCenter,this.getImgElement()?(this._setImageWidth(i),!0===n?(a.width=this._$imgDiv.width(),a.height=this._$imgDiv.height(),this.trigger("command","comp.ApplyStyles",{range:null,imageBlockView:this,blockStyles:a})):this._onUpdateImageTitle(!0)):s.warn("no image element!"))},_onImgDblclick:function(){var e=this.block.getSource(!0);g.IS_PC&&this.trigger("yne-open-image",e)},_onImgClick:function(e){this.trigger("img-title-edit-end"),(g.IS_WEB_GROUP||g.IS_WEB_NOTE||g.IS_MAC)&&(this.showImgPreview||this.isLocked()||this.block.isReadOnly())&&this.trigger("get-image-items",this.block),e.preventDefault(),e.stopPropagation()},_onMouseDownImgPreview:function(){this.showImgPreview=this.$el.hasClass("focused")},_onChangeImageTitle:function(e,t,n,o){var r=this.block,a=[],s=[],l={};return e!==r.getTitle()&&(a.push({source:r.getSource(),title:e}),s.push(r),i.extend(l,{resources:s,resProps:a}),t&&i.extend(l,{endingRange:n}),this.trigger("command","comp.ReplaceResource",l)),!e&&o&&this._$imgTitle.hide(),!0},_onMouseDownImageTitleHandle:function(e){e.preventDefault()},onDestroy:function(){this.trigger("img-title-edit-exit")},_onWinResize:function(){this.$el.hasClass("focused")&&this._onUpdateImageTitle(!0)},_onHighlight:function(e,t,n){var o=this.block.getHighlight(e,t);o&&this._convertToData(o,n)},_convertToData:function(e,t){var n=this;if(n._$imgTitle){var o,r=n._$imgTitle.get(0).firstChild;n._OCRHighlightInfo=null,i.each(e,function(e){null==e.imageInfo?((o=document.createRange()).setStart(r,e.start),o.setEnd(r,e.end),t(o)):n._OCRHighlightInfo=e.imageInfo}),n._createHighlightMark()}},_editImgTitle:function(){var e=this;setTimeout(function(){e._$imgTitle.show(),e._onUpdateImageTitle(!0),e.trigger("img-title-edit-focus")},0)},_onHideImageTitle:function(){this.trigger("img-title-edit-exit")},_handlerImgTitle:function(){this.title?this._$imgTitle.show():this._$imgTitle.hide()},clearHighlight:function(){this._OCRHighlightInfo=null,this._clearHighlightMark()},_clearHighlightMark:function(){i.each(this._OCRHighlightItem,function(e){e.remove()}),this._OCRHighlightItem=[]},disablePageMode:function(){t.prototype.disablePageMode.apply(this),this.$el.hasClass("focused")&&this._onUpdateImageTitle(!0),this.$el.css("max-height","none"),this._resetImageMaxWidth()},_contentHeightOverflowCheck:function(){var e,t,n,o,i=this._$imgTitle.height(),r=0,a=this._$imgDiv.height();return this._isInPageMode()?(null!=(e=this.getLastTransPageIndex())&&(t=this._getTopPosInPage(e),a=Math.ceil(a),r=Math.ceil(t+a+i+this._viewFrameHeight)-this.PAGE_HEIGHT),r>0&&((n=this._$imgDiv.height()-r)<m.PAGE_SPLIT_BLANK_HEIGHT/2&&(n=m.PAGE_SPLIT_BLANK_HEIGHT/2),o=this._$imgDiv.width()*n/this._$imgDiv.height(),this._$imgDiv.css("max-width",o)),r):r},_isPagingContinue:function(){return this._isFloatSwitch},_onImgLoaded:function(){var e;this._isImgLoaded=!0,this.$el.height("auto"),this._$imgDiv.height("auto"),e=this._$imgDiv.height(),this._imgHeightInData!==e||null==this._imgWidthInData?(this.block.setStyles("height",e),/^-?\d+%$/.test(this._imgWidthInData)?this.block.setStyles("width",this._imgWidthInData):this.block.setStyles("width",this._$imgDiv.width()),this._imgHeightInData=e):this._imgHeightBeforeLoad!==e?this.trigger("view-height-changed",this.cid):s.log("No height change after image loaded",this),this._createHighlightMark()},_createHighlightMark:function(){var e=this,t=e._OCRHighlightInfo;if(e._clearHighlightMark(),null!=t){var n=e._$imgContainerDiv.width()/t.width;i.each(t.pos,function(t){var i=o(r.render("common","high_light_item",{top:t.top*n-1,left:t.left*n-2,height:(t.bottom-t.top)*n,width:(t.right-t.left)*n}));i.appendTo(e._$imgContainerDiv),e._OCRHighlightItem.push(i)})}},_resetImageMaxWidth:function(){null!=this._$imgDiv&&this._$imgDiv.css("max-width","")},_setImageWidth:function(e){null!=e&&(/^-?\d+%$/.test(e)||(this._$imgContainerDiv.css("display","inline-block"),e=Math.ceil(e)),this._$imgDiv.width(e),this._resetImageMaxWidth(),null!=this._imgHeightInData&&!1===this._isImgLoaded&&this._$imgDiv.height(Math.ceil(this._imgHeightInData*this._$imgDiv.width()/e)))},_setViewMaxHeight:function(e){var t=this._pageInfo[e-1],n=0,o=this._getTopPosInPage(e);t&&(n=this._getPageBreakBottomPosInView(e-1)),this.$el.css("max-height",this.PAGE_HEIGHT+n-this._viewFrameHeight-o),this._contentHeightOverflowCheck()},_loadOriginImg:function(e){var t=this;e=p.getURL(h.addIfNeeded(e)),o("<img />").attr("src",e).load(function(){t._$imgDiv.attr("src",e),t._$imgDiv.removeClass("filter-blur")}).error(function(){t._$imgDiv.unbind("error")}),t._$imgDiv.error(function(){t._$imgDiv.attr("src",e),t._$imgDiv.removeClass("filter-blur")})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(5);return{adjustMenu:function(e){var n=e.find(".menu-wrapper"),o=n.width(),i=t(e.children()[0]),r=e.offsetParent().width(),a=i.position().left;a<o&&i.width()<o?n.addClass("menu-wrapper-left"):n.removeClass("menu-wrapper-left"),r-a-i.width()<o?i.width()<o?(n.addClass("menu-wrapper-mini"),n.removeClass("menu-wrapper-right")):(n.addClass("menu-wrapper-right"),n.removeClass("menu-wrapper-mini")):(n.removeClass("menu-wrapper-mini"),n.removeClass("menu-wrapper-right")),n.show()}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(90),i=n(14),r=n(92);return o.extend({className:"block-view list-item-view paragraph-view",_template:i.getTemplate("common","list_item_view"),_styleSheet:null,initialize:function(){o.prototype.initialize.apply(this,arguments),this._initEvents()},_initEvents:function(){var e=this.block,n=e.getOwnerList();if(!n)throw"no ownerList!";t.bindAll(this,"_onLevelChange","_onIndexChange","_onTypeChange","_onStyleChange"),e.on("level-change",this._onLevelChange),e.on("index-change",this._onIndexChange),n.on("type-change",this._onTypeChange),e.on("style-change",this._onStyleChange)},_renderLevel:function(){var e=this.block,t=e.getLevel(),n=this.$el.find(".li-box"),o=r.makeHtmlMarker(e);n.attr("data-level",t),o&&o.listStyleType&&n.attr("data-style-type",o.listStyleType)},_renderText:function(){o.prototype._renderText.apply(this,arguments),this._renderMarkerText(),this._renderBlockstyles()},_renderMarkerText:function(){var e,t=this,n=t.block.getText(),o=t.$el.find("li");o.attr("style",""),n.getLength()?e=r.convertToCssStyle(n.getStylesAtIndex(0),t._inlineStyleViewMapper):t.trigger("get-editing-styles",function(n){e=r.convertToCssStyle(n,t._inlineStyleViewMapper)}),e&&o.css(e)},_renderIndex:function(){var e=this.block;this.$el.find(".li-box").attr("start",e.getIndex())},_setContainerStyles:function(){var e=this,n=e.block.getBlockStyles();t.each(n,function(t,n){e._setContainerStyle(n,t)})},_setContainerStyle:function(e,t){var n=this.$el.find(".li-box");switch(e){case"back-color":n.parent().css("background-color",t);break;case"padding":n.css("padding",t)}},render:function(){o.prototype.render.apply(this,arguments),this._renderLevel(),this._renderIndex(),this._setContainerStyles(),this.trigger("view-height-changed",this.cid)},_renderTemplate:function(){var e=this.block;this.$el.html(this._template({isOrdered:e.isOrdered()}))},_onLevelChange:function(){this._renderLevel(),this._renderIndex(),this.trigger("view-height-changed",this.cid)},_onIndexChange:function(){this._renderIndex(),this.trigger("view-height-changed",this.cid)},_onTypeChange:function(){this.block.setLocked(!1),this.render()},_onStyleChange:function(e,t){var n=this.$el.find("li");switch(o.prototype._onStyleChange.apply(this,arguments),this._setContainerStyle(e,t),e){case"align":n.css("text-align",t);break;case"line-height":n.css("line-height",t)}},_renderBlockstyles:function(){var e=this.$el.find("li"),t=this.block.getBlockStyle("align"),n=this.block.getBlockStyle("line-height");t&&e.css("text-align",t),n&&e.css("line-height",n)},_onContentChange:function(){0===this.$el.find(".para-text").length&&this.render(),this._renderText(),this.trigger("view-height-changed",this.cid)},_getContentContainer:function(){return this.$el.find(".li-box")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(43);return function(e,n){if(t.isNode(e)){if(n=!1!==n,e.removeNode&&n)return e.removeNode(e,n);if(e.parentNode&&e.parentNode.removeChild){if(!n)for(;e.firstChild;)e.parentNode.insertBefore(e.firstChild,e);return e.parentNode.removeChild(e)}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(166);return t.View.extend({tagName:"div",className:"selection-layer",initialize:function(e){var t=e.tableView;this._tableView=t},render:function(){this.$el.attr("contenteditable","false")},hide:function(){this.$el.hide()},_computeViewRect:function(e){if(e){var t,n,i,r,a=this._tableView,s=e.getAsRectRange();if(s&&(t=s.getFirstCell(),n=s.getLastCell(),t&&t.cell&&n&&n.cell))return i=a.getBoundingRectByCell(t.cell),r=a.getBoundingRectByCell(n.cell),o.union(i,r)}},draw:function(e){var t=this._computeViewRect(e);t&&t.width>0&&t.height>0?this.$el.css({top:t.top,left:t.left,width:t.width,height:t.height}).show():this.$el.hide()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(20),i=n(5),r=n(1),a=n(0),s=n(25),l=n(137),c=n(35),d=n(7),u=n(448),h=n(41),p=n(129),g=n(8),f=n(56),m=n(43),y=n(449),_=n(52),I=n(74),b=n(132),v=n(38),k=n(28),C=n(14),w=n(457),A=n(207),S=n(458),N=n(459),T=n(97),M=n(66);return n(460),t=o.View.extend({tagName:"div",className:"cell-edit",_editBox:null,_changeMonitor:null,_isDirty:!1,_editingCellId:null,_rangeWhenBlur:null,_editingInlineStates:null,events:{contextmenu:"_onPreventAndStop",mousedown:"_onStopPropagation",copy:"_onStopPropagation",cut:"_onStopPropagation",paste:"_onPaste",dblclick:"_onDblclick"},_onPreventAndStop:function(e){e.preventDefault(),e.stopPropagation()},_onStopPropagation:function(e){e.stopPropagation()},initialize:function(e){this._table=e.table,this._tableView=e.tableView,this._styleRules=e.styleRules,this._mapper=e.mapper,this._isRendered=!1,this._commander=y({editHost:this}),this._uid=a.unique("cell-edit-view-"),this._eventNS="."+this._uid,delete this.options},render:function(){var e=C.render("common","table_cell_edit",{}),t=this.el;!0!==this._isRendered&&(this._isRendered=!0,t.innerHTML=e,this._editBox=t.querySelector(".cell-edit-box"),this._initEvents())},_initEvents:function(){var e=this._editBox;c.addListeners({focus:"_onFocus",blur:"_onBlur",textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",click:"_onClick"},i(e),this),this._initKeyHandlerManager(),this._changeMonitor=u.create({el:e}),c.addListeners({"content-change":"_onContentChange"},this._changeMonitor,this),this._history=N.create(),c.addListeners({undo:"_onHistoryUndo",redo:"_onHistoryRedo",change:"_onHistoryChange"},this._history,this)},_bindKey:function(e){var t=this,n=t._keyMonitor;e&&(n||(t._keyMonitor=n=new l({el:t._editBox,beforeMatch:function(e){e.stopPropagation()}})),n.unbind(e),n.bind(e,function(n){t._keyHandlerManager&&t._keyHandlerManager.execWithKey(e,t,n)}))},_unbindKey:function(e){var t=this._keyMonitor;t&&e&&t.unbind(e)},_initKeyHandlerManager:function(){var e=new d({scope:"table-cell-edit"}),t=e.getAvailableHandlerNames();e.on("bind-key",this._bindKey.bind(this)),e.on("unbind-key",this._unbindKey.bind(this)),a.each(t,function(t){e.bind(t)}),this._keyHandlerManager=e},blur:function(){this._editBox.blur()},_onBlur:function(){this._isOnToolbarLinkView()?this._rangeWhenBlur=this.getNativeRange():(this.trigger("blur"),this._commitChange())},_onFocus:function(){r.log("on focus")},_recognizeLink:function(e){var t,n,o=this.getNativeRange(),i=this.getEditBox(),r=A.getUrlInfoBeforeRange(o,i)||{};if((this._compositionStartUriInfo||{}).alreadyUrl||r.alreadyUrl)return e.preventDefault(),(n=document.createElement("div")).innerHTML=e.data,t=I.create({name:"insertHTML",value:"<span></span>"+n.innerText,isNative:!0}),void this.execCommand(t);r.startNode&&(" "!==e.data||r.alreadyUrl||(e.preventDefault(),(o=document.createRange()).setStart(r.startNode,r.startOffset),o.setEnd(r.endNode,r.endOffset),this.setNativeRange(o),t=I.create({name:"insertLink",value:r.uri}),this.execCommand(t),(o=this.getNativeRange()).collapse(!1),this.setNativeRange(o),t=I.create({name:"insertHTML",value:" ",isNative:!0}),this.execCommand(t)))},_onTextInput:function(e){var t=e.originalEvent||e;t.stopPropagation(),r.log("text",t.data),this._recognizeLink(t)},_onCompositionStart:function(e){var t=this.getNativeRange(),n=this.getEditBox();e.stopPropagation(),r.log("composition start"),this._isOnComposition=!0,this._compositionStartUriInfo=A.getUrlInfoBeforeRange(t,n)},_onCompositionEnd:function(e){e.stopPropagation(),r.log("composition end"),this._isOnComposition=!1,this._compositionStartUriInfo=null},_onClick:function(e){e.stopPropagation()},_onContentChange:function(){this._isDirty=!0,this._handleChangeWithDebounce()},_snapshot:function(){var e,t=this._editBox,n=this.getNativeRange();if(n)return e=S.jsonlify(t,n),{html:t.innerHTML,jsonRange:e};r.warn("Failed to create snapshot",n)},_saveHistory:function(){var e=this._lastSnapshot||this._baseSnapshot,t=this._snapshot();this._history.save({snapshotBefore:e,snapshotAfter:t}),this._lastSnapshot=t},_clearTimeoutOfHandleChange:function(){this._timeoutOfHandleChange&&(window.clearTimeout(this._timeoutOfHandleChange),this._timeoutOfHandleChange=null)},_handleChangeWithDebounce:function(){var e=this;e._clearTimeoutOfHandleChange(),e._timeoutOfHandleChange=window.setTimeout(function(){if(e._isOnComposition)return!1;e._saveHistory()},500)},_silentDo:function(e){this._changeMonitor&&!1===this._changeMonitor.isMonitoring()?e():(this._changeMonitor.disconnect(),e(),this._changeMonitor.observe())},silentDocSelectionChangeDo:function(e){var t=this;t._stopListenerDocSelectionChange?e():(t._stopListenerDocSelectionChange=!0,e(),window.clearTimeout(t._timeoutForStopListenerDocSelectionChange),t._timeoutForStopListenerDocSelectionChange=window.setTimeout(function(){t._stopListenerDocSelectionChange=!1},0))},undo:function(){var e=this._history;return this._clearTimeoutOfHandleChange(),!!e&&e.undo()},redo:function(){var e=this._history;return this._clearTimeoutOfHandleChange(),!!e&&e.redo()},_restoreSnapshot:function(e){if(e){var t=this;t._clearTimeoutOfHandleChange(),t._silentDo(function(){var n;t._editBox.innerHTML=e.html,n=S.parseJSON(t._editBox,e.jsonRange),t.setNativeRange(n)})}},_onHistoryUndo:function(e){this._restoreSnapshot(e)},_onHistoryRedo:function(e){this._restoreSnapshot(e)},_onHistoryChange:function(){var e=this._history;this.trigger("cell-edit-view-history-change",{canUndo:e.canUndo(),canRedo:e.canRedo()})},_handleContentWhenShowAndEdit:function(e,t){var n,o,i=!1;return null!=e?e instanceof f||(n=e instanceof g?e:g.create(e+""),i=!(o=f.create({richText:n})).isEmpty()):t.getType()===h.TEXT&&(o=t.getContent()).isEmpty()&&(o=null),{lines:o,isDirty:i}},showAndEdit:function(e){if(e&&null!=e.row&&null!=e.col){var t,n,o,s,l=this,c=l._table.getCell(e.row,e.col),d=l._tableView.$el.width(),u=i(".page-A4").get(0)?85:25,h=i(l._editBox),p={};c&&(l._changeMonitor.disconnect(),l._editingCellId=c.getCellId(),(t=l._tableView.getBoundingRectAt(e.row,e.col))&&((o=(n=l._handleContentWhenShowAndEdit(e.content,c)).lines)||(o=f.createBlank(!0),s=!0),l._isDirty=n.isDirty,t.width+t.left>d&&(t.width=d-t.left+u),u+t.left<0&&(t.left=-u,t.width=u+t.right),h.css({left:t.left,top:t.top,width:t.width,minHeight:t.height-3}),l._renderLines(o),l.$el.show(),l._focusEditBox(!0),s&&(a.each(c.getStylesForEmpty(),function(e,t){var n,o={};if(o[t]=e,n=w.createCmdBall("comp.ApplyStyles",{inlineStyles:o}),r.log("stylesForEmpty to cmdBall",t,e,n),!n)return!1;p[n.name]=n}),p.fontSize&&(l.execCommand(p.fontSize),delete p.fontSize),a.each(p,function(e){l.execCommand(e)})),l._changeMonitor.observe(),l._addListenerForDocSelectionChange(),l._baseSnapshot=l._snapshot(),l.trigger("cell-edit-view-enter",{canUndo:l._history.canUndo(),canRedo:l._history.canRedo()})))}else r.warn("Failed to show cell edit view, parameter is not valid",e)},_onSelectionChange:function(){var e=this.getNativeRange();this._clearEditingInlineStates(),this.trigger("cell-edit-view-selection-change",e)},_addListenerForDocSelectionChange:function(){var e=this;i(document).on("selectionchange"+e._eventNS,function(t){e.getNativeRange()?e._stopListenerDocSelectionChange?r.log("selection change NOT listener"):e._onSelectionChange(t):r.log("native range is not in cell edit view")})},_removeListenerForDocSelectionChange:function(){i(document).off("selectionchange"+this._eventNS)},_renderLines:function(e){var t=e.toHtml({styleRules:this._styleRules}),n=this._editBox;i(n).html(t)},_focusEditBox:function(e){var t,n=this._editBox;if(e){var o=_.getRange(),i=n.querySelector(".table-cell-line");if(!i||!o)return;t=i.lastChild||i,o.setStart(t,t.childNodes.length),o.setEnd(t,t.childNodes.length),_.setRange(o)}n.focus()},hide:function(){this.$el.hide()},_filterToLinesHtml:function(){var e=this._editBox,t=function(e){a.each(e,function(e){var n=e.style.textDecorationLine;n&&(e.style.textDecoration=n),e.hasChildNodes()&&t(e.children)})};t(e.children)},_getContentAsLines:function(){var e,t,n=f.createBlank();return this._viewStyleToData(),this._filterToLinesHtml(),e=this._editBox.innerHTML,t=p(e,{holdSpaces:!0})||[],a.each(t,function(e){var t=M.blockToCellContent(e);t instanceof f&&n.appendLines(t)}),n},_viewStyleToData:function(){var e=this,t=e._editBox,n=e._styleRules,o=e._mapper;a.map(n,function(n,i){var r,s,l;r=t.querySelectorAll("font"),"font-family"!==i?(e._elsViewStyleToData(r,o,i),e._elsViewStyleToData(t.querySelectorAll("span"),o,i)):a.forEach(r,function(e){s=e.getAttribute("face"),(s=v.getFontFirstValue(s))&&(l=o.valueFromView(i,s))&&e.setAttribute("face",l)})})},_elsViewStyleToData:function(e,t,n){var o,i,r=!1;a.forEach(e,function(e){(o=e.getAttribute(n))?r=!0:o=e.style[n],o&&("color"===n&&(o=k(o).toHexString()),(i=t.valueFromView(n,o))&&(r?e.setAttribute(n,i):e.style[n]=i))})},_commitChange:function(){var e;r.log("commit change"),this._isDirty&&(e=this._getContentAsLines(),this.trigger("set-cell-content",this._editingCellId,e)),this.exit()},_isOnToolbarLinkView:function(){return i(".combo-menu-link .link-input").is(":visible")},isFocused:function(){var e=document.activeElement;return e===this.el||i.contains(this.el,e)},_isShow:function(){return this.$el.is(":visible")},isOnEdit:function(){return!!this.isFocused()||this._isOnToolbarLinkView()&&this._isShow()},getNativeRange:function(){var e=_.getRange();if(_.isRangeInNode(this._editBox,e))return e;r.warn("native range is null or not in cell edit view",e)},setNativeRange:function(e){_.isRangeInNode(this._editBox,e)?_.setRange(e):r.warn("Failed to set native range to cell edit view",e)},_formatStyles:function(e){return e},_queryStyles:function(e){var t,n,o=this.getNativeRange();if(o)return t=o.startContainer,m.isText(t)&&(t=t.parentNode),n=window.getComputedStyle(t,null),n=this._formatStyles(n),e?n[e]:n},_queryInlineStylesForBulb:function(){var e=this._queryStyles(),t={},n={style:e},o=a.keys(w.INLINE_STYLES_CMD_MAP);return a.forEach(o,function(e){t[e]=T[e].action(n)}),t},queryInlineStylesForBulb:function(){var e,t,n,o=this.getNativeRange();if(o)return e=this._queryInlineStylesForBulb(),o.collapsed&&this._editingInlineStates?(t=a.clone(this._editingInlineStates),a.defaults(t,e),n=t):n=e,n.cellEditViewRangeCollapsed=o.collapsed,n},toggleInlineStyle:function(e){var t,n;-1!==a.keys(w.TOGGLE_INLINE_STYLES_CMD_MAP).indexOf(e)?(n=w.getCmdNameByStyleName(e),t=I.create({name:n,tryNativeIfNeeded:!0}),this.execCommand(t)):r.warn("toggleInlineStyle does NOT supprot",e)},_shouldModifyEditingInlineStates:function(e,t,n){return!!(e&&e.name&&t&&t.collapsed&&1===n)&&a.values(w.INLINE_STYLES_CMD_MAP).indexOf(e.name)>-1},_grabEditingInlineStates:function(e){if(e&&e.name){var t;this._editingInlineStates||(t=this._queryInlineStylesForBulb(),this._editingInlineStates=t)}},_updateEditingInlineStates:function(e){if(e&&e.name){var t=e.name,n=e.value,o=w.getStyleNameByCmdName(t),i=a.keys(w.TOGGLE_INLINE_STYLES_CMD_MAP);o&&this._editingInlineStates&&(i.indexOf(o)>-1&&!0!==n&&!1!==n&&(n=!this._editingInlineStates[o]),this._editingInlineStates[o]=n)}},_clearEditingInlineStates:function(){this._editingInlineStates=null},execCommand:function(e){var t,n,o=this.getNativeRange();return r.log("execCommand",e),o?(this._nestLevel||(this._nestLevel=0),this._nestLevel++,t=this._shouldModifyEditingInlineStates(e,o,this._nestLevel),1===this._nestLevel&&(t?this._grabEditingInlineStates(e):this._clearEditingInlineStates()),(n=this._commander.exec(e))&&1===this._nestLevel&&(t?this._updateEditingInlineStates(e):this._clearEditingInlineStates(),this.trigger("cell-edit-view-command-executed")),this._nestLevel--,n):(r.warn("nativeRange  is not in editBox"),!1)},exit:function(){this._isDirty=!1,this._editingCellId=null,this._clearTimeoutOfHandleChange(),this._lastSnapshot=null,this._baseSnapshot=null,this._removeListenerForDocSelectionChange(),this._changeMonitor.disconnect(),this._history.reset(),this.trigger("cell-edit-view-exit"),this.hide()},_filterTable:function(e){var t=e.querySelectorAll("table");a.each(t,function(e){var t=e.querySelectorAll("td"),n="";a.each(t,function(e){n+=e.innerHTML}),e.innerHTML=n})},_filterHtml:function(e){var t=s(e),n=["img"];return t?(this._filterTable(t),a.each(b,function(e,t){!1===e&&n.push(t)}),a.each(n,function(e){var n=t.querySelectorAll(e);a.each(n,function(e){e&&e.parentNode&&e.parentNode.removeChild(e)})}),t.innerHTML.trim()):""},_onPaste:function(e){var t,n,o=(e.originalEvent||e).clipboardData;e.stopPropagation(),e.preventDefault(),o&&o.types&&(-1!==a.indexOf(o.types,"text/html")?(t=o.getData("text/html"),t=this._filterHtml(t),n=I.create({name:"insertHTML",isNative:!0,value:t})):-1!==a.indexOf(o.types,"text/plain")&&(t=o.getData("text/plain"),n=I.create({name:"insertText",isNative:!0,value:t})),this.execCommand(n))},_onDblclick:function(e){e.stopPropagation()},editFromToolbar:function(e,t){var n,o=this.getNativeRange(),i=this.queryInlineStylesForBulb();return this._rangeWhenBlur&&(o=this._rangeWhenBlur,_.setRange(o)),!!o&&(!!(n=w.createCmdBall(e,t,i))&&(this.execCommand(n),this._rangeWhenBlur=null,!0))},getEditBox:function(){return this._editBox}},{create:function(e){if(e&&e.table&&e.tableView)return new t(e);r.warn("Failed to create CellEditView",e)},isRangeIn:function(e){if(!e)return!1;return _.isRangeInSelector("div.cell-edit",e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){"use strict";var t,o,i=n(0),r={ACTION_SHOW_ENABLE:1,ACTION_HIDE:2,ACTION_ENABLE:3,ACTION_DISABLE:4},a={RANGE_DEFAULT:1,RANGE_HEADER_FOOTER:2,RANGE_TABLE_CELL:3,RANGE_CATALOGUE:4,RANGE_IMAGE:5,RANGE_ATTACHMENT:6,RANGE_QUOTE:7,RANGE_CODE:8},s={EDITOR_BUTTON_STATE_MAP:{undo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],redo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],"remove-format":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"format-painter":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"no-table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE}],heading:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"base-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE}],"font-family":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"font-size":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],bold:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],italic:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],underline:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],strike:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],color:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"back-color":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"unordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"ordered-list":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],todo:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],quote:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],align:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],"table-justify":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],indent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],outdent:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE},{on:a.RANGE_QUOTE,action:r.ACTION_DISABLE}],code:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],"code-theme":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],"code-language":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_CODE,action:r.ACTION_SHOW_ENABLE}],"line-height":[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_IMAGE,action:r.ACTION_DISABLE},{on:a.RANGE_ATTACHMENT,action:r.ACTION_DISABLE}],"table-wrap":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-operate":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-split":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],"table-merge":[{on:a.RANGE_DEFAULT,action:r.ACTION_HIDE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_SHOW_ENABLE}],table:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],hr:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],link:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],img:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],attachment:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}],catalogue:[{on:a.RANGE_DEFAULT,action:r.ACTION_SHOW_ENABLE},{on:a.RANGE_HEADER_FOOTER,action:r.ACTION_DISABLE},{on:a.RANGE_TABLE_CELL,action:r.ACTION_HIDE},{on:a.RANGE_CATALOGUE,action:r.ACTION_DISABLE}]}},l=["font-family","font-size","table","table-justify","table-wrap","table-operate","table-split","table-merge"];return t=["undo","redo","code","code-language","code-theme"].concat(l),o={on:a.RANGE_CODE,action:r.ACTION_DISABLE},Object.keys(s.EDITOR_BUTTON_STATE_MAP).forEach(function(e){t.indexOf(e)>-1||s.EDITOR_BUTTON_STATE_MAP[e].push(o)}),function(e,t){e.forEach(function(e){s.EDITOR_BUTTON_STATE_MAP[e]&&s.EDITOR_BUTTON_STATE_MAP[e].push(t)})}(l,{on:a.RANGE_CODE,action:r.ACTION_HIDE}),i.extend(s,r,a)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(13),i=n(5),r=n(1),a=window.MutationObserver||window.WebKitMutationObserver;return t=o.extend({initialize:function(e){var t=this;e=e||{},t._el=e.el,t._monitoring=!1,t._hasBindDOMSubtreeModified=!1,delete t.options,a&&(t._observer=new a(function(){t._fireChange()}))},_fireChange:function(){!0===this._monitoring&&this.trigger("content-change")},observe:function(){this.isMonitoring()||(this._observer?this._observer.observe(this._el,{childList:!0,attributes:!0,subtree:!0,characterData:!0,attributeFilter:["style"]}):!1===this._hasBindDOMSubtreeModified&&(this._hasBindDOMSubtreeModified=!0,i(this._el).on("DOMSubtreeModified",this._fireChange.bind(this))),this._monitoring=!0)},disconnect:function(){this._monitoring=!1,this._observer&&this._observer.disconnect()},destroy:function(){this._observer?(this._observer.disconnect(),this._observer=null):!0===this._hasBindDOMSubtreeModified&&i(this._el).off("DOMSubtreeModified")},isMonitoring:function(){return this._monitoring}},{create:function(e){if(e&&e.el)return new t(e);r.warn("Failed to create ChangeMonitor")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(450),o=n(451),i=[n(452),n(453),o,n(454),n(455),n(456)];return function(e){var n=t.create(e);return n.addCmds(i),n}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(1),r=n(16),a=["undo","redo","fontSize"];return t=r.extend({initialize:function(e){e=o.defaults(e||{},{editHost:null}),this._commands={},this._editHost=e.editHost,delete this.options},addCmd:function(e){var t=this._commands;if(e&&e.name&&e.action){if(t[e.name])return void i.warn("command has defined: ",e.name);t[e.name]=e}},addCmds:function(e){var t=this;o.each(e,function(e){t.addCmd(e)})},exec:function(e){var t,n=this;return e&&e.name?(!0===e.stopSelectionChange?n._editHost.silentDocSelectionChangeDo(function(){t=n._exec(e)}):t=n._exec(e),t):(i.warn("Failed to exec cmdBall",e),!1)},_exec:function(e){var t,n,o,r=this._commands;if(t=e.name,!e.isNative){if((o=r[t])&&o.action)return n=o.action.apply(o,[e.value,this,this._editHost]),e.callback&&e.callback(n),n;if(i.warn("no command",t),!e.tryNativeIfNeeded)return!1;i.warn("try to exec native command",t)}return a.indexOf(t)>-1?(i.error("native command is unvalid",t),!1):(n=this.execNative(t,e.value),e.callback&&e.callback(n),n)},execNative:function(e,t){if(document.queryCommandSupported(e)){document.execCommand("styleWithCSS",!1,!0);var n=document.execCommand(e,!1,t||"");return n||i.error("Failed to exec command",e,t),n}i.error("command is not supported",e)}},{create:function(e){return new t(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(74);return{name:"fontSize",action:function(e,n,o){var i,r=o.getNativeRange();return!!r&&(r.collapsed?(o.execCommand(t.create({name:"insertHTML",isNative:!0,value:'<span style="font-size: '+e+'px;"> </span>'})),o.execCommand(t.create({name:"delete",isNative:!0}))):(i=t.create({name:"applyInlineStyle",value:{name:"fontSize",value:e+"px"},isNative:!1}),o.execCommand(i)))}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(43),i=n(1),r=function(e,t){for(var n=t.parentNode;null!==n;){if(n===e)return!0;n=n.parentNode}return!1},a=function(e,t,n){if(n===e)return null;if(e.firstChild&&!t)return e.firstChild;if(!e.parentNode)return null;for(var o=e.nextSibling||a(e.parentNode,!0,n);r(o,n);)o=o.firstChild;return o},s=function(e,t,n){var i,r=e.startContainer,s=e.startOffset,l=e.endContainer,c=e.endOffset;for(o.isElement(r)&&0!==s&&(r=(i=r.childNodes[s])||r.nextSibling,s=0),o.isElement(l)&&c!==l.length&&(c=(l=0===c?l.previousSibling:(i=l.childNodes[c-1])||l.previousSibling).length),i=r;i;i=a(i,t,l))n(i)},l=function(e){if(e.parentNode){var n=t.toArray(e.childNodes),o=e.parentNode;(function(e,t){if(e&&e.tagName)return(e.tagName+"").toLowerCase()===(t+"").toLowerCase()})(e,"span")&&0===e.attributes.length&&(t.each(n,function(t){e.removeChild(t),o.insertBefore(t,e)}),o.removeChild(e)),t.each(n,function(e){l(e)})}},c=function(e,t,n){var i;!function(e){var t,n=e.startContainer,i=e.endContainer,r=e.startOffset,a=e.endOffset;o.isText(i)&&a!==i.length&&i.splitText(a),o.isText(n)&&0!==r&&(t=n.splitText(r),n===i&&(i=t,a=t.length),n=t,r=0),e.setStart(n,r),e.setEnd(i,a)}(e),i=function(e){return{startNode:e.startContainer,endNode:e.endContainer,startOffset:e.startOffset,endOffset:e.endOffset}}(e),function(e,t){s(e,!1,function(e){o.isElement(e)&&(e.style[t]="")}),l(e.commonAncestorContainer)}(e,t),s(e,!0,function(i){var r;o.isElement(i)?i.style[t]=n:o.isText(i)&&!/^\s*$/.test(i.data)&&((r=e.startContainer.ownerDocument.createElement("span")).style[t]=n,i.parentNode.insertBefore(r,i),i.parentNode.removeChild(i),r.appendChild(i))}),function(e,t){e.setStart(t.startNode,t.startOffset),e.setEnd(t.endNode,t.endOffset)}(e,i)};return{name:"applyInlineStyle",action:function(e,t,n){var o=e.name,r=e.value,a=n.getNativeRange();return a&&!function(e){var t=e.startContainer,n=e.endContainer,o=e.startOffset,i=e.endOffset;return t===n&&o===i}(a)?(c(a,o,r),n.setNativeRange(a),!0):(i.warn("Failed to execute applyInlineStyle",a),!1)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(74),i=n(240);return{name:"applyInlineStyles",action:function(e,n,r){var a=!1;return t.map(i.INLINE_STYLES_CMD_MAP,function(n,i){if(t.has(e,i)){if(null==e[i])return;r.execCommand(o.create({name:n,value:e[i],stopSelectionChange:"fontSize"===n})),a=!0}}),a}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(74),o=n(120),i=n(62);return{name:"insertLink",action:function(e,n,r){return!!(e=i.safeHref(e))&&(r.execCommand(t.create({name:"underline",value:!0})),r.execCommand(t.create({name:"createLink",value:o.completeUrl(e||"")})),!0)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{name:"undo",action:function(e,t,n){return n.undo()}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{name:"redo",action:function(e,t,n){return n.redo()}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(74),o=n(38),i=n(0),r=n(1),a=n(240);return{TOGGLE_INLINE_STYLES_CMD_MAP:a.TOGGLE_INLINE_STYLES_CMD_MAP,INLINE_STYLES_CMD_MAP:a.INLINE_STYLES_CMD_MAP,getStyleNameByCmdName:function(e){var t;return i.some(this.INLINE_STYLES_CMD_MAP,function(n,o){if(n===e)return t=o,!0}),t},getCmdNameByStyleName:function(e){if(e)return this.INLINE_STYLES_CMD_MAP[e]},_createInlineStyleCmdBall:function(e){e=e||{};var n;return i.some(this.INLINE_STYLES_CMD_MAP,function(r,a){if(i.has(e,a))return"font-family"===a&&(e[a]=o.getAllValueByFont(e[a])||e[a]),n=t.create({name:r,value:e[a],stopSelectionChange:"fontSize"===r}),!0}),n},_createFormatPainterCmdBall:function(e,n){return i.map(n,function(t,o){e[o]===n[o]&&delete e[o]}),t.create({name:"applyInlineStyles",value:e})},createCmdBall:function(e,n,o){var i;switch(n=n||{},e){case"comp.RemoveFormat":i=t.create({name:"removeFormat"});break;case"comp.FormatPainter":if(!n.data||!n.data.inlineStyles)return;i=this._createFormatPainterCmdBall(n.data.inlineStyles,o);break;case"comp.ApplyStyles":n.inlineStyles&&(i=this._createInlineStyleCmdBall(n.inlineStyles));break;case"comp.InsertLink":if(!n.src)return;i=t.create({name:"insertLink",value:n.src});break;case"undo":i=t.create({name:"undo",isNative:!1,tryNativeIfNeeded:!1});break;case"redo":i=t.create({name:"redo",isNative:!1,tryNativeIfNeeded:!1})}return i?r.log("toolbarAdapter handles name/args/ball",e,n,i):r.warn("toolbarAdapter do NOT handle: ",e,n),i}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(43),i=n(1);return{jsonlify:function(e,n){if(e&&n){var r=function(n){var i,r={};return o.isText(n)?(i=n.parentNode,r.childIndex=t.indexOf(i.childNodes,n)):i=n,r.isRoot=i===e,r.isRoot?r:(r.tagName=i.tagName,r.tagIndex=t.indexOf(e.querySelectorAll(r.tagName),i),r)},a={collapsed:n.collapsed,startContainer:r(n.startContainer),startOffset:n.startOffset};return i.log(a),a.collapsed?a:(a.endContainer=r(n.endContainer),a.endOffset=n.endOffset,a)}},parseJSON:function(e,t){if(e&&t){var n,o=function(t){var n;return t.isRoot?null!=t.childIndex?e.childNodes[t.childIndex]:e:(n=e.querySelectorAll(t.tagName)[t.tagIndex],null!=t.childIndex?n.childNodes[t.childIndex]:n)},i=e.ownerDocument.createRange(),r=o(t.startContainer);return i.setStart(r,t.startOffset),t.collapsed?i.setEnd(r,t.startOffset):(n=o(t.endContainer),i.setEnd(n,t.endOffset)),i}}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(13),i=n(1);return t=o.extend({initialize:function(){delete this.options,this.reset()},reset:function(){this._undo=[],this._redo=[],this.trigger("change")},save:function(e){if(!e||!e.snapshotBefore||!e.snapshotAfter)return i.warn("parameter is unvalid",e),!1;return this._undo.push(e),this._redo=[],this.trigger("change"),i.log("history save operation",this._undo.length,e),!0},canUndo:function(){return this._undo.length>0},canRedo:function(){return this._redo.length>0},undo:function(e){var t;for(e=e||1,i.log("history undo",e);e&&e>0&&this.canUndo();)t=this._undo.pop(),this._redo.push(t),e--;return!!t&&(i.log("history undo",t.snapshotBefore),this.trigger("undo",t.snapshotBefore),this.trigger("change"),!0)},redo:function(e){var t;for(e=e||1,i.log("history redo",e);e&&e>0&&this.canRedo();)t=this._redo.pop(),this._undo.push(t),e--;return!!t&&(i.log("history redo",t.snapshotAfter),this.trigger("redo",t.snapshotAfter),this.trigger("change"),!0)}},{create:function(e){return new t(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(461),n(462),n(463),n(464),n(465),n(466),n(467)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(74),i=n(207);t.register({name:"enter",scope:"table-cell-edit",key:"enter",action:function(e){var t,n,r=e.getNativeRange(),a=e.getEditBox();(t=i.getUrlInfoBeforeRange(r,a))?(t.alreadyUrl||((r=document.createRange()).setStart(t.startNode,t.startOffset),r.setEnd(t.endNode,t.endOffset),e.setNativeRange(r),n=o.create({name:"insertLink",value:t.uri}),e.execCommand(n),(r=e.getNativeRange()).collapse(!1),e.setNativeRange(r)),n=o.create({name:"insertHTML",value:"<div><br/></div>",isNative:!0})):n=o.create({name:"insertLineBreak",isNative:!0}),e.execCommand(n)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(74),i=n(207),r=function(e){var t,n,r=e.getNativeRange(),a=e.getEditBox();(t=i.getUrlInfoBeforeRange(r,a))?(t.alreadyUrl||((r=document.createRange()).setStart(t.startNode,t.startOffset),r.setEnd(t.endNode,t.endOffset),e.setNativeRange(r),n=o.create({name:"insertLink",value:t.uri}),e.execCommand(n),(r=e.getNativeRange()).collapse(!1),e.setNativeRange(r)),n=o.create({name:"insertHTML",value:"<div><br/></div>",isNative:!0})):n=o.create({name:"insertLineBreak",isNative:!0}),e.execCommand(n)};t.register({name:"altEnter",scope:"table-cell-edit",key:"alt+enter",action:r}),t.register({name:"shiftEnter",scope:"table-cell-edit",key:"shift+enter",action:r})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(7).register({name:"esc",scope:"table-cell-edit",key:"esc",action:function(e){e.exit()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7);n(0).each({"mod+b":"bold","mod+i":"italic","mod+e":"strike","mod+u":"underline"},function(e,n){t.register({name:e,scope:"table-cell-edit",key:n,action:function(t){t.toggleInlineStyle(e)}})})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(74);t.register({name:"modZ",scope:"table-cell-edit",key:"mod+z",action:function(e){var t=o.create({name:"undo",isNative:!1,tryNativeIfNeeded:!1});e.execCommand(t)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(74),i=function(e){var t=o.create({name:"redo",isNative:!1,tryNativeIfNeeded:!1});e.execCommand(t)};t.register({name:"modShiftZ",scope:"table-cell-edit",key:"mod+shift+z",action:i}),t.register({name:"modY",scope:"table-cell-edit",key:"mod+y",action:i})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(7).register({name:"save",scope:"table-cell-edit",key:"mod+s",action:function(){}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(20),i=n(0),r=n(1),a=n(35),s=n(137),l=n(52),c=new Array(3).join(" "),d=[8,9,13,16,17,18,19,20,27,33,34,35,36,37,38,39,40,45,46,91,92,93,112,113,114,115,116,117,118,119,120,121,122,123,144,145,229];return t=o.View.extend({tagName:"input",className:"hidden-input",_lastKeyDownCode:null,initialize:function(){this._initEvents(),delete this.options},_initEvents:function(){a.addListeners({keydown:"_onKeyDown",textInput:"_onTextInput",compositionstart:"_onCompositionStart",compositionend:"_onCompositionEnd",copy:"_onCopyCutPaste",cut:"_onCopyCutPaste",paste:"_onCopyCutPaste"},this.$el,this)},bindKey:function(e){var t=this,n=t._keyMonitor;e&&(n||(t._keyMonitor=n=new s({el:t.el,beforeMatch:function(e){e.stopPropagation()},afterMatch:function(e,n){n||-1!==i.indexOf(d,e.keyCode)||e.ctrlKey||e.metaKey||t._onPrintableKeyDown(e)}})),n.unbind(e),n.bind(e,function(n){t.trigger("key-monitor",e,n)}))},unbindKey:function(e){var t=this._keyMonitor;t&&e&&t.unbind(e)},render:function(){this.$el.val(c)},isFocused:function(){return document.activeElement===this.el},isOnEdit:function(){return this.isFocused()&&this.getValue()!==c},focus:function(e){var t=this.el;e&&this.setPosition(e.left,e.top),t.select()},blur:function(){this.el.blur()},setPosition:function(e,t){var n=this.el;n.style.left=e+"px",n.style.top=t+"px"},setWidth:function(e){this.el.style.width=e+"px"},bringToFront:function(){this.el.value="",this.el.style.zIndex=255},hideBehind:function(){this.el.style.zIndex=-255},_onPrintableKeyDown:function(e){this._printableKeyDown=!0,32===e.keyCode&&(e.preventDefault(),this.$el.trigger("textInput",e))},_onKeyDown:function(e){this._lastKeyDownCode=e.keyCode},_onTextInput:function(e){e=e.originalEvent||e,r.log("hiddenInputView textInput",e),e.stopPropagation();var t=this,n=e.data;if(this._printableKeyDown)return e.preventDefault(),this._triggerTextInput(n),void(this._printableKeyDown=!1);229===t._lastKeyDownCode&&window.setTimeout(function(){t._triggerTextInput(n)},50)},_onCompositionStart:function(e){r.log("hiddenInputView compositionstart",e),e.stopPropagation(),this.bringToFront()},_onCompositionEnd:function(e){if(e=e.originalEvent||e,r.log("hiddenInputView compositionend",e),e.stopPropagation(),!this.locked){var t=e.data||this.$el.val();t&&i.defer(function(){this._triggerTextInput(t)}),this.hideBehind()}},_onCopyCutPaste:function(e){var t=e.type;e.preventDefault(),e.stopPropagation(),r.log("on copy/cut/paste",t,e),this.trigger(t,e)},_triggerTextInput:function(e){this.trigger("text-input",e),this.clearValue()},clearValue:function(){this.el.value=c},getValue:function(){return this.el.value}},{create:function(e){return new t(e)},isRangeIn:function(e){if(e){return l.isRangeInSelector("input.hidden-input",e)}}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(239),i=n(35),r=n(73),a=n(14),s=n(0);return t.View.extend({className:"cell-resize-layer",initialize:function(e){var t=e.tableView,n=t.$el;this._tableView=t,this._draggable=new o({el:this.el,disableDocSelection:!0}),this._active=!0,this._onDrag=!1,this._resizeDirection=null,this._cellInfo=null,this._rowLine=n.find(".row-resize-line"),this._colLine=n.find(".col-resize-line"),this._bindEvents()},onDestroy:function(){this.draggable.off()},_bindEvents:function(){var e=this._draggable,t=this._tableView,n={};s.bindAll(this,"_onCellEnter"),n[o.DRAG_START]="_onDragStart",n[o.DRAGGING]="_onDragging",n[o.DRAG_END]="_onDragEnd",i.addListeners(n,e,this),t.on("cell-enter",this._onCellEnter)},render:function(){var e=a.render("common","table_cell_resize",{});this.$el.html(e),this.showAt()},showAt:function(e){e&&null!=e.width&&this.$el.css({width:e.width,height:e.height,top:e.top,left:e.left}).show()},hide:function(){this.$el.hide()},enable:function(){this._active=!0},disable:function(){this._active=!1,this.hide()},isActive:function(){return this._active},_parseType:function(e){var t,n=e.className;return s.some(r,function(e,o){var i=o.toLowerCase();if(n.indexOf(i)>-1)return t=e,!0}),t||r.UP},_onDragStart:function(e){var t,n=this._tableView;n&&!n.isLocked()&&(e.stopPropagation(),this._onDrag=!0,this._resizeDirection=this._parseType(e.target),t=n.getEventBoundingRect(e),this._startRect=t,this._updateResizeLine(t.left,t.top),n.focusOutTbody())},_onDragging:function(e){var t,n=this._tableView;n&&!n.isLocked()&&(e.stopPropagation(),this._onDrag=!0,t=n.getEventBoundingRect(e),this._updateResizeLine(t.left,t.top))},_onDragEnd:function(e){var t,n,o,i=this._tableView,a=this._cellInfo;i&&!i.isLocked()&&(e.stopPropagation(),this._onDrag=!1,t=i.getEventBoundingRect(e),this._updateResizeLine(t.left,t.top,!0),n=t.left-this._startRect.left,o=t.top-this._startRect.top,a&&(0===a.row&&this._resizeDirection===r.TOP&&(o=0-o),0===a.col&&this._resizeDirection===r.LEFT&&(n=0-n)),this._execResizeCommand(n,o))},_updateResizeLine:function(e,t,n){switch(this._resizeDirection){case r.UP:case r.DOWN:n?this._rowLine.hide():this._rowLine.css({top:t}).show();break;case r.RIGHT:case r.LEFT:n?this._colLine.hide():this._colLine.css({left:e}).show()}},_execResizeCommand:function(e,t){var n,o,i,a,l,c,d,u,h,p,g=this._tableView,f=g.block,m=this._cellInfo;switch(this._resizeDirection){case r.UP:case r.DOWN:n=m.row,this._resizeDirection===r.UP?n-=1:(c=f.getMergePointAttrAt(m.row,m.col).height||0)>1&&(n+=c-1),n=n<0?0:n,i=g.getRowElHeight(n),i+=t,i=s.max([i,10]),this.trigger("set-row-height",n,i);break;case r.RIGHT:case r.LEFT:if(o=m.col,this._resizeDirection===r.LEFT?o-=1:(l=f.getMergePointAttrAt(m.row,m.col).width||0)>1&&(o+=l-1),d=o+1,o=o<0?0:o,u=g.getColElWidth(o),a=s.max([u+e,35]),d>=f.getColumnCount()){this.trigger("set-col-width",o,u+e);break}d!==o?(h=u+f.getColumnWidth(d),p=s.max([h-a,35]),this.trigger("set-cells-size",[{col:d,width:p},{col:o,width:h-p}])):this.trigger("set-col-width",o,a)}},_onCellEnter:function(e){var t,n,o,i=this._tableView,r=i.block;!r.locked&&i&&this.isActive()&&!this._onDrag&&(n=i.getCellElementByTarget(e),(t=r.getCellById(n))&&(this._cellInfo={row:t.row,col:t.col},o=i.getBoundingRect(n),this.showAt(o)))}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(14),o=n(117),i=n(236),r=n(237);return{_renderWrap:function(e){return'<div class="resource-wrap">'+e+"</div>"},renderImage:function(e,t){var n=e.getSource(t),o=document.createElement("img");return o.setAttribute("draggable","false"),o.setAttribute("src",r.getURL(i.addIfNeeded(n))||""),o.setAttribute("width","100%"),o.setAttribute("height","auto"),this._renderWrap(o.outerHTML)},renderAttachment:function(e){var n,i,r,a,s=e.getInfo();return n=o.splitFileFullName(s.fileName),i=o.getSizeString(s.fileLength),a=o.getFileIconByName(s.fileName),r=t.render("common","attachment-view-attachment-container",{name:a,fileName:n.fileName.replace(/ /g,"&nbsp;"),fileType:n.fileType.replace(/ /g,"&nbsp;"),size:i,title:s.fileName.replace(/ /g,"&nbsp;"),draggable:!1}),this._renderWrap(r)}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{encode:function(e){return window.btoa(window.unescape(encodeURIComponent(e)))},decode:function(e){return decodeURIComponent(window.escape(window.atob(e)))}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(473),n(474),n(475),n(476),n(477),n(478),n(479),n(480)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7);n(0).each({"mod+b":"bold","mod+i":"italic","mod+u":"underline","mod+e":"strike"},function(e,n){t.register({name:e,scope:"table-hidden-input",key:n,action:function(t){t.toggleInlineStyle(e)}})})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(73),i=n(0),r={left:o.LEFT,right:o.RIGHT,up:o.UP,down:o.DOWN,tab:o.RIGHT,"shift+tab":o.LEFT,enter:o.DOWN};i.each(r,function(e,n){t.register({name:n,scope:"table-hidden-input",key:n,action:function(t,n){t.moveWithDirection(e,n)}})})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7);n(0).each(["backspace","del"],function(e){t.register({name:e,scope:"table-hidden-input",key:e,action:function(e){e.clearSelectedCells()}})})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(7).register({name:"save",scope:"table-hidden-input",key:"mod+s",action:function(e){e.trigger("save-content")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(7).register({name:"select-all",scope:"table-hidden-input",key:"mod+a",action:function(e){e.selectAll(!0)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7);t.register({name:"undo",scope:"table-hidden-input",key:"mod+z",action:function(e){e.trigger("global-undo")}}),t.register({name:"redo",scope:"table-hidden-input",key:"mod+y",action:function(e){e.trigger("global-redo")}}),t.register({name:"redo_2",scope:"table-hidden-input",key:"mod+shift+z",action:function(e){e.trigger("global-redo")}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7),o=n(0),i=n(1),r=n(9);n(36).isSafari()&&!r.IS_MAC||o.each(["mod+1","mod+2","mod+3","mod+4","mod+d","mod+h","mod+l","ctrl+q"],function(e){t.register({name:e,scope:"table-hidden-input",key:e,preventDefault:!0,action:function(){i.log("shortcut prevented on table")}}),t.register({name:e,scope:"table-cell-edit",key:e,action:function(){i.log("shortcut prevented on table")}})})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(7);t.register({name:"paste",key:"mod+v",scope:"table-hidden-input",preventDefault:!1,action:function(e){e.setPasteAsText(!1)}}),t.register({name:"pasteAsText",key:"mod+shift+v",scope:"table-hidden-input",preventDefault:!1,action:function(e){e.setPasteAsText(!0)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(90),o=n(0),i=n(14);return t.extend({$checkbox:null,_checked:!1,name:"todo",className:"block-view todo-view",events:{"mousedown .todo-mark":"_onClick"},initialize:function(e){t.prototype.initialize.apply(this,arguments),this.options=e,this.block=e.block,o.bindAll(this,"_blockCheckedChange","_onStyleChange"),this.block.on("checked-change",this._blockCheckedChange),this.block.on("style-change",this._onStyleChange)},_renderTemplate:function(){this.$el.html(i.render("common",this.name))},render:function(){var e=this.block;t.prototype.render.apply(this,arguments),this._blockCheckedChange(e.getChecked()),this._setContainerStyles()},_setContainerStyles:function(){var e=this,t=e.block.getBlockStyles();o.each(t,function(t,n){e._setContainerStyle(n,t)})},_setContainerStyle:function(e,t){var n=this.$el.find(".todo-content");switch(e){case"back-color":n.parent().css("background-color",t);break;case"padding":n.css("padding",t)}},_onStyleChange:function(e,n){t.prototype._onStyleChange.apply(this,arguments),this._setContainerStyle(e,n)},_blockCheckedChange:function(e){e?this.$el.addClass("checked"):this.$el.removeClass("checked"),this._checked=e},_onClick:function(e){e.preventDefault(),e.stopPropagation();var t=this._checked;this.trigger("command","comp.SetBlockProps",{blocks:[this.block],props:{checked:!t}})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(5),i=n(90),r=n(59),a=n(234),s=n(24),l=n(28),c=n(19),d=n(88),u=n(115),h=n(38);return i.extend({name:"quote",className:"block-view paragraph-view quote-view",render:function(){this._renderTemplate(),this._renderText(u.getQuoteDefaultStyles()),this._renderStyles(),this._setContainerStyles(),r.prototype.render.apply(this,arguments)},_setContainerStyles:function(){var e=this,n=e.block.getBlockStyles();t.each(n,function(t,n){e._setContainerStyle(n,t)})},_setContainerStyle:function(e,t){var n=this.$el.find(".para-text");switch(e){case"back-color":n.parent().css("background-color",t);break;case"padding":n.css({padding:t,margin:t}),"0px"===n.css("padding-left")&&n.css("padding-left","17px"),n.css("padding-top","0px")}},_renderText:function(e){var n,i,r=this,p=r.block,g=p.getReadOnlyText(),f=r._inlineStyleViewMapper,m=r.$el.find(".para-text");n=g.isEmpty()?this._createHtmlForBlankLine(e):s.rich2html(g,{styles:e,styleRules:{color:function(e){var t=e.color;return e.href!==c.getDefault("href")&&l.equals(e.color,"#003884")?u.getQuoteColor():l.equals(e.color,"#393939")||t===c.getDefault("color")?u.getQuoteColor():null!=t&&f?f.valueToView("color",t):void 0},"font-family":function(e){var t,n=e["font-family"];return n!==c.getDefault("font-family")&&f&&(t=f.valueToView("font-family",n)),n!==t?t:h.getAllValueByFont(n)||n}}}),m.html(n),i=p.getStyleRanges("href"),t.each(i,function(e){var t,n,i;t=new a({start:e.from,end:e.to,block:p}),n=r.convertToNativeRange(t),(i=r._findLinkNode(n.endContainer))&&(o(i).off("hover"),o(i).hover(function(){d.isNoteLinkUrl(i.href)||r.isCollabLocked()||r.trigger("link-menu-show",{linkNode:i,range:t,block:p})},function(){r.trigger("link-menu-hide")}))})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(90),n(59),n(5),n(0),n(484),n(93),n(51),n(62),n(52)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u){"use strict";var h=function(e){return(e.data||e.innerText||e.innerHTML)===d.escapeHtmlEntities(c.EMPTY_LINE_TAG)},p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.className="block-view code-view",t.name="code",t.isSelectedBlock=!1,t}return a(t,e),t.prototype._convertToData=function(){},t.prototype._getContentContainer=function(){return this.$el},t.prototype.getBlock=function(){return this.block},t.prototype.initialize=function(){o.prototype.initialize.apply(this,arguments),n.prototype.initialize.apply(this,arguments);var e=this.getBlock();e.injectTokenizer(s),e.injectRenderParams({YNE_HEAD_CLASS:"yne",PLAIN_STRING_CLASS:"plain"}),r.bindAll(this,"renderText","_onContentChange","onClickBlock","onDrawRange"),this.on("draw-range",this.onDrawRange),e.on("content-change",this.renderText),e.on("content-change",this._onContentChange)},t.prototype.render=function(){this.renderText(),this.renderBackColor(),o.prototype.render.apply(this,arguments)},t.prototype.renderText=function(e){e?this.update(e):(this.renderAll(),this.updateTheme(),this.getCodeLineContainer().on("mousedown",this.onClickBlock))},t.prototype.renderBackColor=function(){var e=this.getBlock().getBlockStyles()["back-color"];this._getContentContainer().css("background-color",e)},t.prototype.onClickBlock=function(e){this.isSelectedBlock=e.currentTarget===e.toElement,this.drawSelectAllRange()},t.prototype.onDrawRange=function(e,t){e||this.getBlock()===t||(this.isSelectedBlock=!1,this.drawSelectAllRange())},t.prototype.onSetRange=function(e){var t=document.createRange();e&&(t.selectNodeContents(this.getCodeLineContainer()[0]),u.setRange(t,window),this.isSelectedBlock=!0,this.getBlock().isSelectedBlock=!0,this.getCodeLineContainer().addClass("selectAll"))},t.prototype.drawSelectAllRange=function(e){var t=this,n=e||this.isSelectedBlock;this.isSelectedBlock=n,this.getBlock().isSelectedBlock=n,n?this.getCodeLineContainer().addClass("selectAll"):this.getCodeLineContainer().removeClass("selectAll"),n?setTimeout(function(){t._getContentContainer().parent().attr("contenteditable",!1)},0):this._getContentContainer().parent().attr("contenteditable",!0),this._getContentContainer().attr("draggable",n)},t.prototype.scrollToStart=function(){this._getContentContainer().scrollLeft(0)},t.prototype.scrollRightByIndex=function(e){var t,n=(t=e,this.get$CodeLine(t)).children(),o=this._getContentContainer(),i=0;n.each(function(e){var t=Number(n.eq(e).width());isNaN(t)||(i+=t)}),o.scrollLeft(i)},t.prototype.updateTheme=function(){var e=this.className+" "+("yne-code-theme-"+this.getBlock().getTheme());this._getContentContainer().attr("class",e)},t.prototype.renderAll=function(){var e=this.getBlock().code2html();this._getContentContainer().html('<div class="para-text"></div>'),this.getCodeLineContainer().html(e)},t.prototype.update=function(e){var t=this;for(var n=e.preRichText,o=e.newRichText,i=this.getBlock(),r=i.toCodeLines(n.toString()),a=i.toCodeLines(o.toString()),s=[],l=[];r.length>0&&a.length>0&&r[0]===a[0];)s.push(r[0]),r.shift(),a.shift();for(r.reverse(),a.reverse();r.length>0&&a.length>0&&r[0]===a[0];)l.push(r[0]),r.shift(),a.shift();var c=s.length,d=s.length;r.forEach(function(e,n){var o=c+1;t.get$CodeLine(o).remove()}),a.forEach(function(e,n){var o=i.codeLineToHtml(d+n+1);t.insertAfter(d+n,o)})},t.prototype.parseNativeRange=function(e,t,n){var o=function(e){for(var t=i(e);"PRE"!==t.prop("tagName")&&!(t=t.parent()).is(document.body););return 1+t.prevAll("pre").length},r=function(e,t){if(h(e)||h(e.parentElement))return 0;"drop-hint"===e.id&&(t=e.parentElement.innerText.length),e.nextSibling&&"drop-hint"===e.nextSibling.id&&(t=e.wholeText.length),e.previousSibling&&"drop-hint"===e.previousSibling.id&&(t=i(e.parentElement).text().length-e.wholeText.length);var n=e.parentElement;return i(n).prevAll().text().length+t},a=function(e){for(;;){if(/code-view/.test(e.className))return!0;if(/note-view/.test(e.className))return!1;e=e.parentElement}};if(this.isSelectedBlock)return new l({block:t,selectWholeBlock:!0});var s=e.commonAncestorContainer.className,c=e.startContainer.className,d=/para-text/;if(n||d.test(s)&&d.test(c))return l.createSelectToEndRange(t);if(/note-view/.test(s)){if(a(e.startContainer))return l.createSelectToEndRange(t,o(e.startContainer),r(e.startContainer,e.startOffset));if(a(e.endContainer)){var u=o(e.endContainer),p=r(e.endContainer,e.endOffset);return new l({block:t,startLineIndex:1,startLineCharIndex:0,endLineIndex:u,endLineCharIndex:p})}return l.createSelectToEndRange(t)}var g=r(e.startContainer,e.startOffset),f=r(e.endContainer,e.endOffset),m=o(e.startContainer),y=o(e.endContainer);return new l({block:t,startLineCharIndex:g,endLineCharIndex:f,startLineIndex:m,endLineIndex:y,selectWholeBlock:this.isSelectedBlock})},t.prototype.convertToNativeRange=function(e){var t=this,n=document.createRange();e.selectWholeBlock&&(this.drawSelectAllRange(!0),e=l.createBeginRange(e.block));var o=function(e){return t.get$CodeLine(e)},i=function(e,t){var n={node:null,offset:0};return e.children().each(function(){n.node||(h(this)?n.node=this:(t-=this.innerText.length)<=0&&(n.node=this.firstChild,n.offset=t+this.innerText.length))}),n},r=o(e.startLineIndex),a=o(e.endLineIndex),s=i(r,e.startLineCharIndex),c=i(a,e.endLineCharIndex);return n.setStart(s.node,s.offset),n.setEnd(c.node,c.offset),n},t.prototype.insertAfter=function(e,t){0===e?this.getCodeLineContainer().prepend(i(t)):this.get$CodeLine(e).after(t)},t.prototype.getCodeLineContainer=function(){return this._getContentContainer().find(".para-text")},t.prototype.get$CodeLine=function(e){return this.getCodeLineContainer().children("pre").eq(e-1)},t}(n);return delete p.prototype.constructor,p.prototype.className="block-view code-view",o.extend(p.prototype)}.apply(t,o))||(e.exports=i)},function(e,t,n){(function(t){var n="undefined"!=typeof window?window:"undefined"!=typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope?self:{},o=function(){var e=/\blang(?:uage)?-([\w-]+)\b/i,t=0,o=n.Prism={manual:n.Prism&&n.Prism.manual,disableWorkerMessageHandler:n.Prism&&n.Prism.disableWorkerMessageHandler,util:{encode:function(e){return e instanceof i?new i(e.type,o.util.encode(e.content),e.alias):"Array"===o.util.type(e)?e.map(o.util.encode):e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},objId:function(e){return e.__id||Object.defineProperty(e,"__id",{value:++t}),e.__id},clone:function(e,t){var n=o.util.type(e);switch(t=t||{},n){case"Object":if(t[o.util.objId(e)])return t[o.util.objId(e)];var i={};for(var r in t[o.util.objId(e)]=i,e)e.hasOwnProperty(r)&&(i[r]=o.util.clone(e[r],t));return i;case"Array":if(t[o.util.objId(e)])return t[o.util.objId(e)];i=[];return t[o.util.objId(e)]=i,e.forEach(function(e,n){i[n]=o.util.clone(e,t)}),i}return e}},languages:{extend:function(e,t){var n=o.util.clone(o.languages[e]);for(var i in t)n[i]=t[i];return n},insertBefore:function(e,t,n,i){var r=(i=i||o.languages)[e];if(2==arguments.length){for(var a in n=arguments[1])n.hasOwnProperty(a)&&(r[a]=n[a]);return r}var s={};for(var l in r)if(r.hasOwnProperty(l)){if(l==t)for(var a in n)n.hasOwnProperty(a)&&(s[a]=n[a]);s[l]=r[l]}var c=i[e];return i[e]=s,o.languages.DFS(o.languages,function(t,n){n===c&&t!=e&&(this[t]=s)}),s},DFS:function(e,t,n,i){for(var r in i=i||{},e)e.hasOwnProperty(r)&&(t.call(e,r,e[r],n||r),"Object"!==o.util.type(e[r])||i[o.util.objId(e[r])]?"Array"!==o.util.type(e[r])||i[o.util.objId(e[r])]||(i[o.util.objId(e[r])]=!0,o.languages.DFS(e[r],t,r,i)):(i[o.util.objId(e[r])]=!0,o.languages.DFS(e[r],t,null,i)))}},plugins:{},highlightAll:function(e,t){o.highlightAllUnder(document,e,t)},highlightAllUnder:function(e,t,n){var i={callback:n,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",i);for(var r,a=i.elements||e.querySelectorAll(i.selector),s=0;r=a[s++];)o.highlightElement(r,!0===t,i.callback)},highlightElement:function(t,i,r){for(var a,s,l=t;l&&!e.test(l.className);)l=l.parentNode;l&&(a=(l.className.match(e)||[,""])[1].toLowerCase(),s=o.languages[a]),t.className=t.className.replace(e,"").replace(/\s+/g," ")+" language-"+a,t.parentNode&&(l=t.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(e,"").replace(/\s+/g," ")+" language-"+a));var c={element:t,language:a,grammar:s,code:t.textContent};if(o.hooks.run("before-sanity-check",c),!c.code||!c.grammar)return c.code&&(o.hooks.run("before-highlight",c),c.element.textContent=c.code,o.hooks.run("after-highlight",c)),void o.hooks.run("complete",c);if(o.hooks.run("before-highlight",c),i&&n.Worker){var d=new Worker(o.filename);d.onmessage=function(e){c.highlightedCode=e.data,o.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,r&&r.call(c.element),o.hooks.run("after-highlight",c),o.hooks.run("complete",c)},d.postMessage(JSON.stringify({language:c.language,code:c.code,immediateClose:!0}))}else c.highlightedCode=o.highlight(c.code,c.grammar,c.language),o.hooks.run("before-insert",c),c.element.innerHTML=c.highlightedCode,r&&r.call(t),o.hooks.run("after-highlight",c),o.hooks.run("complete",c)},highlight:function(e,t,n){var r={code:e,grammar:t,language:n};return o.hooks.run("before-tokenize",r),r.tokens=o.tokenize(r.code,r.grammar),o.hooks.run("after-tokenize",r),i.stringify(o.util.encode(r.tokens),r.language)},matchGrammar:function(e,t,n,i,r,a,s){var l=o.Token;for(var c in n)if(n.hasOwnProperty(c)&&n[c]){if(c==s)return;var d=n[c];d="Array"===o.util.type(d)?d:[d];for(var u=0;u<d.length;++u){var h=d[u],p=h.inside,g=!!h.lookbehind,f=!!h.greedy,m=0,y=h.alias;if(f&&!h.pattern.global){var _=h.pattern.toString().match(/[imuy]*$/)[0];h.pattern=RegExp(h.pattern.source,_+"g")}h=h.pattern||h;for(var I=i,b=r;I<t.length;b+=t[I].length,++I){var v=t[I];if(t.length>e.length)return;if(!(v instanceof l)){if(f&&I!=t.length-1){if(h.lastIndex=b,!(N=h.exec(e)))break;for(var k=N.index+(g?N[1].length:0),C=N.index+N[0].length,w=I,A=b,S=t.length;S>w&&(C>A||!t[w].type&&!t[w-1].greedy);++w)k>=(A+=t[w].length)&&(++I,b=A);if(t[I]instanceof l)continue;T=w-I,v=e.slice(b,A),N.index-=b}else{h.lastIndex=0;var N=h.exec(v),T=1}if(N){g&&(m=N[1]?N[1].length:0);C=(k=N.index+m)+(N=N[0].slice(m)).length;var M=v.slice(0,k),x=v.slice(C),E=[I,T];M&&(++I,b+=M.length,E.push(M));var D=new l(c,p?o.tokenize(N,p):N,y,N,f);if(E.push(D),x&&E.push(x),Array.prototype.splice.apply(t,E),1!=T&&o.matchGrammar(e,t,n,I,b,!0,c),a)break}else if(a)break}}}}},tokenize:function(e,t){var n=[e],i=t.rest;if(i){for(var r in i)t[r]=i[r];delete t.rest}return o.matchGrammar(e,n,t,0,0,!1),n},hooks:{all:{},add:function(e,t){var n=o.hooks.all;n[e]=n[e]||[],n[e].push(t)},run:function(e,t){var n=o.hooks.all[e];if(n&&n.length)for(var i,r=0;i=n[r++];)i(t)}}},i=o.Token=function(e,t,n,o,i){this.type=e,this.content=t,this.alias=n,this.length=0|(o||"").length,this.greedy=!!i};if(i.stringify=function(e,t,n){if("string"==typeof e)return e;if("Array"===o.util.type(e))return e.map(function(n){return i.stringify(n,t,e)}).join("");var r={type:e.type,content:i.stringify(e.content,t,n),tag:"span",classes:["token",e.type],attributes:{},language:t,parent:n};if(e.alias){var a="Array"===o.util.type(e.alias)?e.alias:[e.alias];Array.prototype.push.apply(r.classes,a)}o.hooks.run("wrap",r);var s=Object.keys(r.attributes).map(function(e){return e+'="'+(r.attributes[e]||"").replace(/"/g,"&quot;")+'"'}).join(" ");return"<"+r.tag+' class="'+r.classes.join(" ")+'"'+(s?" "+s:"")+">"+r.content+"</"+r.tag+">"},!n.document)return n.addEventListener?(o.disableWorkerMessageHandler||n.addEventListener("message",function(e){var t=JSON.parse(e.data),i=t.language,r=t.code,a=t.immediateClose;n.postMessage(o.highlight(r,o.languages[i],i)),a&&n.close()},!1),n.Prism):n.Prism;var r=document.currentScript||[].slice.call(document.getElementsByTagName("script")).pop();return r&&(o.filename=r.src,o.manual||r.hasAttribute("data-manual")||("loading"!==document.readyState?window.requestAnimationFrame?window.requestAnimationFrame(o.highlightAll):window.setTimeout(o.highlightAll,16):document.addEventListener("DOMContentLoaded",o.highlightAll))),n.Prism}();e.exports&&(e.exports=o),void 0!==t&&(t.Prism=o),o.languages.markup={comment:/<!--[\s\S]*?-->/,prolog:/<\?[\s\S]+?\?>/,doctype:/<!DOCTYPE[\s\S]+?>/i,cdata:/<!\[CDATA\[[\s\S]*?]]>/i,tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s+[^\s>\/=]+(?:=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+))?)*\s*\/?>/i,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/i,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"attr-value":{pattern:/=(?:("|')(?:\\[\s\S]|(?!\1)[^\\])*\1|[^\s'">=]+)/i,inside:{punctuation:[/^=/,{pattern:/(^|[^\\])["']/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:/&#?[\da-z]{1,8};/i},o.languages.markup.tag.inside["attr-value"].inside.entity=o.languages.markup.entity,o.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),o.languages.xml=o.languages.markup,o.languages.html=o.languages.markup,o.languages.mathml=o.languages.markup,o.languages.svg=o.languages.markup,o.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:/@[\w-]+?.*?(?:;|(?=\s*\{))/i,inside:{rule:/@[\w-]+/}},url:/url\((?:(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|.*?)\)/i,selector:/[^{}\s][^{};]*?(?=\s*\{)/,string:{pattern:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},property:/[-_a-z\xA0-\uFFFF][-\w\xA0-\uFFFF]*(?=\s*:)/i,important:/\B!important\b/i,function:/[-a-z0-9]+(?=\()/i,punctuation:/[(){};:]/},o.languages.css.atrule.inside.rest=o.languages.css,o.languages.markup&&(o.languages.insertBefore("markup","tag",{style:{pattern:/(<style[\s\S]*?>)[\s\S]*?(?=<\/style>)/i,lookbehind:!0,inside:o.languages.css,alias:"language-css",greedy:!0}}),o.languages.insertBefore("inside","attr-value",{"style-attr":{pattern:/\s*style=("|')(?:\\[\s\S]|(?!\1)[^\\])*\1/i,inside:{"attr-name":{pattern:/^\s*style/i,inside:o.languages.markup.tag.inside},punctuation:/^\s*=\s*['"]|['"]\s*$/,"attr-value":{pattern:/.+/i,inside:o.languages.css}},alias:"language-css"}},o.languages.markup.tag)),o.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/((?:\b(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/,boolean:/\b(?:true|false)\b/,function:/\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/--?|\+\+?|!=?=?|<=?|>=?|==?=?|&&?|\|\|?|\?|\*|\/|~|\^|%/,punctuation:/[{}[\];(),.:]/},o.languages.javascript=o.languages.extend("clike",{"class-name":[o.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])[_$A-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\.(?:prototype|constructor))/,lookbehind:!0}],keyword:[{pattern:/((?:^|})\s*)(?:catch|finally)\b/,lookbehind:!0},/\b(?:as|async|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield)\b/],number:/\b(?:(?:0[xX][\dA-Fa-f]+|0[bB][01]+|0[oO][0-7]+)n?|\d+n|NaN|Infinity)\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee][+-]?\d+)?/,function:/[_$a-zA-Z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*\(|\.(?:apply|bind|call)\()/,operator:/-[-=]?|\+[+=]?|!=?=?|<<?=?|>>?>?=?|=(?:==?|>)?|&[&=]?|\|[|=]?|\*\*?=?|\/=?|~|\^=?|%=?|\?|\.{3}/}),o.languages.javascript["class-name"][0].pattern=/(\b(?:class|interface|extends|implements|instanceof|new)\s+)[\w.\\]+/,o.languages.insertBefore("javascript","keyword",{regex:{pattern:/((?:^|[^$\w\xA0-\uFFFF."'\])\s])\s*)\/(\[[^\]\r\n]+]|\\.|[^\/\\\[\r\n])+\/[gimyu]{0,5}(?=\s*($|[\r\n,.;})\]]))/,lookbehind:!0,greedy:!0},"function-variable":{pattern:/[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*(?=\s*[=:]\s*(?:function\b|(?:\([^()]*\)|[_$a-z\xA0-\uFFFF][$\w\xA0-\uFFFF]*)\s*=>))/i,alias:"function"},constant:/\b[A-Z][A-Z\d_]*\b/}),o.languages.insertBefore("javascript","string",{"template-string":{pattern:/`(?:\\[\s\S]|\${[^}]+}|[^\\`])*`/,greedy:!0,inside:{interpolation:{pattern:/\${[^}]+}/,inside:{"interpolation-punctuation":{pattern:/^\${|}$/,alias:"punctuation"},rest:o.languages.javascript}},string:/[\s\S]+/}}}),o.languages.markup&&o.languages.insertBefore("markup","tag",{script:{pattern:/(<script[\s\S]*?>)[\s\S]*?(?=<\/script>)/i,lookbehind:!0,inside:o.languages.javascript,alias:"language-javascript",greedy:!0}}),o.languages.js=o.languages.javascript,o.languages.c=o.languages.extend("clike",{keyword:/\b(?:_Alignas|_Alignof|_Atomic|_Bool|_Complex|_Generic|_Imaginary|_Noreturn|_Static_assert|_Thread_local|asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*\/%&|^!=<>]=?/,number:/(?:\b0x[\da-f]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?)[ful]*/i}),o.languages.insertBefore("c","string",{macro:{pattern:/(^\s*)#\s*[a-z]+(?:[^\r\n\\]|\\(?:\r\n|[\s\S]))*/im,lookbehind:!0,alias:"property",inside:{string:{pattern:/(#\s*include\s*)(?:<.+?>|("|')(?:\\?.)+?\2)/,lookbehind:!0},directive:{pattern:/(#\s*)\b(?:define|defined|elif|else|endif|error|ifdef|ifndef|if|import|include|line|pragma|undef|using)\b/,lookbehind:!0,alias:"keyword"}}},constant:/\b(?:__FILE__|__LINE__|__DATE__|__TIME__|__TIMESTAMP__|__func__|EOF|NULL|SEEK_CUR|SEEK_END|SEEK_SET|stdin|stdout|stderr)\b/}),delete o.languages.c["class-name"],delete o.languages.c.boolean,o.languages.csharp=o.languages.extend("clike",{keyword:/\b(?:abstract|add|alias|as|ascending|async|await|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|descending|do|double|dynamic|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|from|get|global|goto|group|if|implicit|in|int|interface|internal|into|is|join|let|lock|long|namespace|new|null|object|operator|orderby|out|override|params|partial|private|protected|public|readonly|ref|remove|return|sbyte|sealed|select|set|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|value|var|virtual|void|volatile|where|while|yield)\b/,string:[{pattern:/@("|')(?:\1\1|\\[\s\S]|(?!\1)[^\\])*\1/,greedy:!0},{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*?\1/,greedy:!0}],"class-name":[{pattern:/\b[A-Z]\w*(?:\.\w+)*\b(?=\s+\w+)/,inside:{punctuation:/\./}},{pattern:/(\[)[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}},{pattern:/(\b(?:class|interface)\s+[A-Z]\w*(?:\.\w+)*\s*:\s*)[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}},{pattern:/((?:\b(?:class|interface|new)\s+)|(?:catch\s+\())[A-Z]\w*(?:\.\w+)*\b/,lookbehind:!0,inside:{punctuation:/\./}}],number:/\b0x[\da-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)f?/i}),o.languages.insertBefore("csharp","class-name",{"generic-method":{pattern:/\w+\s*<[^>\r\n]+?>\s*(?=\()/,inside:{function:/^\w+/,"class-name":{pattern:/\b[A-Z]\w*(?:\.\w+)*\b/,inside:{punctuation:/\./}},keyword:o.languages.csharp.keyword,punctuation:/[<>(),.:]/}},preprocessor:{pattern:/(^\s*)#.*/m,lookbehind:!0,alias:"property",inside:{directive:{pattern:/(\s*#)\b(?:define|elif|else|endif|endregion|error|if|line|pragma|region|undef|warning)\b/,lookbehind:!0,alias:"keyword"}}}}),o.languages.dotnet=o.languages.csharp,function(e){var t={variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--?|-=|\+\+?|\+=|!=?|~|\*\*?|\*=|\/=?|%=?|<<=?|>>=?|<=?|>=?|==?|&&?|&=|\^=?|\|\|?|\|=|\?|:/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\([^)]+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},/\$(?:[\w#?*!@]+|\{[^}]+\})/i]};e.languages.bash={shebang:{pattern:/^#!\s*\/bin\/bash|^#!\s*\/bin\/sh/,alias:"important"},comment:{pattern:/(^|[^"{\\])#.*/,lookbehind:!0},string:[{pattern:/((?:^|[^<])<<\s*)["']?(\w+?)["']?\s*\r?\n(?:[\s\S])*?\r?\n\2/,lookbehind:!0,greedy:!0,inside:t},{pattern:/(["'])(?:\\[\s\S]|\$\([^)]+\)|`[^`]+`|(?!\1)[^\\])*\1/,greedy:!0,inside:t}],variable:t.variable,function:{pattern:/(^|[\s;|&])(?:alias|apropos|apt-get|aptitude|aspell|awk|basename|bash|bc|bg|builtin|bzip2|cal|cat|cd|cfdisk|chgrp|chmod|chown|chroot|chkconfig|cksum|clear|cmp|comm|command|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|du|egrep|eject|enable|env|ethtool|eval|exec|expand|expect|export|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|getopts|git|grep|groupadd|groupdel|groupmod|groups|gzip|hash|head|help|hg|history|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|jobs|join|kill|killall|less|link|ln|locate|logname|logout|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|make|man|mkdir|mkfifo|mkisofs|mknod|more|most|mount|mtools|mtr|mv|mmv|nano|netstat|nice|nl|nohup|notify-send|npm|nslookup|open|op|passwd|paste|pathchk|ping|pkill|popd|pr|printcap|printenv|printf|ps|pushd|pv|pwd|quota|quotacheck|quotactl|ram|rar|rcp|read|readarray|readonly|reboot|rename|renice|remsync|rev|rm|rmdir|rsync|screen|scp|sdiff|sed|seq|service|sftp|shift|shopt|shutdown|sleep|slocate|sort|source|split|ssh|stat|strace|su|sudo|sum|suspend|sync|tail|tar|tee|test|time|timeout|times|touch|top|traceroute|trap|tr|tsort|tty|type|ulimit|umask|umount|unalias|uname|unexpand|uniq|units|unrar|unshar|uptime|useradd|userdel|usermod|users|uuencode|uudecode|v|vdir|vi|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yes|zip)(?=$|[\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&])(?:let|:|\.|if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)(?=$|[\s;|&])/,lookbehind:!0},boolean:{pattern:/(^|[\s;|&])(?:true|false)(?=$|[\s;|&])/,lookbehind:!0},operator:/&&?|\|\|?|==?|!=?|<<<?|>>|<=?|>=?|=~/,punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];]/};var n=t.variable[1].inside;n.string=e.languages.bash.string,n.function=e.languages.bash.function,n.keyword=e.languages.bash.keyword,n.boolean=e.languages.bash.boolean,n.operator=e.languages.bash.operator,n.punctuation=e.languages.bash.punctuation,e.languages.shell=e.languages.bash}(o),o.languages.cpp=o.languages.extend("c",{keyword:/\b(?:alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|int8_t|int16_t|int32_t|int64_t|uint8_t|uint16_t|uint32_t|uint64_t|long|mutable|namespace|new|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/,boolean:/\b(?:true|false)\b/,operator:/>>=?|<<=?|->|([-+&|:])\1|[?:~]|[-+*\/%&|^!=<>]=?|\b(?:and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/}),o.languages.insertBefore("cpp","keyword",{"class-name":{pattern:/(class\s+)\w+/i,lookbehind:!0}}),o.languages.insertBefore("cpp","string",{"raw-string":{pattern:/R"([^()\\ ]{0,16})\([\s\S]*?\)\1"/,alias:"string",greedy:!0}}),function(e){e.languages.ruby=e.languages.extend("clike",{comment:[/#.*/,{pattern:/^=begin(?:\r?\n|\r)(?:.*(?:\r?\n|\r))*?=end/m,greedy:!0}],keyword:/\b(?:alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|protected|private|public|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/});var t={pattern:/#\{[^}]+\}/,inside:{delimiter:{pattern:/^#\{|\}$/,alias:"tag"},rest:e.languages.ruby}};e.languages.insertBefore("ruby","keyword",{regex:[{pattern:/%r([^a-zA-Z0-9\s{(\[<])(?:(?!\1)[^\\]|\\[\s\S])*\1[gim]{0,3}/,greedy:!0,inside:{interpolation:t}},{pattern:/%r\((?:[^()\\]|\\[\s\S])*\)[gim]{0,3}/,greedy:!0,inside:{interpolation:t}},{pattern:/%r\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}[gim]{0,3}/,greedy:!0,inside:{interpolation:t}},{pattern:/%r\[(?:[^\[\]\\]|\\[\s\S])*\][gim]{0,3}/,greedy:!0,inside:{interpolation:t}},{pattern:/%r<(?:[^<>\\]|\\[\s\S])*>[gim]{0,3}/,greedy:!0,inside:{interpolation:t}},{pattern:/(^|[^\/])\/(?!\/)(\[.+?]|\\.|[^\/\\\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/,lookbehind:!0,greedy:!0}],variable:/[@$]+[a-zA-Z_]\w*(?:[?!]|\b)/,symbol:{pattern:/(^|[^:]):[a-zA-Z_]\w*(?:[?!]|\b)/,lookbehind:!0}}),e.languages.insertBefore("ruby","number",{builtin:/\b(?:Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|Fixnum|Float|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z]\w*(?:[?!]|\b)/}),e.languages.ruby.string=[{pattern:/%[qQiIwWxs]?([^a-zA-Z0-9\s{(\[<])(?:(?!\1)[^\\]|\\[\s\S])*\1/,greedy:!0,inside:{interpolation:t}},{pattern:/%[qQiIwWxs]?\((?:[^()\\]|\\[\s\S])*\)/,greedy:!0,inside:{interpolation:t}},{pattern:/%[qQiIwWxs]?\{(?:[^#{}\\]|#(?:\{[^}]+\})?|\\[\s\S])*\}/,greedy:!0,inside:{interpolation:t}},{pattern:/%[qQiIwWxs]?\[(?:[^\[\]\\]|\\[\s\S])*\]/,greedy:!0,inside:{interpolation:t}},{pattern:/%[qQiIwWxs]?<(?:[^<>\\]|\\[\s\S])*>/,greedy:!0,inside:{interpolation:t}},{pattern:/("|')(?:#\{[^}]+\}|\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0,inside:{interpolation:t}}]}(o),o.languages["markup-templating"]={},Object.defineProperties(o.languages["markup-templating"],{buildPlaceholders:{value:function(e,t,n,i){e.language===t&&(e.tokenStack=[],e.code=e.code.replace(n,function(n){if("function"==typeof i&&!i(n))return n;for(var o=e.tokenStack.length;-1!==e.code.indexOf("___"+t.toUpperCase()+o+"___");)++o;return e.tokenStack[o]=n,"___"+t.toUpperCase()+o+"___"}),e.grammar=o.languages.markup)}},tokenizePlaceholders:{value:function(e,t){if(e.language===t&&e.tokenStack){e.grammar=o.languages[t];var n=0,i=Object.keys(e.tokenStack),r=function(a){if(!(n>=i.length))for(var s=0;s<a.length;s++){var l=a[s];if("string"==typeof l||l.content&&"string"==typeof l.content){var c=i[n],d=e.tokenStack[c],u="string"==typeof l?l:l.content,h=u.indexOf("___"+t.toUpperCase()+c+"___");if(h>-1){++n;var p,g=u.substring(0,h),f=new o.Token(t,o.tokenize(d,e.grammar,t),"language-"+t,d),m=u.substring(h+("___"+t.toUpperCase()+c+"___").length);if(g||m?(p=[g,f,m].filter(function(e){return!!e}),r(p)):p=f,"string"==typeof l?Array.prototype.splice.apply(a,[s,1].concat(p)):l.content=p,n>=i.length)break}}else l.content&&"string"!=typeof l.content&&r(l.content)}};r(e.tokens)}}}}),o.languages.go=o.languages.extend("clike",{keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,builtin:/\b(?:bool|byte|complex(?:64|128)|error|float(?:32|64)|rune|string|u?int(?:8|16|32|64)?|uintptr|append|cap|close|complex|copy|delete|imag|len|make|new|panic|print(?:ln)?|real|recover)\b/,boolean:/\b(?:_|iota|nil|true|false)\b/,operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,number:/(?:\b0x[a-f\d]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e[-+]?\d+)?)i?/i,string:{pattern:/(["'`])(\\[\s\S]|(?!\1)[^\\])*\1/,greedy:!0}}),delete o.languages.go["class-name"],o.languages.java=o.languages.extend("clike",{keyword:/\b(?:var|abstract|continue|for|new|switch|assert|default|goto|package|synchronized|boolean|do|if|private|this|break|double|implements|protected|throw|byte|else|import|public|throws|case|enum|instanceof|return|transient|catch|extends|int|short|try|char|final|interface|static|void|class|finally|long|strictfp|volatile|const|float|native|super|while)\b/,number:/\b0b[01]+\b|\b0x[\da-f]*\.?[\da-fp-]+\b|(?:\b\d+\.?\d*|\B\.\d+)(?:e[+-]?\d+)?[df]?/i,operator:{pattern:/(^|[^.])(?:<<=?|>>>?=?|->|([-+&|])\2|[?:~]|[-+*\/%&|^!=<>]=?)/m,lookbehind:!0}}),o.languages.insertBefore("java","function",{annotation:{alias:"punctuation",pattern:/(^|[^.])@\w+/,lookbehind:!0}}),o.languages.insertBefore("java","class-name",{generics:{pattern:/<\s*\w+(?:\.\w+)?(?:\s*,\s*\w+(?:\.\w+)?)*>/i,alias:"function",inside:{keyword:o.languages.java.keyword,punctuation:/[<>(),.:]/}}}),o.languages.json={property:/"(?:\\.|[^\\"\r\n])*"(?=\s*:)/i,string:{pattern:/"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,greedy:!0},number:/-?\d+\.?\d*([Ee][+-]?\d+)?/,punctuation:/[{}[\],]/,operator:/:/g,boolean:/\b(?:true|false)\b/i,null:/\bnull\b/i},o.languages.jsonp=o.languages.json,function(e){e.languages.kotlin=e.languages.extend("clike",{keyword:{pattern:/(^|[^.])\b(?:abstract|actual|annotation|as|break|by|catch|class|companion|const|constructor|continue|crossinline|data|do|dynamic|else|enum|expect|external|final|finally|for|fun|get|if|import|in|infix|init|inline|inner|interface|internal|is|lateinit|noinline|null|object|open|operator|out|override|package|private|protected|public|reified|return|sealed|set|super|suspend|tailrec|this|throw|to|try|typealias|val|var|vararg|when|where|while)\b/,lookbehind:!0},function:[/\w+(?=\s*\()/,{pattern:/(\.)\w+(?=\s*\{)/,lookbehind:!0}],number:/\b(?:0[xX][\da-fA-F]+(?:_[\da-fA-F]+)*|0[bB][01]+(?:_[01]+)*|\d+(?:_\d+)*(?:\.\d+(?:_\d+)*)?(?:[eE][+-]?\d+(?:_\d+)*)?[fFL]?)\b/,operator:/\+[+=]?|-[-=>]?|==?=?|!(?:!|==?)?|[\/*%<>]=?|[?:]:?|\.\.|&&|\|\||\b(?:and|inv|or|shl|shr|ushr|xor)\b/}),delete e.languages.kotlin["class-name"],e.languages.insertBefore("kotlin","string",{"raw-string":{pattern:/("""|''')[\s\S]*?\1/,alias:"string"}}),e.languages.insertBefore("kotlin","keyword",{annotation:{pattern:/\B@(?:\w+:)?(?:[A-Z]\w*|\[[^\]]+\])/,alias:"builtin"}}),e.languages.insertBefore("kotlin","function",{label:{pattern:/\w+@|@\w+/,alias:"symbol"}});var t=[{pattern:/\$\{[^}]+\}/,inside:{delimiter:{pattern:/^\$\{|\}$/,alias:"variable"},rest:e.languages.kotlin}},{pattern:/\$\w+/,alias:"variable"}];e.languages.kotlin.string.inside=e.languages.kotlin["raw-string"].inside={interpolation:t}}(o),o.languages.markdown=o.languages.extend("markup",{}),o.languages.insertBefore("markdown","prolog",{blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},code:[{pattern:/^(?: {4}|\t).+/m,alias:"keyword"},{pattern:/``.+?``|`[^`\n]+`/,alias:"keyword"}],title:[{pattern:/\w+.*(?:\r?\n|\r)(?:==+|--+)/,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#+.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:/(^|[^\\])(\*\*|__)(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^\*\*|^__|\*\*$|__$/}},italic:{pattern:/(^|[^\\])([*_])(?:(?:\r?\n|\r)(?!\r?\n|\r)|.)+?\2/,lookbehind:!0,inside:{punctuation:/^[*_]|[*_]$/}},url:{pattern:/!?\[[^\]]+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)| ?\[[^\]\n]*\])/,inside:{variable:{pattern:/(!?\[)[^\]]+(?=\]$)/,lookbehind:!0},string:{pattern:/"(?:\\.|[^"\\])*"(?=\)$)/}}}}),o.languages.markdown.bold.inside.url=o.languages.markdown.url,o.languages.markdown.italic.inside.url=o.languages.markdown.url,o.languages.markdown.bold.inside.italic=o.languages.markdown.italic,o.languages.markdown.italic.inside.bold=o.languages.markdown.bold,o.languages.matlab={comment:[/%\{[\s\S]*?\}%/,/%.+/],string:{pattern:/\B'(?:''|[^'\r\n])*'/,greedy:!0},number:/(?:\b\d+\.?\d*|\B\.\d+)(?:[eE][+-]?\d+)?(?:[ij])?|\b[ij]\b/,keyword:/\b(?:break|case|catch|continue|else|elseif|end|for|function|if|inf|NaN|otherwise|parfor|pause|pi|return|switch|try|while)\b/,function:/(?!\d)\w+(?=\s*\()/,operator:/\.?[*^\/\\']|[+\-:@]|[<>=~]=?|&&?|\|\|?/,punctuation:/\.{3}|[.,;\[\](){}!]/},o.languages.objectivec=o.languages.extend("c",{keyword:/\b(?:asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while|in|self|super)\b|(?:@interface|@end|@implementation|@protocol|@class|@public|@protected|@private|@property|@try|@catch|@finally|@throw|@synthesize|@dynamic|@selector)\b/,string:/("|')(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1|@"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"/,operator:/-[->]?|\+\+?|!=?|<<?=?|>>?=?|==?|&&?|\|\|?|[~^%?*\/@]/}),function(e){e.languages.php=e.languages.extend("clike",{keyword:/\b(?:and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|private|protected|parent|throw|null|echo|print|trait|namespace|final|yield|goto|instanceof|finally|try|catch)\b/i,constant:/\b[A-Z0-9_]{2,}\b/,comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|\/\/.*)/,lookbehind:!0}}),e.languages.insertBefore("php","string",{"shell-comment":{pattern:/(^|[^\\])#.*/,lookbehind:!0,alias:"comment"}}),e.languages.insertBefore("php","keyword",{delimiter:{pattern:/\?>|<\?(?:php|=)?/i,alias:"important"},variable:/\$+(?:\w+\b|(?={))/i,package:{pattern:/(\\|namespace\s+|use\s+)[\w\\]+/,lookbehind:!0,inside:{punctuation:/\\/}}}),e.languages.insertBefore("php","operator",{property:{pattern:/(->)[\w]+/,lookbehind:!0}});var t={pattern:/{\$(?:{(?:{[^{}]+}|[^{}]+)}|[^{}])+}|(^|[^\\{])\$+(?:\w+(?:\[.+?]|->\w+)*)/,lookbehind:!0,inside:{rest:e.languages.php}};e.languages.insertBefore("php","string",{"nowdoc-string":{pattern:/<<<'([^']+)'(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\1;/,greedy:!0,alias:"string",inside:{delimiter:{pattern:/^<<<'[^']+'|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<'?|[';]$/}}}},"heredoc-string":{pattern:/<<<(?:"([^"]+)"(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\1;|([a-z_]\w*)(?:\r\n?|\n)(?:.*(?:\r\n?|\n))*?\2;)/i,greedy:!0,alias:"string",inside:{delimiter:{pattern:/^<<<(?:"[^"]+"|[a-z_]\w*)|[a-z_]\w*;$/i,alias:"symbol",inside:{punctuation:/^<<<"?|[";]$/}},interpolation:t}},"single-quoted-string":{pattern:/'(?:\\[\s\S]|[^\\'])*'/,greedy:!0,alias:"string"},"double-quoted-string":{pattern:/"(?:\\[\s\S]|[^\\"])*"/,greedy:!0,alias:"string",inside:{interpolation:t}}}),delete e.languages.php.string,e.hooks.add("before-tokenize",function(t){if(/(?:<\?php|<\?)/gi.test(t.code)){e.languages["markup-templating"].buildPlaceholders(t,"php",/(?:<\?php|<\?)[\s\S]*?(?:\?>|$)/gi)}}),e.hooks.add("after-tokenize",function(t){e.languages["markup-templating"].tokenizePlaceholders(t,"php")})}(o),o.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:_INSERT|COL)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURNS?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:TRUE|FALSE|NULL)\b/i,number:/\b0x[\da-f]+\b|\b\d+\.?\d*|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|IN|LIKE|NOT|OR|IS|DIV|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/},o.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0},"triple-quoted-string":{pattern:/("""|''')[\s\S]+?\1/,greedy:!0,alias:"string"},string:{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},keyword:/\b(?:as|assert|async|await|break|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|nonlocal|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:True|False|None)\b/,number:/(?:\b(?=\d)|\B(?=\.))(?:0[bo])?(?:(?:\d|0x[\da-f])[\da-f]*\.?\d*|\.\d+)(?:e[+-]?\d+)?j?\b/i,operator:/[-+%=]=?|!=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]|\b(?:or|and|not)\b/,punctuation:/[{}[\];(),.:]/},o.languages.r={comment:/#.*/,string:{pattern:/(['"])(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0},"percent-operator":{pattern:/%[^%\s]*%/,alias:"operator"},boolean:/\b(?:TRUE|FALSE)\b/,ellipsis:/\.\.(?:\.|\d+)/,number:[/\b(?:NaN|Inf)\b/,/(?:\b0x[\dA-Fa-f]+(?:\.\d*)?|\b\d+\.?\d*|\B\.\d+)(?:[EePp][+-]?\d+)?[iL]?/],keyword:/\b(?:if|else|repeat|while|function|for|in|next|break|NULL|NA|NA_integer_|NA_real_|NA_complex_|NA_character_)\b/,operator:/->?>?|<(?:=|<?-)?|[>=!]=?|::?|&&?|\|\|?|[+*\/^$@~]/,punctuation:/[(){}\[\],;]/},o.languages.typescript=o.languages.extend("javascript",{keyword:/\b(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|var|void|while|with|yield|module|declare|constructor|namespace|abstract|require|type)\b/,builtin:/\b(?:string|Function|any|number|boolean|Array|symbol|console)\b/}),o.languages.ts=o.languages.typescript,o.languages.scala=o.languages.extend("java",{keyword:/<-|=>|\b(?:abstract|case|catch|class|def|do|else|extends|final|finally|for|forSome|if|implicit|import|lazy|match|new|null|object|override|package|private|protected|return|sealed|self|super|this|throw|trait|try|type|val|var|while|with|yield)\b/,string:[{pattern:/"""[\s\S]*?"""/,greedy:!0},{pattern:/("|')(?:\\.|(?!\1)[^\\\r\n])*\1/,greedy:!0}],builtin:/\b(?:String|Int|Long|Short|Byte|Boolean|Double|Float|Char|Any|AnyRef|AnyVal|Unit|Nothing)\b/,number:/\b0x[\da-f]*\.?[\da-f]+|(?:\b\d+\.?\d*|\B\.\d+)(?:e\d+)?[dfl]?/i,symbol:/'[^\d\s\\]\w*/}),delete o.languages.scala["class-name"],delete o.languages.scala.function,o.languages.swift=o.languages.extend("clike",{string:{pattern:/("|')(\\(?:\((?:[^()]|\([^)]+\))+\)|\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0,inside:{interpolation:{pattern:/\\\((?:[^()]|\([^)]+\))+\)/,inside:{delimiter:{pattern:/^\\\(|\)$/,alias:"variable"}}}}},keyword:/\b(?:as|associativity|break|case|catch|class|continue|convenience|default|defer|deinit|didSet|do|dynamic(?:Type)?|else|enum|extension|fallthrough|final|for|func|get|guard|if|import|in|infix|init|inout|internal|is|lazy|left|let|mutating|new|none|nonmutating|operator|optional|override|postfix|precedence|prefix|private|protocol|public|repeat|required|rethrows|return|right|safe|self|Self|set|static|struct|subscript|super|switch|throws?|try|Type|typealias|unowned|unsafe|var|weak|where|while|willSet|__(?:COLUMN__|FILE__|FUNCTION__|LINE__))\b/,number:/\b(?:[\d_]+(?:\.[\de_]+)?|0x[a-f0-9_]+(?:\.[a-f0-9p_]+)?|0b[01_]+|0o[0-7_]+)\b/i,constant:/\b(?:nil|[A-Z_]{2,}|k[A-Z][A-Za-z_]+)\b/,atrule:/@\b(?:IB(?:Outlet|Designable|Action|Inspectable)|class_protocol|exported|noreturn|NS(?:Copying|Managed)|objc|UIApplicationMain|auto_closure)\b/,builtin:/\b(?:[A-Z]\S+|abs|advance|alignof(?:Value)?|assert|contains|count(?:Elements)?|debugPrint(?:ln)?|distance|drop(?:First|Last)|dump|enumerate|equal|filter|find|first|getVaList|indices|isEmpty|join|last|lexicographicalCompare|map|max(?:Element)?|min(?:Element)?|numericCast|overlaps|partition|print(?:ln)?|reduce|reflect|reverse|sizeof(?:Value)?|sort(?:ed)?|split|startsWith|stride(?:of(?:Value)?)?|suffix|swap|toDebugString|toString|transcode|underestimateCount|unsafeBitCast|with(?:ExtendedLifetime|Unsafe(?:MutablePointers?|Pointers?)|VaList))\b/}),o.languages.swift.string.inside.interpolation.inside.rest=o.languages.swift}).call(this,n(60))},function(e,t,n){var o;void 0===(o=function(e){var t=n(59),o=n(167);return t.extend({className:"block-view unknown-view",initialize:function(){t.prototype.initialize.apply(this,arguments)},render:function(){this.$el.html("<div>当前版本不支持的内容</div>"),t.prototype.render.apply(this,arguments)},convertToNativeRange:function(){},parseNativeRange:function(e,t,n){if(n)return new o({block:t})}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(5),i=n(0),r=n(14);return t.View.extend({className:"highlight-view",_baseRect:null,_focusIndex:-1,_list:[],initialize:function(){i.bindAll(this,"_extractData","onHide","nextHighlight")},_extractData:function(e){var t=this,n=e.getClientRects(),a=[];i.each(n,function(e){e.width<2||a.push(o(r.render("common","high_light_item",{top:e.top-t._baseRect.top-1,left:e.left-t._baseRect.left-2,height:e.height-2,width:e.width})).appendTo(t.$el).get(0))}),t._list.push(o(a))},_reset:function(){this._list=[],this._focusIndex=-1,this.$el.empty()},showHighlight:function(e,t){return e&&t?0===t.length?(this._reset(),void this.onHide()):(this.$el.empty(),this.$el.show(),this._list=[],this._baseRect=this.el.getBoundingClientRect(),i.each(t,this._extractData),this._focusIndex=0,this._list[this._focusIndex].addClass("focused"),void this._list[this._focusIndex].get(0).scrollIntoViewIfNeeded()):(this._reset(),void this.onHide())},nextHighlight:function(e){0!==this._list.length&&(this.$el.show(),e=e||1,this._list[this._focusIndex].removeClass("focused"),this._focusIndex=(this._focusIndex+this._list.length+e)%this._list.length,this._list[this._focusIndex].addClass("focused"),this._list[this._focusIndex].get(0).scrollIntoViewIfNeeded())},preHighlight:function(){this.nextHighlight(-1)},onHide:function(){this.$el.hide()}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(14),i=n(5),r=n(0),a=n(1),s=n(137),l=n(228),c=i('<div class="collab-editing-view-wrapper"><div class="collab-session-view"></div></div>'),d="header-footer-view";function u(e){var t=null;do{r.contains(e.classList,d)&&(r.contains(e.classList,"page-header")?t="header":r.contains(e.classList,"page-footer")&&(t="footer")),e=e.parentElement}while(e);return t}return t.View.extend({className:d,name:"header-footer",_focus:!1,_isReadOnly:!1,$input:null,events:{"focus .header-footer-input":"_onFocus","blur .header-footer-input":"_onBlur","keydown .header-footer-input":"_onKeyDown","input .header-footer-input":"_onTextInput","paste .header-footer-input":"_onPaste"},initialize:function(e,t){e=e||{};this.block=e,this._contentOnFocus=null,this._keyMonitor=new s({el:this.el}),this.isFooter=!0===e.isFooter,this._isReadOnly=!!t,r.bindAll(this,"_onLockedChange","_updateViewByModel","_onPaste","_onHighlight"),e.on("high-light",this._onHighlight),e.on("locked-change",this._onLockedChange),e.on("change",this._updateViewByModel),this.render()},render:function(){var e,t=this.block,n=this.$el,i="page-"+(t.isFooter?"footer":"header"),r="点击编辑"+(t.isFooter?"页脚":"页眉");e=o.render("common",this.name,{readonly:this._isReadOnly}),n.html(e),n.addClass(i).attr("title",r),this.$input=n.find(".header-footer-input"),this._updateViewByModel(t.getContent(),t.getAlign()),this._updateLockState(this.isLocked())},_updateViewByModel:function(e,t){this._focus||void 0===e||this.setContent(e),void 0!==t&&this.setAlign(t)},_onHighlight:function(e,t,n){var o=this.block.getHighlight(e,t);o&&this._convertToData(o,n)},_convertToData:function(e,t){var n,o=this.$input.get(0).firstChild;r.each(e,function(e){(n=document.createRange()).setStart(o,e.start),n.setEnd(o,e.end),t(n)})},_onPaste:function(e){var t,n,o=e.originalEvent;e.preventDefault(),o.clipboardData&&o.clipboardData.getData?(n=(t=o.clipboardData.getData("text/plain"))&&t.replace(/\r?\n/g," "),document.execCommand("insertHTML",!1,n)):window.clipboardData&&window.clipboardData.getData&&(t=window.clipboardData.getData("Text"),l(t))},_onLockedChange:function(e){this._updateLockState(this.isLocked()),this._updateLockIndicator(this.block.isLocked(),e),this.trigger("locked-change")},isLocked:function(){var e=this.block,t=!1;return e&&(t=e.isLocked()),t},_updateLockIndicator:function(e,t){var n=c.clone(),o=n.find(".collab-session-view"),i=t&&t.lockColor,r=t&&t.nickname;e?(this.$el.addClass("collab-editing-view"),void 0!==r&&(o.css("background-color",i),o.text(r),this.$el.find(".collab-editing-view-wrapper").remove(),this.$el.prepend(n))):(this.$el.removeClass("collab-editing-view"),this.$el.find(".collab-editing-view-wrapper").remove())},_updateLockState:function(e){e?this.$el.addClass("collab-locked"):this.$el.removeClass("collab-locked")},_onTextInput:function(){this.trigger("text-input",this.$input.text())},_onFocus:function(){this._focus=!0,this._contentOnFocus=this.$input.text()||"",a.log("content on focus: "+this._contentOnFocus),this.trigger("focus")},_onBlur:function(){var e=this.$input.text();this._focus=!1,a.log("content on blur: "+e),e!==this._contentOnFocus&&this.trigger("text-change",e),this.trigger("blur"),this._contentOnFocus=null},_stopPropagation:function(e){e.stopPropagation()},_onKeyDown:function(e){var t=this._keyMonitor;t.isEventMatchKey(e,"enter")?(e.stopPropagation(),e.preventDefault(),this.$el.blur()):t.isEventMatchKey(e,"tab")?(e.stopPropagation(),e.preventDefault(),document.execCommand("insertHTML",!1,"&emsp;")):t.isEventMatchKey(e,"mod+z")||t.isEventMatchKey(e,"mod+y")?(e.stopPropagation(),e.preventDefault()):r.some(["mod+s","mod+shift+r","mod+f"],function(n){return t.isEventMatchKey(e,n)})?e.preventDefault():e.stopPropagation()},getAlign:function(){return this.$input.css("text-align")},setAlign:function(e){var t="left"===e||"right"===e?e:"center";this.$input.css("text-align",t)},setContent:function(e){this.$input.text(e)},getContent:function(){return this.$input.text()},checkChange:function(){var e=this.$input.text()||"";null!=this._contentOnFocus&&e!==this._contentOnFocus&&(this.trigger("text-change",e),this._contentOnFocus=e)}},{isHeaderView:function(e){return"header"===u(e)},isFooterView:function(e){return"footer"===u(e)}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(489),n(1),n(142)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.onPaste=function(e){var t,n,o=e.originalEvent.clipboardData;e.preventDefault(),this.isPasteAsText?this.trigger("yne-on-paste",!0,e):(n=o.getData("text/yne-json"),t=o.getData("text/yne-table-json"),!n&&t&&this.pasteYTableJson(t)||this.trigger("yne-on-paste",!1,e))},t.prototype.focusEditor=function(){var e=this.getNoteRange();o.log("focusEditor",e),this.isReadOnly()||(this.isValidNoteRange(e)||(e=this.defaultNoteRange()),this.noteSelection.setRange(e,null,null,!1))},t.prototype.getRangeData=function(t){var n,o=e.prototype.getRangeData.call(this,t),r=o["text/html"],a=this.note.getExtraInfo("pcResMap");return n=i(r,a),o["text/html"]=n,o},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(34),n(3),n(26),n(52),n(490),n(35),n(9),n(13),n(1),n(96),n(491),n(539),n(6),n(2),n(12),n(8),n(53),n(19),n(76),n(7),n(30),n(17),n(540),n(248),n(241),n(242),n(36),n(541)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k,C,w,A,S,N,T,M,x){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.addDragHint=function(e,t){var n,o,i=this.getRangeByPoint(e,t),r=this.noteView.parseNativeRange(i)[0];return this.getNoteRange()?(n=this.getNoteRange().getStartBlockRange())&&r?!(r.block===n.block&&r.start>=n.start&&r.start<n.end)&&(this.lastDragOver?o=this.lastDragSpace.parentNode.removeChild(this.lastDragSpace):((o=document.createElement("span")).id="drop-hint",this.lastDragOver={}),this.lastDragOver.x=e,this.lastDragOver.y=t,this.lastDragSpace=o,void i.insertNode(o)):(h.error("addDragHint:startRange and dragRange should not be null",n,r),!1):(h.error("addDragHint:Failed to get NoteRange"),!1)},t.prototype.canRemoveFormat=function(){var e=this.getNoteRange();return e&&!e.isCollapsed()},t.prototype.canUndo=function(){return this.cmdManager.canUndo()},t.prototype.canRedo=function(){return this.cmdManager.canRedo()},t.prototype.createCmd=function(e,t){return this._createCmd(e,t)},t.prototype.defaultNoteRange=function(){var e,t,n=this.note;if(n&&(e=n.getBlockAt(0)))return t=w.createRangeByBlock({allContent:!1,block:e,collapseToStart:!0}),new A({endRange:t,startRange:t})},t.prototype.execBackTab=function(){this.execCommand("comp.KeyTab",{inlineStyles:this.editingInlineStates,withShiftKey:!0})},t.prototype.execCommand=function(e,t){var o,r,a=this;if(r=(t=n.defaults(t||{},{collabProperties:a.editor.buildCollabProperties()})).collabProperties.isCollabCmd,!a.isReadOnly()||r)if(t.isOriginalCmd=!0,(o=a._createCmd(e,t))&&!o.cmdError){if(!i.isInlineStateSetCommand(o))return a.isCollabEnabled()?(o.isOriginalCmd=!0,r?a._executeCollabCmd(o,t):a._handleLocalCmdInCollabMode(o,t),t.collabProperties.dataCmdError&&h.error(t.collabProperties.dataCmdError),o):a._executeLocalCmd(o,t);n.each(t.inlineStyles,function(e,t){a.setEditingInlineState(t,e)})}else h.error("Failed to create/initialize command:"+e);else a.editor.notifyErrorToHost(m.INVALIDACTION_EDIT_READ_ONLY)},t.prototype.execCmdByShortCut=function(e,t){this.editor.execCommandByToolbar(e,t)},t.prototype.execDeleteBackward=function(e){var t,n;n=(t=(e=e||this.getNoteRange()).getStartBlockRange()).block,e?(y.isHeading(n)&&e.isCollapsed()&&t.isCollapsed()&&0===t.start?this.resetEditingInlineStates():n.isEmpty()||this._updateDeleteInlineStates(this.queryBackwardFirstInlineStyles(e)),this.execCommand("comp.KeyBackspace",{inlineStyles:this.editingInlineStates})):h.error("noteRange not found")},t.prototype.execDeleteForward=function(){var e=this.getNoteRange();e?(this._updateDeleteInlineStates(this.queryForwardFirstInlineStyles(e)),this.execCommand("comp.KeyDelete")):h.error("noteRange not found")},t.prototype.execDeleteToEnd=function(){var e,t=this.getNoteRange();if(t){if(!t.isCollapsed())return this._onDeleteSelection();e=t.clone(!0),t.getEndBlockRange().expandToEnd(),this.execDeleteBackward(e)}},t.prototype.execInsertDate=function(){var e,t=new Date,n=function(e){return o.pad(e,2,"0","left")};e=" "+t.getFullYear()+"/"+n(t.getMonth()+1)+"/"+n(t.getDate())+" "+n(t.getHours())+":"+n(t.getMinutes())+" ",this.insertText(e,!1)},t.prototype.execKeyHandler=function(e){this.keyHandlerManager.execWithName(e,this,{})},t.prototype.getDefaultFont=function(){return this.defaultFont},t.prototype.getEditingInlineState=function(e){var t=this.editingInlineStates||{};return e?t[e]:t},t.prototype.getNextCaretBlockRange=function(){var e,t,n,o=this.getNoteRange().getStartBlockRange().block;return y.isTextOrTableBlock(o)||(e=this._getNextCaretBlock(o))&&(t=w.createRangeByBlock({allContent:!1,block:e,collapseToStart:!0}),n=new A({endRange:t,startRange:t}),this.noteSelection.setRange(n)),n},t.prototype.getNoteRange=function(){var e=this.noteSelection.getRange();return e||(e=this.defaultNoteRange()),e},t.prototype.getRangeByPoint=function(e,t){var n,o;return n=document.caretRangeFromPoint(e,t),(o=document.createRange()).setStart(n.startContainer,n.startOffset),o},t.prototype.hasKeyHandler=function(e){return this.keyHandlerManager.hasHandler(e)},t.prototype.innerGoto=function(e){var t,n;if(t=document.getElementById(e),this.pageViewManager&&!t&&(this.pageViewManager.activePageByBlockId(e),t=document.getElementById(e)),!t)return h.warn("No find the block!");window.location.hash="#"+e,(n=document.createRange()).setStart(t.lastChild,1),n.setEnd(t.lastChild,1),s.setRange(n,window),window.location.hash=""},t.prototype.insertAttachment=function(e){var t,n=this.getNoteRange();if(!e||!e.src)return h.log("Error: attachment data is invald! "+e);switch(t=e.resource&&e.fileName?"attachment":"image",this.noteSelection.setRange(n),t){case"attachment":this.execCommand("comp.InsertAttachment",{fileLength:e.fileLength,fileName:e.fileName,resource:e.resource,src:e.src});break;case"image":this.insertImage(e.src)}},t.prototype.insertImage=function(e){var t=this.getNoteRange();e&&(this.noteSelection.setRange(t),this.execCommand("comp.InsertImage",{src:e}))},t.prototype.insertText=function(e,t){var o,i,r=v.getAllDefault();e instanceof I?o=e:(i=this.editingInlineStates,o=new I({text:e}),n.isEqual(r,i)||o.setStyles(0,o.getLength(),i)),this.execCommand("comp.KeyTextInput",{recogLink:t,text:o})},t.prototype.isDragProhibited=function(){return this.dragProhibited},t.prototype.isCopyProhibited=function(){return this.isCopyProhibited},t.prototype.isCollabEnabled=function(){return null!=this.editor&&this.editor.isCollabEnabled&&this.editor.isCollabEnabled()},t.prototype.isReadOnly=function(){return this.readOnly},t.prototype.isSameList=function(e){var t=this.note,n=this.getNoteRange();return!!n&&t.isSameList(n,e)},t.prototype.isValidNoteRange=function(e){var t=this,n=function(e){var n;return!(!e||!e.block)&&(n=e.block,t.note.getBlockIndex(n)>-1)};return!!e&&(t.isValidHeaderFooterRange(e)||n(e.getStartBlockRange())&&n(e.getEndBlockRange()))},t.prototype.isValidHeaderFooterRange=function(e){var t=this.note,o=e.getStartBlockRange(),i=e.getEndBlockRange();return n.all([o,i],function(e){if(!e||!e.block)return!1;var n=e.block;return t.getHeaderFooter(!0)===n||t.getHeaderFooter(!1)===n})},t.prototype.moveCaretWithDirection=function(e,t){this._onMoveCaretWithDirection(e,t)},t.prototype.lockBlockById=function(e){this.isCollabEnabled()&&this._sendBlockLockInfo(e)},t.prototype.onCommand=function(e,t){this.execCommand(e,t)},t.prototype.onUpdateSelection=function(e,t,n){var o;n&&n.inlineStyles&&(o=n.inlineStyles),this.noteSelection.setRange(e,N.createCommandTypeEvent(t),o)},t.prototype.onPaste=function(e){var t,n,o,i,r,a,s;if(e.preventDefault(),d.IS_MAC)this._pasteForMac();else{if(t=new T({event:e}),this.isPasteAsText)return s=t.getData("text/plain"),void this._pastePlain(s,this.isPasteAsText);n=t.getData("text/yne-json"),o=t.getData("text/yne-image-json"),r=t.getData("text/yne-note-id"),n&&this._pasteJSON(n,o,r)||(i=t.getData("text/yne-table-json"))&&this.pasteYTableJson(i)||((a=t.getData("text/html"))&&this._pasteHTML(a)?h.log("paste html ok"):(s=t.getData("text/plain"))?this._pastePlain(s,this.isPasteAsText):this._pasteBlobImg(e))}},t.prototype.pasteForTable=function(e){var t,n=this.getNoteRange(),o=n.getStartBlockRange(),i=n.getEndBlockRange(),r=o.block,a=i.block,s=this.noteView;return!(!y.isTable(r)||r.getId()!==a.getId())&&(!(!(t=s.getBlockViewByBlock(r))||!t.pasteBlockList)&&t.pasteBlockList(e))},t.prototype.queryBackwardFirstInlineStyles=function(e,t){var n,o,i,r,a,s=v.getAllDefault();if(e=e||this.getNoteRange()){if(o=(n=e.getStartBlockRange()).block,y.isTextBlock(o))return o.isEmptyContent()?o.getInlineStylesForEmpty()||t||this.getDefaultFont()||s:(r=n.start,a=o.getLength(),(e.isCollapsed()||r>=a)&&(r=r>0?r-1:0),i=o.getTextStylesAtIndex(r),this._omitLinkStylesIfNeeded(i,e))}else h.warn("noteRange is null")},t.prototype.queryForwardFirstInlineStyles=function(e){var t,n,o,i,r;if(e=e||this.getNoteRange()){if(n=(t=e.getEndBlockRange()).block,y.isTextBlock(n))return n.isEmptyContent()?n.getInlineStylesForEmpty()||v.getAllDefault():(i=t.end,r=n.getLength(),(!e.isCollapsed()||i>=r)&&(i=i>0?i-1:0),o=n.getTextStylesAtIndex(i),this._omitLinkStylesIfNeeded(o,e))}else h.error("noteRange is null")},t.prototype.querySelectionCodeInfo=function(e){if(e=e||this.getNoteRange()){var t=e.getStartBlockRange().block;return{"code-theme":t.getTheme(),"code-language":t.getLanguage()}}h.warn("noteRange not found")},t.prototype.querySelectionInlineStyle=function(e,t){var n=this.note;if(t=t||this.getNoteRange())return n.getCommonInlineStyle(t,e);h.warn("noteRange not found")},t.prototype.querySelectionBlockStyle=function(e,t){var n=this.note;if(t=t||this.getNoteRange())return n.getRangeBlockStyle(t,e);h.warn("noteRange not found")},t.prototype.querySelectionInlineStyles=function(e){var t,o,i,r,a=this,s={},l=v.getStyleNames();if(e=e||a.getNoteRange())return t=e.getStartBlockRange(),e.isSingleTableSelected()&&t.isOnCellEdit()&&(o=t.block,i=a.noteView.getBlockViewByBlock(o))?(r=i.getCellEditView(),s=r.queryInlineStylesForBulb()):(n.each(l,function(t){s[t]=a.querySelectionInlineStyle(t,e)}),s);h.warn("noteRange not found")},t.prototype.querySelectionBlockStyles=function(e){var t,o,i=this,r={};if(e=e||i.getNoteRange())return t=b.getAllStyleNames(),o=k.getAllStyleNames(),t=t.concat(o),n.each(t,function(t){r[t]=i.querySelectionBlockStyle(t,e)}),r;h.warn("noteRange not found")},t.prototype.redo=function(){var e=this.cmdManager;if(!this.isCollabEnabled())return e.redo();var t={collabProperties:{coreEditor:this.editor,isCollabRedo:!0}};return this._redoUndoLocalCmdInCollabMode(t)},t.prototype.removeDragHint=function(){this.lastDragSpace&&this.lastDragSpace.parentNode&&this.lastDragSpace.parentNode.removeChild(this.lastDragSpace),this.lastDragOver=this.lastDragSpace=null},t.prototype.removeShortCut=function(e){var t=this.keyHandlerManager;t&&t.unbind(e)},t.prototype.reset=function(){this.cmdManager&&this.cmdManager.reset(),this.noteSelection&&this.noteSelection.reset(),this.resetEditingInlineStates(),this.defaultFont=null,this.readOnly=!1},t.prototype.resetEditingInlineStates=function(){var e=v.getAllDefault();this.setEditingInlineStates(null),this.trigger("yne-editing-state-change",e)},t.prototype.setEditingInlineStyles=function(e){this.setEditingInlineStates(e),e||(e=v.getAllDefault()),this.trigger("yne-editing-state-change",e)},t.prototype.resizeSpecialBlock=function(){var e=this.note;n.each(e.blocks,function(e){(y.isTable(e)||y.isImage(e))&&e.trigger("view-resize")})},t.prototype.selectAll=function(){return this.noteView.onSelectAll()},t.prototype.setDefaultFont=function(e,t){this.defaultFont=this.defaultFont||{},e&&(this.defaultFont["font-family"]=e,this.setEditingInlineState("font-family",e)),t&&(this.defaultFont["font-size"]=t,this.setEditingInlineState("font-size",t))},t.prototype.setEditingInlineState=function(e,t){var n={};this.isReadOnly()||(this.editingInlineStates||(this.editingInlineStates={}),this.editingInlineStates[e]=t,n[e]=t,this.trigger("yne-editing-state-change",n),this.isLinkStylesChanged=this._isLinkStyles(e))},t.prototype.setEditingInlineStates=function(e){this.editingInlineStates=e,this.isLinkStylesChanged=!1},t.prototype.setOptions=function(e){var t;this.reset(),this.readOnly=e.isReadOnly,t=this.note=e.note,c.bubble(["color-picker-show","yne-user-action-collection"],t,this,!0),c.addListeners({"get-block-view":"_onGetBlockView","get-default-set-font":"_onGetDefaultSetFont"},t,this,!0)},t.prototype.setPasteAsText=function(e){this.isPasteAsText=e},t.prototype.setEntity=function(e,t){this.note.setEntityCache(e),this.note.setEntity(e,t)},t.prototype.setDragProhibited=function(e){e=!!e,this.dragProhibited=e,this.note.setDragProhibited(e)},t.prototype.setCopyProhibited=function(e){e=!!e,this.note.setCopyProhibited(e)},t.prototype.setReadOnly=function(e){var t=this;e=!!e,t.isReadOnly()!==e&&(t.readOnly=e,n.each(["note"],function(n){var o=t[n];o&&o.setReadOnly&&o.setReadOnly(e)}))},t.prototype.toggleInlineStyle=function(e){var t,n=this.getNoteRange(),o={};n?(t=n.isCollapsed()?!this.editingInlineStates[e]:!0!==(t=this.querySelectionInlineStyle(e)),o[e]=t,this.execCommand("comp.ApplyStyles",{inlineStyles:o})):h.warn("noteRange not found")},t.prototype.undo=function(){var e=this.cmdManager;if(!this.isCollabEnabled())return e.undo();var t={collabProperties:{coreEditor:this.editor,isCollabUndo:!0}};return this._redoUndoLocalCmdInCollabMode(t)},t.prototype.updateShortCut=function(e,t){var n=this.keyHandlerManager;n&&n.updateKey(e,t)},t.prototype.zoomInEditor=function(){this.editor.setZoomPercent(1)},t.prototype.zoomOutEditor=function(){this.editor.setZoomPercent(-1)},t.prototype.zoomEditor=function(){this.editor.zoomEditor(1,!0)},t.prototype.getRangeData=function(e){var t=this.note,n={"text/yne-json":e.getDataAsJSON(t),"text/html":'<meta charset="utf-8">'+e.getDataAsHtml(t),"text/plain":e.getDataAsPlain(t),"text/yne-note-id":t.getNoteId()},o=this._getImgDomInRange(e);return n["text/yne-image-json"]=this._getImageDataAsJson(o),this._addYneTableData(t,e,n),n},t.prototype.initialize=function(e){var t=e.noteView;this.cmdManager=new f(e),this.cmdFactory=new g(e),this.removeLocalImg=e.removeLocalImg||!1,this.setOptions(e),this.noteView=t,this.noteSelection=new S({noteView:this.noteView}),this._initKeyHandlerManager(e.keyHandlerNames),this.editor=e.editor,this.imgTitleInput=e.imgTitleInput,this._bindEvents()},t.prototype.pasteYTableJson=function(e){if(n.isString(e))try{e=JSON.parse(e)}catch(e){return void h.error("parse ytable json  string error")}return this._pasteJSON([{blockType:y.TABLE,data:e}])},t.prototype._addYneTableData=function(e,t,n){if(t.isSingleTableSelected()){var o=t.getStartBlockRange().getDataAsJSON(!0);o&&(n["text/yne-table-json"]=JSON.stringify(o))}},t.prototype._bindEvents=function(){var e=this,t=e.cmdManager,n=e.noteView;c.addListeners({"update-selection":"onUpdateSelection","command-exec":"_onCommandExec"},t,e),c.bubble(["redo-stack-change","undo-stack-change"],t,e),c.addListeners({"selection-change":"_onSelectionChange"},e.noteSelection,e),c.bubble({contextmenu:!0,selectstart:!0,"mouse-down":!0,"yne-replace-image":!0,"yne-replace-attachment":!0,"yne-download-image":!0,"yne-preview-image":!0,"yne-download-attachment":!0,"yne-get-entity":!0,"yne-request-image-rendered-src":!0,"yne-mac-preview":!0,"yne-open-image":!0,"yne-open-attachment":!0,"yne-on-paste":!0,"yne-blob-paste":!0,"open-link":"yne-open-link","cell-edit-view-exit":!0,"cell-edit-view-history-change":!0,"yne-image-ocr":!0},n,e),c.bubble(["link-menu-hide","locked-change"],n,e.editor.linkView),c.addListeners({"delete-selection":"_onDeleteSelection","text-input":"_onTextInput","key-pressed":"_onKey",command:"onCommand",copy:"_onCopy",cut:"_onCut",paste:"onPaste",dragstart:"_onDragStart",dragover:"_onDragOver",drop:"_onDrop",dragend:"_onDragEnd","note-append-blankparagraph":"_onAppendBlankParagraph",onCompositionStart:"_onCompositionStart","inner-goto":"innerGoto","header-footer-view-text-change":"_onHeaderFooterViewTextChange","backup-drag-range":"_onBackupDragRange","get-note-range":"_onGetNoteRange","move-caret":"_onMoveCaretWithDirection","global-redo":"redo","global-undo":"undo","cell-edit-view-enter":"_onEnterTableEdit","cell-edit-view-selection-change":"_onCellEditViewSelectionChange","cell-edit-view-command-executed":"_onCellEditViewSelectionChange","save-content":"_onSaveContent"},n,e),n.on("get-editing-styles",function(t){t(e.editingInlineStates)}),n.on("get-entity",e._getEntity),n.on("request-rendered-imagSrc",e._requestImagSrc),e.editor&&e.editor.onDocSelectionChange&&e.noteSelection.on("doc-change-selection",e.editor.onDocSelectionChange,e.editor),n.on("yne-click",function(){e.editor.recoverFromIdleTimeout(),e.trigger("yne-click")}),n.on("link-menu-show",function(t){e.editor.linkView.trigger("link-menu-show",t)}),n.on("get-image-items",e._getImgItems),e.imgTitleInput&&c.bubble(["img-title-edit-start","img-title-edit-end","img-title-edit-focus","img-title-edit-exit","img-title-edit-update","locked-change"],n,e.imgTitleInput)},t.prototype._createCmd=function(e,t){var n=this.cmdFactory;return t.range||i.isCollabCommand(t)||(t.range=this.getNoteRange()||A.createMock()),n.create(e,this.note,t)},t.prototype._executeCollabCmd=function(e,t){var n=this.getNoteRange();!1===this.cmdManager.exec(e,n,t)&&t.collabProperties.isOwnCmd&&this.editor.notifyErrorToHost(m.INVALIDACTION_FAILED_COLLABCMD)},t.prototype._executeLocalCmd=function(e,t){var n;if(!e||!1!==e.isReadyToApply)return n=this.getNoteRange(),this.cmdManager.exec(e,n,t)},t.prototype._getImgDomInRange=function(e){var t,o,i,r,a=this.note,s=this.noteView,l=e.getStartBlockRange(),c=e.getEndBlockRange(),d=a.getBlockIndex(l.block),u=a.getBlockIndex(c.block),h={};for(t=d;t<=u;t++)o=null,i=a.getBlockAt(t),y.isImage(i)&&(r=s.blockViews[t].getImgElement(),h[i.getId()]={img:r,source:i.getSource()}),y.isTable(i)&&(t===d&&(o=l),t===u&&(o=c),n.extend(h,s.blockViews[t].getImageDomMapByTableRange({selectAll:!o,tableRange:o})));return h},t.prototype._getImageDataAsJson=function(e){var t=l.getBase64Data(e);return JSON.stringify(t)},t.prototype._getNextCaretBlock=function(e){for(var t=this.note.getNextBlock(e);t&&(!this._isCaretBlock(t)||t.isLocked());)t=this.note.getNextBlock(t);return t},t.prototype._getImgItems=function(e){var t=this.note.blocks,o=[],i=0;n.each(t,function(t){if(t&&y.isImage(t)){var n=t.getSource().replace(location.protocol+"//"+location.hostname,"");e===t&&(i=o.length),o.push({index:o.length,name:t.getTitle(),preSrc:n,src:n})}}),this.trigger("yne-preview-image",[i,o])},t.prototype._getEntity=function(e,t){var n;if(this.note.entityExistInCache(t)){if((n=this.note.getBlockById(e))&&n instanceof _){var o=this.note.getEntityCache(t);n.setEntity(o)}}else this.trigger("yne-get-entity",t,e)},t.prototype._requestImagSrc=function(e,t){var n=this.note.getNoteId();this.trigger("yne-request-image-rendered-src",n,e,t)},t.prototype._getPreCaretBlock=function(e){for(var t=this.note.getPreBlock(e);t&&(!this._isCaretBlock(t)||t.isLocked());)t=this.note.getPreBlock(t);return t},t.prototype._getUploadData=function(e,t,o){var i,r=0,a=[],s={},c={};if(!(n.isEmpty(e)||n.isEmpty(t)&&n.isEmpty(o)))return i=l.setBlockIds(o,e),n.each(e,function(e,t){e.base64&&(a.push({id:r,url:t,blob:l.base64ToBlob(e.base64),isGroup:d.isFromWebGroup(t)}),s[r]=e.imgBlockIds,r++)}),n.each(t,function(e){var t=e.getSource(),o=t+"_"+e.getResource(),i=e.getId();n.isUndefined(c[o])?(c[o]=r,s[r]=[i],a.push({id:r,source:t,resource:e.getResource(),isGroup:d.isFromWebGroup(t)}),r++):s[c[o]].push(i)}),{data:a,map:s,replaceImgList:i}},t.prototype._handleLocalCmdInCollabMode=function(e,t){var n,o,i,r=!0;n=this.getNoteRange(),e.setCmdOriginalNoteVersion(this.note.getFileVersion()),this.editor.isValidLocalDataCmd(e)?(o=this.noteView.isOnComposition&&"comp.KeyBackspace"===e.name,i=e.isSingleBlockAffected()&&this.editor.isMyOwnLockedBlock(t.range)&&this.editor.isLastOwnDataCmdExecuted(),o||i?!1===this.cmdManager.exec(e,n,t)?(r=!1,this.editor.notifyErrorToHost(m.INVALIDACTION_FAILED_LOCALCMD)):e.effected?e.isLocalExecutedCmd=!0:r=!1:e.isLocalExecutedCmd=!1,r?this.editor.pushLocalDataCommand(e,o):h.warn("NotReadyToSend:",e)):h.warn("skip invalid local command")},t.prototype._initKeyHandlerManager=function(e){var t=this,o=t.keyHandlerManager=new C({});o.on("bind-key",function(e){var n=t.noteView;n&&n.bindKey(e)}),o.on("unbind-key",function(e){var n=t.noteView;n&&n.unbindKey(e)}),e=e||o.getAvailableHandlerNames(),n.each(e,function(e){o.bind(e)})},t.prototype._isCaretBlock=function(e){return y.isTextBlock(e)||y.isImage(e)||y.isAttachment(e)||y.isTable(e)},t.prototype._isLinkStyles=function(e){return n.contains(["color","underline"],e)},t.prototype._isPartlyOverlapWithAnchor=function(e){var t,n,o,i,r,a,s;return!(!e||!e.isInSingleBlock())&&((n=(t=e.getStartBlockRange()).block)instanceof _&&((o=t.start)===(i=t.end)?(o>0&&(a=n.getTextStyle("href",o-1,o)[0]),o<n.getLength()&&(s=n.getTextStyle("href",o,o+1)[0]),(a||s)&&a!==s):(r=n.getCommonInlineStyle("href",{end:i,start:o}))&&r===m.INTERM))},t.prototype._onMoveCaretWithDirection=function(e,t){var n,o,i,r,a,s;(n=this.getNoteRange())?n.canDrawedByNative()?h.log("The noteRange can be drawed by native selection!"):(o=n.getStartBlockRange().block,(y.isImage(o)||y.isAttachment(o)||y.isTable(o)||y.isHr(o)||y.isUnknown(o)||y.isHandWrite(o))&&(e?(i=this._getNextCaretBlock(o),r=!0):(i=this._getPreCaretBlock(o),r=!1),i?(a=w.createRangeByBlock({allContent:!1,block:i,collapseToStart:r}),s=new A({endRange:a,startRange:a}),this.noteSelection.setRange(s),t&&t.preventDefault()):e&&this.noteView.focusLastBlankLine())):h.log("The noteRange is null!")},t.prototype._notifyEditingStatesChange=function(){var e,t,o,i=this,r=i.getNoteRange(),a=i.editingInlineStates||{},s=!1;!i.isReadOnly()&&r&&(e=r.getStartBlockRange(),r.isInSingleBlock()&&y.isTextBlock(e.block)&&e.block.getLength()<e.start&&(s=!0),(s||a&&r.isCollapsed())&&(!r.isSingleTableSelected()||e.getAsRectRange())||(a=i.querySelectionInlineStyles(r)||{}),o=n.clone(a),(t=r.clone(!0)).collapse(!0),n.each(["font-family","font-size"],function(e){var n;a[e]===m.INTERM&&(n=i.querySelectionInlineStyle(e,t),a[e]=n)}),y.isCode(e.block)&&Object.assign(a,i.querySelectionCodeInfo(r)),a.heading=null,i.trigger("yne-editing-state-change",a,o))},t.prototype._onAppendBlankParagraph=function(){this.execCommand("comp.AppendBlank",{inlineStyles:this.editingInlineStates})},t.prototype._onCellEditViewSelectionChange=function(){var e,t=this.getNoteRange().getStartBlockRange().block,n=this.noteView.getBlockViewByBlock(t);n&&(e=n.getCellEditView().queryInlineStylesForBulb(),this.trigger("yne-editing-state-change",e))},t.prototype._onCommandExec=function(e,t){this.trigger("command-exec",e,t)},t.prototype._onCompositionStart=function(e){var t,o,i=this,r=i.getNoteRange(),a=[],s=!1;if(r){if(i.isCollabEnabled()){if(o=i.note.getInterBlocks(r.getStartBlockRange().block,r.getEndBlockRange().block,!0),n.each(o,function(e){var t=i.noteView.getBlockViewByBlock(e);a.push(t),t.isCollabLocked()&&(s=!0)}),e(s,a),s)return;(t=r.getStartBlockRange())&&r.isInSingleBlock()&&y.isTextBlock(t.block)&&!i.editor.isMyOwnLockedBlock(t)&&(i.editor.sendCachedDataCommand(),i._sendBlockLockInfo(t.block.getId()))}}else h.error("_onCompositionStart:noteRange should not be null")},t.prototype._omitLinkStylesIfNeeded=function(e,t){return e&&e.href&&this._isPartlyOverlapWithAnchor(t)&&(e.href=void 0,this.isLinkStylesChanged||(e.color="#393939",e.underline=!1)),e},t.prototype._onCut=function(e){var t=this.getNoteRange();e.preventDefault(),h.log("on cut!"),this._setClipboardByRange(t,e),!t||t.isCollapsed()||t.isSingleTableSelected()||this.execCommand("comp.DeleteNoteRange",{range:t})},t.prototype._onCopy=function(e){var t=this.getNoteRange();h.DEBUG&&(h.profile("on-copy"),h.time("on-copy")),e.preventDefault(),h.log("on copy!"),this._setClipboardByRange(t,e),h.DEBUG&&(h.timeEnd("on-copy"),h.profileEnd("on-copy"))},t.prototype._onDeleteSelection=function(){var e=this.getNoteRange();e&&!e.isCollapsed()&&this.execDeleteBackward(e)},t.prototype._onGetDefaultSetFont=function(e){e(this.getDefaultFont())},t.prototype._onKey=function(e,t){var n=this.noteView,o=this.keyHandlerManager;n&&(n.directionKeyJustMoved=!1),o.execWithKey(e,this,t)},t.prototype._onBackupDragRange=function(){var e=this.getNoteRange();e&&!e.isCollapsed()&&(this.dragTextRange=e)},t.prototype._onDragStart=function(e,t){var n,o,i,r=this.getNoteRange().getStartBlockRange();n=y.isTextBlock(t,r)?this.dragTextRange:this.getNoteRange(),this.startNoteRange=n,n&&!n.isCollapsed()?(i=new M({event:e}),o={"text/html":n.getDataAsHtml(this.note),"text/plain":n.getDataAsPlain(this.note),"text/yne-json":n.getDataAsJSON(this.note)},i.setDataMap(o),i.clearData("text/uri-list"),i.setProperty("effectAllowed","move")):h.log("no note range or note range is collapsed!")},t.prototype._onDragOver=function(e,t){var o=e.clientX,i=e.clientY,r=e.dataTransfer.types;if(!n.contains(r,"text/yne-json"))return n.contains(r,"Files")&&(e.preventDefault(),e.stopPropagation()),!0;if(e.preventDefault(),e.stopPropagation(),!this.lastDragOver||this.lastDragOver.x!==o||this.lastDragOver.y!==i){if(!y.isTextBlock(t)&&!y.isListItem(t))return e.dataTransfer.dropEffect="none",void this.removeDragHint();e.dataTransfer.dropEffect="move",!1===this.addDragHint(o,i)&&(e.dataTransfer.dropEffect="none")}},t.prototype._onDrop=function(e){var t,o,r,a,s,l=e.dataTransfer,c=l.types,u=this.noteView;e.preventDefault(),e.stopPropagation(),s=u.getBlock(e.target),(d.IS_MAC||x.isSafari())&&s&&y.isTable(s)?((r=document.createRange()).setStart(e.target,0),r.collapse()):r=this.getRangeByPoint(e.clientX,e.clientY),n.contains(c,"text/yne-json")&&(t=l.getData("text/yne-json"),o=p.parseJSON(t),n.map(o,function(e){e.setId(i.newGUID())}),(a=u.parseNativeRange(r)[0])&&a.isCollapsed()&&u.trigger("command","comp.DragBlocks",{blocks:o,dropRange:a,range:this.startNoteRange})),n.contains(c,"Files")&&this.noteSelection.setRange(r),this.removeDragHint()},t.prototype._onDragEnd=function(){this.removeDragHint()},t.prototype._onHeaderFooterViewTextChange=function(e,t){this.onCommand("comp.SetHeaderFooter",{content:e,headerFooter:t,range:A.createForHeaderFooter(t)})},t.prototype._onGetNoteRange=function(e){e(this.getNoteRange())},t.prototype._onGetBlockView=function(e,t){var n=this.noteView;n&&t(n.getBlockViewByBlock(e))},t.prototype._onEnterTableEdit=function(e){e.blockId&&(this.editor.sendCachedDataCommand(),this._sendBlockLockInfo(e.blockId)),this.trigger("cell-edit-view-enter",e)},t.prototype._onSaveContent=function(){this.trigger("yne-save-content")},t.prototype._onSelectionChange=function(e,t){this.lastDeleteInlineStates?(this.setEditingInlineStates(this.lastDeleteInlineStates),this.lastDeleteInlineStates=null):this._shouldKeepEditingStates(e)||this._updateEditingStates(t),this._notifyEditingStatesChange(),this.trigger("yne-selection-change")},t.prototype._onTextInput=function(e){this.insertText(e,!1)},t.prototype._pasteBlobImg=function(e){var t,n,o=this;(t=e.originalEvent.clipboardData.items)&&1===t.length&&0===t[0].type.indexOf("image")&&(n=t[0].getAsFile(),o.trigger("yne-blob-paste",{data:n,isImg:!0},function(e){e&&e.source&&o.insertImage(e.source)}))},t.prototype._pasteForMac=function(){var e,t,o,i,r,a,s,l=this,c=l.editor,d=window.ynote;if(d&&d.macClipboardData||h.error("YNote does not exist!"),l.isPasteAsText)return e=c.callMacNativeApi("macClipboardData",["text/plain"]),void l._pastePlain(e,l.isPasteAsText);if(!((t=c.callMacNativeApi("macClipboardData",["text/yne-table-json"]))&&l.pasteYTableJson(t)||(o=c.callMacNativeApi("macClipboardData",["text/yne-json"]),i=c.callMacNativeApi("macClipboardData",["text/yne-image-json"]),r=c.callMacNativeApi("macClipboardData",["text/yne-note-id"]),o&&l._pasteJSON(o,i,r))))if((a=c.callMacNativeApi("macClipboardData",["text/html"]))&&l._pasteHTML(a))h.log("mac paste html ok");else{if(s=c.callMacNativeApi("macClipboardData",["image"]))return s=JSON.parse(s),void n.each(s,function(e){l.insertImage(e)});(e=c.callMacNativeApi("macClipboardData",["text/plain"]))&&l._pastePlain(e,l.isPasteAsText)}},t.prototype._pasteJSON=function(e,t,o){h.log("Paste JSON\n",e);var a,s,c=this,d={},u=this.getNoteRange();u.isInSingleBlock()&&y.isCode(u.getStartBlockRange().block)&&(s=!0);var g,f=l.parseImageJson(t),m=p.parseJSON(e,s),_=[],I=[],b={},v={};return n.each(m,function(e){y.isHeading(e)&&(b[e.getId()]=e)}),n.each(m,function(e){var t,n;y.isCatalogue(e)?(t=b[e.getHref()])&&(e.setIndent(t.getLevel()-1),n=i.newGUID(),v[n]=!0,t.setId(n),e.setHref(n)):y.isHeading(e)||(e.setId(i.newGUID()),y.isListItem(e)?(a=e.getListId(),d[a]||(d[a]=r.getOrCreateListById(c.note.getAllBlocks(),a,e.getListType())),e.setOwnerList(d[a])):y.isAttachment(e)?_.push(e):y.isImage(e)&&I.push(e))}),n.each(b,function(e){v[e.getId()]||e.setId(i.newGUID())}),c.note.isSameNote(o)||(g=c._uploadImageData(f||{},_,I)),c._pasteBlockList(m,g)},t.prototype._pasteHTML=function(e){h.log("Paste HTML\n",e);var t=this,o={},r={},a=p.parseHtml(e);return n.each(a,function(e){y.isHeading(e)&&(o[e.getId()]=e)}),n.each(a,function(e){var n,a;if(y.isCatalogue(e)&&(n=o[e.getHref()])&&(e.setIndent(n.getLevel()-1),a=i.newGUID(),r[a]=!0,n.setId(a),e.setHref(a)),y.isTextBlock(e)){var s=t.getNoteRange().getStartBlockRange().block;e.setBlockStyles(s.getBlockStyles())}}),n.each(o,function(e){r[e.getId()]||e.setId(i.newGUID())}),t._pasteBlockList(a)},t.prototype._pastePlain=function(e,t){var o,i,r,a=this,s=a.getNoteRange();return t&&(i=null,r=a.querySelectionBlockStyles(s)),o=p.parsePlain(e,i,r,t),n.each(o,function(e){if(y.isTextBlock(e)){var t=a.getNoteRange().getStartBlockRange().block;e.setBlockStyles(t.getBlockStyles())}}),a._pasteBlockList(o)},t.prototype._pasteBlockList=function(e,t){var o;if(e&&e.length&&(!0===this.removeLocalImg&&(e=n.filter(e,function(e){var o=/^(http:\/\/|https:\/\/|\/\/)/i;return e.getBlockStyle("back-color")&&e.setBlockStyle("back-color",""),y.isImage(e)&&-1===n.indexOf(t||[],e)?o.test(e.getSource())||/^data:.+;base64/i.test(e.getSource()):!y.isAttachment(e)||o.test(e.getResource())})),e&&e.length))return o=this.editingInlineStates,this.editingInlineStates=null,this.execCommand("comp.InsertBlocks",{blocks:e}),this.editingInlineStates=o,!0},t.prototype._redoUndoLocalCmdInCollabMode=function(e){var t;e.collabProperties.isCollabUndo?t=this.cmdManager.getUndoCmd():e.collabProperties.isCollabRedo&&(t=this.cmdManager.getRedoCmd()),t?((t=n.clone(t)).setCmdOriginalNoteVersion(this.note.getFileVersion()),t.isLocalExecutedCmd=!1,e.collabProperties.isCollabUndo?(t.setCollabUndo(!0),t.setCollabRedo(!1)):e.collabProperties.isCollabRedo&&(t.setCollabRedo(!0),t.setCollabUndo(!1)),this.editor.isValidLocalDataCmd(t)?i.isInlineStateSetCommand(t)||this.editor.pushLocalDataCommand(t,!0):h.warn("skip invalid redo/undo local command")):h.warn("skip empty redo/undo local command")},t.prototype._setClipboardByRange=function(e,t){var n,o;e&&!e.isCollapsed()?(n=this.getRangeData(e),new T({event:t}).setDataMap(n),o=e.isInSingleBlock()&&y.isAttachment((e.getStartBlockRange()||{}).block),this.trigger("yne-clipboard-set",o)):h.log("no note range or note range is collapsed!")},t.prototype._sendBlockLockInfo=function(e){this.editor.hasCachedDataCmd()?window.setTimeout(this._sendBlockLockInfo.bind(this,e),100):this.editor.sendBlockLockInfo(e)},t.prototype._shouldKeepEditingStates=function(e){var t,o,i;return!!(e&&e.isCommandType&&e.isCommandType())&&(o=(t=e.getData()||{}).cmdType,i=t.cmdName,n.contains({do:["key.Space","key.Enter","comp.ApplyStyles","comp.IndentOutdent","comp.InsertAttachment","comp.InsertHorizontalRule","comp.InsertImage","comp.InsertList","comp.InsertTable","comp.KeyTab","comp.KeyTextInput"],redo:["comp.ApplyStyles","comp.IndentOutdent","comp.InsertList"],undo:["comp.ApplyStyles","comp.IndentOutdent","comp.InsertList"]}[o],i))},t.prototype._updateDeleteInlineStates=function(e){e&&e.href&&(e=null),this.lastDeleteInlineStates=e},t.prototype._updateEditingStates=function(e){var t=this.getNoteRange(),n=this.queryBackwardFirstInlineStyles(t,e);this.setEditingInlineStates(n)},t.prototype._uploadImageData=function(e,t,o){if(!(n.isEmpty(e)||n.isEmpty(t)&&n.isEmpty(e.data))){var i,r,a,s,l=this,c=e.data,d=l.note,u=l.editor;if(a=l._getUploadData(c,t,o))return i=a.data,r=a.map,s=a.replaceImgList,u.trigger("yne-upload-image",{data:i,isImg:!0},function(e){setTimeout(function(){var t=[],o=[];n.each(e,function(e,i){n.each(r[i],function(i){var r=d.getBlockById(i);r&&(t.push(r),y.isImage(r)?o.push(n.defaults(e,{source:r.getSource()||"uploadfail"})):y.isAttachment(r)&&o.push(n.defaults(e,{resource:r.getResource(),source:r.getSource()})))})}),t.length>0&&(l.execCommand("comp.ReplaceResource",{ignoreUndoRedo:!0,resProps:o,resources:t}),n.each(t,function(e){e.trigger("content-change")}))})},function(){n.each(n.union(t,s),function(e){e.setFakeLoading(!0)})}),s}},t}(u)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(1),i=n(2),r=function(e){var t=document.createElement("CANVAS"),n=t.getContext("2d"),i=null;if(!e)return null;t.height=e.naturalHeight,t.width=e.naturalWidth,n.fillStyle="white",n.fillRect(0,0,t.width,t.height),n.drawImage(e,0,0);try{i=t.toDataURL("image/jpeg",1)}catch(e){o.warn(e.message)}return i};return{getBase64Data:function(e){if(!e)return{};var n,o={data:{}},i=o.data;return t.each(e,function(e){(n=r(e.img))&&(i[e.source]={base64:n})}),o},parseImageJson:function(e){var t=null;if(!e)return null;try{t=JSON.parse(e)}catch(e){return o.error("no imagejson or parse imagejson error"),null}return t},base64ToBlob:function(e){for(var t=e.split(","),n=t[0].match(/:(.*?);/)[1],o=atob(t[1]),i=o.length,r=new Uint8Array(i);i--;)r[i]=o.charCodeAt(i);return new Blob([r],{type:n})},imgToBase64:r,setBlockIds:function(e,n){var o=[];return t.each(e,function(e){if(i.isImage(e)){var t=e.getSource(),r=n[t];r&&r.base64&&(o.push(e),r.imgBlockIds?r.imgBlockIds.push(e.getId()):r.imgBlockIds=[e.getId()])}}),o}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(16),o=n(1),i=n(4),r=n(17),a=n(3);return n(492),t.extend({_editor:null,initialize:function(e){this._editor=e.editor},create:function(e,t,n){var s,l=null;if(n.collabProperties=n.collabProperties||{},e+="",s=i.get(e)){if(l=new s({note:t,args:n}),!this._editor.isCollabEnabled())return l.isSimple||l.setStartingRange(n.range),l;if(n.collabProperties.dataCmdError)return o.error(n.collabProperties.dataCmdError),null;if(l.isSimple)return l;!a.isCollabCommand(n)&&l.isOriginalCmd&&(r.isNoteRange(n.range)?l.setStartingRange(n.range):(n.collabProperties.dataCmdError="original cmd args.range should be noteRange",l=null))}else o.warn("No class for `"+e+"` command");return l}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){n(243),n(493),n(494),n(495),n(496),n(497),n(498),n(499),n(500),n(501),n(502),n(503),n(504),n(505),n(507),n(508),n(510),n(511),n(512),n(513),n(514),n(515),n(516),n(517),n(518),n(519),n(521),n(522),n(523),n(525),n(527),n(529),n(531),n(532),n(534),n(536),n(537),n(538)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(18),a=n(33),s=n(86),l=n(3);return t=o.extend({name:"comp.AppendBlank",_cmdArgs:null,_note:null,_newBlkId:null,_preBlkId:null,_preBlock:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},l.isCollabCommand(this._cmdArgs)||(this._newBlkId=l.newGUID(),this._preBlock=this._note.getLastBlock(),this._preBlock&&(this._preBlkId=this._preBlock.getId())),t.__super__.initialize.apply(this,arguments)},apply:function(){var e,t;return e=r.createNewParagraph(this._preBlock,this._newBlkId,""),r.setBlockStyle(e,this._cmdArgs.inlineStyles),!1!==this.executeAtomicCommand(new a({note:this._note,newBlks:[e],preBlk:this._preBlock}))&&(t=s.buildNoteRangeFromParagraph(e,0,0),this.setEndingRange(t),!0)},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;e&&(this._newBlkId=e.newBlkId,e.preBlkId&&(this._preBlock=this._note.getBlockById(e.preBlkId))),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e;return this.rangeIsRequired=!1,this.resetAffectedBlockIds(),(e=t.__super__.toCollabJSON.apply(this)).newBlkId=this._newBlkId,this._preBlkId&&(e.preBlkId=this._preBlkId),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(0),s=n(18),l=n(3);return t=o.extend({name:"comp.ApplyStyles",_note:null,_cmdArgs:null,_blockStyleNameValues:null,_inlineStyleNameValues:null,initialize:function(){var e;if(this._note=this.options.note,this._cmdArgs=this.options.args,e=this._cmdArgs.range,t.__super__.initialize.apply(this),!l.isCollabCommand(this._cmdArgs)){if(!e)return r.error("note range should NOT be null:",this.name),void(this.isReadyToApply=!1);this._blockStyleNameValues=this._cmdArgs.blockStyles,this._inlineStyleNameValues=this._cmdArgs.inlineStyles}},apply:function(){var e=this._cmdArgs.range;return!s.setStylesOnNoteRange(this,this._note,e,a.clone(this._blockStyleNameValues),a.clone(this._inlineStyleNameValues))&&(this.setEndingRange(e),!0)},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;e&&(e.blockStyles&&(this._blockStyleNameValues=e.blockStyles),e.inlineStyles&&(this._inlineStyleNameValues=e.inlineStyles)),t.__super__.fromCollabJSON.apply(this)},isInlineStateSet:function(){var e=this._cmdArgs.range,t=!1;return e&&e.isCollapsed()&&(!this._blockStyleNameValues||a.isEmpty(this._blockStyleNameValues))&&this._inlineStyleNameValues&&!a.isEmpty(this._inlineStyleNameValues)&&(t=!0),t},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(this._blockStyleNameValues&&!a.isEmpty(this._blockStyleNameValues)&&(e.blockStyles=this._blockStyleNameValues),this._inlineStyleNameValues&&!a.isEmpty(this._inlineStyleNameValues)&&(e.inlineStyles=this._inlineStyleNameValues)),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(246),i=n(4),r=n(1),a=n(3);return t=o.extend({name:"comp.DeleteNoteRange",_cmdArgs:null,_note:null,initialize:function(){var e;if(this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),!a.isCollabCommand(this._cmdArgs)){if(!(e=this._cmdArgs.range))return this.isReadyToApply=!1,void r.error("note range should NOT be null",this.name);if(e.isCollapsed()&&!this._cmdArgs.isTableDelete&&!this._cmdArgs.isCodeDelete)return this.isReadyToApply=!1,r.error("should NOT trigger the cmd when NoteRange is collapsed",e),!1}},isSingleBlockAffected:function(){var e,n,o=this._args.range,i=t.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o&&o.isCollapsed()&&(e=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(e)&&r===e.getEndOffset()&&(i=!1)),i}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(0),s=n(2),l=n(51),c=n(8),d=n(18),u=n(17),h=n(33),p=n(91),g=n(121),f=n(78),m=n(37),y=n(30),_=n(139),I=n(3);return t=o.extend({name:"comp.DragBlocks",_note:null,_cmdArgs:null,_dropBlockRange:null,_insertedBlocks:null,_newEndBlankParaId:null,_insertedBlocksJSON:null,initialize:function(){var e,n=this;if(n._note=n.options.note,n._cmdArgs=n.options.args,t.__super__.initialize.apply(n),!I.isCollabCommand(n._cmdArgs)){if(!(e=n._cmdArgs.range))return r.error(n.name+":note range should NOT be null"),void(n.isReadyToApply=!1);if(n._dropBlockRange=n._cmdArgs.dropRange,n._insertedBlocks=[],n._insertedBlocksJSON=[],a.each(n._cmdArgs.blocks,function(e){n._insertedBlocks.push(e),n._insertedBlocksJSON.push(e.toCollabJSON())}),n._newEndBlankParaId=I.newGUID(),!(n._dropBlockRange&&n._dropBlockRange.block&&s.isTextBlock(n._dropBlockRange.block)&&n._dropBlockRange.isCollapsed()))return n.isReadyToApply=!1,void r.error("drag destination should be a single pos in text block",n._dropBlockRange);if(n._isDropRangeInStartNoteRange(n._dropBlockRange))return n.isReadyToApply=!1,void r.error("dropBlockRange should not be in the startNoteRange",e,n._dropBlockRange)}},apply:function(){var e;return e=y.createRangeByBlock({block:this._dropBlockRange.block,start:this._dropBlockRange.start,end:this._dropBlockRange.end}),this._dropBlockRange.hasOwnProperty("startLineCharIndex")&&(e=this._dropBlockRange.clone()),e=this._handleStartNoteRangeData(e),this._insertDraggedData(e),!0},_handleStartNoteRangeData:function(e){var t,n,o,i,r,l,c,u=this._cmdArgs.range,h=[];if(n=(t=u.getStartBlockRange()).block,i=(o=u.getEndBlockRange()).block,c=this._isFullSelectionInTextBlock(t),u.isCollapsed()||t.selectWholeBlock||d.deleteSelectedContent(this,this._note,u),u.isInMultiBlock())s.isTextBlock(n)&&!n.isEmpty()||(h.push(n),n=null),s.isTextBlock(i)&&!i.isEmpty()||(h.push(i),i=null),a.isEmpty(h)&&(e.block.getId()===i.getId()&&(e=this._rebuildDropRangeWhenNoteRangeMerge(t,o,e)),s.isCode(n)||s.isCode(i)||(this.executeAtomicCommand(new p({block:n,start:n.getLength(),text:i.getText()})),h.push(i))),h.length&&this.executeAtomicCommand(new m({note:this._note,blocks:h}));else if(s.isTextBlock(n,t))c&&(r=this._note.getPreBlock(n),l=this._note.getNextBlock(n),s.isImage(r)||s.isImage(l)||s.isAttachment(r)||s.isAttachment(l)||s.isTable(r)||s.isTable(l)||(this.executeAtomicCommand(new m({note:this._note,blocks:[n]})),n=null));else{if(s.isCode(n)&&d.replaceBlockWithParagraph(this,this._note,n,""),s.isCode(e.block))return e;d.replaceBlockWithParagraph(this,this._note,n,""),n=null}return e},_insertDraggedData:function(e){var t,n,o,i,r,l,c=this._cmdArgs.range,g=this._insertedBlocks[0],_=a.last(this._insertedBlocks),I=e.block;(t=c.getStartBlockRange()).block.getId(),(n=c.getEndBlockRange()).block.getId(),this._tuneDropBlockRange(e,t,n),s.isCode(e.block)?this._handleInCode(e):(s.isTextBlock(g,t)&&!s.isHeading(g)?(this._insertedBlocks.shift(),this.executeAtomicCommand(new p({block:e.block,start:e.start,text:g.getText()})),l=r=y.createRangeByBlock({block:e.block,start:e.start,end:e.start+g.getLength()}),e.start+=g.getLength(),e.end=e.start):l=r=y.createRangeByBlock({block:this._insertedBlocks[0]}),a.isEmpty(this._insertedBlocks)||(o=e.block.sliceText(e.start,e.block.getLength()),c.isInMultiBlock()&&(l=s.isTextBlock(_)?y.createRangeByBlock({block:_,start:0,end:_.getLength()}):y.createRangeByBlock({block:_})),0===e.start?(I=this._note.getPreBlock(e.block),s.isTextBlock(_,n)?(_.append(o),this.executeAtomicCommand(new m({note:this._note,blocks:[e.block]}))):0===e.block.getLength()&&this.executeAtomicCommand(new m({note:this._note,blocks:[e.block]}))):e.start<e.block.getLength()&&(this.executeAtomicCommand(new f({block:e.block,start:e.start,end:e.block.getLength()})),s.isTextBlock(_,n)?(_.append(o),s.isCode(_)&&(this._insertedBlocks.pop(),_=d.createNewParagraph(e.block,null,_.getText()),this._insertedBlocks.push(_))):(i=s.isListItem(e.block)?d.createNewListItem(e.block,this._newEndBlankParaId,o):s.isHeading(e.block)?d.createNewHeading(e.block,this._newEndBlankParaId,o,e.block.getLevel()):s.isTodo(e.block)?d.createNewTodo(e.block,{id:this._newEndBlankParaId,text:o,checked:e.block.getChecked()}):s.isQuote(e.block)?d.createNewQuote(e.block,{id:this._newEndBlankParaId,text:o}):s.isCode(e.block)?d.createNewCode(e.block,{id:this._newEndBlankParaId,text:e.block.getText()}):d.createNewParagraph(e.block,this._newEndBlankParaId,o),this._insertedBlocks.push(i),c.isInMultiBlock()&&(l=y.createRangeByBlock({block:i,start:0,end:0})))),this.executeAtomicCommand(new h({note:this._note,newBlks:this._insertedBlocks,preBlk:I}))),this.setEndingRange(u.create({startRange:r,endRange:l})))},_isDropRangeInStartNoteRange:function(e){var t,n=this._cmdArgs.range,o=n.getStartBlockRange(),i=n.getEndBlockRange(),r=e,s=r.block.getId(),l=!1;return s===o.block.getId()&&r.start>=o.start&&r.start<=o.end&&(l=!0),!l&&n.isInMultiBlock()&&(s===i.block.getId()&&r.start>=i.start&&r.start<=i.end?l=!0:(t=this._note.getInterBlocks(o.block,i.block),a.some(t,function(e){return s===e.getId()&&(l=!0),l}))),l},_isFullSelectionInTextBlock:function(e){var t=!1,n=0;return s.isTextBlock(e.block)&&(n=e.block.getLength()),n>0&&0===e.start&&e.end===n&&(t=!0),t},_handleInCode:function(e){var t,n=e,o=[];a.each(this._insertedBlocks,function(e){s.isTextBlock(e)&&o.push(e.getText().toString())}),o.length&&(this.executeAtomicCommand(new g({block:n.block,startBlockRange:n,text:new c({text:o.join(l.LINE_BREAK)})})),(t=o.reduce(function(e,t){var n=t.split(l.LINE_BREAK);return t.length>0&&t[t.length-1]===l.LINE_BREAK&&n.pop(),e.concat(n)},[])).length>1?d.expandCodeRange(this,n,t[t.length-1].length,t.length-1):d.expandCodeRange(this,n,t[0].length))},_rebuildDropRangeWhenNoteRangeMerge:function(e,t,n){var o;return o=n.start+e.start-t.end,y.createRangeByBlock({block:e.block,start:o,end:o})},_tuneDropBlockRange:function(e,t,n){var o=t.block.getId(),i=n.block.getId();e.block.getId()===o&&e.start>t.end&&(e.start-=t.end-t.start,e.end-=e.start),o!==i&&e.block.getId()===i&&e.start>n.end&&(e.start-=n.end-n.start,e.end-=e.start)},fromCollabJSON:function(){var e=this,n=e.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.coreEditor;t.__super__.fromCollabJSON.apply(e),o&&(e._newEndBlankParaId=o.newEndBlkId,e._dropBlockRange=i.buildBlockRangeFromJSON(o.dropRange),e._insertedBlocks=[],a.each(o.insertedBlocks,function(t){e._insertedBlocks.push(_.buildBlockFromJSON(t,i))}))},isSingleBlockAffected:function(){var e=this._cmdArgs.range,t=e.getStartBlockRange();return!(!e.isInSingleBlock()||this._dropBlockRange.block.getId()!==t.block.getId())},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(e.newEndBlkId=this._newEndBlankParaId,e.dropRange=this._dropBlockRange.toCollabJSON(),e.insertedBlocks=this._insertedBlocksJSON),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(18),a=n(6),s=n(0),l=n(1),c=n(3);return t=o.extend({name:"comp.FormatPainter",_cmdArgs:null,_note:null,_inlineStyles:null,_blockStyles:null,initialize:function(){var e;if(this._note=this.options.note,this._cmdArgs=this.options.args||{},e=this._cmdArgs.range,t.__super__.initialize.apply(this,arguments),!c.isCollabCommand(this._cmdArgs)){if(!e)return l.error(this.name+":note range should NOT be null"),void(this.isReadyToApply=!1);this._inlineStyles=this._cmdArgs.data.inlineStyles,this._blockStyles=this._cmdArgs.data.blockStyles}},apply:function(){var e=this._cmdArgs.range,t={},n={};return!!e.isCollapsed()||(s.each(this._inlineStyles,function(e,n){"href"!==n&&e!==a.INTERM&&null!=e&&(t[n]=e)}),s.each(this._blockStyles,function(e,t){e!==a.INTERM&&null!=e&&(n[t]=e)}),r.resetAllStyles(this,this._note,e),r.setStylesOnNoteRange(this,this._note,e,n,t),this.setEndingRange(e),!0)},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;e&&(this._inlineStyles=e.inlineStyles,this._blockStyles=e.blockStyles),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this)).inlineStyles=this._inlineStyles,e.blockStyles=this._blockStyles,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(2),a=n(18),s=n(1),l=n(141),c=n(3);return t=o.extend({name:"comp.IndentOutdent",_cmdArgs:null,_note:null,_indentStep:null,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),!c.isCollabCommand(this._cmdArgs)){if(e=this._cmdArgs.range,this._indentStep=this._cmdArgs.indentStep,!e||!e.canDrawedByNative())return s.error(this.name+":note range should NOT be null or cannot be Drawed by native"),void(this.isReadyToApply=!1);if(n=e.getStartBlockRange().block,e.isInSingleBlock()&&!r.isTextBlock(n))return void(this.isReadyToApply=!1)}},apply:function(){var e,t,n,o=this._cmdArgs.range;return e=o.getStartBlockRange().block,t=o.getEndBlockRange().block,o.isInMultiBlock()?(n=this._note.getInterBlocks(e,t,!0),a.isInSameList(n)?this._isFirstListItem(n[0])?a.updateBlocksIndentLevel(this,n[0].getOwnerList().getItems(),this._indentStep):this.executeAtomicCommand(new l({listItems:n,deltaLevel:this._indentStep})):a.updateBlocksIndentLevel(this,n,this._indentStep),this.setEndingRange(o),!0):(r.isListItem(e)?this._isFirstListItem(e)?a.updateBlocksIndentLevel(this,e.getOwnerList().getItems(),this._indentStep):this.executeAtomicCommand(new l({listItems:[e],deltaLevel:this._indentStep})):a.updateBlocksIndentLevel(this,[e],this._indentStep),this.setEndingRange(o),!0)},_isFirstListItem:function(e){return 1===e.getLevel()&&1===e.getIndex()},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;e&&(this._indentStep=e.indentStep),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.indentStep=this._indentStep),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(122),i=n(4),r=n(2),a=n(72),s=n(46),l=n(33),c=n(103),d=n(3),u=n(18);return t=o.extend({name:"comp.InsertAttachment",_cmdArgs:null,_note:null,_attachBlkId:null,_attachSrc:null,_attachRes:null,_attachFileName:null,_attchFileLen:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),d.isCollabCommand(this._cmdArgs)||(this._attachBlkId=d.newGUID(),this._attachSrc=this._cmdArgs.src,this._attachRes=this._cmdArgs.resource,this._attachFileName=this._cmdArgs.fileName,this._attchFileLen=this._cmdArgs.fileLength)},insertResource:function(e,t,n){var o,i=this._cmdArgs.range,s=[];return r.isTable(e)&&i.isSingleTableSelected()?this._insertAttachmentInTable(e):(o=new a({source:this._attachSrc,resource:this._attachRes,fileName:this._attachFileName,fileLength:this._attchFileLen}),u.setResourceBlockStyleByPreBlock(o,e),t&&s.push(t),s.push(o),n&&s.push(n),o.setId(this._attachBlkId),this.executeAtomicCommand(new l({note:this._note,newBlks:s,preBlk:e})),o)},_insertAttachmentInTable:function(e){var t,n=this._cmdArgs.range.getStartBlockRange().getAsRectRange();if(n)return t=n.getFirstCellRect(),this.executeAtomicCommand(new c({table:e,cellRect:t,content:new s({source:this._attachSrc,resource:this._attachRes,fileName:this._attachFileName,fileLength:this._attchFileLen})})),e},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._attachBlkId=e.newBlkId,this._attachSrc=e.src,this._attachRes=e.attachRes,this._attachFileName=e.fileName,this._attchFileLen=e.fileLen)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._attachBlkId,e.src=this._attachSrc,e.attachRes=this._attachRes,e.fileName=this._attachFileName,e.fileLen=this._attchFileLen),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(0),s=n(2),l=n(18),c=n(17),d=n(33),u=n(91),h=n(121),p=n(37),g=n(78),f=n(209),m=n(30),y=n(139),_=n(8),I=n(51),b=n(3);return t=o.extend({name:"comp.InsertBlocks",_note:null,_cmdArgs:null,_insertedBlocks:null,_newEndBlankParaId:null,_insertedBlocksJSON:null,initialize:function(){var e=this;if(e._note=e.options.note,e._cmdArgs=e.options.args,t.__super__.initialize.apply(e),!b.isCollabCommand(e._cmdArgs)){if(!e._cmdArgs.range)return r.error(e.name+":note range should NOT be null"),void(e.isReadyToApply=!1);e._insertedBlocks=[],e._insertedBlocksJSON=[],a.each(e._cmdArgs.blocks,function(t){e._insertedBlocks.push(t),e._insertedBlocksJSON.push(t.toCollabJSON())}),e._newEndBlankParaId=b.newGUID()}},apply:function(){var e,t,n,o=this,i=o._note,r=o._cmdArgs.range,c=r.getStartBlockRange(),d=c.block,u=d.getBlockStyles(),h=a.last(o._insertedBlocks);return o._getCollabRequiredData(o._insertedBlocks),o._insertedBlocks=o._insertedBlocks.map(function(e){return u&&u["back-color"]&&e.setBlockStyle("back-color",u["back-color"]),e}),s.isTextBlock(h)?t=m.createRangeByBlock({block:h,start:h.getLength(),end:h.getLength()}):(n=i.getNextBlock(o.startingRange.getEndBlockRange().block),s.isTextBlock(n)&&(t=m.createRangeByBlock({block:n,start:n.getLength(),end:n.getLength()}))),r.isCollapsed()||s.isCode(d)||l.deleteSelectedContent(o,o._note,r),s.isCode(d)&&!c.selectWholeBlock?(o._handleInCode(),!0):(o._insertedBlocks=o._insertedBlocks.reduce(function(e,t,n){var i;return 0!==n&&n!==o._insertedBlocks.length-1||t.isSelectedBlock?e.push(t):(i=l.convertCodeToPara(t),Array.isArray(i)?i.map(function(t){e.push(t)}):e.push(i)),e},[]),e=r.isInMultiBlock()?o._handleMultiBlockSelection(t):o._handleSingleBlockSelection(t),o.setEndingRange(e),!0)},_handleMultiBlockSelection:function(e){var t=this._cmdArgs.range,n=t.getStartBlockRange(),o=n.block,i=t.getEndBlockRange(),r=i.block,a=this._insertedBlocks[0];return 1===this._insertedBlocks.length&&s.isTextBlock(a)&&s.isTextBlock(o)&&s.isTextBlock(r)?(this._insertedBlocks.shift(),e=m.createRangeByBlock({block:o,start:o.getLength()+a.getLength(),end:o.getLength()+a.getLength()}),a.append(r.getText()),this.executeAtomicCommand(new p({note:this._note,blocks:[r]})),this.executeAtomicCommand(new u({block:o,start:o.getLength(),text:a.getText()}))):e=this._insertBlocksBetweenStartEndBlock(n,i,e),c.create({startRange:e,endRange:e})},_getCollabRequiredData:function(e){var t=[];e&&e.length>0&&a.each(e,function(e){t.push(e.getId())}),t.push(this._newEndBlankParaId),this.pushAffectedBlockIds(t)},_handleSingleBlockSelection:function(e){var t,n=this,o=n._cmdArgs.range.getStartBlockRange(),i=o.block;return t=s.isTextBlock(i,o)?n._handleSingleTextStartBlock(i,e):n._handleSingleNonTextStartBlock(i,e),a.isEmpty(n._insertedBlocks)||(t.needToRebuildLIs&&n._rebuildListItems(n._insertedBlocks,t.refBlockForInsert,t.deltaLevel),s.isQuote(t.refBlockForInsert)&&(n._insertedBlocks=n._insertedBlocks.map(function(e){return s.isParagraph(e)?new l.createNewQuote(e,{id:e.getId(),text:e.getText(),checked:n._checked}):e})),n.executeAtomicCommand(new d({note:n._note,newBlks:n._insertedBlocks,preBlk:t.refBlockForInsert}))),c.create({startRange:t.newEndBlockRange,endRange:t.newEndBlockRange})},_handleSingleNonTextStartBlock:function(e,t){var n=this._insertedBlocks[0],o=a.last(this._insertedBlocks),i=this._note.getPreBlock(e),r=this._note.getNextBlock(e),c={};return c.refBlockForInsert=i,c.newEndBlockRange=t,c.needToRebuildLIs=!1,this.executeAtomicCommand(new p({note:this._note,blocks:[e]})),s.isTextBlock(n)||s.isTextBlock(i)||this._insertedBlocks.unshift(l.createNewParagraph(e,e.getId(),"")),s.isTextBlock(o)||s.isTextBlock(r)||(this._insertedBlocks.push(l.createNewParagraph(e,this._newEndBlankParaId,"")),c.newEndBlockRange=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0})),c},_handleSingleTextStartBlock:function(e,t){var n,o=this._cmdArgs.range.getStartBlockRange(),i=this._note.getPreBlock(e),r=this._note.getNextBlock(e),l=this._insertedBlocks[0],c=a.last(this._insertedBlocks),d="",h=1===this._insertedBlocks.length,y={};return y.refBlockForInsert=e,y.newEndBlockRange=t,y.needToRebuildLIs=!1,y.deltaLevel=0,o.start<e.getLength()&&(d=e.sliceText(o.start,e.getLength())),h&&s.isTextBlock(l)&&!s.isCode(l)||(s.isTextBlock(c)&&!s.isCode(l)?(n=d instanceof _?d:_.createBlank(),c.append(n),this.executeAtomicCommand(new g({block:e,start:o.start,end:e.getLength()}))):""===d&&s.isTextBlock(r)?y.newEndBlockRange=m.createRangeByBlock({block:r,start:0,end:0}):(this._insertedBlocks.push(this._buildNewBlockFromStartBlock(e,this._newEndBlankParaId,d)),y.newEndBlockRange=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0}),this.executeAtomicCommand(new g({block:e,start:o.start,end:e.getLength()})))),s.isTextBlock(l)&&!s.isCode(l)?e.getLength()>0||s.isListItem(e)||!s.isListItem(l)&&!s.isHeading(l)&&!s.isCatalogue(l)&&!s.isTodo(l)&&!s.isQuote(l)?(this._insertedBlocks.shift(),h&&(y.newEndBlockRange=m.createRangeByBlock({block:e,start:o.start+l.getLength(),end:o.start+l.getLength()})),this.executeAtomicCommand(new f({blocks:[e],styleNameValues:l.getBlockStyles()})),this.executeAtomicCommand(new u({block:e,start:o.start,text:l.getText()})),s.isListItem(e)&&s.isListItem(this._insertedBlocks[0])&&(y.needToRebuildLIs=!0,s.isListItem(l)&&(y.deltaLevel=this._insertedBlocks[0].getLevel()-l.getLevel()))):(y.refBlockForInsert=i,this.executeAtomicCommand(new p({note:this._note,blocks:[e]})),s.isListItem(i)&&s.isListItem(l)&&(y.needToRebuildLIs=!0,y.deltaLevel=1-i.getLevel())):0===e.getLength()&&s.isTextBlock(i)&&(y.refBlockForInsert=i,this.executeAtomicCommand(new p({note:this._note,blocks:[e]}))),y},_handleInCode:function(){var e,t=this._cmdArgs.range,n=t.getStartBlockRange(),o=[];a.each(this._insertedBlocks,function(e){s.isTextBlock(e)&&o.push(e.getText().toString())}),t.isCollapsed()||l.deleteSelectedContent(this,this._note,t),o.length&&(this.executeAtomicCommand(new h({block:n.block,startBlockRange:n,text:new _({text:o.join(I.LINE_BREAK)})})),(e=o.reduce(function(e,t){var n=t.split(I.LINE_BREAK);return t.length>0&&t[t.length-1]===I.LINE_BREAK&&n.pop(),e.concat(n)},[])).length>1?l.setCodeBlockAsEndingRange(this,n,e[e.length-1].length,e.length-1):l.setCodeBlockAsEndingRange(this,n,e[0].length))},_buildNewBlockFromStartBlock:function(e,t,n){return s.isHeading(e)?l.createNewHeading(e,t,n,e.getLevel()):s.isCatalogue(e)?l.createNewCatalogue(e,{paraId:t,text:n,href:e.getHref()}):s.isListItem(e)?l.createNewListItem(e,t,n):s.isTodo(e)?l.createNewTodo(e,{id:t,text:n,checked:e.getChecked()}):s.isQuote(e)?l.createNewQuote(e,{id:t,text:n}):l.createNewParagraph(e,t,n)},_insertBlocksBetweenStartEndBlock:function(e,t,n){var o=e.block,i=t.block,r=this._note.getPreBlock(o),c=this._note.getNextBlock(i),d=this._insertedBlocks[0],h=a.last(this._insertedBlocks),g=o,f=[],y=0;return s.isTextBlock(i)?s.isTextBlock(h)?(f.push(i),h.append(i.getText())):s.isTextBlock(h)||(n=m.createRangeByBlock({block:i,start:0,end:0})):(f.push(i),s.isTextBlock(c)||s.isTextBlock(h)?s.isTextBlock(h)||(n=m.createRangeByBlock({block:c,start:0,end:0})):(this._insertedBlocks.push(l.createNewParagraph(i,i.getId(),"")),n=m.createRangeByBlock({block:a.last(this._insertedBlocks),start:0,end:0}))),s.isTextBlock(o)?s.isTextBlock(d)?o.getLength()>0||s.isListItem(o)||!s.isListItem(d)?(this._insertedBlocks.shift(),this.executeAtomicCommand(new u({block:o,start:o.getLength(),text:d.getText()})),s.isListItem(d)&&s.isListItem(this._insertedBlocks[0])&&(y=this._insertedBlocks[0].getLevel()-d.getLevel())):(g=r,this.executeAtomicCommand(new p({note:this._note,blocks:[o]}))):0===o.getLength()&&s.isTextBlock(r)&&(g=r,this.executeAtomicCommand(new p({note:this._note,blocks:[o]}))):(f.push(o),g=r,s.isTextBlock(r)||s.isTextBlock(d)||this._insertedBlocks.unshift(l.createNewParagraph(o,o.getId(),""))),a.isEmpty(f)||this.executeAtomicCommand(new p({note:this._note,blocks:f})),this._insertedRemainedBlocks(g,y),n},_insertedRemainedBlocks:function(e,t){a.isEmpty(this._insertedBlocks)||(s.isListItem(this._insertedBlocks[0])&&s.isListItem(e)&&this._rebuildListItems(this._insertedBlocks,e,t),this.executeAtomicCommand(new d({note:this._note,newBlks:this._insertedBlocks,preBlk:e})))},_rebuildListItems:function(e,t,n){var o,i,r,l=e[0];isNaN(n)&&(n=0),i=l.listId,o=t.getOwnerList(),r=t.getLevel()-l.getLevel()+n,a.chain(e).groupBy(function(e){if(s.isListItem(e))return e.listId}).each(function(e,t){e.length>0&&t===i&&a.each(e,function(e){0!==r&&e.setLevel(e.getLevel()+r),e.setOwnerList(o)})})},fromCollabJSON:function(){var e=this,n=e.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.coreEditor;t.__super__.fromCollabJSON.apply(e),o&&(e._newEndBlankParaId=o.newEndBlkId,e._insertedBlocks=[],a.each(o.insertedBlocks,function(t){e._insertedBlocks.push(y.buildBlockFromJSON(t,i))}))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(e.newEndBlkId=this._newEndBlankParaId,e.insertedBlocks=this._insertedBlocksJSON),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(122),r=n(4),a=n(49),s=n(50),l=n(6),c=n(18),d=n(33),u=n(3);return t=i.extend({name:"comp.InsertCatalogue",_cmdArgs:null,_note:null,_blkId:null,_ownerId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),this._initBlocks()},_initBlocks:function(){var e,t,n=this,i=n._note.blocks,r=[],d=[];n._ownerId=n._ownerId||u.newGUID(),t=new s({id:n._ownerId}),o.each(i,function(e){c.isForCatalogueBlock(e)&&r.push(e)}),n._catalogueIds=n._catalogueIds||[],o.each(r,function(o,i){e=new a({indent:o.getLevel()-1,text:o.getText().toString().trim(),href:o.getId(),ownerList:t}),d.push(e),n._catalogueIds[i]?e.setId(n._catalogueIds[i]):n._catalogueIds[i]=e.getId()}),0===r.length&&(e=new a({indent:0,text:l.INSERT_BLANK_CATALOGUE_TEXT,ownerList:t}),d.push(e),n._catalogueIds[0]?e.setId(n._catalogueIds[0]):n._catalogueIds[0]=e.getId()),n._newCatalogues=d},insertResource:function(e,t,n){var i=this._newCatalogues,r=i[i.length-1];return o.each(i,function(t){c.setResourceBlockStyleByPreBlock(t,e)}),i.length<1?e:(t&&i.unshift(t),n&&i.push(n),this.executeAtomicCommand(new d({note:this._note,newBlks:i,preBlk:e})),r)},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._ownerId=e.listId,this._catalogueIds=e.blockIds)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.listId=this._ownerId,e.blockIds=this._catalogueIds),e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(18),r=n(4),a=n(17),s=n(30),l=n(3),c=n(2);return t=o.extend({name:"comp.InsertHeading",_cmdArgs:null,_note:null,_blkId:null,_level:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},this._level=this._cmdArgs.level,t.__super__.initialize.apply(this,arguments),l.isCollabCommand(this._cmdArgs)||(this._blkId=l.newGUID())},apply:function(){var e,t,n,o=this,r=o._cmdArgs.range,l=r.getStartBlockRange(),d=r.getEndBlockRange(),u=l.block,h=d.block;if(r.isInMultiBlock())(n=o._note.getInterBlocks(u,h,!0)).forEach(function(i,r){0!==r?r!==n.length-1?o._helpSetBlock(i):t=o._helpSetBlock(i):e=o._helpSetBlock(i)}),o.setEndingRange(new a({startRange:s.createRangeByBlock({block:e,start:l.start,end:l.end}),endRange:s.createRangeByBlock({block:t,start:d.start,end:d.end})}));else{if(!c.isTextBlock(h))return!1;t=o._helpSetBlock(h),i.setTextBlockAsEndingRange(o,t,d.start,d.end)}},_helpSetBlock:function(e){return c.isTextBlock(e)?"default"===this._level||c.isHeading(e)&&e.getLevel()===this._level?i.replaceBlockWithParagraph(this,this._note,e,e.getText(),"",!0):i.replaceBlockWithHeading(this,this._note,e,e.getText(),this._level):e},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._blkId=e.blockId,this._level=e.listType)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.blockId=this._blkId,e.listType=this._level),e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(122),i=n(4),r=n(71),a=n(33),s=n(3);return t=o.extend({name:"comp.InsertHorizontalRule",_cmdArgs:null,_note:null,_hLineBlkId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),s.isCollabCommand(this._cmdArgs)||(this._hLineBlkId=s.newGUID())},insertResource:function(e,t,n){var o,i,s=[];return(o=new r).setId(this._hLineBlkId),e&&((i=e.getBlockStyles())["back-color"]&&o.setBlockStyle("back-color",i["back-color"]),i.padding&&o.setBlockStyle("padding",i.padding)),t&&s.push(t),s.push(o),n&&s.push(n),this.executeAtomicCommand(new a({note:this._note,newBlks:s,preBlk:e})),o},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._hLineBlkId=e.newBlkId)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._hLineBlkId),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(122),i=n(4),r=n(2),a=n(42),s=n(39),l=n(33),c=n(103),d=n(3),u=n(18);return t=o.extend({name:"comp.InsertImage",_cmdArgs:null,_note:null,_imgBlkId:null,_imgSrc:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),d.isCollabCommand(this._cmdArgs)||(this._imgBlkId=d.newGUID(),this._imgSrc=this._cmdArgs.src)},insertResource:function(e,t,n){var o,i,a=this._cmdArgs.range,c=[];return r.isTable(e)&&a.isSingleTableSelected()?this._insertImageInTable(e):(i=new s({source:this._imgSrc}),e&&((o=e.getBlockStyles())["back-color"]&&i.setBlockStyle("back-color",o["back-color"]),o.padding&&i.setBlockStyle("padding",o.padding)),u.setResourceBlockStyleByPreBlock(i,e),t&&c.push(t),c.push(i),n&&c.push(n),i.setId(this._imgBlkId),this.executeAtomicCommand(new l({note:this._note,newBlks:c,preBlk:e})),i)},_insertImageInTable:function(e){var t,n=this._cmdArgs.range.getStartBlockRange().getAsRectRange();if(n)return t=n.getFirstCellRect(),this.executeAtomicCommand(new c({table:e,cellRect:t,content:new a({source:this._imgSrc})})),e},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._imgBlkId=e.newBlkId,this._imgSrc=e.src)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._imgBlkId,e.src=this._imgSrc),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(8),a=n(18),s=n(1),l=n(0),c=n(2),d=n(120),u=n(91),h=n(208),p=n(506),g=n(103),f=n(3);return t=o.extend({name:"comp.InsertLink",_cmdArgs:null,_note:null,_linkSrc:null,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this,arguments),!f.isCollabCommand(this._cmdArgs)){if(n=(e=this._cmdArgs.range).getStartBlockRange().block,!this._cmdArgs.src)return void(this.isReadyToApply=!1);if(!c.isTable(n)){if(!e||!e.canDrawedByNative())return s.error(this.name+":note range should NOT be null or cannot be Drawed by native"),void(this.isReadyToApply=!1);if(e.isInMultiBlock()||!c.isTextBlock(n))return this.isReadyToApply=!1,void s.error("Cannot be executed in multi-selected blocks or non-text blocks:",this.name)}this._linkSrc=d.completeUrl(this._cmdArgs.src||""),this._linkStyles=this._cmdArgs.styles||{}}},apply:function(){var e,t,n,o,i,d=this._cmdArgs.range,g=l.extend(this._linkStyles,{color:"#003884",underline:!0,href:this._linkSrc});return(e=d.getStartBlockRange())?(t=e.block,c.isTable(t)?(this._setTableBlock(g,d),void this.setEndingRange(d)):c.isCatalogue(t)?(0===t.getLength()?(n=new r({text:this._linkSrc}),o=n.getLength(),this.executeAtomicCommand(new u({block:t,start:e.start,text:n})),this.executeAtomicCommand(new p({block:t,href:this._linkSrc})),a.setTextBlockAsEndingRange(this,t,o,o)):(this.executeAtomicCommand(new p({block:t,href:this._linkSrc})),this.setEndingRange(d)),!0):(e.isCollapsed()?(n=new r({text:this._linkSrc}),o=n.getLength(),n.setStyle(0,o,"href",this._linkSrc),l.each(g,function(e,t){n.setStyle(0,o,t,e)}),i=e.start+o,this.executeAtomicCommand(new u({block:t,start:e.start,text:n})),a.setTextBlockAsEndingRange(this,t,i,i)):(g.href=this._linkSrc,this.executeAtomicCommand(new h({blocks:[t],styleNameValues:g,start:e.start,end:e.end})),this.setEndingRange(d)),!0)):(s.error(this.name+":startBlockRange should not be null"),!1)},_setTableBlock:function(e,t){var n=this,o=n._linkSrc,i=t.getStartBlockRange(),a=i.block,s=i.getAsRectRange();s&&s.forEach(function(t,i){var s,l,c,d,u;(c=a.getCell(t,i)).isMergedCell()||(s=c.getContent(t,i),c.isTextNoEmptyCell()&&(u=(l=s.toRichText()).getLength()),u=u||o.length,(d=l||new r({text:o})).setStyles(0,u,e),n.executeAtomicCommand(new g({table:a,content:d,cellRect:{row:t,col:i}})))})},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._linkSrc=e.src,this._linkStyles=e.inlineStyles)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(e.src=this._linkSrc,e.inlineStyles=this._linkStyles),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(3);return t=o.extend({name:"atom.SetCatalogueHref",_href:null,_block:null,_oldHref:null,initialize:function(){var e=this.options,n=e.args;r.isCollabCommand(n)||(this._block=e.block||n.block,this._href=e.href||n.href),t.__super__.initialize.apply(this,arguments)},apply:function(){var e=this._href,t=this._block;t.setHref&&(this._oldHref=t.getHref(),t.setHref(e))},doUnapply:function(){this._block.setHref(this._oldHref)},getEndingRange:function(){return this.options.args.range},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._block=e.getBlockById(o.blockId),this._href=o.styleNameValues,this._oldHref=o.oldStyleNameValues)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.blockId=this._block.getId(),e.styleNameValues=this._href,e.oldStyleNameValues=this._oldHref),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(93),a=n(12),s=n(8),l=n(33),c=n(37),d=n(3),u=n(18),h=n(2);return t=o.extend({name:"comp.InsertCode",_cmdArgs:null,_note:null,newBlkId:null,multiResult:null,splitCodeResult:null,convertToCodeResult:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),this.options.args.range&&this.calculateNewBlocks()},apply:function(){var e,t,n,o=this._cmdArgs.range,i=o.getStartBlockRange(),a=o.getEndBlockRange(),s=i.block,d=a.block,p=this._note.getPreBlock(s);if(this.multiResult||this.splitCodeResult||this.convertToCodeResult||this.calculateNewBlocks(),o.isInMultiBlock())return e=this.multiResult.selectedBlocks,n=this.multiResult.willBeInsertedBlocks,this.executeAtomicCommand(new c({note:this._note,blocks:e})),this.executeAtomicCommand(new l({note:this._note,newBlks:n,preBlk:p})),h.isCode(n[0])?(t=r.createBeginRange(n[0]),u.setCodeBlockAsEndingRange(this,t,i.start,0)):u.setTextBlockAsEndingRange(this,n[0],0,0),!0;this.handleInSingleBlock(d)},calculateNewBlocks:function(){var e,t=this.options.args.range;t&&(e=t.getEndBlockRange().block),t&&t.isInMultiBlock()?this.multiResult=this.handleInMultiBlock():h.isCode(e)?this.splitCodeResult=this.splitCodeBlock(e):this.convertToCodeResult=this.convertToCode(e)},handleInSingleBlock:function(e){var t,n,o=this._note,i=this._note.getPreBlock(e),a=this._cmdArgs.range.getStartBlockRange(),s=0;h.isCode(e)?(this.executeAtomicCommand(new c({note:this._note,blocks:[e]})),t=this.splitCodeResult,this.executeAtomicCommand(new l({note:o,newBlks:t,preBlk:i})),u.setTextBlockAsEndingRange(this,t[a.startLineIndex-1],a.startLineCharIndex,a.startLineCharIndex)):(this.executeAtomicCommand(new c({note:o,blocks:[e]})),this.executeAtomicCommand(new l({note:o,newBlks:this.convertToCodeResult.newBlocks,preBlk:i})),h.isTextBlock(a.block)&&(s=a.start),n=r.createBeginRange(this.convertToCodeResult.newCode),u.setCodeBlockAsEndingRange(this,n,s,0))},handleInMultiBlock:function(){var e,t,n,o=this,i=o._cmdArgs.range,r=i.getStartBlockRange(),l=i.getEndBlockRange(),c=r.block,d=l.block,p=o._note.getNextBlock(d);if(i.isInMultiBlock())return t=(e=o._note.getInterBlocks(c,d,!0)).map(function(e){return h.isTextBlock(e)?e.getText():e}),n=(n=t.reduce(function(t,n,i){var r,a=0===t.length?null:t[t.length-1];return n instanceof s?a&&h.isCode(a)?a.pushNewLineText(n):((r=u.createNewCode(e[i],{id:e[i].getId(),checked:o._checked})).pushNewLineText(n),t.push(r)):t.push(n),t},[])).reduce(function(e,t,o){var i=o+1<n.length?n[o+1]:p;return h.isCode(t)?(e.push(t),(!i||i&&!h.isTextBlock(i))&&e.push(a.createBlank())):e.push(t),e},[]),o.handleNewBlockIds(n),{selectedBlocks:e,willBeInsertedBlocks:n}},splitCodeBlock:function(e){var t;return t=e.getRichTexts().map(function(t){return u.createNewParagraph(e,null,t)}),this.handleNewBlockIds(t),t},convertToCode:function(e){var t,n=e.getId(),o=this._note.getPreBlock(e),i=this._note.getNextBlock(e),r=[];return t=u.createNewCode(e,{id:n,checked:this._checked}),h.isTextBlock(e)?t.pushNewLineText(e.getText()):t.pushNewLineText(""),r.push(t),!h.isCode(i)&&h.isTextBlock(i)||r.push(a.createBlank()),o&&h.isTextBlock(o)&&!h.isCode(o)||r.unshift(a.createBlank()),this.handleNewBlockIds(r),{newBlocks:r,newCode:t}},handleNewBlockIds:function(e){var t=this;t.newBlkId||(t.newBlkId=[]),t.newBlkId.length?e.forEach(function(e){e.setId(t.newBlkId.shift())}):e.forEach(function(e){var n=d.newGUID();t.newBlkId.push(n),e.setId(n)})},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this.newBlkId=e.newBlkId)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this.newBlkId),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(18),a=n(1),s=n(2),l=n(0),c=n(17),d=n(30),u=n(29),h=n(26),p=n(37),g=n(33),f=n(509),m=n(3);return t=o.extend({name:"comp.InsertList",_cmdArgs:null,_note:null,_listType:null,_listId:null,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,e=this._cmdArgs.range,t.__super__.initialize.apply(this,arguments),!m.isCollabCommand(this._cmdArgs)){if(!e)return this.isReadyToApply=!1,void a.error(this.name+":note range should NOT be null");if(n=e.getStartBlockRange().block,e.isInSingleBlock()&&!s.isTextBlock(n))return this.isReadyToApply=!1,void a.error("Single Block must be text block:",this.name,e);if(e.isInSingleBlock()&&s.isListItem(n)&&l.some(n.getOwnerList().getItems(),function(e){return e.isLocked()}))return void(this.isReadyToApply=!1);this._listType=this._cmdArgs.type,this._listId=m.newGUID()}},apply:function(){return this._cmdArgs.range.isInSingleBlock()?this._handleSingleBlockSelection():this._handleMultiBlockSelection(),!0},_handleMultiBlockSelection:function(){var e,t,n,o,i,a,f,m,y=this._cmdArgs.range,_=y.getStartBlockRange(),I=_.block,b=this._note.getPreBlock(I),v=y.getEndBlockRange(),k=v.block,C=this._note.getInterBlocks(I,k,!0),w=[],A=!0;for(o=0;o<C.length;++o)if(e=C[o],s.isListItem(e)){if(t=e.getOwnerList(),n&&n.getId()!==t.getId()){A=!1;break}n=t}else if(s.isTextBlock(e)){A=!1;break}A&&n.getType()===this._listType?l.each(C,function(e){"getLevel"in e&&e.getLevel()&&e.setBlockStyle("indent",e.getLevel()-1),s.isTextBlock(e)?w.push(r.createNewParagraph(e,e.getId(),e.getText())):w.push(e)}):(a=s.isListItem(b)&&b.getType()===this._listType?b.getOwnerList():new u({type:this._listType,listId:this._listId}),l.each(C,function(e){e.resetLockState(),s.isTextBlock(e)?s.isListItem(e)?((i=new h({id:e.getId(),level:e.getLevel(),list:a,text:e.getText()})).setBlockStyles(e.getBlockStyles()),w.push(i)):((i=new h({id:e.getId(),level:1,list:a,text:e.getText()})).setBlockStyles(e.getBlockStyles()),f=i.getBlockStyle("indent")||0,m=i.getBlockStyle("text-indent")||0,0!==f&&(i.setLevel(f+i.getLevel()),i.setBlockStyle("indent",0)),0!==m&&(i.setLevel(m+i.getLevel()),i.setBlockStyle("text-indent",0)),w.push(i)):w.push(e)})),l.isEmpty(w)||(this.executeAtomicCommand(new p({note:this._note,blocks:C})),this.executeAtomicCommand(new g({note:this._note,newBlks:w,preBlk:b})),s.isTextBlock(_.block)&&(_=d.createRangeByBlock({block:w[0],start:_.start,end:_.end})),v=w.length>1&&s.isTextBlock(v.block)?d.createRangeByBlock({block:l.last(w),start:v.start,end:v.end}):_,y=c.create({startRange:_,endRange:v})),this.setEndingRange(y)},_handleSingleBlockSelection:function(){var e,t,n,o,i=this._cmdArgs.range,a=i.getStartBlockRange().block;s.isListItem(a)?(n=a.getOwnerList()).getType()!==this._listType?(this.executeAtomicCommand(new f({lists:[n],isToggle:!0})),this.setEndingRange(i)):(o=r.replaceBlockWithParagraph(this,this._note,a,a.getText()),r.setTextBlockAsEndingRange(this,o,o.getLength(),o.getLength())):(e=this._note.getPreBlock(a),t=this._note.getNextBlock(a),e&&s.isListItem(e)&&e.getOwnerList().getType()===this._listType?o=r.replaceBlockWithListItem(this,this._note,e,a,a.getText(),e):t&&s.isListItem(t)&&t.getOwnerList().getType()===this._listType?o=r.replaceBlockWithListItem(this,this._note,t,a,a.getText(),e):(n=new u({type:this._listType,listId:this._listId}),(o=new h({id:a.getId(),level:1,list:n,text:a.getText()})).setBlockStyles(a.getBlockStyles()),this.executeAtomicCommand(new p({note:this._note,blocks:[a]})),this.executeAtomicCommand(new g({note:this._note,newBlks:[o],preBlk:e}))),r.setTextBlockAsEndingRange(this,o,o.getLength(),o.getLength()))},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._listId=e.listId,this._listType=e.listType)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(e.listId=this._listId,e.listType=this._listType),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(29),s=n(2),l=n(3);return t=o.extend({name:"atom.SetListType",_lists:null,_newTypes:null,_oldTypes:null,initialize:function(){var e=this,n=e.options,o=n.args;t.__super__.initialize.apply(e),l.isCollabCommand(o)||(e._lists=n.lists,e._newTypes={},n.newType?r.each(e._lists,function(t,o){e._newTypes[o]=n.newType}):n.isToggle&&r.each(e._lists,function(t,n){e._newTypes[n]=t.isOrdered()?a.UNORDERED:a.ORDERED}))},apply:function(){var e=this;return e._oldTypes={},r.each(e._newTypes,function(t,n){e._oldTypes[n]=e._lists[n].getType(),t!==e._lists[n].getType()&&e._lists[n].setType(t)}),!0},doUnapply:function(){var e=this;return r.each(e._oldTypes,function(t,n){e._lists[n].getType()!==t&&e._lists[n].setType(t)}),!0},fromCollabJSON:function(){var e,n=this.options.args,o=n.collabProperties.cmdJSON;o&&(e=n.collabProperties.coreEditor.getNote(),o.dataBefore&&(this._oldTypes=o.dataBefore),this._newTypes=o.dataAfter,this._lists=this._getListByIds(e,o.listId)),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e=[],n=t.__super__.toCollabJSON.apply(this);return this._oldTypes&&(n.dataBefore=this._oldTypes),n.dataAfter=this._newTypes,r.each(this._lists,function(t){e.push(t.getId())}),n.listId=e,n},_getListByIds:function(e,t){var n=[];return r.some(e.getAllBlocks(),function(e){return s.isListItem(e)&&e.getOwnerList()&&r.contains(t,e.getOwnerList().getId())&&n.push(e.getOwnerList()),n.length===t.length}),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(122),i=n(4),r=n(55),a=n(33),s=n(3),l=n(67),c=n(18);return t=o.extend({name:"comp.InsertTable",_cmdArgs:null,_note:null,_tableBlkId:null,_columnNums:null,_rowNums:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),s.isCollabCommand(this._cmdArgs)||(this._tableBlkId=s.newGUID(),this.skipBlockLocking=!0,this._columnNums=1,this._rowNums=1,this._cmdArgs.cols&&(this._columnNums=this._cmdArgs.cols),this._cmdArgs.rows&&(this._rowNums=this._cmdArgs.rows))},insertResource:function(e,t,n){var o,i=[];return o=r.createBlankTable(this._columnNums,this._rowNums,this._tableBlkId,l.DEFAULT_TABLE_WIDTH),c.setResourceBlockStyleByPreBlock(o,e),t&&i.push(t),i.push(o),n&&i.push(n),this.executeAtomicCommand(new a({note:this._note,newBlks:i,preBlk:e})),o},_initArray:function(e,t){for(var n=[];e--;)n[e]=t;return n},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._tableBlkId=e.newBlkId,this._columnNums=e.colNums,this._rowNums=e.rowNums)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._tableBlkId,e.colNums=this._columnNums,e.rowNums=this._rowNums),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(30),a=n(17),s=n(33),l=n(37),c=n(3),d=n(18),u=n(2);return t=o.extend({name:"comp.InsertTodo",_cmdArgs:null,_note:null,_todoBlkId:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),c.isCollabCommand(this._cmdArgs)||(this._todoBlkId=c.newGUID(),this._checked=this._cmdArgs.checked)},apply:function(){var e,t,n,o,i=this,s=i._cmdArgs.range,l=s.getStartBlockRange(),c=s.getEndBlockRange(),h=l.block,p=c.block;s.isInMultiBlock()?(o=i._note.getInterBlocks(h,p,!0),n=o.every(function(e){return u.isTodo(e)||!u.isTextBlock(e)}),o.forEach(function(r,a){0!==a?a!==o.length-1?i._helpSetBlock(r,n):t=i._helpSetBlock(r,n):e=i._helpSetBlock(r,n)}),l=r.createRangeByBlock({block:e,start:l.start,end:l.end}),c=r.createRangeByBlock({block:t,start:c.start,end:c.end}),s=a.create({startRange:l,endRange:c}),i.setEndingRange(s)):(t=i._helpSetBlock(p,!0),d.setTextBlockAsEndingRange(i,t,c.start,c.end))},_helpSetBlock:function(e,t){var n,o,i=this._note,r=e.getId();return u.isTodo(e)?n=t?d.replaceBlockWithParagraph(this,this._note,e,e.getText()):e:u.isTextBlock(e)&&(o=i.getPreBlock(e),n=d.createNewTodo(e,{id:r,text:e.getText(),checked:this._checked}),this.executeAtomicCommand(new l({note:i,blocks:[e]})),this.executeAtomicCommand(new s({note:i,newBlks:[n],preBlk:o}))),n},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._todoBlkId=e.newBlkId,this._checked=e.simpleValue1)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._todoBlkId,e.simpleValue1=this._checked),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(30),a=n(17),s=n(33),l=n(37),c=n(3),d=n(18),u=n(2);return t=o.extend({name:"comp.InsertQuote",_cmdArgs:null,_note:null,_quoteBlkId:null,_checked:!1,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},t.__super__.initialize.apply(this,arguments),c.isCollabCommand(this._cmdArgs)||(this._quoteBlkId=c.newGUID())},apply:function(){var e,t,n,o,i=this,s=i._cmdArgs.range,l=s.getStartBlockRange(),c=s.getEndBlockRange(),h=l.block,p=c.block;s.isInMultiBlock()?(o=i._note.getInterBlocks(h,p,!0),n=o.every(function(e){return u.isQuote(e)||!u.isTextBlock(e)}),o.forEach(function(r,a){0!==a?a!==o.length-1?i._helpSetBlock(r,n):t=i._helpSetBlock(r,n):e=i._helpSetBlock(r,n)}),l=r.createRangeByBlock({block:e,start:l.start,end:l.end}),c=r.createRangeByBlock({block:t,start:c.start,end:c.end}),s=a.create({startRange:l,endRange:c}),i.setEndingRange(s)):(t=i._helpSetBlock(p,!0),d.setTextBlockAsEndingRange(i,t,c.start,c.end))},_helpSetBlock:function(e,t){var n,o,i=this._note,r=e.getId();return u.isQuote(e)?n=t?d.replaceBlockWithParagraph(this,this._note,e,e.getText()):e:u.isTextBlock(e)&&(o=i.getPreBlock(e),n=d.createNewQuote(e,{id:r,text:e.getText(),checked:this._checked}),this.executeAtomicCommand(new l({note:i,blocks:[e]})),this.executeAtomicCommand(new s({note:i,newBlks:[n],preBlk:o}))),n},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._quoteBlkId=e.newBlkId)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.newBlkId=this._quoteBlkId),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(2),s=n(18),l=n(211),c=n(37),d=n(78),u=n(138),h=n(91),p=n(209),g=n(141),f=n(120),m=n(86),y=n(3);return t=o.extend({name:"comp.KeyBackspace",_cmdArgs:null,_note:null,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,this._inlineStyles=this._cmdArgs.inlineStyles,t.__super__.initialize.apply(this),!y.isCollabCommand(this._cmdArgs)){if(n=(e=this._cmdArgs.range).getStartBlockRange().block,!e)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(e.isInSingleBlock()&&a.isTable(n))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.")}},apply:function(){var e,t,n,o,i,r,l,d,u=this._cmdArgs.range,p=[];if(t=(e=u.getStartBlockRange()).block,i=o=u.getEndBlockRange().block,r=this._note.getPreBlock(t),d=this._cmdArgs.inlineStyles,a.isCode(t))return e.selectWholeBlock?(i=s.replaceBlockWithParagraph(this,this._note,t,""),s.setTextBlockAsEndingRange(this,i,0,0)):u.isCollapsed()?(n=this._deleteCodeText(t,e),s.setCodeBlockAsEndingRange(this,n,0)):(s.deleteSelectedContent(this,this._note,u),s.setCodeBlockAsEndingRange(this,e,0)),!0;if(u.isCollapsed()||s.deleteSelectedContent(this,this._note,u),u.isCollapsed()&&a.isTextBlock(t))return 0===e.start?this._deleteAtTextBlockStart(r,t,d):this._deleteAtTextBlockMiddle(t,e.start);if(u.isInSingleBlock()&&a.isTextBlock(t))return s.setTextBlockAsEndingRange(this,t,e.start,e.start),!0;if(a.isTextBlock(t)||(r&&!a.isTable(r)?(p.push(t),i=r,a.isTextBlock(r)&&(l=r.getLength())):(i=s.replaceBlockWithParagraph(this,this._note,t,""),l=0)),u.isInMultiBlock(o)&&(a.isTextBlock(o)?a.isTextBlock(t)&&!a.isCode(o)?(this.executeAtomicCommand(new h({block:t,start:t.getLength(),text:o.getText()})),p.push(o),l=e.start,i=t):(l=0,i=o):p.push(o)),p.length>0&&this.executeAtomicCommand(new c({note:this._note,blocks:p})),a.isTextBlock(i)){if(a.isCode(i))return s.setCodeBlockAsEndingRange(),!0;s.setTextBlockAsEndingRange(this,i,l,l)}else this.setEndingRange(m.buildNoteRangeFromNonTextBlock(i));return!0},_deleteAtTextBlockStart:function(e,t,n){var o,i,r;return a.isListItem(t)?(t.getIndex()>0&&t.getLevel()>1?this.executeAtomicCommand(new g({listItems:[t],newLevel:t.getLevel()-1})):t=s.replaceBlockWithParagraph(this,this._note,t,t.getText(),n),s.setTextBlockAsEndingRange(this,t,0,0),!0):a.isTodo(t)||a.isQuote(t)?(t=s.replaceBlockWithParagraph(this,this._note,t,t.getText(),n),s.setTextBlockAsEndingRange(this,t,0,0),!0):(i=t.getBlockStyle("text-indent"))&&i>0?(this.executeAtomicCommand(new p({blocks:[t],styleNameValues:{"text-indent":i-1}})),s.setTextBlockAsEndingRange(this,t,0,0),!0):(o=t.getBlockStyle("indent"))&&o>0?(this.executeAtomicCommand(new p({blocks:[t],styleNameValues:{indent:o-1}})),s.setTextBlockAsEndingRange(this,t,0,0),!0):e?!a.isTextBlock(e)||a.isCode(e)?(a.isHr(e)?(this.executeAtomicCommand(new c({note:this._note,blocks:[e]})),s.setTextBlockAsEndingRange(this,t,0,0)):this.setEndingRange(m.buildNoteRangeFromNonTextBlock(e)),!0):(r=e.getLength(),this.executeAtomicCommand(new h({block:e,start:e.getLength(),text:t.getText()})),this.executeAtomicCommand(new c({note:this._note,blocks:[t]})),s.setTextBlockAsEndingRange(this,e,r,r),!0):(s.setTextBlockAsEndingRange(this,t,0,0),!0)},_deleteAtTextBlockMiddle:function(e,t){f.isAtHrefBorder(e,t,!0)?this._deleteHrefAtCursorPos(e,t):(this.executeAtomicCommand(new d({block:e,start:t-1,end:t,inlineStyles:this._inlineStyles})),s.setTextBlockAsEndingRange(this,e,t-1,t-1))},_deleteHrefAtCursorPos:function(e,t){var n;-1!==(n=f.findHrefBorder(e,t,!0))&&s.deleteHref(this,e,n,t)},_deleteCodeText:function(e,t){var n=t.clone(),o=t.block.getLineInfo(t.startLineIndex),i=t.block.getLineInfo(t.startLineIndex-1);return 0===t.startLineCharIndex?i&&(n.startLineIndex=t.startLineIndex-1,n.startLineCharIndex=i.lineLength):o.lineStartSpacesNum===t.startLineCharIndex?l.keyBackspace.currentLineIsEmpty.backToLineStart||!i?n.startLineCharIndex=0:(n.startLineIndex=t.startLineIndex-1,n.startLineCharIndex=i.lineLength):n.startLineCharIndex=t.startLineCharIndex-1,n.startLineIndex<t.startLineIndex&&s.getNoteView(this).getBlockViewByBlock(e).scrollRightByIndex(n.startLineIndex),this.executeAtomicCommand(new u({block:e,start:t.start,startBlockRange:n,endBlockRange:t,inlineStyles:this._inlineStyles})),n},isSingleBlockAffected:function(){var e,n=this._args.range,o=t.__super__.isSingleBlockAffected.apply(this),i=0;return o&&n.isCollapsed()&&(i=(e=n.getStartBlockRange()).start,this._note.getPreBlock(e.block)&&0===i&&(o=!1)),o}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(246),i=n(4),r=n(1),a=n(2),s=n(3);return t=o.extend({name:"comp.KeyDelete",_cmdArgs:null,_note:null,initialize:function(){var e,n,o,i,l;if(this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),!s.isCollabCommand(this._cmdArgs)){if(i=(n=(e=this._cmdArgs.range).getStartBlockRange()).block,l=(o=e.getEndBlockRange()).block,!e)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(e.isInSingleBlock()&&a.isTable(i))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.");if(e.isInSingleBlock()&&a.isTextBlock(i)&&e.isCollapsed()&&n.start===i.getLength()&&!this._note.getNextBlock(i))return this.isReadyToApply=!1,void r.warn("do NOT support the command at the end of note:",this.name);a.isTextBlock(l)&&o.end===l.getLength()&&a.isCatalogue(this._note.getNextBlock(l))&&(this.isReadyToApply=!1,r.warn("do NOT support when next is Catalogue block."))}},isSingleBlockAffected:function(){var e,n,o=this._args.range,i=t.__super__.isSingleBlockAffected.apply(this),r=0;return i&&o.isCollapsed()&&(e=(n=o.getStartBlockRange()).block,r=n.start,this._note.getNextBlock(e)&&r===e.getEndOffset()&&(i=!1)),i},isValidStartNoteRange:function(){var e,t,n=!0;return(e=this.getStartingRange())&&e.isInSingleBlock()&&(t=e.getStartBlockRange().block,a.isTable(t)&&(n=!1)),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(0),s=n(2),l=n(8),c=n(51),d=n(18),u=n(211),h=n(33),p=n(121),g=n(78),f=n(37),m=n(141),y=n(120),_=n(3);return t=o.extend({name:"comp.KeyEnter",_note:null,_cmdArgs:null,_newBlkId:null,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),!_.isCollabCommand(this._cmdArgs)){if(n=(e=this._cmdArgs.range).getStartBlockRange().block,!e)return this.isReadyToApply=!1,void r.error(this.name+":note range should NOT be null");if(e.isInSingleBlock()&&s.isTable(n))return this.isReadyToApply=!1,void r.error("should NOT trigger the cmd when in Table.");this._newBlkId=_.newGUID()}},apply:function(){var e,t,n,o,i,r,l=this._cmdArgs.range,c=!1,u=null,h=[];return i=t=(e=l.getStartBlockRange()).block,r=n=l.getEndBlockRange().block,l.isCollapsed()||d.deleteSelectedContent(this,this._note,l),s.isTextBlock(t)&&!s.isCode(t)&&(s.isCatalogue(t)||(i=s.isQuote(t)&&t.richText.getLength()?d.createNewQuote(t,{id:t.getId(),text:t.getText()}):d.createNewParagraph(t,t.getId(),t.getText()),y.isAtHrefBorder(i,e.start,!0)&&d.deleteHref(this,i,0,t.getLength())),d.recogLink(this,t,0,t.getLength())),l.isInMultiBlock()?(s.isTextBlock(t)||(i=d.replaceBlockWithParagraph(this,this._note,t,"")),s.isTextBlock(n)||(r=d.replaceBlockWithParagraph(this,this._note,n,"")),s.isListItem(i)?r=this._replaceBlockWithListItem(r,i,r.getText()):s.isTextBlock(i)&&s.isListItem(r)&&(r=d.replaceBlockWithParagraph(this,this._note,r,r.getText())),d.setTextBlockAsEndingRange(this,r,0,0),!0):(s.isTextBlock(t)?s.isCode(t)||(o=t.sliceText(e.start,t.getLength()),this.executeAtomicCommand(new g({block:t,start:e.start,end:t.getLength()}))):i=d.replaceBlockWithParagraph(this,this._note,t,""),s.isListItem(t)?t.isEmpty()&&0===o.getLength()?r=i=this._reduceListItemLevel(t):(r=this._insertListItem(t,this._newBlkId,o,this._cmdArgs.inlineStyles),c=!0):(s.isHeading(t)?r=o.toString().length>0?this._insertHeading(i,this._newBlkId,o,t.getLevel()):this._insertParagraph(i,this._newBlkId,o):s.isCatalogue(t)?r=this._insertCatalogueHelp(i,{startBlock:t,paraId:this._newBlkId,text:o}):s.isTodo(t)?r=t.isEmpty()&&0===o.getLength()?d.replaceBlockWithParagraph(this,this._note,t,""):this._insertTodo(i,{startBlock:t,id:this._newBlkId,text:o,checked:!1,inlineStyles:this._cmdArgs.inlineStyles}):s.isQuote(t)?r=t.isEmpty()&&0===o.getLength()?d.replaceBlockWithParagraph(this,this._note,t,""):this._insertQuote(i,{id:this._newBlkId,text:o,inlineStyles:this._cmdArgs.inlineStyles}):s.isCode(t)?e.selectWholeBlock?r=d.replaceBlockWithParagraph(this,this._note,t,""):u=this._insertCodeLine(e):r=this._insertParagraph(i,this._newBlkId,o,this._cmdArgs.inlineStyles),c=!0),r.setInlineStylesForEmpty(this._cmdArgs.inlineStyles),s.isCode(r)?(d.getNoteView(this).getBlockViewByBlock(r).scrollToStart(),d.setCodeBlockAsEndingRange(this,e,u.newCursorOffset,Number(!!u.insertedChars))):d.setTextBlockAsEndingRange(this,r,0,0),a.each(this._note.getInterBlocks(t,n,!0),function(e){h.push(e.getId())}),c&&h.push(this._newBlkId),this.pushAffectedBlockIds(h),!0)},_insertListItem:function(e,t,n,o){var i;return i=d.createNewListItem(e,t,n),d.setBlockStyle(i,o),this.executeAtomicCommand(new h({note:this._note,newBlks:[i],preBlk:e})),i},_insertParagraph:function(e,t,n,o){var i;if(i=d.createNewParagraph(e,t,n,!o))return o&&d.setBlockStyle(i,o),this.executeAtomicCommand(new h({note:this._note,newBlks:[i],preBlk:e})),i},_insertHeading:function(e,t,n,o){var i;return i=d.createNewHeading(e,t,n,o,!0),this.executeAtomicCommand(new h({note:this._note,newBlks:[i],preBlk:e})),i},_insertTodo:function(e,t){var n;return n=d.createNewTodo(e,t),d.setBlockStyle(n,t.inlineStyles),this.executeAtomicCommand(new h({note:this._note,newBlks:[n],preBlk:e})),n},_insertQuote:function(e,t){var n;return n=d.createNewQuote(e,t),d.setBlockStyle(n,t.inlineStyles),this.executeAtomicCommand(new h({note:this._note,newBlks:[n],preBlk:e})),n},_insertCodeLine:function(e){var t,n,o,i,r=0,a=e.block.getLineInfo(e.startLineIndex);return e.startLineCharIndex===a.lineLength&&(r=u.keyEnter.whenEndCharIs[a.lineEndChar]||u.keyEnter.whenEndCharIs.default),e.startLineCharIndex===a.lineLength-1&&(n=a.lineText.slice(a.lineText.length-2),(o=["{}","()","[]"].indexOf(n)>-1)&&(r=4)),t=c.LINE_BREAK+" ".repeat(a.lineStartSpacesNum+r),o&&(t+=c.LINE_BREAK+" ".repeat(a.lineStartSpacesNum)),i=new l({text:t}),this.executeAtomicCommand(new p({block:e.block,startBlockRange:e,text:i})),{insertedChars:t,isBetweenPairs:o,newCursorOffset:o?t.length-a.lineStartSpacesNum-2:t.length-1}},_insertCatalogueHelp:function(e,t){var n=t.startBlock;return t.text.getLength()<1?t.href="":t.href=n.getHref(),this._insertCatalogue(e,t)},_insertCatalogue:function(e,t){var n;return n=d.createNewCatalogue(e,t),this.executeAtomicCommand(new h({note:this._note,newBlks:[n],preBlk:e})),n},_reduceListItemLevel:function(e){var t=e;return e.getLevel()<=1?t=d.replaceBlockWithParagraph(this,this._note,e,""):this.executeAtomicCommand(new m({listItems:[e],newLevel:e.getLevel()-1})),t},_replaceBlockWithListItem:function(e,t,n){return this.executeAtomicCommand(new f({note:this._note,blocks:[e]})),this._insertListItem(t,e.getId(),n,this._cmdArgs.inlineStyles)},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._newBlkId=e.newBlkId)},isSingleBlockAffected:function(){return!1},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.newBlkId=this._newBlkId,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(2),s=n(8),l=n(18),c=n(211),d=n(78),u=n(121),h=n(138),p=n(141),g=n(3);return t=o.extend({name:"comp.KeyTab",_cmdArgs:null,_note:null,_withShiftKey:!1,initialize:function(){var e,n;if(this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),!g.isCollabCommand(this._cmdArgs)){if(e=this._cmdArgs.range,this._cmdArgs.withShiftKey&&(this._withShiftKey=!0),!e||!e.canDrawedByNative())return r.error(this.name+":note range should NOT be null"),void(this.isReadyToApply=!1);if(n=e.getStartBlockRange().block,e.isInSingleBlock()&&!a.isTextBlock(n))return void(this.isReadyToApply=!1)}},apply:function(){var e,t,n,o,i,r,s=this._cmdArgs.range,c=1;if(t=(e=s.getStartBlockRange()).block,n=s.getEndBlockRange().block,this._withShiftKey&&(c=-1),(i=s.isInMultiBlock())||0===e.start&&e.end===t.getLength())return r=!i,o=this._note.getInterBlocks(t,n,!0),l.isInSameList(o)?this._isFirstListItem(o[0])?l.updateBlocksIndentLevel(this,o[0].getOwnerList().getItems(),c):this.executeAtomicCommand(new p({listItems:o,deltaLevel:c})):this._withShiftKey&&r?t.getBlockStyle("text-indent")?this._updateBlockTextIndent(t,c):l.updateBlocksIndentLevel(this,[t],c):r&&0===e.end?this._updateBlockTextIndent(t,c):l.updateBlocksIndentLevel(this,o,c),this.setEndingRange(s),!0;0===e.start?a.isListItem(t)?this._isFirstListItem(t)?(l.updateBlocksIndentLevel(this,t.getOwnerList().getItems(),c),this.setEndingRange(s)):(this.executeAtomicCommand(new p({listItems:[t],deltaLevel:c})),this.setEndingRange(s)):this._withShiftKey?t.getBlockStyle("text-indent")?this._updateBlockTextIndent(t,c):(l.updateBlocksIndentLevel(this,[t],c),this.setEndingRange(s)):this._updateBlockTextIndent(t,c):this._withShiftKey?this._handleShiftTabNotAtStart(e):this._insertTabChar()},_handleShiftTabNotAtStart:function(e){var t,n,o,i,r=e.block,s=!0;if(a.isCode(r))return this._decreaseIndent(e);for(t=r.getText().getReadOnlyData(),i=(n=e.start)-1;i>=0;i--)if("\t"!==t[i].char){if(" "!==t[i].char){s=!1;break}n-i==4&&(o=i)}else o||(o=i);s?(o=o||0,this.executeAtomicCommand(new d({block:r,start:o,end:n})),l.setTextBlockAsEndingRange(this,r,o,o)):this._insertTabChar()},_insertTabChar:function(){var e,t,n=this._cmdArgs.inlineStyles,o=this._cmdArgs.range,i=0,r=o.getStartBlockRange(),d=o.getEndBlockRange(),h=r.clone(),p=r.clone();if(a.isCode(r.block)&&o.isInSingleBlock()){for(t=r.startLineIndex;t<=d.endLineIndex;t++)e=new s({text:" ".repeat(c.keyTab.addSpacesNum)}),h.startLineIndex=t,h.startLineCharIndex=0,this.executeAtomicCommand(new u({block:r.block,startBlockRange:h,text:e}));return p.startLineCharIndex+=4,i=p.endLineCharIndex+c.keyTab.addSpacesNum,void(r.isCollapsed()?l.setCodeBlockAsEndingRange(this,p,0):l.expandCodeRange(this,p,i,p.endLineIndex-p.startLineIndex))}l.deleteSelectedContent(this,this._note,o),l.insertTabChar(this,r.block,r.start,n),l.setTextBlockAsEndingRange(this,r.block,r.start+1,r.start+1)},_decreaseIndent:function(e){var t,n,o,i=e.block,r=e.clone(),a=e.clone(),s=[];for(t=e.startLineIndex;t<=e.endLineIndex;t++)0!==(n=i.getLineInfo(t).lineStartSpacesNum)?(o=n<4?n:4,r.startLineIndex=t,r.endLineIndex=t,r.startLineCharIndex=0,r.endLineCharIndex=o,s.push(o),this.executeAtomicCommand(new h({block:e.block,startBlockRange:r,endBlockRange:r}))):s.push(0);a.startLineCharIndex=Math.max(a.startLineCharIndex-s.shift(),0),l.expandCodeRange(this,a,a.endLineCharIndex-s.pop()||0,a.endLineIndex-a.startLineIndex)},_isFirstListItem:function(e){return 1===e.getLevel()&&1===e.getIndex()},_updateBlockTextIndent:function(e,t){l.updateBlockTextIndentLevel(this,e,t),this.setEndingRange(this._cmdArgs.range)},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;e&&e.simpleValue1&&(this._withShiftKey=!0),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return this._withShiftKey&&(e.simpleValue1=!0),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(8),a=n(18),s=n(1),l=n(2),c=n(37),d=n(91),u=n(121),h=n(103),p=n(3);return t=o.extend({name:"comp.KeyTextInput",_cmdArgs:null,_note:null,_inputtedText:null,_recogLink:!1,initialize:function(){var e;if(this._note=this.options.note,this._cmdArgs=this.options.args,e=this._cmdArgs.range,t.__super__.initialize.apply(this,arguments),!p.isCollabCommand(this._cmdArgs)){if(!e)return this.isReadyToApply=!1,void s.error(this.name+":note range should NOT be null");this._recogLink=this._cmdArgs.recogLink,this._inputtedText=this._cmdArgs.text}},apply:function(){var e,t,n,o,i,s,h,p,g=!0,f=this._cmdArgs.range;if(n=t=(e=f.getStartBlockRange()).block,i=e.start,o=f.getEndBlockRange().block,f.isInSingleBlock()&&l.isTable(t))return this._insertTextInTable(e,t,this._inputtedText);if(f.isCollapsed()||l.isCode(n)||a.deleteSelectedContent(this,this._note,f),l.isTextBlock(t,e)||(n=a.replaceBlockWithParagraph(this,this._note,t,""),i=0),f.isInMultiBlock()&&(l.isTextBlock(o)&&(p=o.getText()),this.executeAtomicCommand(new c({note:this._note,blocks:[o]}))),s=i+this._inputtedText.getLength(),p&&this._inputtedText.append(p),l.isCode(n)){switch(f.isCollapsed()||a.deleteSelectedContent(this,this._note,f),h=this._inputtedText.toString()){case"{":h+="}";break;case"(":h+=")";break;case"[":h+="]";break;default:g=!1}return this._inputtedText=new r({text:h}),this.executeAtomicCommand(new u({block:n,start:i,text:this._inputtedText,startBlockRange:e})),a.setCodeBlockAsEndingRange(this,e,this._inputtedText.getLength()-Number(g)),!0}return this.executeAtomicCommand(new d({block:n,start:i,text:this._inputtedText})),this._recogLink&&a.recogLink(this,n,0,i),a.setTextBlockAsEndingRange(this,n,s,s),!0},_insertTextInTable:function(e,t,n){var o,i;(o=e.getAsRectRange())&&(i=o.getFirstCell(),this.executeAtomicCommand(new h({table:t,cellRect:{row:i.row,col:i.col},content:n})))},canBeMerged:function(e){var n,o,i;if(t.__super__.canBeMerged.apply(this,[e])){if(!this.startingRange||!e.getStartingRange())return!1;if(n=this.startingRange.getStartBlockRange(),i=e.getStartingRange().getStartBlockRange(),!e.getStartingRange().isCollapsed())return!1;if(this.isLocalExecutedCmd){if(!this.endingRange)return!1;if(o=this.endingRange.getEndBlockRange(),!l.isTextBlock(o))return!1;if(i.getBlockId()!==o.getBlockId())return!1;if(o.end!==i.start)return!1}else{if(n.getBlockId()!==i.getBlockId())return!1;if(n.start!==i.start)return!1}return" "!==e.getInputtedText().toString()}return!1},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._inputtedText=r.fromCollabJSON(e.richText),e.recogLink&&(this._recogLink=!0))},getInputtedText:function(){return this._inputtedText},mergeLocalCmd:function(e){var t,n,o=e.getInputtedText();this.endingRange&&(t=this.endingRange.getEndBlockRange()),o&&o.getLength()>0&&(this._inputtedText.append(o),this.isLocalExecutedCmd&&(n=t.end+o.getLength(),a.setTextBlockAsEndingRange(this,t.block,n,n)))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e&&(e.richText=this._inputtedText.toCollabJSON(),this._recogLink&&(e.recogLink=this._recogLink)),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(1),a=n(18);return t=o.extend({name:"comp.RemoveFormat",_note:null,_cmdArgs:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this)},apply:function(){var e=this._cmdArgs.range;return!e||e.isCollapsed()?(r.error("collapsed时应该修改编辑器当前样式状态，不应进入此命令",e),!1):(a.resetAllStyles(this,this._note,e,this._args.blockStyles,this._args.inlineStyles,{resetAllStyles:this._args.resetAllStyles,isRemoveFormat:!0}),this.setEndingRange(e),!0)}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(0),a=n(520),s=n(3);return t=o.extend({name:"comp.ReplaceResource",_note:null,_cmdArgs:null,_resources:null,_resProps:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),s.isCollabCommand(this._cmdArgs)||(this._resources=this._cmdArgs.resources,this._resProps=this._cmdArgs.resProps,this.endingRange=this._cmdArgs.endingRange)},apply:function(){return this.executeAtomicCommand(new a({resources:this._resources,newResProps:this._resProps}),this.endingRange),!0},fromCollabJSON:function(){var e=this,n=e._cmdArgs.collabProperties.coreEditor,o=e._cmdArgs.collabProperties.cmdJSON;o&&(e._resProps=o.simpleValue1,e._resources=[],r.each(o.resIds,function(t){e._resources.push(n.getBlockById(t))}),o.simpleValue2&&(e._cmdArgs.ignoreUndoRedo=!0),o.endNoteRange&&(e.endingRange=o.endNoteRange)),t.__super__.fromCollabJSON.apply(e)},isSingleBlockAffected:function(){return!1},toCollabJSON:function(){var e=[],n=t.__super__.toCollabJSON.apply(this);return n&&(r.each(this._resources,function(t){e.push(t.getId())}),n.simpleValue1=this._resProps,n.resIds=e,this._cmdArgs.ignoreUndoRedo&&(n.simpleValue2=!0),n.endNoteRange=this.endingRange),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(2),s=n(3);return t=o.extend({name:"atom.SetResourceProps",_resources:null,_newResProps:null,_oldResProps:null,initialize:function(){var e=this.options,n=e.args;t.__super__.initialize.apply(this),s.isCollabCommand(n)||(this._resources=e.resources,this._newResProps=e.newResProps)},apply:function(){var e=this;return e._oldResProps={},r.each(e._resources,function(t,n){e._oldResProps[n]={},a.isImage(t)?(e._newResProps[n].source&&(e._oldResProps[n].source=t.getSource(),t.setSource(e._newResProps[n].source)),r.isUndefined(e._newResProps[n].title)||(e._oldResProps[n].title=t.getTitle(),t.setTitle(e._newResProps[n].title))):a.isAttachment(t)&&(e._newResProps[n].source&&(e._oldResProps[n].source=t.getSource(),t.setSource(e._newResProps[n].source)),e._newResProps[n].resource&&(e._oldResProps[n].resource=t.getResource(),t.setResource(e._newResProps[n].resource)),e._newResProps[n].fileName&&(e._oldResProps[n].fileName=t.getFileName(),t.setFileName(e._newResProps[n].fileName)),e._newResProps[n].fileLength&&(e._oldResProps[n].fileLength=t.getFileLength(),t.setFileLength(e._newResProps[n].fileLength)))}),!0},doUnapply:function(){var e=this;return r.each(e._resources,function(t,n){a.isImage(t)?(e._oldResProps[n].source&&t.setSource(e._oldResProps[n].source),r.isUndefined(e._oldResProps[n].title)||t.setTitle(e._oldResProps[n].title)):a.isAttachment(t)&&(e._oldResProps[n].source&&t.setSource(e._oldResProps[n].src),e._oldResProps[n].resource&&t.setResource(e._oldResProps[n].resource),e._oldResProps[n].fileName&&t.setFileName(e._oldResProps[n].fileName),e._oldResProps[n].fileLength&&t.setFileLength(e._oldResProps[n].fileLength))}),!0},fromCollabJSON:function(){var e,n=this.options.args,o=n.collabProperties.cmdJSON;o&&(e=n.collabProperties.coreEditor.getNote(),o.dataBefore&&(this._oldResProps=o.dataBefore),this._newResProps=o.dataAfter,this._resources=this._getResByIds(e,o.resIds)),t.__super__.fromCollabJSON.apply(this)},toCollabJSON:function(){var e=[],n=t.__super__.toCollabJSON.apply(this);return this._oldResProps&&(n.dataBefore=this._oldResProps),n.dataAfter=this._newResProps,r.each(this._resources,function(t){e.push(t.getId())}),n.resIds=e,n},_getResByIds:function(e,t){var n=[];return r.some(e.getAllBlocks(),function(e){return r.contains(t,e.getId())&&n.push(e),t.length===n.length}),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(11),r=n(4),a=n(2),s=n(18),l=n(49),c=n(50),d=n(8),u=n(6),h=n(37),p=n(33),g=n(3);return t=i.extend({name:"comp.RefreshCatalogue",_cmdArgs:null,_note:null,_ownerId:null,_delete:!1,_catalogueIds:null,_catalogues:null,_newCatalogues:null,_blankParaId:null,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args||{},this._ownerId=this._cmdArgs.ownerId,this._delete=this._cmdArgs.delete,t.__super__.initialize.apply(this,arguments),this._initBlocks()},_initBlocks:function(){var e,t,n=this,i=n._note.blocks,r=[],d=[],h=[];o.each(i,function(e){a.isCatalogue(e)&&e.getOwnerId()===n._ownerId&&r.push(e),s.isForCatalogueBlock(e)&&d.push(e)}),(r.length>0||!n._ownerId)&&(n._catalogueIds=n._catalogueIds||[],n._ownerId=n._ownerId||g.newGUID(),t=new c({id:n._ownerId}),o.each(d,function(o,i){e=new l({indent:o.getLevel()-1,text:o.getText().toString().trim(),href:o.getId(),ownerList:t}),h.push(e),n._catalogueIds[i]?e.setId(n._catalogueIds[i]):n._catalogueIds[i]=e.getId()}),0===d.length&&(e=new l({indent:0,text:u.INSERT_BLANK_CATALOGUE_TEXT,ownerList:t}),h.push(e),n._catalogueIds[0]?e.setId(n._catalogueIds[0]):n._catalogueIds[0]=e.getId())),n._catalogues=r,n._newCatalogues=h,(0===h.length||n._delete)&&(n._blankParaId=n._blankParaId||g.newGUID())},apply:function(){var e=this._catalogues,t=this._newCatalogues,n=e[e.length-1]||this.startingRange.getEndBlockRange().block,i=t[t.length-1];o.each(t,function(e){s.setResourceBlockStyleByPreBlock(e,n)}),this._blankParaId?(i=s.createNewParagraph(null,this._blankParaId,new d({text:""})),s.setResourceBlockStyleByPreBlock(i,n),this.executeAtomicCommand(new p({note:this._note,newBlks:[i],preBlk:n}))):this.executeAtomicCommand(new p({note:this._note,newBlks:t,preBlk:n})),e.length>0&&this.executeAtomicCommand(new h({note:this._note,blocks:this._note.getInterBlocks(e[0],e[e.length-1],!0)})),s.setTextBlockAsEndingRange(this,i,i.getLength(),i.getLength())},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._ownerId=e.listId,this._catalogueIds=e.blockIds,this._delete=e.simpleValue1,this._blankParaId=e.newBlkId)},toCollabJSON:function(){var e;return(e=t.__super__.toCollabJSON.apply(this))&&(e.listId=this._ownerId,e.blockIds=this._catalogueIds,e.simpleValue1=this._delete,e.newBlkId=this._blankParaId),e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(3);return t=o.extend({_cmdArgs:null,_oldData:null,_content:null,_align:null,_headerFooter:null,name:"comp.SetHeaderFooter",initialize:function(e){this._oldData={},this._cmdArgs=e.args,r.isCollabCommand(this._cmdArgs)||(this._content=this._cmdArgs.content,this._align=this._cmdArgs.align,this._headerFooter=this._cmdArgs.headerFooter),this.startingRange=e.args.range,this.endingRange=e.args.endingRange,t.__super__.initialize.apply(this)},apply:function(){var e=this._align,t=this._content,n=this._headerFooter;n&&(null!=e&&(this._oldData.align=n.getAlign()),null!=t&&(this._oldData.content=n.getContent(!1)),n.setContentAndStyle(t,e),this.effected=!0)},doReapply:function(){var e=this._align,t=this._content;this._headerFooter.setContentAndStyle(t,e)},doUnapply:function(){var e=this._headerFooter,t=this._oldData;t&&e.setContentAndStyle(t.content,t.align)},fromCollabJSON:function(){var e=this._cmdArgs.collabProperties,n=e.cmdJSON,o=e.coreEditor.note;t.__super__.fromCollabJSON.apply(this),n&&(this._content=n.headerFooterInfo.content,this._align=n.headerFooterInfo.align,this._headerFooter=o.getHeaderFooter(n.headerFooterInfo.isFooter))},toCollabJSON:function(){var e,n=t.__super__.toCollabJSON.apply(this);return n&&((e={}).content=this._content,e.align=this._align,e.isFooter=this._headerFooter.isFooter,n.headerFooterInfo=e),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(11),r=n(4),a=n(524),s=n(235),l=n(17),c=n(3);return t=i.extend({name:"comp.SetBlockProps",_cmdArgs:null,_note:null,_blocks:null,_props:null,updateSelectionDisabled:!0,initialize:function(){this._note=this.options.note,this._cmdArgs=this.options.args,t.__super__.initialize.apply(this),c.isCollabCommand(this._cmdArgs)||(this._blocks=this._cmdArgs.blocks,this._props=this._cmdArgs.props)},apply:function(){var e=this._blocks[0],t=new s({block:e,start:e.getEndOffset(),end:e.getEndOffset()});return this.executeAtomicCommand(new a({blocks:this._blocks,props:this._props}),new l({startRange:t,endRange:t})),!0},fromCollabJSON:function(){var e=this,n=e._cmdArgs.collabProperties.cmdJSON;n&&(e._blocks=[],o.each(n.blockIds,function(t){e._blocks.push(e._note.getBlockById(t))}),e._props=n.simpleValue1),t.__super__.fromCollabJSON.apply(e)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this),n=[];return o.each(this._blocks,function(e){n.push(e.getId())}),e.blockIds=n,e.simpleValue1=this._props,e}}),r.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(0),a=n(3);function s(e){return e.charAt(0).toUpperCase()+e.slice(1)}function l(e){return"set"+s(e)}return t=o.extend({name:"atom.SetBlockProps",_blocks:null,_oldPropsMap:{},_props:null,initialize:function(e){var n=this.options.args;this._oldPropsMap={},a.isCollabCommand(n)||(this._blocks=e.blocks,this._props=e.props),t.__super__.initialize.apply(this,arguments)},apply:function(){var e,t=this;r.each(t._blocks,function(n){e={},r.each(t._props,function(t,o){e[o]=n[function(e){return"get"+s(e)}(o)](),n[l(o)](t)}),t._oldPropsMap[n.getId()]=e})},doUnapply:function(){var e,t=this;r.each(t._blocks,function(n){e=t._oldPropsMap[n.getId()],r.each(e,function(e,t){n[l(t)](e)})})},fromCollabJSON:function(){var e=this,n=e.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(e),e._note=n.coreEditor.getNote(),o&&(e._blocks=[],r.each(o.blockIds,function(t){e._blocks.push(e._note.getBlockById(t))}),e._props=o.simpleValue1,e._oldPropsMap=o.simpleValue2)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this),n=[];return r.each(this._blocks,function(e){n.push(e.getId())}),e.blockIds=n,e.simpleValue1=this._props,e.simpleValue2=this._oldPropsMap,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(526),a=n(3);return t=o.extend({name:"comp.SetCodeLanguage",_codeBlock:null,_language:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._codeBlock=this.options.args.block,this._language=this.options.args.newLanguage),t.__super__.initialize.apply(this)},apply:function(){var e=this.options.args,t=this.startingRange.startRange.block;return a.isCollabCommand(e)&&t&&(this._codeBlock=t),this.executeAtomicCommand(new r({block:this._codeBlock,newLanguage:this._language})),!0},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._language=e.language)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.language=this._language,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(3);return t=o.extend({name:"atom.SetCodeLanguage",_codeBlock:null,_language:null,_preLanguage:null,initialize:function(){var e=this.options.args;r.isCollabCommand(e)||(this._codeBlock=this.options.block,this._language=this.options.newLanguage,this._preLanguage=this.options.block.getLanguage()),t.__super__.initialize.apply(this)},apply:function(){return!!this._language&&(this._codeBlock.setLanguage(this._language),!0)},doUnapply:function(){this._codeBlock&&this._preLanguage&&this._codeBlock.setLanguage(this._preLanguage)},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._language=e.language)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.language=this._language,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(528),a=n(3);return t=o.extend({name:"comp.SetCodeTheme",_codeBlock:null,_theme:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._codeBlock=this.options.args.block,this._theme=this.options.args.newTheme),t.__super__.initialize.apply(this)},apply:function(){var e=this.options.args,t=this.startingRange.startRange.block;return a.isCollabCommand(e)&&t&&(this._codeBlock=t),this.executeAtomicCommand(new r({block:this._codeBlock,newTheme:this._theme})),!0},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._theme=e.theme)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.theme=this._theme,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(3);return t=o.extend({name:"atom.SetCodeTheme",_codeBlock:null,_theme:null,_preTheme:null,initialize:function(){var e=this.options.args;r.isCollabCommand(e)||(this._codeBlock=this.options.block,this._theme=this.options.newTheme,this._preTheme=this.options.block.getTheme()),t.__super__.initialize.apply(this)},apply:function(){return!!this._theme&&(this._codeBlock.setTheme(this._theme),!0)},doUnapply:function(){this._codeBlock&&this._preTheme&&this._codeBlock.setTheme(this._preTheme)},fromCollabJSON:function(){var e=this.options.args.collabProperties.cmdJSON;t.__super__.fromCollabJSON.apply(this),e&&(this._theme=e.theme)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.theme=this._theme,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(530),a=n(3);return t=o.extend({name:"comp.SetTableCellsSize",_table:null,_sizes:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._table=e.table,this._sizes=e.sizes),t.__super__.initialize.apply(this)},apply:function(){var e=this,t=e._table,n=e._sizes;return!(n.length<1)&&(n.forEach(function(n){e.executeAtomicCommand(new r({table:t,size:n}))}),!0)},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._sizes=o.simpleValue1)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._sizes,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(3);return t=o.extend({name:"atom.SetTableCellSize",_table:null,_size:null,_oldSize:null,effected:!1,initialize:function(){var e=this.options.args;this._oldSize={},t.__super__.initialize.apply(this),r.isCollabCommand(e)||(this._table=this.options.table,this._size=this.options.size)},apply:function(){var e=this._table,t=this._size;return null!=t.row&&(this._oldSize.row=t.row,this._oldSize.height=e.getRowHeight(t.row),e.setRowHeight(t.row,t.height),this.effected=!0),null!=t.col&&(this._oldSize.col=t.col,this._oldSize.width=e.getColumnWidth(t.col),e.setColumnWidth(t.col,t.width),this.effected=!0),this.effected},doUnapply:function(){var e=this._table,t=this._oldSize;null!=t.row&&e.setRowHeight(t.row,t.height),null!=t.col&&e.setColumnWidth(t.col,t.width)},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._size=o.simpleValue1,this._oldSize=o.simpleValue2)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._size,e.simpleValue2=this._oldSize,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(18),a=n(73),s=n(83),l=n(247),c=n(3);return t=o.extend({name:"comp.InsertTableRowCol",_table:null,_rect:null,_cellsData:null,effected:!1,initialize:function(){var e,n=this.options.args;this._rect={},t.__super__.initialize.apply(this),c.isCollabCommand(n)||(this._cellsData=n.cellsData,this._sizes=n.sizes,(e=n.range)?this._transformRangeToData(e,n):(this._rect=n.rect,this._table=n.table))},_transformRangeToData:function(e,t){var n,o=e.getStartBlockRange(),i=o.getAsRectRange(),r=t.describe;i&&(n=i.getRect(),this._cellsData||(this._cellsData=this._calculateInsertData(r,n)),null!=r.row&&(this._rect.row=r.row===a.UP?n.top:n.top+n.height),null!=r.col&&(this._rect.col=r.col===a.LEFT?n.left:this._rect.col=n.left+n.width),this._table=o.block)},apply:function(){var e=this,t=e._rect,n=e._cellsData,o=e._sizes;null!=t.row&&(n.forEach(function(n){e._insertRows(t.row,[n],o)}),this.effected=!0),null!=t.col&&(n.forEach(function(n){e._insertCols(t.col,[n],o)}),this.effected=!0)},_insertRows:function(e,t,n){var o=this,i=o._table;t.forEach(function(n,a){0===n.length&&(n=i.creatRowData(e+a)),t[a]=n,r.fixMergeCellBeforeRowColChange({index:e+a,table:i,cmd:o,insertData:n})}),o.executeAtomicCommand(new l({cellsData:t,sizes:n,rect:this._rect,table:i}))},_insertCols:function(e,t,n){var o,i=this,a=i._table,s=a.getCells().length,c=[];t.forEach(function(t,n){for(c.push([]),o=0;o<s;o++)c[n].push(t[o]||a.createCell());r.fixMergeCellBeforeRowColChange({index:e+n,table:a,cmd:i,isCol:!0,insertData:c[n]})}),i.executeAtomicCommand(new l({cellsData:c,sizes:n,rect:this._rect,table:a}))},_calculateInsertData:function(e,t){return e.hasOwnProperty("col")?new Array(t.width).fill([]):e.hasOwnProperty("row")?new Array(t.height).fill([]):void 0},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1,this._sizes=o.simpleValue2,this._cellsData=s.cellsFromCollabJSON(o.dataBefore))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e.simpleValue2=this._sizes,e.dataBefore=s.cellsToCollabJSON(this._cellsData),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(37),a=n(533),s=n(18),l=n(17),c=n(64),d=n(3);return t=o.extend({name:"comp.DeleteTableRowCol",_table:null,_rect:null,_oldData:null,_count:null,_range:null,effected:!1,initialize:function(){var e,n=this.options.args;this._rect={},t.__super__.initialize.apply(this),d.isCollabCommand(n)||((e=n.range)?this._transformRangeToData(e,n):(this._rect=n.rect,this._count=n.count,this._table=n.table))},_transformRangeToData:function(e,t){var n,o,i=e.getStartBlockRange(),r=t.describe;(n=i.getAsRectRange())&&(o=n.getRect(),r.row&&(this._rect.row=o.top,this._count=o.height),r.col&&(this._rect.col=o.left,this._count=o.width),this._rectOfRectRange=o,this._table=i.block)},apply:function(){var e,t,n,o,i,r,d=this._count,u=this._rect,h=this._table;if(null!=u.row){if(e=h.getRowCount(),0===u.row&&e===d)return this._deleteTable();for(n=0;n<d;n++)s.fixMergeCellBeforeRowColChange({index:u.row,table:h,cmd:this,isDelete:!0}),this.executeAtomicCommand(new a({count:1,rect:u,table:h}));this.effected=!0}if(null!=u.col){if(t=h.getColumnCount(),0===u.col&&t===d)return this._deleteTable();for(n=0;n<d;n++)s.fixMergeCellBeforeRowColChange({index:u.col,table:h,cmd:this,isDelete:!0,isCol:!0}),this.executeAtomicCommand(new a({count:1,rect:u,table:h}));this.effected=!0}this._rectOfRectRange&&((o=c.create({block:h,type:c.TYPES.NORMAL,rect:this._rectOfRectRange}))&&(i=o.getAsRectRange()),i||(o=c.create({block:h,type:c.TYPES.FIRST_CELL})),r=l.create({startRange:o,endRange:o}),this.setEndingRange(r))},_deleteTable:function(){this._applyCommandToComposite(new r({blocks:[this._table],note:this.options.note})),this.setEndingRange(l.createMock()),this.effected=!0},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1,this._count=o.simpleValue2)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e.simpleValue2=this._count,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(22),i=n(4),r=n(83),a=n(3);return t=o.extend({name:"atom.DeleteTableRowCol",_table:null,_rect:null,_oldCellsData:null,_count:null,effected:!1,initialize:function(){var e=this.options,n=e.args;a.isCollabCommand(n)||(this._count=e.count,this._rect=e.rect,this._table=e.table),t.__super__.initialize.apply(this)},apply:function(){var e=this._rect,t=this._table,n=this._count;null!=e.row&&(this._oldCellsData=t.deleteRows(e.row,n),this.effected=!0),null!=e.col&&(this._oldCellsData=t.deleteCols(e.col,n),this.effected=!0)},doUnapply:function(){var e=this._rect,t=this._table,n=this._oldCellsData;null!=e.row&&t.insertRows(e.row,n.rowsData,n.heights),null!=e.col&&t.insertCols(e.col,n.colsData,n.widths)},fromCollabJSON:function(){var e,n,o=this.options.args.collabProperties,i=o.cmdJSON;t.__super__.fromCollabJSON.apply(this),n=o.coreEditor.getNote(),i&&(this._table=n.getBlockById(i.blockId),this._rect=i.simpleValue1,this._count=i.simpleValue2,(e=i.dataBefore)&&(this._oldCellsData=e,e.rowsData&&(this._oldCellsData.rowsData=r.cellsFromCollabJSON(e.rowsData)),e.colsData&&(this._oldCellsData.colsData=r.cellsFromCollabJSON(e.colsData))))},toCollabJSON:function(){var e,n=t.__super__.toCollabJSON.apply(this);return n.blockId=this._table.getId(),n.simpleValue1=this._rect,n.simpleValue2=this._count,(e=this._oldCellsData)&&(n.dataBefore=e,e.rowsData&&(n.dataBefore.rowsData=r.cellsToCollabJSON(e.rowsData)),e.colsData&&(n.dataBefore.colsData=r.cellsToCollabJSON(e.colsData))),n}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(210),a=n(140),s=n(535),l=n(3);return t=o.extend({name:"comp.ToggleMergeTableCell",_table:null,_rect:null,_oldData:null,_range:null,effected:!1,initialize:function(){var e,n=this.options.args;l.isCollabCommand(n)||((e=n.range)?this._transformRangeToData(e,n):(this._rect=n.rect,this._table=n.table)),t.__super__.initialize.apply(this)},_transformRangeToData:function(e){var t,n,o=e.getStartBlockRange();(t=o.getAsRectRange())&&(n=t.getRect(),this._range=e,this._rect=n,this._table=o.block)},apply:function(){var e,t,n,o=this._rect,i=this._table,l=!1,c=!1,d=null;if(o&&(1!==o.width||1!==o.height)){for(i.isMergeRect(o)&&(l=!0),t=o.top;t<o.top+o.height;t++)for(n=o.left;n<o.left+o.width;n++)e=i.getCell(t,n),t===o.top&&n===o.left?(e.isEmpty()||(c=!0),this.executeAtomicCommand(new r({table:i,type:r.TYPES.POINT,value:l?null:{width:o.width,height:o.height},rect:{row:t,col:n}}))):(c||d||e.isEmpty()||(d=e.getContent()),l||(this._applyCommandToComposite(new s({args:{table:i,content:"",range:this._range,cellRect:{row:t,col:n}}})),this.executeAtomicCommand(new a({table:i,styles:null,rect:{width:1,height:1,top:t,left:n}}))),this.executeAtomicCommand(new r({table:i,type:r.TYPES.CELL,value:l?null:{dy:t-o.top,dx:n-o.left},rect:{row:t,col:n}})));d&&this._applyCommandToComposite(new s({args:{table:i,content:d,cellRect:{row:o.top,col:o.left}}})),this.effected=!0}},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(103),a=n(3),s=n(82);return t=o.extend({name:"comp.SetTableCellContent",_table:null,_cellRect:null,_oldContent:null,initialize:function(){var e=this.options.args;a.isCollabCommand(e)||(this._table=e.table,this._cellRect=e.cellRect,this._content=e.content),t.__super__.initialize.apply(this)},apply:function(){this.executeAtomicCommand(new r({table:this._table,cellRect:this._cellRect,content:this._content}))},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._content=s.contentFromCollabJSON(o.simpleValue1),this._oldContent=s.contentFromCollabJSON(o.simpleValue2),this._cellRect=o.newBlkId)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=s.contentToCollabJSON(this._content),e.simpleValue2=s.contentToCollabJSON(this._oldContent),e.newBlkId=this._cellRect,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(140),a=n(3);return t=o.extend({name:"comp.SetTableCellBlockStyle",_table:null,_styles:null,_rect:null,_toggle:null,_default:null,effected:!1,initialize:function(){var e,n=this.options.args;t.__super__.initialize.apply(this),a.isCollabCommand(n)||(e=n.range,this._styles=n.styles,this._toggle=n.toggle,this._default=n.default,this._transformRangeToData(e,n))},_transformRangeToData:function(e){var t,n,o=e.getStartBlockRange();(t=o.getAsRectRange())&&(n=t.getRect(),this._rect=n,this._table=o.block)},apply:function(){if(!this._rect)return this.effected;this.executeAtomicCommand(new r({table:this._table,rect:this._rect,styles:this._styles,toggle:this._toggle,default:this._default})),this.effected=!0},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1,this._styles=o.simpleValue2||null,this._toggle=o.newBlkId||null)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e.simpleValue2=this._styles||null,e.newBlkId=this._toggle||null,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(247),a=n(103),s=n(210),l=n(140),c=n(83),d=n(3);return t=o.extend({name:"comp.InsertTableCells",_table:null,_widths:null,_heights:null,_cellsData:null,_rect:null,effected:!1,initialize:function(){var e=this.options.args;t.__super__.initialize.apply(this),d.isCollabCommand(e)||(this._table=e.table,this._widths=e.widths,this._heights=e.heights,this._cellsData=e.cellsData,this._transformRangeToData(e.range))},_transformRangeToData:function(e){var t,n=e.getStartBlockRange();n.getAsRectRange&&(t=n.getAsRectRange(),this._rect=t.getRect())},apply:function(){var e,t,n,o,i,r,s,c=this._table,d=this._rect,u=this._cellsData;if(!u)return this._clearCellsData();if(!u[0]||u[0].length<1)return!1;for(e=u.length,t=u[0].length,this._handleExtendCol(),this._handleExtendRow(),o=0;o<e;o++)for(r=o+d.top,i=0;i<t;i++)s=i+d.left,n=u[o][i],(e>1||t>1)&&(this._handleOldMergePoint(c.getCell(r,s),r,s),this._handleMergePointCell(n,o,i)),n.isMergedCell()||(this.executeAtomicCommand(new a({content:n.getContent(),table:c,cellRect:{row:o+d.top,col:i+d.left}})),this.executeAtomicCommand(new l({rect:{top:d.top+o,left:d.left+i,width:1,height:1},styles:n.getBlockStyles(),table:c})),this.effected=!0)},_handleExtendCol:function(){var e,t,n,o=this._table,i=this._rect,a=this._widths,s=this._cellsData,l=s[0].length,c=o.getColumnCount(),d=o.getRowCount(),u=[];if((e=i.left+l-c)>0){for(s.forEach(function(t,n){t.slice(-e).forEach(function(e,t){u[t]=u[t]||[],u[t][i.top+n]=e})}),t=0;t<d;t++)for(n=0;n<u.length;n++)u[n][t]=u[n][t]||o.createCell({row:t,col:i.left+n});this.executeAtomicCommand(new r({rect:{col:c},table:o,cellsData:u,sizes:a?a.slice(-e):null})),this.effected=!0}},_handleExtendRow:function(){var e,t,n,o=this._table,i=this._rect,a=this._heights,s=this._cellsData,l=s.length,c=o.getColumnCount(),d=o.getRowCount(),u=[];if((e=i.top+l-d)>0){for(s.slice(-e).forEach(function(e,t){u[t]=u[t]||[],e.forEach(function(e,n){u[t][i.left+n]=e})}),t=0;t<u.length;t++)for(n=0;n<c;n++)u[t][n]=u[t][n]||o.createCell({row:i.top+i.height,col:n});this.executeAtomicCommand(new r({rect:{row:d},table:o,cellsData:u,sizes:a?a.slice(-e):null})),this.effected=!0}},_handleMergePointCell:function(e,t,n){var o=this._table,i=this._rect;e.isMergePoint()?(e.getMergePointAttr(),this.executeAtomicCommand(new s({rect:{row:i.top+t,col:i.left+n},value:e.getMergePointAttr(),type:s.TYPES.POINT,table:o}))):e.isMergedCell()&&this.executeAtomicCommand(new s({rect:{row:i.top+t,col:i.left+n},value:e.getMergedCellAttr(),type:s.TYPES.CELL,table:o}))},_handleOldMergePoint:function(e,t,n){var o,i,r=this._table,a=this._rect,s=this._cellsData,l=s.length,c=s[0].length;if(e&&(e.isMergePoint()&&(o=e.getMergePointAttr(),this._clearCellsAttr(t,n,o.width,o.height)),e.isMergedCell())){if(!(i=r.getCell(t,n,{findMergePointIfNeeded:!0,withPosition:!0}))||a.top+l>=i.row&&a.top<=i.row&&a.left+c>i.col&&a.left<=i.col)return;o=i.cell.getMergePointAttr(),this._clearCellsAttr(i.row,i.col,o.width,o.height)}},_clearCellsAttr:function(e,t,n,o){var i,r,a=this._table;for(i=0;i<o;i++)for(r=0;r<n;r++)this.executeAtomicCommand(new s({table:a,rect:{row:e+i,col:t+r}}))},_clearCellsData:function(){var e,t,n=this._rect,o=this._table;for(e=0;e<n.height;e++)for(t=0;t<n.width;t++)this.executeAtomicCommand(new a({content:"",table:o,cellRect:{row:e+n.top,col:t+n.left}}));this.executeAtomicCommand(new l({rect:n,table:o}))},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1,this._widths=o.simpleValue2.widths,this._heights=o.simpleValue2.heights,this._cellsData=c.cellsFromCollabJSON(o.dataBefore))},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e.simpleValue2={widths:this._widths,height:this._heights},e.dataBefore=c.cellsToCollabJSON(this._cellsData),e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(11),i=n(4),r=n(245),a=n(3);return t=o.extend({name:"comp.SetTableCellInlineStyle",_table:null,_styles:null,_rect:null,_toggle:null,initialize:function(){var e,n=this.options.args;t.__super__.initialize.apply(this),a.isCollabCommand(n)||(e=n.range,this._styles=n.styles,this._toggle=n.toggle,this._transformRangeToData(e,n))},_transformRangeToData:function(e){var t,n,o=e.getStartBlockRange();(t=o.getAsRectRange())&&(n=t.getRect(),this._rect=n,this._table=o.block)},apply:function(){this._rect&&this.executeAtomicCommand(new r({table:this._table,rect:this._rect,styles:this._styles,toggle:this._toggle}))},fromCollabJSON:function(){var e,n=this.options.args.collabProperties,o=n.cmdJSON;t.__super__.fromCollabJSON.apply(this),e=n.coreEditor.getNote(),o&&(this._table=e.getBlockById(o.blockId),this._rect=o.simpleValue1,this._styles=o.simpleValue2||null,this._toggle=o.newBlkId||null)},toCollabJSON:function(){var e=t.__super__.toCollabJSON.apply(this);return e.blockId=this._table.getId(),e.simpleValue1=this._rect,e.simpleValue2=this._styles||null,e.newBlkId=this._toggle||null,e}}),i.add(t),t}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(16),i=n(0),r=n(1),a=n(20),s=n(6),l=n(243),c=function(e){return e&&e.name===l.prototype.name},d=n(86),u=n(17);return t={_editor:null,_undoStack:null,_redoStack:null,_notOwnManagerAdapterStack:null,initialize:function(e){this._undoStack=[],this._redoStack=[],this._notOwnManagerAdapterStack=[],this._editor=e.editor},exec:function(e,t,n){var o,i,a,s,l=!1,d=!0,h=!1;return e?this._editor.isCollabEnabled()&&(l=n.collabProperties.isCollabCmd&&n.collabProperties.isOwnCmd,d=!n.collabProperties.isCollabCmd,l&&(c(e)?this._localManagerAdapterOverriden(e)?e.setIgnoreUndoRedo(!0):h=!0:n.collabProperties.cmdJSON.isLocalExecutedCmd&&(h=!0)),h)?(r.log("Skip local-executed collab command and update noteVersion",e),this._updateUndoCmdFinalVersion(e.cmdId,n.collabProperties.finalNoteVersion),this.trigger("command-exec",e,n),!0):(s=e.apply(),i={cmdName:e.name,cmdType:"do"},o=e.getEndingRange(),!1!==s&&!u.isNoteRange(o)&&e.getStartingRange()&&(r.warn("endingRange should be a noteRange, so set it to be same as startEndingRange:",o),o=e.getStartingRange(),e.setEndingRange(o)),a=d||l,o&&a&&!e.updateSelectionDisabled&&this.trigger("update-selection",o,i,n),a&&!e.effected?(this.trigger("command-exec",e,n),s):(c(e)&&(e.sendInfoToInner({canUndo:this.canUndo(),canRedo:this.canRedo()}),a||this._notOwnManagerAdapterStack.push(e)),this._editor.isCollabEnabled()?n.collabProperties.dataCmdError?(this.trigger("command-exec",e,n),!1):(a&&(e.getIgnoreUndoRedo()||this._pushToUndoStack(e),this._redoStack=[]),this.trigger("command-exec",e,n),!0):(e.getIgnoreUndoRedo()||this._undoStack.push(e),this._redoStack=[],this.trigger("command-exec",e,n),!0))):(r.log("Skip empty local command"),!1)},canUndo:function(){return 0!==this._undoStack.length},undo:function(){if(!this.canUndo())return r.warn("Can Not undo"),!1;var e,t=this._undoStack,n=this._redoStack,o=t.pop();return o.doUnapply(),n.push(o),this.trigger("command-exec",o),e={cmdName:o.name,cmdType:"undo"},this.trigger("update-selection",o.getStartingRange(),e),!0},canRedo:function(){return 0!==this._redoStack.length},redo:function(){if(!this.canRedo())return!1;var e,t=this._undoStack,n=this._redoStack.pop();return n.doReapply(),t.push(n),this.trigger("command-exec",n),e={cmdName:n.name,cmdType:"redo"},this.trigger("update-selection",n.getEndingRange(),e),!0},reset:function(){this._undoStack=[],this._redoStack=[],this._notOwnManagerAdapterStack=[]},registerManager:function(e,t){var n,o=this;e&&e.on?(o.unregisterManager(e),e.on("command-executed",function(i,a){var s=l.create(t,i,a);s?(s.isOriginalCmd=!0,s.isLocalExecutedCmd=!0,s.setCmdOriginalNoteVersion(o._editor.getNoteVersion()),o._pushToUndoStack(s),o._redoStack=[],o.trigger("command-exec",s),e.triggerGlobalUndoStatus(o.canUndo(),o.canRedo()),o._editor.isCollabEnabled()&&(n=window.JSON.parse(a))&&0!==n.colWidths.length&&0!==n.rowHeights.length&&o._editor.pushLocalDataCommand(s,!0)):r.warn("ManagerAdapter failed to create command!")})):r.warn("commandManager is not Valid!")},unregisterManager:function(e){e&&e.on&&e.off("command-executed")},applyCollabCmdRedoUndo:function(e){var t,n=e.options.args,o=n.collabProperties.cmdJSON,i=n.collabProperties.isOwnCmd;if(i&&n.collabProperties.isLocalExecutedCmd)return r.log("skip local-executed-own redo/undo",e),void this.trigger("command-exec",e,n);n.collabProperties.isCollabUndo?(e.setCollabUndo(!0),e.setCollabRedo(!1),t=e.doUnapply(n)):n.collabProperties.isCollabRedo&&(e.setCollabUndo(!1),e.setCollabRedo(!0),t=e.doReapply(n)),!1!==t?(n.collabProperties.isCollabUndo&&e.setStartingRange(d.buildNoteRangeFromJSON(o.startNoteRange,this._editor)),n.collabProperties.isCollabRedo&&e.setEndingRange(d.buildNoteRangeFromJSON(o.endNoteRange,this._editor)),i&&(n.collabProperties.isCollabUndo?(this._pushToRedoStack(this._undoStack.pop()),this.trigger("update-selection",e.getStartingRange())):n.collabProperties.isCollabRedo&&(this._pushToUndoStack(this._redoStack.pop()),this.trigger("update-selection",e.getEndingRange())))):i&&(n.collabProperties.isCollabUndo?this.dropUndoCmds():n.collabProperties.isCollabRedo&&this.dropRedoCmd(),this._editor.notifyErrorToHost(s.INVALIDACTION_FAILED_COLLABCMD,n.collabProperties.coreEditor)),i&&c(e)&&e.sendInfoToInner({canUndo:this.canUndo(),canRedo:this.canRedo()}),this.trigger("command-exec",e,n)},dropRedoCmd:function(){r.log("Drop Redo Command"),this._redoStack.pop(),this.trigger("redo-stack-change")},dropUndoCmds:function(e,t,n){var o;r.log("Drop Undo Command:",e,t,n),e?(o=this._getUndoCmdIndexById(e))>=0&&(n?this._undoStack.splice(o,t,n):this._undoStack.splice(o,t)):this._undoStack.pop(),this.trigger("undo-stack-change")},getRedoCmd:function(){return i.last(this._redoStack)},getUndoCmd:function(){return i.last(this._undoStack)},_getUndoCmdIndexById:function(e){var t=-1,n=0;return i.some(this._undoStack,function(o){return o.getCmdId()===e&&(t=n),t>=0||(n++,!1)}),t},_pushToRedoStack:function(e){e?this._redoStack.push(e):r.log("null command should NOT be pushed to Redo Stack")},_pushToUndoStack:function(e){e?e.getIgnoreUndoRedo()?r.log("this command no need undo redo."):(this._undoStack.push(e),this._undoStack.length>s.MAX_UNDO_STACK_SIZE&&this._undoStack.shift()):r.log("null command should NOT be pushed to Undo Stack")},_localManagerAdapterOverriden:function(e){var t,n=!1,o=0;for(this._notOwnManagerAdapterStack&&(o=this._notOwnManagerAdapterStack.length);o>0&&(t=this._notOwnManagerAdapterStack[o-1]).getCmdOriginalNoteVersion()===e.getCmdOriginalNoteVersion();o--)if(e.getBlockId()===t.getBlockId()){n=!0;break}return n},_updateUndoCmdFinalVersion:function(e,t){i.some(this._undoStack,function(n){if(n.cmdId===e)return n.setCmdFinalNoteVersion(t),!0})}},i.extend(t,a.Events),o.extend(t)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(17),n(35),n(13),n(1),n(52),n(248)],void 0===(i=function(e,t,n,o,i,r,s,l){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.collapseToStart=function(){this.noteRange&&this.noteRange.collapse&&(this.noteRange.collapse(!0),this._drawRange(),this._triggerSelectionChange())},t.prototype.collapseToEnd=function(){this.noteRange&&this.noteRange.collapse&&(this.noteRange.collapse(!1),this._drawRange(),this._triggerSelectionChange())},t.prototype.getNativeRange=function(){return s.getRange(window)},t.prototype.getRange=function(){return this.noteRange},t.prototype.isCollapsed=function(){var e=this.noteRange;return!!e&&e.isCollapsed()},t.prototype.reset=function(){this.noteRange=null},t.prototype.setRange=function(e,t,n,o){this._setRange(e,{scrollIntoView:o,selectionChangeEvent:t,toDraw:!0,trigger:!0,inlineStyles:n})},t.prototype.initialize=function(e){this.noteView=e.noteView,this._bindEvents()},t.prototype._bindEvents=function(){o.addListeners({selectionchange:"_onDocSelectionChange","set-range":"_onSetRange"},this.noteView,this)},t.prototype._convertToNoteRange=function(e){return n.fromNativeRange(e,this.noteView)},t.prototype._drawRange=function(e){e=!1!==e,this.noteView.trigger("draw-range",this.noteRange,e)},t.prototype._onDocSelectionChange=function(e){var t=s.getRange(),n=this._convertToNoteRange(t);this.noteRange=n,!n||n.canDrawedByNative()?(this.trigger("doc-change-selection",n),this._triggerSelectionChange()):this.setRange(n)},t.prototype._onSetRange=function(e,t,n,o){this._setRange(e,{selectionChangeEvent:o,toDraw:t,trigger:n})},t.prototype._setRange=function(e,t){var n=this._convertToNoteRange(e);n&&n.getStartBlockRange()&&n.getEndBlockRange()?(t=t||{},this.noteRange=n,t.toDraw&&this._drawRange(t.scrollIntoView),t.trigger&&this._triggerSelectionChange(t.selectionChangeEvent,t.inlineStyles)):r.warn("Failed convert native range to note range!")},t.prototype._triggerSelectionChange=function(e,t){e||(e=l.createUserTypeEvent()),this.trigger("selection-change",e,t)},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(542),n(543),n(544),n(545),n(546),n(547),n(548),n(549),n(550),n(551),n(552),n(553),n(554),n(555),n(556),n(557),n(558),n(559),n(560),n(561),n(562),n(563),n(564),n(565),n(566),n(567),n(568),n(569),n(570),n(571),n(572),n(573),n(574)],void 0===(i=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"backspace",key:"backspace",action:function(e){e.execDeleteBackward()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"del",key:"del",action:function(e){e.execDeleteForward()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7),n(17),n(30),n(2)],void 0===(i=function(e,t,n,o,i,r){"use strict";var a=this;Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,n){var s=e.noteView;s&&(s.directionKeyJustMoved=!0),e.moveCaretWithDirection(!0,t);var l=e.getNoteRange().getEndBlockRange(),c=l.block,d=e.note.getLastBlock(),u=e.note.getNextBlock(c);if(!c.isEmpty()||r.isHr(u))switch(n){case"right":c.getLength()===l.end&&d===c&&e.execCommand("comp.AppendBlank",{inlineStyles:a.editingInlineStates});break;case"down":d===c&&e.execCommand("comp.AppendBlank",{inlineStyles:a.editingInlineStates})}else if(d!==c&&u){var h=i.createRangeByBlock({allContent:!1,block:u,collapseToStart:!1});e.noteSelection.setRange(new o({startRange:h,endRange:h})),t.preventDefault()}};n.register({name:"down",key:"down",preventDefault:!1,action:s}),n.register({name:"right",key:"right",preventDefault:!1,action:s})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(2),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){var t,o;o=(t=e.getNoteRange()).getEndBlockRange(),t.isInSingleBlock()&&n.isHeading(o.block)&&o.isCollapsed()&&o.start===o.block.getLength()&&e.resetEditingInlineStates(),e.execCommand("comp.KeyEnter",{inlineStyles:e.getEditingInlineState()})};o.register({name:"enter",key:"enter",action:i}),o.register({name:"alt+enter",key:"alt+enter",action:i}),o.register({name:"shift+enter",key:"shift+enter",action:i})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"esc",key:"esc",preventDefault:!1,action:function(e){e.trigger("esc")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(2),n(1),n(7)],void 0===(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),i.register({name:"space",key:"space",action:function(e){var t,i=e.getNoteRange();i&&(t=i.getStartBlockRange().block,i.isInSingleBlock()&&t&&n.isTable(t))?o.error("should NOT trigger insertText when select only Table."):e.insertText(" ",!1)}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"tab",key:"tab",action:function(e){var t=e.getEditingInlineState();e.execCommand("comp.KeyTab",{inlineStyles:t})}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e,t){var n=e.noteView;n&&(n.directionKeyJustMoved=!0),e.moveCaretWithDirection(!1,t)};n.register({name:"up",key:"up",preventDefault:!1,action:o}),n.register({name:"left",key:"left",preventDefault:!1,action:o})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7),n(0),n(1)],void 0===(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});o.each(["ctrl+backspace","ctrl+del","shift+backspace","shift+del","alt+backspace","alt+del","mod+backspace","mod+del"],function(e){n.register({name:e,key:e,preventDefault:!0,action:function(){i.log("shortcut prevented:",e)}})})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"bold",key:"mod+b",action:function(e){e.toggleInlineStyle("bold")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(34),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){return n.pad(e,2,"0","left")};o.register({name:"insertDate",key:"alt+shift+d",action:function(e){var t=new Date,n=t.getFullYear()+"/"+i(t.getMonth()+1)+"/"+i(t.getDate())+" "+i(t.getHours())+":"+i(t.getMinutes());e.insertText(" "+n+" ",!1)}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"italic",key:"mod+i",action:function(e){e.toggleInlineStyle("italic")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(e){e.redo()};n.register({name:"redo",key:"mod+y",action:o}),n.register({name:"redo_2",key:"mod+shift+z",action:o})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(1),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o.register({name:"reloadPage",key:"mod+shift+r",preventDefault:!1,action:function(){if(n.DEBUG){window.clearJstCache&&(window.clearJstCache(),window.alert("Clear JST cache... Done!"));var e=window.location.href;window.location.href=e}}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"save",key:"mod+s",action:function(e){e.trigger("yne-save-content")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"underline",key:"mod+u",action:function(e){e.toggleInlineStyle("underline")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"undo",key:"mod+z",action:function(e){e.undo()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"selectAll",key:"mod+a",read:!0,action:function(e){e.selectAll()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(2),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){var t,o,i=e.getNoteRange(),r=e.noteView;r.getHtmlContentEditable()||i&&i.isInSingleBlock()&&i.isMatchBlockTypes(e.note,[n.IMAGE,n.ATTACHMENT])&&(t=i.getStartBlockRange().block,(o=r.getBlockViewByBlock(t))&&(r.setHtmlContentEditable(!0),o.el.focus(),window.setTimeout(function(){r.setHtmlContentEditable(!1)},0)))};o.register({name:"copy",key:"mod+c",preventDefault:!1,read:!0,action:i}),o.register({name:"cut",key:"mod+x",preventDefault:!1,action:i})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o.register({name:"paste",key:"mod+v",preventDefault:!1,action:function(e,t){var o=e.editor;e.setPasteAsText(!1),n.IS_MAC&&(t.preventDefault(),o.callMacNativeApi("menuPaste"))}}),o.register({name:"pasteAsText",key:"mod+shift+v",preventDefault:!1,action:function(e){e.setPasteAsText(!0)}}),o.register({name:"pasteAsText_alternative",key:"mod+shift+option+v",preventDefault:!1,action:function(e){e.setPasteAsText(!0)}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=!0;(n.IS_WEB_NOTE||n.IS_WEB_GROUP)&&(i=!1),o.register({name:"find",key:"mod+f",read:!0,preventDefault:i,action:function(e){e.trigger("find")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"shiftTab",key:"shift+tab",action:function(e){var t=e.getEditingInlineState();e.execCommand("comp.KeyTab",{inlineStyles:t,withShiftKey:!0})}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.IS_PC&&(o.register({name:"zoomIn_0",key:"mod+plus",action:function(e){e.zoomInEditor()}}),o.register({name:"zoomIn_1",key:"mod+shift+plus",action:function(e){e.zoomInEditor()}}),o.register({name:"zoomIn_2",key:"mod+=",action:function(e){e.zoomInEditor()}}),o.register({name:"zoomIn_3",key:"mod+shift+=",action:function(e){e.zoomInEditor()}}))}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.IS_PC&&(o.register({name:"zoomOut_0",key:"mod+-",action:function(e){e.zoomOutEditor()}}),o.register({name:"zoomOut_1",key:"mod+shift+-",action:function(e){e.zoomOutEditor()}}),o.register({name:"zoomOut_2",key:"mod+0",action:function(e){e.zoomEditor(1,!0)}}))}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o.register({name:"deleteToEnd",key:"ctrl+k",action:function(e){n.IS_MAC&&e.execDeleteToEnd()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(9),n(7)],void 0===(i=function(e,t,n,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),o.register({name:"deleteForward",key:"ctrl+d",action:function(e){n.IS_MAC&&e.execDeleteForward()}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(36),n(1),n(9),n(7)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={insertHeading_1:"1",insertHeading_2:"2",insertHeading_3:"3",insertHeading_4:"4"},s=function(e,t,n){o.log(t),null!=a[n]?e.execCmdByShortCut("comp.InsertHeading",{level:a[n]}):o.warn("Unsupported shortKey:",n)};n.isSafari()&&!i.IS_MAC||(r.register({name:"insertHeading_1",key:"mod+1",preventDefault:!0,action:s}),r.register({name:"insertHeading_2",key:"mod+2",preventDefault:!0,action:s}),r.register({name:"insertHeading_3",key:"mod+3",preventDefault:!0,action:s}),r.register({name:"insertHeading_4",key:"mod+4",preventDefault:!0,action:s}))}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(7)],void 0===(i=function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n.register({name:"strikeout",key:"mod+e",action:function(e){e.toggleInlineStyle("strike")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(29),n(36),n(1),n(9),n(7)],void 0===(i=function(e,t,n,o,i,r,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=function(e,t,o){var r;if(i.log(t),"insertOrderList"===o)r=n.ORDERED;else{if("insertUnorderList"!==o)return void i.warn("Unsupported shortKey:",o);r=n.UNORDERED}e.execCmdByShortCut("comp.InsertList",{type:r})};o.isSafari()&&!r.IS_MAC||(a.register({name:"insertUnorderList",key:"mod+l",preventDefault:!0,action:s}),a.register({name:"insertOrderList",key:"mod+shift+l",preventDefault:!0,action:s}))}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(36),n(1),n(9),n(7)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertTodo",key:"mod+d",preventDefault:!0,action:function(e,t,n){o.log(t,n),e.execCmdByShortCut("comp.InsertTodo",{checked:!1})}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(36),n(1),n(9),n(7)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertHR",key:"mod+h",preventDefault:!0,action:function(e,t,n){o.log(t,n),e.execCmdByShortCut("comp.InsertHorizontalRule")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(36),n(1),n(9),n(7)],void 0===(i=function(e,t,n,o,i,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.isSafari()&&!i.IS_MAC||r.register({name:"insertQuote",key:"ctrl+q",preventDefault:!0,action:function(e,t,n){o.log(t,n),e.execCmdByShortCut("comp.InsertQuote")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i;o=[n,t,n(36),n(9),n(7)],void 0===(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});n.isSafari()&&!o.IS_MAC||i.register({name:"insertCode",key:"ctrl+alt+d",preventDefault:!0,action:function(e,t,n){e.execCmdByShortCut("comp.InsertCode")}})}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(20),o=n(0),i=n(5),r=n(14),a=n(9),s=n(6);return t.View.extend({className:"content-load-progress-view",events:{mouseenter:"_onMouseEnter",mouseleave:"_onMouseLeave"},_progressTracker:null,_$parentEl:null,_progressBarSlideTimer:null,_$messageView:null,_$percentNumberSpan:null,_$progressMark:null,initialize:function(e){this._progressTracker=e.progressTracker,this._$parentEl=e.$parentEl,this.render()},render:function(){var e,t=this.$el;e=r.render("common","content-load-progress"),t.html(e),i(this._$parentEl).before(t),this._$messageView=t.find(".progress-message"),this._$percentNumberSpan=t.find(".progress-message-number"),this._$progressMark=t.find(".progressbar-mark"),this.bindEvents()},bindEvents:function(){o.bindAll(this,"_onProgressUpdate","_onProgressStop"),this._progressTracker.on("progress-update",this._onProgressUpdate),this._progressTracker.on("progress-stop",this._onProgressStop)},_onMouseEnter:function(e){if(a.IS_PC){e.stopPropagation(),this._$messageView.stop(!0),this._$messageView.slideDown({duration:1e3})}},_onMouseLeave:function(e){if(a.IS_PC){e.stopPropagation(),this._$messageView.stop(!0),this._$messageView.slideUp({duration:1e3})}},_onProgressStop:function(){null!=this._progressBarSlideTimer&&(clearTimeout(this._progressBarSlideTimer),this._progressBarSlideTimer=null),this._$messageView.stop(!0),this.$el.hide(),this._$progressMark.width(0)},_onProgressUpdate:function(e){var t=this;if(o.isNumber(e.percent))if(e.percent>=1)t._onProgressStop();else if(0===e.percent){var n=a.IS_PC?s.LATENCY_TO_SHOW_SET_CONTENT_PROGRESS:0;t._progressBarSlideTimer=setTimeout(function(){t.$el.show(),a.IS_PC&&(t._$messageView.slideDown({duration:1e3}),t._progressBarSlideTimer=setTimeout(function(){t._$messageView.slideUp({duration:1e3})},1500))},n)}else t._$percentNumberSpan.text(parseInt(100*e.percent)+"%"),t._$progressMark.width(e.percent*t.$el.width())}})}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(13),n(0)],void 0===(i=function(e,t,n,o){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.stop=function(){this.trigger("progress-stop")},t.prototype.updateContentSetProgress=function(e){o.isNumber(e.percent)&&this.trigger("progress-update",e)},t.prototype.initialize=function(e){},t}(n)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(3),n(6),n(2),n(39),n(8),n(578),n(77),n(212),n(215),n(88),n(580),n(95),n(1),n(43),n(25),n(96),n(233),n(142),n(26)],void 0===(i=function(e,t,n,o,i,r,s,l,c,d,u,h,p,g,f,m,y,_,I,b,v,k){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.buildCollabSession=function(t,o){m.log("buildCollabSession");var i,r,a=this;try{null!=t?r=JSON.parse(t):a.coreEditor.isLegacyHost()||(i="propsJSONStr should NOT be Null",m.debugAlert(i),a.trigger("callback-to-native",o,[{resultCode:0,message:i}])),n.isObject(r)||(r={}),e.prototype.buildCollabSession.call(this,r,function(e){a.trigger("callback-to-native",o,[{message:e.message,resultCode:e.resultCode}])})}catch(e){i=e.message,a.trigger("callback-to-native",o,[{resultCode:0,message:i}])}},t.prototype.clearHighlight=function(){m.log("clearHighlight"),this.coreEditor.clearHighlight()},t.prototype.closeCollabSession=function(){m.log("closeCollabSession"),e.prototype.closeCollabSession.call(this),this.coreEditor.toggleStats(!1)},t.prototype.doPaste=function(e,i,a,l,c,d){m.log("doPaste");var u,h,p,y,_=this.coreEditor,b=_.getController(),v=_.getNote(),C=null,w={};(_.getdefaultFontName()||_.getDefaultFontSize())&&(C=_.getDefaultStyle()),e&&(b.setPasteAsText(a),d=f.parseToBoolean(d,!1),i===t.DO_PASTE_CONTENT_TYPE.PLAIN?u=I.parsePlain(e,a?C:_.querySelectionInlineStyles(),_.querySelectionBlockStyles(),a):i!==t.DO_PASTE_CONTENT_TYPE.YNE_JSON&&i!==t.DO_PASTE_CONTENT_TYPE.HTML||(c&&(p=JSON.parse(c)),i===t.DO_PASTE_CONTENT_TYPE.HTML?(e=this.HANDLE_PASTE_OLD_CONTENT(e,p),u=I.parseHtml(e)):u=I.parseJSON(e),a?u=g(u):n.each(p,function(e,t){_.updateResMapWithKey(t,e,!0)})),u&&(u.forEach(function(e){r.isListItem(e)&&(y=e.getListId(),w[y]||(w[y]=k.getOrCreateListById(v.getAllBlocks(),y,e.getListType())),e.setOwnerList(w[y]))}),(h=function(e){var t,i;if(e&&e.length){if(t=n.filter(e,function(e){if(i=_.isCollabEnabled(),e.getBlockStyle("back-color")&&e.setBlockStyle("back-color",""),r.isAttachment(e)){if(d)return!1;if(!i&&/^http/i.test(e.getResource()))return!1}return e&&e.setId&&e.setId(o.newGUID()),!r.isTable(e)||function(e,t,n){var o;return!(1===e.getRowCount()&&1===e.getColumnCount()&&function(e,t,n){if(!e||!e.isAttachmentCell())return!1;if(t)return!0;if(!n){var o=e.getContent();if(o&&/^http/i.test(o.getResource()))return!0}return!1}(e.getCell(0,0),t,n)||(b.dragProhibited&&e.forEach(function(t,n){((o=e.getCell(t,n)).isImageCell()||o.isAttachmentCell())&&e.setCellContent(t,n,"")}),0))}(e,d,i)}),t=n.map(t,function(e){return r.isHandWrite(e)?new s({source:e.getSource(!1)}):e}),b.dragProhibited&&(t=t.filter(function(e){return!r.isImage(e)&&e})),t&&t.length>0){if(b.pasteForTable&&b.pasteForTable(t))return;_.execCommand("comp.InsertBlocks",{blocks:t,range:_.getNoteRange()})}return t}}(u))&&h.length>0&&_.trigger("yne-check-image",v.getNoteId(),v.getAllResourceInfo(u,[r.IMAGE]))))},t.prototype.enterFullScreen=function(){m.log("enterFullScreen"),this.coreEditor.enterFullScreen()},t.prototype.enterPresentation=function(e){m.log("enterPresentation"),this.coreEditor.enterPresentation(e)},t.prototype.exitFullScreen=function(){m.log("exitFullScreen"),this.coreEditor.exitFullScreen()},t.prototype.updateImageByOrigSrc=function(e,t,n){this.coreEditor.updateImageByOrigSrc(e,t,n)},t.prototype.focusEditor=function(){m.log("focusEditor"),this.coreEditor.focusEditor()},t.prototype.getCollabContent=function(t,n){m.log("getCollabContent");var o,i=this;return o=e.prototype.getCollabContent.call(this,function(e){i.trigger("callback-to-native",t,[JSON.stringify(e)])},n),JSON.stringify(o)},t.prototype.getContent=function(t,n){m.log("getContent");var o,i=this;return null!=t&&(o=function(e){i.trigger("callback-to-native",t,[{content:e.content,resultCode:e.status,status:e.status}])}),e.prototype.getContent.call(this,!1,o,n)},t.prototype.getFirstLineTextContent=function(){return m.log("getFirstLineTextContent"),this.coreEditor.getFirstLineTextContent()},t.prototype.getHtmlContent=function(t,n){m.log("getHtmlContent");var o,i,r=this,a=r.coreEditor;return o=e.prototype.getContent.call(this,!0,function(e){null!=(o=e.content)&&(i=a.getPcResMap(),o=v(o,i),o=u(o)),r.trigger("callback-to-native",t,[{content:o,resultCode:e.status,status:e.status}])},n,!0)},t.prototype.getModifiers=function(t,o){m.log("getModifiers");var i,r=this,a=f.parseToNumber(t);return n.isNaN(a)&&r.trigger("callback-to-native",o,[JSON.stringify({status:2,errorCode:1})]),i=e.prototype.getModifiers.call(this,a,function(e){r.trigger("callback-to-native",o,[JSON.stringify(e)])}),JSON.stringify(i)},t.prototype.getNativeDisabledToolbarItemNames=function(){m.log("getNativeDisabledToolbarItemNames");var e,t,o=this.coreEditor.getNoteRange(),i={};return o&&(t=o.getStartBlockRange().block,r.isHeaderFooter(t)?n.extend(i,b.NATIVE_HEADER_FOOTER_DISABLED_MAP):o.isSingleTableSelected()?e=!0:r.isCatalogue(t)?n.extend(i,b.NATIVE_CATALOGUE_DISABLED_MAP):r.isCode(t)&&n.extend(i,b.NATIVE_CODE_DISABLED_MAP)),this.coreEditor.hasHandWriteBlock()&&n.extend(i,b.NATIVE_HANDWRITE_DISABLED_MAP),e&&n.extend(i,b.NATIVE_TABLE_DISABLED_MAP),JSON.stringify(n.keys(i))},t.prototype.getResourceMap=function(){m.log("getResourceMap");var e,t,o,i=this.coreEditor,r=i.getNote(),a=r.getAllBlocks(),s={};return t=r.getAllResourceInfo(),n.each(t,function(e){e&&(e.source&&e.extraSource&&(s[e.source]=e.extraSource),e.resource&&e.extraResource&&(s[e.resource]=e.extraResource))}),(o=r.getAllResouceIds())&&o.length&&(e=i.getPcResMap()||{},n.each(o,function(t){var n=e[t];n&&(s[t]=n)})),1===a.length&&a[0].isEmpty()&&this.focusEditor(),JSON.stringify(s)},t.prototype.getScrollPercent=function(){m.log("getScrollPercent");var e=this.coreEditor.getScrollPercent();return e=Math.round(e*t.SCROLL_PERCENT_RATIO)},t.prototype.getWordInfoFromPosition=function(e,t){var o,i,r;return m.log("getWordInfoFromPosition"),(o=document.caretRangeFromPoint(e,t))&&y.isText(o.commonAncestorContainer)?((i=document.createRange()).selectNode(o.commonAncestorContainer),r=i.getClientRects(),n.some(r,function(n){return n.top<t&&n.left<e&&n.bottom>t&&n.right>e})?o.startOffset+"|"+o.commonAncestorContainer.nodeValue:""):""},t.prototype.highlight=function(e){m.log("highlight");var t=JSON.parse(e);n.isString(t.words)?t.words=t.words.split(/\s+/):null==t.words&&(t.words=[]),n.each(t.images,function(e){e.height=parseInt(e.height,10),e.width=parseInt(e.width,10),n.each(e.pos,function(e){e.bottom=parseInt(e.bottom,10),e.left=parseInt(e.left,10),e.right=parseInt(e.right,10),e.top=parseInt(e.top,10)})}),this.coreEditor.highlight(t.words,t)},t.prototype.initializeEditor=function(e){m.log("initializeEditor");var t,r,a=0,s=this.coreEditor;try{if(!0===this.initializedByPC)return t="initializeEditor should only be called for one time",void m.debugAlert(t);r=JSON.parse(e),isNaN(this.options.buildVersion)&&(m.error("Invalid buildVersion:",this.options.buildVersion),this.options.buildVersion=922337203685477e4),(r=n.defaults(r,{buildVersion:this.options.buildVersion,backgroundURIJSON:[],shortCutsJSON:[],viewMode:0,pageType:i.PAGE_TYPE_A4,sessionId:o.newGUID()})).defaultFontSize=f.parseToNumber(r.defaultFontSize),s.updateEditorProps(r),s.setDefaultFont(r.defaultFontName,r.defaultFontSize),this._setShortCut(r.shortCutsJSON),s.setViewMode(r.viewMode,!0,!1),s.showSaveSyncButton(!!r.showSaveSyncButton),s.setZoomPercent(r.zoomValue,r.isZoomPercent),a=1,this.initializedByPC=!0}catch(e){t="initializeEditor API:"+e.message,m.error(t),s.trigger("yne-log-to-native",0,t)}return a},t.prototype.insertAttachment=function(e){m.log("insertAttachment");var t=JSON.parse(e),n=this.coreEditor;n.updateResMapWithKey(t.source,t.localSource),n.updateResMapWithKey(t.resource,t.localResource),n.execCommand("comp.InsertAttachment",{fileLength:t.fileLength,fileName:t.fileName,resource:t.resource,retainStartBlock:t.retained,src:t.source})},t.prototype.insertCatalogue=function(){return m.log("insertCatalogue"),this.coreEditor.execCommand("comp.InsertCatalogue"),1},t.prototype.insertHorizontalLine=function(){m.log("insertHorizontalLine");return this.coreEditor.execCommand("comp.InsertHorizontalRule"),1},t.prototype.insertHyperlink=function(e){m.log("insertHyperlink");var t=0;return null!=e&&n.isString(e)&&""!==e&&(this.coreEditor.execCommand("comp.InsertLink",{src:e,styles:this.coreEditor.getController().getEditingInlineState()}),t=1),t},t.prototype.insertImage=function(e,t,n,o,i){m.log("insertImage");var r=this.coreEditor;r.getController().dragProhibited||(r.updateResMapWithKey(e,t,!1),r.execCommand("comp.InsertImage",{height:i,retainStartBlock:n,src:e,width:o}))},t.prototype.insertNoteLink=function(e,t){if(m.log("insertNoteLink"),e&&t){var n,o,i=this.coreEditor,r=p.fillAsUrl(e);o=(n=new l({text:t})).getLength(),n.setStyles(0,o,{color:"rgb(0, 56, 132)",href:r,underline:!0}),i.insertText(n,!1)}},t.prototype.insertTable=function(e,t){m.log("insertTable");var n=0;return e=f.parseToNumber(e,0),t=f.parseToNumber(t,0),null!=e&&e>0&&null!=t&&t>0&&(this.coreEditor.execCommand("comp.InsertTable",{cols:t,rows:e}),n=1),n},t.prototype.insertTodo=function(){m.log("insertTodo"),this.coreEditor.execCommand("comp.InsertTodo",{checked:!1})},t.prototype.isCaretInFirstTextLine=function(e){return m.log("isCaretInFirstTextLine"),this.coreEditor.isCaretInFirstTextLine(e)},t.prototype.isReadyToClose=function(){if(m.log("isReadyToClose"),this.coreEditor.isLegacyHost())return e.prototype.isReadyToClose.call(this);m.debugAlert("isReadyToClose should not be invoked after PC6.0")},t.prototype.reset=function(t){m.log("reset"),e.prototype.reset.call(this),t&&this.coreEditor.isLegacyHost()&&this.resetEditorOptions(t)},t.prototype.resetEditorOptions=function(t){m.log("resetEditorOptions");var o=t;this.coreEditor.isLegacyHost()?(n.isString(o)&&(o=JSON.parse(t)),n.isString(o.collabServer)&&(o.collabServer=JSON.parse(o.collabServer)),n.isString(o.userInfo)&&(o.userInfo=JSON.parse(o.userInfo)),o.isCollabEnabled=f.parseToBoolean(o.isCollabEnabled,!1),e.prototype.resetEditorOptions.call(this,o)):m.debugAlert("resetEditorOptions should not be invoked after PC6.0")},t.prototype.rotateSaveSyncIcon=function(e){m.log("rotateSaveSyncIcon"),this.coreEditor.isLegacyHost()?this.coreEditor.rotateSaveSyncIcon(!!e):m.debugAlert("rotateSaveSyncIcon should not be invoked after PC6.0")},t.prototype.saveNotification=function(t,o){m.log("saveNotification");var i=f.parseToNumber(t),r=f.parseToBoolean(o);if(n.isNaN(i)||null===r)throw new Error("invalid format of savedNoteVersion/isHistorySave"+t+"/"+o);e.prototype.saveNotification.call(this,i,r)},t.prototype.selectCtxMenu=function(e){m.log("selectCtxMenu"),this.trigger("select-context-menu",e)},t.prototype.setCaretPosition=function(e,t){m.log("setCaretPosition"),this.coreEditor.setCaretPosition(e,t)},t.prototype.setContent=function(e,o,r,a){m.log("setContent");var s,l,c,d,u,p,g=this,f=g.coreEditor;try{f.trigger("bridge-off-events"),p=function(e){e.isXml=s,e.callbackUID=a,e.hasHandWrite=f.hasHandWriteBlock(),null!=d&&(l=(d.scrollPercent||0)/t.SCROLL_PERCENT_RATIO,f.setScrollPercentWithDelay(l)),g._setContentCallBack(e)},null!=o&&n.isString(o)&&""!==o.trim()&&(c=JSON.parse(o)),null==r||n.isNumber(r)?(d=g.options||{}).scrollPercent=r:d=JSON.parse(r),d=n.defaults(d,{bgImageId:i.DEFAULT_BACKGROUND,disableBackground:!1,disableOCR:!1,hasOriginFile:!1,hideAttendeeHint:!1,isCollabEnabled:!1,isOCR:!1,ocrType:"ms",ocrParseParagraph:!0,isCopyProhibited:!1,isDragProhibited:!1,ocrParseIndent:!0,isReadOnly:!1,scrollPercent:0,todoContents:{}}),e=$.trim(e),(s=h(e))?f.setXmlContent(e,c,d,p):(f.setHtmlContent(e,c,d,p),f.getNote().setValidForCollab(!1)),f.getNote().isEmptyContent()&&f.useDefaultFontAsEditingStyle()}catch(e){if(u=e.message,m.DEBUG)throw e;m.error(u),f.trigger("yne-log-to-native",0,u),null!=p&&p({resultCode:0,message:u})}},t.prototype.setDefaultFont=function(e,t){m.log("setDefaultFont"),t=parseInt(t+"",10),this.coreEditor.setDefaultFont(e,t),this.coreEditor.getController().setDefaultFont(e,t)},t.prototype.setPageMode=function(e){m.log("setPageMode"),this.coreEditor.isLegacyHost()||!this.coreEditor.isNotSetContent()?this.coreEditor.setViewMode(e,!0,!1):m.debugAlert("setPageMode should NOT be called before setContent")},t.prototype.setShortCut=function(e){var t;m.log("setShortCut"),t=JSON.parse(e),this._setShortCut(t)},t.prototype.setZoomPercent=function(e,t){m.log("setZoomPercent"),this.coreEditor.isLegacyHost()?m.debugAlert("method of setZoomPercent CAN NOT be called in less-than-6.0 PC version"):this.coreEditor.setZoomPercent(e,t)},t.prototype.showSaveSyncButton=function(e){m.log("showSaveSyncButton"),this.coreEditor.isLegacyHost()?(e=!!e,this.coreEditor.showSaveSyncButton(e)):m.debugAlert("setDefaultFont should not be invoked after PC6.0")},t.prototype.toggleAttendeeHint=function(t){m.log("toggleAttendeeHint");var n=f.parseToBoolean(t);this.coreEditor.isLegacyHost()?(null===n&&(n=!0),e.prototype.toggleAttendeeHint.call(this,n),this.coreEditor.toggleAttendeeHint(t)):m.debugAlert("toggleAttendeeHint should not be invoked after PC6.0")},t.prototype.toggleToolbar=function(e){m.log("toggleToolbar"),this.coreEditor.toggleToolbar(e)},t.prototype.triggerEvent=function(e){m.log("triggerEvent: editor api trigger: "+e);var t=n.toArray(arguments);this.trigger("bridge-event",t)},t.prototype.updateAttachment=function(e,t,o,i){m.log("updateAttachment");var a,s,l,c,d=JSON.parse(t),u=this.coreEditor,h=u.getNote(),p=[];if(i){if(!(a=h.getBlockById(i))||!r.isAttachment(a))return;p=[a]}else p=h.getAttachmentByResource(e);p&&p.length?(o=!1!==o,n.each(p,function(e){l=d.source||e.getSource(),c=d.resource||e.getResource(),d.localSource&&u.updateResMapWithKey(l,d.localSource),d.localResource&&u.updateResMapWithKey(c,d.localResource),o?u.execCommand("attachment.Replace",{attachment:e,fileLength:d.fileLength||e.getFileLength(),fileName:d.fileName||e.getFileName(),resource:c,src:l}):(s=["Source","Resource","FileName","FileLength"],n.each(s,function(t){var n="set"+t,o=t.substring(0,1).toLowerCase()+t.substring(1),i=d[o];i&&e[n](i)}))})):m.warn("Can not find attachment by resource: "+e)},t.prototype.updateImage=function(e,t,n,o,i,r,a){m.log("updateImage"),this.coreEditor.isLegacyHost()?this._updateImage(e,t,n,o,i,r,a):m.debugAlert("updateImage should NOT be called after PC 6.0")},t.prototype.updateImageV2=function(e){m.log("updateImageV2");var t=JSON.parse(e);this._updateImage(t.source,t.newSource,t.newLocalSource,t.triggerContentChange,t.blockId,t.width,t.height)},t.prototype.updateUserInfo=function(e){m.log("updateUserInfo");var t=JSON.parse(e);this.coreEditor.updateUserInfo(t)},t.prototype.GET_ENCODED_SRC=function(e){var t,n=document.createElement("img");return n.setAttribute("src",e),t=n.src,n=null,t},t.prototype.HANDLE_PASTE_OLD_CONTENT=function(e,t){var o=this;if(!e||!t)return e;var i=_(e),r=n.toArray(i.querySelectorAll("img[data-media-type=attachment]"));return n.each(r,function(e){var i,r,a=e.getAttribute("data-res-id"),s=e.getAttribute("src");s=o.GET_ENCODED_SRC(s),n.some(t,function(e,t){if((e=o.GET_ENCODED_SRC(e))===s)return i=t,!0}),i?(r={filelength:e.getAttribute("data-file-length"),path:a,src:i},o.SET_ATTRS(r,e)):e.parentNode.removeChild(e)}),r=n.toArray(i.querySelectorAll("img[data-media-type=image]")),n.each(r,function(e){var t,n=e.getAttribute("data-attr-org-src-id");n?(t={src:n},o.SET_ATTRS(t,e)):e.parentNode.removeChild(e)}),e=i.innerHTML},t.prototype.SET_ATTRS=function(e,t){n.each(e,function(e,n){e&&t.setAttribute(n,e)})},t.prototype._setContentCallBack=function(e){this.coreEditor.isLegacyHost()||null==e.callbackUID||this.trigger("callback-to-native",e.callbackUID,[{hasHandWrite:!!e.hasHandWrite,isXml:!!e.isXml,message:e.message,resultCode:e.resultCode}]),this.coreEditor.isCollabEnabled()&&1===e.resultCode&&this.coreEditor.noteSetNotification()},t.prototype._setShortCut=function(e){var t=this.coreEditor;e&&e.length&&n.each(e,function(e){if(e.name)if(0!==e.keyCode){var o=function(e){var t=[],o=e.keyCode,i=n.isNumber(o)?d.getKey(o):o;if(i)return i=(i+"").toLowerCase(),n.each(["ctrl","alt","shift"],function(n){!0===e[n]&&t.push(n)}),t.push(i),t.join("+")}(e);o&&t.updateShortCut(e.name,o)}else t.removeShortCut(e.name)})},t.prototype._updateImage=function(e,t,o,i,a,s,l){if(t||o){var c,d=this.coreEditor,u=d.getNote(),h=[];if(a){if(!(c=u.getBlockById(a))||!r.isImage(c))return;h=[c]}else h=u.getImageBySource(e,!1);h&&h.length?(i=!1!==i,n.each(h,function(e){i?(t=t||e.getSource(),o&&d.updateResMapWithKey(t,o,!1),d.execCommand("comp.ReplaceResource",{heights:[l],resProps:[{source:t}],resources:[e],widths:[s]})):(t&&e.setSource(t),o&&d.updateResMapWithKey(t||e.getSource(),o,!0))})):m.warn("Can not find image by source: "+e)}},t.SCROLL_PERCENT_RATIO=1e4,t.DO_PASTE_CONTENT_TYPE={PLAIN:1,HTML:2,YNE_JSON:3},t}(c)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(6),n(579),n(1)],void 0===(i=function(e,t,n,o,i){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.buildCollabSession=function(e,t){var n,o=0;try{if(t=t||function(){},n=this.coreEditor.getEditorProps(),null==e&&((e={}).shareKey=n.shareKey,e.sessionType=n.sessionType,null!=n.sessionId&&(e.sessionId=n.sessionId)),e.buildVersion=n.buildVersion,e.userInfo=n.userInfo,e.collabServer=n.collabServer,null==e.shareKey||"undefined"===e.shareKey)return t({resultCode:0,message:"shareKey should NOT be null"}),0;this.closeCollabSession(),this.coreEditor.buildCollabSession(e,t),o=1}catch(e){t({resultCode:0,message:e.message})}return o},t.prototype.closeCollabSession=function(){this.coreEditor.closeCollabSession(n.WSEVENTID_HOST_CLOSE,"NormalQuit")},t.prototype.getCollabContent=function(e,t){var n;e=e||function(){};try{return this.coreEditor&&this.coreEditor.isCollabEnabled()?n=this.coreEditor.getCollabContent(e,t):(e(n={status:2,resultCode:2,message:"Not-Collab-Enabled"}),n)}catch(t){return e(n={status:3,resultCode:3,message:t.message}),n}},t.prototype.getModifiers=function(e,t){var n;t=t||function(){};try{return this.coreEditor&&this.coreEditor.isCollabEnabled()?this.coreEditor.getModifiers(e,t):(t(n={status:2,resultCode:2,message:"Not-Collab-Enabled"}),n)}catch(e){return t(n={status:3,resultCode:3,message:e.message}),n}},t.prototype.isReadyToClose=function(){var e=!0;return this.coreEditor&&!this.coreEditor.isLegacyHost()?(i.debugAlert("isReadyToClose should NOT be called in new host"),!1):(this.coreEditor&&this.coreEditor.isCollabEnabled()&&(e=!this.coreEditor.hasCachedDataCmd()),e)},t.prototype.reset=function(){this.coreEditor.reset()},t.prototype.resetEditorOptions=function(e){!this.coreEditor||this.coreEditor.isLegacyHost()?this.coreEditor.updateEditorOptions(e):i.debugAlert("resetEditorOptions should NOT be called in new Host")},t.prototype.saveNotification=function(e,t){this.coreEditor&&this.coreEditor.isCollabEnabled()&&this.coreEditor.saveNotification(e,t)},t.prototype.toggleAttendeeHint=function(e){!this.coreEditor||this.coreEditor.isLegacyHost()||i.debugAlert("toggleAttendeeHint should NOT be called in New Host")},t.prototype.destroyCollabEngine=function(){this.closeCollabSession()},t.prototype.isNotSetContent=function(){return this.coreEditor.isNotSetContent()},t.prototype.saveFile=function(e){this.coreEditor.testSendMsgToCollabServer(e)},t}(o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o,i,r,a=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});o=[n,t,n(0),n(6),n(13),n(1)],void 0===(i=function(e,t,n,o,i,r){"use strict";return function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.focus=function(){return this.coreEditor.focus()},t.prototype.getContent=function(e,t,n,o){e=!!e||this.coreEditor.hasHandWriteBlock(),o=!!o;try{return!0===e?this.coreEditor.getHtmlContent(o,t,n):this.coreEditor.getXmlContent(t,n)}catch(e){null!=t&&t({status:0,resultCode:2,message:e.message})}},t.prototype.getNoteVersion=function(){return this.coreEditor.getNoteVersion()},t.prototype.getSchemaVersion=function(){return this.coreEditor.getSchemaVersion()},t.prototype.resetFont=function(){return this.coreEditor.resetFont()},t.prototype.setAllBackgrounds=function(e,t){if(!this.coreEditor||this.coreEditor.isLegacyHost())return this.coreEditor.setAllBackgrounds(e,t);r.debugAlert("setAllBackgrounds shoud NOT be called in new host")},t.prototype.setBackground=function(e){if(!this.coreEditor||this.coreEditor.isLegacyHost()||!this.coreEditor.isNotSetContent())return this.coreEditor.setBackground(e);r.debugAlert("setBackground shoud NOT be called before setContent")},t.prototype.setContent=function(e,t,i,a,s){var l=this;try{var c=function(e){l.coreEditor.isCollabEnabled()&&1===e.resultCode&&l.coreEditor.noteSetNotification(),null!=s&&s(e)};null==a&&(a=this.options||{}),a=n.defaults(a,{bgImageId:o.DEFAULT_BACKGROUND,disableBackground:!1,isCollabEnabled:!1,isReadOnly:!1,isAsync:!1}),!0===t?this.coreEditor.setHtmlContent(e,i,a,c):this.coreEditor.setXmlContent(e,i,a,c)}catch(e){r.error(e),null!=s&&s({resultCode:0,message:e.message})}},t.prototype.setFont=function(e,t){return this.coreEditor.setFont(e,t)},t.prototype.setReadOnly=function(e){!this.coreEditor||this.coreEditor.isLegacyHost()?this.coreEditor.setReadOnly(e):r.debugAlert("setReadOnly shoud NOT be called in new host")},t.prototype.setDragProhibited=function(e){this.coreEditor.setDragProhibited(e)},t.prototype.setCopyProhibited=function(e){this.coreEditor.setReadOnly(e)},t.prototype.setEntity=function(e,t){null!=e&&n.isString(e)&&""!==e.trim()&&(e=JSON.parse(e)),this.coreEditor.setEntity(e,t)},t.prototype.refreshPageMode=function(){var e=this.coreEditor.getNote();e&&e.blocks&&e.blocks[0]&&e.blocks[0].trigger("content-change")},t.prototype.initialize=function(e){},t}(i)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e){var t=n(2),o=n(12),i=n(0);return function(e){var n=i.filter(e,function(e){return!t.isImage(e)&&!t.isAttachment(e)&&!t.isHandWrite(e)});return n=i.map(n,function(e){var n;return e.removeAllStyles(),t.isListItem(e)||t.isHeading(e)||t.isCatalogue(e)||t.isTodo(e)?(n=o.createBlank(!1)).setText(e.getText()):n=e,n})}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(0),n(582)],void 0===(i=function(e,t,n,o){"use strict";return n.union(["content-set","open-image","open-attachment","on-paste","snap-screen","clipboard-status","require-paste","edit-link","click","find","check-image","export-pdf","export-word","download-file","exit-full-screen","exit-presentation","save-and-sync","request-image-rendered-src","get-clipboard","share-note","clipboard-set","rotate-image","zoom-changed","log-to-native","user-action-collection","image-ocr","scroll-in-content-loading"],o)}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";return["content-change","insert-photo","insert-link","insert-attachment","replace-image","replace-attachment","open-link","download-attachment","get-entity","request-rendered-imagSrc","download-image","preview-image","context-menu","show-words","save-content","blob-paste","upload-image","clipboard-error","mac-preview","background-failed-update","background-changed","is-vip-user","table-click","image-ocr","collabsession-change","datacommand-success","session-built","session-closed","session-initialized","useraction-failed","user-action-collection","view-mode-change","note-version-change"]}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o,i;o=[n,t,n(584),n(585),n(104)],void 0===(i=function(e,t,n,o,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.injectToWindow=function(){window&&(window.debugTool={breakPoints:n.default,breakPointsGroup:o.default,stopHere:function(e,t){i.breakPointsLog(e,t);var o=n.default&&n.default[e];return o&&o.enable}},window.postMessage({type:"initial-break-points",from:"inspectWindow",sender:"inspectWindow",to:"devPage",payload:{breakPoints:n.default,breakPointsGroup:o.default}},"*"))},e}();t.default=r}.apply(t,o))||(e.exports=i)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={insertCode:{name:"插入代码块",enable:!1,group:["insert","code"]},insertQuote:{name:"插入引用",enable:!1,group:["insert","quote"]},insertTodo:{name:"插入代办",enable:!1,group:["insert","todo"]},insertImage:{name:"插入图片",enable:!1,group:["insert","image"]},insertLink:{name:"插入链接",enable:!1,group:["insert","link"]},insertList:{name:"插入列表",enable:!1,group:["insert","list"]},insertAttachment:{name:"插入附件",enable:!1,group:["insert","attachment"]},insertHorizontalLine:{name:"插入水平线",enable:!1,group:["insert","hr"]},insertTable:{name:"插入表格",enable:!1,group:["insert","table"]},insertCatalogue:{name:"插入目录",enable:!1,group:["insert","catalogue"]},parseNativeRange:{name:"解析原生range",enable:!1,group:["range","other"]},drawRange:{name:"绘制Range",enable:!1,group:["range","other"]},addDragHint:{name:"绘制拖拽光标",enable:!1,group:["drag","other"]},handleKey:{name:"处理key输入",enable:!1,group:["input"]},textInput:{name:"文本输入",enable:!1,group:["input"]},paste:{name:"粘贴",enable:!1,group:["paste","other"]},copy:{name:"复制",enable:!1,group:["copy","other"]},cut:{name:"剪切",enable:!1,group:["cut","other"]},dragStart:{name:"开始拖拽",enable:!1,group:["drag","other"]},dragEnd:{name:"结束拖拽",enable:!1,group:["drag","other"]},pdfPrintCSS:{name:"pdf/print样式",enable:!1,group:["style","other"]},tab:{name:"tab键",enable:!1,group:["key","other"]},codeUpdate:{name:"代码块更新",enable:!1,group:["render","code"]},codeParse:{name:"代码块解析",enable:!1,group:["code"]},codeRender:{name:"代码块渲染",enable:!1,group:["code","render"]},codeSelectAll:{name:"全选代码块",enable:!1,group:["code","style"]},pcPresentation:{name:"pc演示模式",enable:!1,group:["pc","style","other"]},scrollView:{name:"滚动视图",enable:!1,group:["scroll","other"]},setImageWidth:{name:"设置图片宽度",enable:!1,group:["image","render"]},imageHeight:{name:"图片高度溢出",enable:!1,group:["image","render"]},clickMenu:{name:"点击右键菜单",enable:!1,group:["click","menu","other"]},removeFormat:{name:"清除格式",enable:!1,group:["format","other"]},updateSelectionUI:{name:"更新选区UI",enable:!1,group:["range","render"]},execCommand:{name:"执行命令",enable:!1,group:["command","other"]},doUnapply:{name:"undo命令",enable:!1,group:["command","other"]},execEditorApi:{name:"执行api",enable:!1,group:["api","other"]}}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={action:["insert","input","render","other"],feature:["todo","code","quote","image","link","list","attachment","hr","table","catalogue","other"]}}.apply(t,[n,t]))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t,o=n(0),i=n(16),r=n(20),a=n(1),s=n(587),l=o.keys(s),c=function(e){return(e=(e=e.toString()).substr(0,100)).replace(/%/g,function(){return"%%"})};return t=o.extend({_legacyAPIs:["ExitFullScreen"],initialize:function(e){this._editor=e.editor,this._hasReadyRun=!1,this._nativeApiObj=window.YNote||{}},execEditorApi:function(e,t){var n,o,i=this._editor,r=Date.now(),s="EditorApi."+e;if(!i[e])return o="Editor does not implement api: "+e,a.error(o),this.callNativeApi("Log",[this._nativeApiObj.LOG_FATAL,o]),n;if(a.DEBUG)a.profile(s),a.time(s),n=i[e].apply(i,t);else try{n=i[e].apply(i,t)}catch(t){o="Failed to execute EditorAPI:"+e,a.error(o,t),this.callNativeApi("Log",[this._nativeApiObj.LOG_FATAL,o])}return a.DEBUG&&(a.timeEnd(s),a.profileEnd(s)),this.callNativeApi("Log",[this._nativeApiObj.LOG_TEST,"@@ANALYSIS@@ javascript:"+e+"="+(Date.now()-r)]),n},callNativeApi:function(e,t){var n,o,i=this._nativeApiObj,r="nativeApi."+e;if(-1!==l.indexOf(e))return a.log("Executing native Api:"+e,t),(n=i[e])?(a.DEBUG&&(a.profile(r),a.time(r)),"Log"===e?t[1]=c(t[1]):this._logMethodInfoToNative(e,t),o=n.apply(i,t||[]),a.DEBUG&&(a.timeEnd(r),a.profileEnd(r))):a.error("no native api: "+e),o;a.error("The native api ["+e+"] is not in nativeApiInterface.js")},asyncCallNativeApi:function(e,t,n){var o,i=this,r="on"+e;i.off(r),"function"==typeof t&&(n=t,t=[]),o=function(){i.off(r,o),n.apply(null,arguments)},i.on(r,o,i),i._nativeApiObj[e].apply(i._nativeApiObj,t)},ready:function(){this._hasReadyRun||(this._hasReadyRun=!0,this._checkNativeApi(),this._nativeApiObj.Ready(this.execEditorApi.bind(this),document))},_checkNativeApi:function(){var e=this,t=e._nativeApiObj,n=[];o.each(l,function(o){null==t[o]&&(e._editor.isLegacyHost()||-1===e._legacyAPIs.indexOf(o))&&(n.push(o),a.error("Native does not implement api: "+o))}),a.DEBUG&&n.length>0&&(n=n.join("\n - "),window.alert("No native apis: \n - "+n))},_logMethodInfoToNative:function(e,t){var n="NativeAPI:"+e;t&&t.length>0&&o.each(t,function(e){n=n+"#"+c(e)}),this._nativeApiObj.Log.apply(this._nativeApiObj,[4,n])}},r.Events),i.extend(t)}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(){return{Ready:function(e,t){},PasteAsText:function(){},PasteNoteLink:function(){},ClipboardAvailable:function(){},IsNoteLinkInClipboard:function(){},OnDocumentChange:function(){},OnAreaClick:function(){},OpenLink:function(e){},OpenNote:function(e){},OpenImage:function(e){},Paste:function(){},CtxMenu:function(e){},InsertAttachments:function(e){},ReplaceAttachments:function(e,t,n){},FindText:function(){},OpenAttachment:function(e,t,n){},SaveImage:function(e){},SaveAsAttachment:function(e){},GetTemplateEntity:function(e,t){},RequestReplaceImage:function(e,t,n){},CloneAttachmentAsync:function(e,t){},SaveImageToNote:function(e,t){},IsImageSavedToNote:function(e,t){},ShowInsertLinkDialogAsync:function(e){},GetFocus:function(){},ReloadEditor:function(){},SnapScreen:function(e){},OnCopy:function(e){},Log:function(e,t){},NoteEditorActionCollection:function(e){},LOG_TEST:4,LOG_DEBUG:3,LOG_INFO:2,LOG_WARN:1,LOG_FATAL:0,ShowNoteCharNum:function(e,t){},OnDrop:function(e,t){},ShowShareMenu:function(){},Export2PDF:function(){},Export2Word:function(){},DownloadOriginFile:function(){},ExitFullScreen:function(){},ExitPresentation:function(){},PageModeChanged:function(e){},StartSync:function(){},GetClipboardData:function(e){},RotateImage:function(e,t,n){},OnChangeZoomByEditor:function(e){},ChangeBGImage:function(e,t){},ChangeBGImageFailed:function(e){},IsVIPUser:function(){},OnCollabSessionChange:function(){},OnDataCommandSuccess:function(e){},OnSessionBuilt:function(e){},OnSessionClosed:function(e){},OnSessionInitialized:function(e,t){},OnUserActionFailed:function(e){},EditorCallBack:function(e){},GetVersion:function(){},ImageOCR:function(e){},OnScrollInContentLoading:function(){}}}.call(t,n,t,e))||(e.exports=o)},function(e,t,n){var o;void 0===(o=function(e){var t=n(0),o=n(13);return o.extend({_noteId:null,_xhr:null,_fileReader:null,_queue:null,_savingItem:null,_cacheData:null,initialize:function(){this._queue=[],this._cacheData={}},updateNoteId:function(e){e&&(this._noteId=e,this._queue=t.filter(this._queue,function(t){return t.noteId===e}),this._cacheData={},this._resetSaveProgress())},addImgInfo:function(e,n){if(n&&e){var o=this;o._noteId===n&&(t.isArray(e)||(e=[e]),t.each(e,function(e){if(e&&e.source&&e.extraSource&&e.blockId){var i=t.find(o._queue,function(t){return e.blockId===t.blockId});i?(i.source=e.source,i.extraSource=e.extraSource,i.encode=!1):o._queue.push({source:e.source,extraSource:e.extraSource,blockId:e.blockId,noteId:n,encode:!1})}}))}},startSave:function(){var e,t,n;if(!this._savingItem){for(e=this._queue;e&&e.length&&(!t||t.noteId!==this._noteId);)t=e.shift();if(t){if(n=this._cacheData[t.extraSource])return this.trigger("save-image",n,t),void this.startSaveWithDelay();this._loadItem(t)}}},startSaveWithDelay:function(e){var t=this;e=e||100,window.setTimeout(function(){t.startSave()},e)},_resetSaveProgress:function(){this._xhr&&(this._xhr.onload=null,this._xhr.abort(),this._xhr=null),this._fileReader&&(this._fileReader.onload=null,this._fileReader.abort(),this._fileReader=null),this._savingItem=null},_loadItem:function(e){var t;this._resetSaveProgress(),this._xhr=t=new XMLHttpRequest,t.responseType="blob",this._savingItem=e,t.onload=this._xhrOnLoadEnd.bind(this),t.open("GET",e.extraSource,!0),t.send()},_xhrOnLoadEnd:function(){var e,t=this,n=t._xhr,o=t._savingItem,i=o.noteId,r=t._noteId===i;if(!n.response||!r)return r&&!1===o.encode&&(e=function(e){var t=e.lastIndexOf("\\");if(-1!==t)return{path:e.substring(0,t+1),fileName:e.substring(t+1)}}(o.extraSource))&&t._queue.unshift({source:o.source,extraSource:e.path+window.encodeURIComponent(e.fileName),blockId:o.blockId,noteId:i,encode:!0}),t._resetSaveProgress(),void t.startSaveWithDelay();t._fileReader=new FileReader,t._fileReader.onload=function(){this.result&&t._noteId===i&&t._saveData(this.result,o),t._resetSaveProgress(),t.startSaveWithDelay()},t._fileReader.readAsDataURL(n.response)},_saveData:function(e,t){this._cacheData[t.extraSource]=e,this.trigger("save-image",e,t)},stopSave:function(){this._resetSaveProgress()}})}.call(t,n,t,e))||(e.exports=o)},,,,,,function(e,t){},,,,,,,function(e,t){}])});