webpackJsonp([16],{367:function(t,e,i){"use strict";function a(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var s=i(442),n=a(s),o=i(441),r=a(o),c="";e.default={data:function(){return{isLogin:2,userid:"",userPic:"",loadWays:"",nickName:"",birthyear:"",birthmonth:"",birthday:"",introduce:"",isFirstLoadFlag:!0,isOkNickNameData:{occupy:!1,legal:!0,blank:!1,format:!0},isOkintroduce:!0}},computed:{isOkBirthday:function(){return!!this.isFirstLoadFlag||this.birthyear&&this.birthmonth&&this.birthday}},methods:{uploadImg:n.default,getInitData:function(){var t=this;ydk.isLogin({success:function(e){e.isLogin?t.isLogin=1:t.isLogin=0}}),ydk.getUserInfo({success:function(e){e&&("weixin"==e.type.toLowerCase()?t.loadWays="微信":"qq"==e.type.toLowerCase()?t.loadWays="QQ":"mail"==e.type.toLowerCase()?t.loadWays="邮箱":"weibo"==e.type.toLowerCase()?t.loadWays="微博":t.loadWays=e.type)}}),ydk.getProfile({success:function(e){e.profile&&(t.userPic=e.profile.option_avatar,t.birthyear=e.profile.option_birthyear,t.birthmonth=e.profile.option_birthmonth,t.birthday=e.profile.option_birthday,t.introduce=e.profile.option_introduction),t.getBirthdy()}}),ydk.getNickname({success:function(e){t.nickName=e.nickname,c=e.nickname}})},getBirthdy:function(){var t=this;new r.default("u-select-year","u-select-month","u-select-day",t.birthyear,t.birthmonth,t.birthday,t)},isNickNameFormat:function(){var t=this,e=/^[a-zA-Z0-9-_\u4e00-\u9fa5]{4,12}$/g;return!!e.test(t.nickName)},getStringNum:function(t){for(var e=0,i=0;i<(t+"").length;i++){var a=t.charCodeAt(i);a>=1&&a<=126||65376<=a&&a<=65439?e++:e+=2}return e},isOkNickName:function(){var t=this;return t.isOkNickNameData.blank=!1,t.isOkNickNameData.occupy=!1,t.isOkNickNameData.legal=!0,t.isOkNickNameData.format=!0,t.nickName?t.nickName&&!t.isNickNameFormat()?void(t.isOkNickNameData.format=!1):void ydk.checkNickname({nickname:t.nickName,success:function(e){102==e.nStatusCode?t.isOkNickNameData.occupy=!0:202==e.nStatusCode?t.isOkNickNameData.legal=!1:e.nStatusCode==-1}}):void(t.isOkNickNameData.blank=!0)},isOkIntroduceEvent:function(){var t=this;t.getStringNum(t.introduce)>20?t.isOkintroduce=!1:t.isOkintroduce=!0},setNickName:function(){var t=this;ydk.setNickname({nickname:t.nickName,success:function(e){0==e.nStatusCode||t.$toast.show({text:"昵称设置失败",type:"error"})}})},setValue:function(){var t=this;ydk.setProfile({profile:{option_avatar:t.userPic,option_birthyear:t.birthyear,option_birthmonth:t.birthmonth,option_birthday:t.birthday,option_introduction:t.introduce},success:function(e){0==e.nStatusCode?t.$toast.show({text:"用户信息设置成功",type:"success"}):t.$toast.show({text:"用户信息设置失败",type:"error"})}})},submitUserInfo:function(){var t=this;return this.isFirstLoadFlag=!1,t.nickName?t.nickName&&!t.isNickNameFormat()?void(t.isOkNickNameData.format=!1):t.birthyear&&t.birthmonth&&t.birthday?t.isOkintroduce?void ydk.getNetworkType({success:function(e){e.online?(c.trim()!==t.nickName.trim()&&ydk.checkNickname({nickname:t.nickName,success:function(e){0==e.nStatusCode?t.setNickName():e.nStatusCode==-1&&t.$toast.show({text:"提交失败，请检查您的网络",type:"warn"})}}),t.setValue()):t.$toast.show({text:"网络连接失败，请检查您的网络",type:"warn"})}}):void(t.isOkintroduce=!1):void(t.isOkBirthday=!1):void(t.isOkNickNameData.blank=!0)},closeWin:function(){ydk.closeWin({type:"setting"})},login:function(){ydk.login({success:function(t){"success"==t.status&&window.location.reload(!0)}})}},created:function(){this.getInitData(),ydk.onLoginStatusChanged({success:function(t){window.location.reload(!0)}})}}},441:function(t,e){"use strict";function i(){this.SelY=document.getElementsByName(arguments[0])[0],this.SelM=document.getElementsByName(arguments[1])[0],this.SelD=document.getElementsByName(arguments[2])[0],this.DefY=this.SelD?arguments[3]:arguments[2],this.DefM=this.SelD?arguments[4]:arguments[3],this.DefD=this.SelD?arguments[5]:arguments[4],this.VM=arguments[6],this.SelY.YMD=this,this.SelM.YMD=this;var t=this;this.SelY.onchange=function(){i.SetM(this.YMD),t.VM.birthyear=this.value},this.SelD&&(this.SelM.onchange=function(){i.SetD(this.YMD),t.VM.birthmonth=this.value}),this.SelD&&(this.SelD.onchange=function(){t.VM.birthday=this.value}),i.SetY(this)}var a=123,s=0;i.SetY=function(t){for(var e=new Date,n=e.getFullYear(),o=n+s;o>n-a;o--){var r=o,c=o,l=new Option(r,c);t.SelY.options.add(l),t.DefY==c&&(l.selected=!0)}i.SetM(t)},i.SetM=function(t){if(t.SelM.length=0,t.SelY.value>0)for(var e=1;e<=12;e++){var a=e+"月",s=e,n=new Option(a,s);t.SelM.options.add(n),t.DefM==s&&(n.selected=!0)}t.SelD&&i.SetD(t)},i.SetD=function(t){var e=t.SelY.value,i=t.SelM.value;if(t.SelD.length=0,e>0&&i>0)for(var a=new Date(e,i,0),s=a.getDate(),n=1;n<=parseInt(s);n++){var o=n+"日",r=n,c=new Option(o,r);t.SelD.options.add(c),t.DefD==r&&(c.selected=!0)}},t.exports=i},442:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t){var e=this;if(t.target.files[0]&&a(e,t.target.files[0].name)){var s,n="_upload_"+(new Date).getTime(),o=$("#upload-img"),r=/^https/i.test(window.location.href||"")?"javascript:false":"about:blank";s=$('<iframe id="'+n+'" name="'+n+'" src="'+r+'" />'),s.css({display:"none"}),s.appendTo("body"),window[n]=function(t){var i=t.url;e.userPic=i};var c="http://shared.youdao.com/dict/oimage-callback/callback.html";o.attr("target",n),o.attr("action",i()+"/upload?method=uploadImage&product=dict&tourl="+c+"?callback="+n),o.submit()}};var i=function(){var t=(new Date).getTime(),e=["a","b","c"];return"http://oimage"+e[t%3]+(t%8+1)+".ydstatic.com"},a=function(t,e){return!!/\.(jpg|jpeg|png|gif|bmp)$/.test(e.toLowerCase())||(t.$toast.show({text:"请选择图片上传",type:"warn"}),!1)}},517:function(t,e){},619:function(t,e,i){t.exports=i.p+"img/userinfo_ic_top_avatar_default_big.png"},685:function(t,e,i){i(517);var a=i(1)(i(367),i(722),"data-v-27aeadf4",null);t.exports=a.exports},722:function(t,e,i){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"userInfoPage"}},[1==t.isLogin?a("div",{staticClass:"loginState"},[a("div",{staticClass:"g-userInfo"},[a("h1",{staticClass:"mainTitle"},[t._v("编辑个人信息")]),t._v(" "),a("form",{staticClass:"upload-img",attrs:{id:"upload-img",name:"userimg",method:"post",enctype:"multipart/form-data"}},[a("dl",{staticClass:"clear-fix userPicWrap"},[a("dt",[t._v("头       像：")]),t._v(" "),a("dd",[a("div",{staticClass:"userPic"},[a("img",{attrs:{src:t.userPic}})]),t._v(" "),a("a",{staticClass:"changeBtn",attrs:{href:"javascript:;"}},[t._v("更改")]),t._v(" "),a("input",{attrs:{type:"file",id:"info-file",name:"fileToUpload",accept:"image/*",multiple:"multiple"},on:{change:t.uploadImg}})])])]),t._v(" "),a("form",{attrs:{id:"userinfo",autocomplete:"off",method:"post",onsubmit:"return false"}},[a("dl",{staticClass:"clear-fix"},[a("dt",[t._v("登录方式：")]),t._v(" "),a("dd",{staticClass:"loadWays"},[t._v(t._s(t.loadWays))])]),t._v(" "),t.isOkNickNameData.blank?a("div",{staticClass:"errorTips"},[t._v("  昵称不可为空\r\n          ")]):t._e(),t._v(" "),t.isOkNickNameData.occupy?a("div",{staticClass:"errorTips"},[t._v("  该昵称已被占用，请换一个\r\n          ")]):t._e(),t._v(" "),0==t.isOkNickNameData.legal?a("div",{staticClass:"errorTips"},[t._v("  该昵称不合法\r\n          ")]):t._e(),t._v(" "),0==t.isOkNickNameData.format?a("div",{staticClass:"errorTips"},[t._v("  4-12个字符，仅支持中英文、数字、“_”或减号\r\n          ")]):t._e(),t._v(" "),a("dl",{staticClass:"clear-fix"},[a("dt",{staticClass:"u-vm"},[t._v("昵       称：")]),t._v(" "),a("dd",[a("div",{staticClass:"input-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.nickName,expression:"nickName",modifiers:{trim:!0}}],staticClass:"g-input-text",attrs:{type:"text",name:"nickName",placeholder:"请输入昵称"},domProps:{value:t.nickName},on:{blur:[function(e){return t.isOkNickName()},function(e){return t.$forceUpdate()}],input:function(e){e.target.composing||(t.nickName=e.target.value.trim())}}})])])]),t._v(" "),a("dl",{staticClass:"clear-fix birthdayWrap"},[a("dt",{staticClass:"u-vm"},[t._v("生       日：")]),t._v(" "),a("dd",{class:{disable:!t.isOkBirthday}},[a("div",{staticClass:"g-select-group"},[a("select",{attrs:{name:"u-select-year"}},[a("option",[t._v(t._s((new Date).getFullYear()))])])]),t._v(" "),a("div",{staticClass:"g-select-group"},[a("select",{attrs:{name:"u-select-month"}},[a("option",[t._v(t._s((new Date).getFullYear()))])])]),t._v(" "),a("div",{staticClass:"g-select-group"},[a("select",{attrs:{name:"u-select-day"}},[a("option",[t._v(t._s((new Date).getFullYear()))])])])])]),t._v(" "),0==t.isOkintroduce?a("div",{staticClass:"errorTips"},[t._v("20个字符以内")]):t._e(),t._v(" "),a("dl",{staticClass:"clear-fix"},[a("dt",{staticClass:"u-vm"},[t._v("介       绍：")]),t._v(" "),a("dd",[a("div",{staticClass:"input-wrap"},[a("input",{directives:[{name:"model",rawName:"v-model",value:t.introduce,expression:"introduce"}],staticClass:"g-input-text",attrs:{type:"text",name:"introduce",placeholder:"请简单介绍自己"},domProps:{value:t.introduce},on:{blur:t.isOkIntroduceEvent,input:function(e){e.target.composing||(t.introduce=e.target.value)}}})])])]),t._v(" "),a("div",{staticClass:"m-bottom-button"},[a("a",{staticClass:"subBtn",attrs:{href:"javascript:;"},on:{click:t.submitUserInfo}},[t._v("修改信息")]),t._v(" "),a("a",{staticClass:"cancelBtn",attrs:{href:"javascript:;"},on:{click:t.closeWin}},[t._v("取消")])])])])]):t._e(),t._v(" "),0==t.isLogin?a("div",{staticClass:"logoutState"},[a("img",{staticClass:"userImg",attrs:{src:i(619)}}),t._v(" "),a("p",{staticClass:"tips"},[t._v("立即登录，解锁更多实用功能")]),t._v(" "),a("a",{staticClass:"logBtn",attrs:{href:"javascript:;"},on:{click:t.login}},[t._v("登录")])]):t._e()])},staticRenderFns:[]}}});